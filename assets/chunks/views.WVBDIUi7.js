const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/layout.contribution.darwin.6yM9hauj.js","assets/chunks/.contribution.BThlLkzn.js","assets/chunks/layout.contribution.linux.C3x3-VMB.js","assets/chunks/layout.contribution.win.B2r8FwHz.js"])))=>i.map(i=>d[i]);
import{gZ as nD,g_ as aD,g$ as dD,ft as cD,h0 as hb,dB as ys,_ as D,V as u,$ as nt,bX as ge,an as z,co as we,dR as st,bW as si,cO as xt,be as se,h1 as lD,eI as $C,p as A,fJ as Ae,b8 as ee,fM as hD,h2 as uD,h3 as pD,e1 as fe,h4 as gD,gV as _n,h5 as ub,J as B,b9 as Ze,aL as N,gg as ja,cn as dd,a3 as c,g6 as Fl,gf as ur,aB as ye,fx as qC,fW as Fn,dJ as zc,fu as mp,dC as jC,dD as YC,fV as Bl,e0 as Be,dE as dt,aq as xe,cq as K,cV as ce,cQ as j,ck as b,dW as Eo,h6 as Gl,dH as be,h7 as fD,dG as X,g2 as uo,dX as He,dI as Q,dO as wc,dP as ji,fr as XC,fs as mD,fO as JC,h8 as wD,en as pr,h9 as Ng,fw as Wl,ha as pb,Z as Qe,b_ as je,dT as ot,dU as oi,cL as At,e6 as de,gb as Js,hb as Kl,gE as es,hc as bD,hd as vD,he as ZC,hf as Vs,em as Ei,ev as at,hg as ya,cR as hi,hh as QC,fS as Ya,hi as eS,hj as tS,hk as iS,hl as sS,hm as oS,hn as rS,ho as nS,hp as aS,hq as dS,hr as cS,hs as Ul,dA as Gt,ht as Hv,hu as zv,dw as ke,f as te,eV as le,hv as Co,o as M,ai as ki,hw as pt,hx as Ai,da as bc,Q as pe,hy as yD,bE as Mr,ab as In,aA as ms,gp as ws,hz as CD,hA as Oi,hB as Ms,hC as Od,cj as Te,dg as Hl,hD as lS,hE as hS,bT as zl,hF as SD,hG as ED,fU as gb,d5 as uS,eg as fs,dY as Ho,ax as Ut,hH as _D,hI as fb,dK as mb,dL as Xa,eN as ID,bZ as Ve,c7 as Bi,hJ as $l,hK as ql,hL as Lt,hM as DD,d7 as Xt,ec as Hs,hN as $c,ed as AD,ga as Ja,hO as TD,ak as et,ei as Rt,hP as Ct,fp as kD,c_ as Ns,hQ as xD,aO as re,hR as Fg,hS as pi,hT as Bg,cX as Mi,ds as I,eS as Ge,aj as ei,av as ve,hU as wb,a4 as wp,hV as LD,hW as $v,dZ as pS,hX as RD,bI as Se,bF as Lo,bG as Me,hY as VD,as as ue,bS as qe,hZ as $t,bk as qc,aw as _o,h_ as gS,aa as gr,h$ as fS,i0 as jc,i1 as bb,i2 as cd,i3 as mS,i4 as zs,i5 as Dn,i6 as wS,e2 as bS,i7 as PD,i8 as An,M as F,i9 as Gg,ia as OD,ib as MD,ic as Dt,id as vS,ie as vb,ig as ND,ci as O,ih as Cs,ii as oe,ij as yS,ik as Ue,il as Le,im as CS,ff as FD,io as Wg,ip as SS,c1 as Ee,c2 as P,iq as Kg,ir as BD,is as vc,it as jl,iu as GD,iv as yt,iw as yb,ix as Ws,iy as Bn,c5 as lt,iz as rs,iA as Zs,c8 as S,c9 as R,cb as T,aN as y,ca as L,cd as C,ar as w,dl as Z,fl as fr,cH as U,iB as Pe,dq as ne,dx as yc,iC as Ni,iD as Ro,Y as Es,iE as Ie,cU as Ne,iF as WD,iG as KD,iH as UD,iI as qv,iJ as HD,iK as jv,iL as ES,af as bp,iM as Cb,iN as zt,iO as sg,iP as zD,iQ as zo,iR as $D,iS as _S,iT as Yv,iU as qD,iV as Sb,iW as Tn,iX as Nt,q as jD,iY as IS,iZ as vp,i_ as DS,eO as Jt,i$ as ho,j0 as AS,j1 as It,j2 as Xv,ce as ld,j3 as mr,j4 as TS,cc as Ce,cl as _,j5 as Ug,j6 as Ri,j7 as Eb,j8 as Xe,j9 as Cc,ja as J,jb as yp,dS as tt,jc as Gn,jd as _b,je as Md,jf as og,jg as Ib,jh as vi,ji as Db,jj as Ca,jk as Qs,jl as Hg,bg as Yi,jm as $s,jn as qs,jo as Br,jp as gi,jq as Zt,aS as Za,jr as YD,du as Ab,d$ as Yc,js as kS,jt as Tb,ju as xS,jv as Cp,jw as hd,jx as Ht,fi as LS,jy as Sa,jz as RS,jA as kn,eG as wr,jB as VS,jC as na,jD as ds,bD as Zi,di as Je,jE as mt,jF as Fe,jG as Wn,jH as PS,d8 as ui,al as Xc,jI as ud,jJ as yi,jK as Yl,fo as kb,f0 as mi,f1 as xn,d4 as Ii,jL as Ji,a9 as oo,jM as Hi,jN as $o,jO as Jc,jP as xb,jQ as OS,jR as XD,jS as Mt,jT as MS,ej as Zn,jU as NS,bM as pd,jV as JD,jW as Sp,dy as Sr,jX as FS,jY as BS,jZ as GS,dN as br,ef as Jv,j_ as Qa,j$ as rg,k0 as ZD,k1 as QD,cg as WS,k2 as zg,k3 as eA,k4 as tA,k5 as iA,k6 as sA,k7 as oA,k8 as rA,k9 as nA,ka as aA,kb as dA,kc as cA,kd as lA,gG as Lb,ke as Xl,kf as Fs,kg as KS,kh as US,ki as hA,kj as Rb,kk as Vb,kl as uA,km as pA,kn as gA,ko as fA,kp as mA,kq as wA,fj as Pb,f_ as HS,aU as Ob,kr as zS,ks as bA,kt as vA,ku as yA,kv as CA,kw as SA,aC as Ln,kx as EA,ky as _A,kz as $S,kA as qS,kB as Zv,kC as IA,kD as Zc,kE as jS,kF as Qc,kG as DA,kH as AA,kI as TA,kJ as kA,kK as xA,kL as ut,kM as Qv,kN as Jl,kO as LA,kP as RA,kQ as YS,ct as Ep,kR as VA,cW as _p,kS as Vr,kT as PA,kU as OA,kV as MA,kW as NA,kX as Kn,kY as FA,kZ as BA,k_ as $g,k$ as GA,l0 as WA,l1 as KA,l2 as UA,c$ as HA,bV as me,l3 as qg,l4 as ey,l5 as zA,l6 as Xo,l7 as $A,l8 as qA,l9 as jA,la as Er,lb as YA,fL as XA,e9 as Ss,lc as JA,fB as XS,ez as ty,ex as JS,ep as Mb,cM as gd,eq as ZA,ld as QA,fG as eT,eF as Rn,le as fd,lf as tT,lg as iT,lh as sT,li as ng,lj as Zl,lk as oT,ll as rT,lm as iy,ln as nT,cK as _r,lo as aT,lp as dT,lq as cT,d3 as gl,lr as lT,ls as hT,lt as uT,fz as pT,fA as gT,lu as Ir,lv as Di,lw as qo,lx as Bt,ly as Jo,lz as fT,a1 as Un,lA as jg,a7 as po,gJ as Il,bC as Ip,aQ as he,lB as Nr,lC as mT,lD as wT,lE as ZS,lF as ag,lG as dg,eB as sy,lH as QS,lI as bT,lJ as vT,lK as fl,lL as bs,lM as V,lN as yT,lO as Xi,lP as CT,lQ as ST,bl as ET,lR as Gr,bh as eE,lS as _T,lT as Nb,lU as el,lV as oy,aK as k,lW as IT,lX as tE,lY as DT,lZ as AT,l_ as ry,bj as TT,l$ as ny,cN as Fb,m0 as ay,m1 as kT,cP as iE,m2 as xT,ek as Yg,m3 as ks,m4 as Dl,G as ze,m5 as LT,am as wi,fv as RT,m6 as Dp,h as Ot,m7 as Ea,m8 as VT,m9 as PT,ma as OT,mb as MT,mc as sE,md as NT,me as FT,mf as BT,mg as Ap,ay as Xg,e7 as GT,aG as Bb,aH as Gb,mh as oE,mi as WT,mj as md,mk as Wb,ml as Ql,mm as KT,mn as UT,mo as dy,aR as HT,mp as cy,mq as Tp,mr as Kb,ms as Ub,mt as Hb,mu as qt,mv as rE,mw as zT,mx as io,my as zb,mz as Dd,db as tl,mA as $T,mB as ly,mC as jt,mD as hy,mE as ai,mF as nE,mG as cg,mH as Al,mI as uy,d9 as rt,mJ as zi,mK as qT,mL as jT,mM as YT,mN as XT,mO as js,mP as JT,mQ as di,mR as ZT,mS as QT,mT as ek,mU as tk,mV as ik,mW as Jg,mX as Nd,mY as sk,cZ as Zg,mZ as py,eb as kp,L as gy,m_ as ok,m$ as rk,n0 as $b,a2 as nk,n1 as aE,n2 as dE,n3 as cE,n4 as ci,n5 as Tl,n6 as ak,bO as dk,n7 as ck,ba as ml,n8 as lk,n9 as hk,na as Fd,nb as uk,nc as lE,nd as fy,ne as Bd,nf as my,ng as pk,nh as gk,ni as hE,nj as fk,nk as lg,nl as mk,nm as wk,gS as bk,nn as vk,no as wy,np as xd,nq as yk,nr as by,ns as Ck,nt as De,nu as qb,cm as Sk,nv as hs,nw as Ek,nx as uE,K as Gd,ny as _k,nz as Ik,nA as Dk,nB as Ak,nC as Tk,nD as kk,nE as xk,nF as Fi,nG as Lk,nH as Rk,nI as pE,nJ as gE,x as ts,nK as Hn,nL as fE,nM as mE,nN as vy,nO as Vk,nP as wE,nQ as Pk,nR as Ok,nS as Mk,nT as bE,nU as Nk,dd as Qn,de as yy,df as Fk,nV as vE,nW as Cy,e8 as _t,nX as Bk,dh as eh,nY as Gk,nZ as Sy,n_ as Wk,gT as jb,n$ as Ey,o0 as _y,o1 as th,o2 as Kk,o3 as Qg,el as yE,o4 as Iy,o5 as CE,o6 as Wd,gY as Uk,o7 as _s,bY as Hk,eX as ih,dM as Dy,o8 as zk,o9 as Ay,oa as Ty,eU as $k,cT as cs,ob as qk,oc as jk,od as ef,oe as ky,of as SE,og as xy,oh as Yk,oi as Xk,oj as Jk,ok as Zk,ol as Qk,om as hg,on as ex,oo as tx,op as ix,oq as sx,or as ox,os as kl,ot as rx,ou as EE,ov as xp,aP as zn,ow as Yb,ox as Ly,oy as nx,oz as Io,oA as Lp,oB as tf,oC as ax,oD as $n,oE as dx,oF as _E,eW as cx,oG as li,oH as lx,oI as hx,oJ as Qi,oK as sh,oL as ux,oM as IE,oN as px,oO as gx,oP as fx,bu as go,oQ as Ry,oR as oh,oS as Rp,oT as mx,cr as Vp,oU as Pp,oV as wx,oW as bx,oX as DE,ao as Vt,ap as Pt,oY as AE,oZ as TE,o_ as kE,o$ as Wt,p0 as xE,p1 as LE,p2 as RE,p3 as VE,p4 as PE,p5 as OE,p6 as ME,p7 as NE,p8 as FE,p9 as BE,pa as Op,pb as GE,pc as ug,pd as qn,pe as eo,pf as rh,pg as WE,ph as Kt,pi as pg,pj as vx,fa as KE,gq as yx,pk as UE,gi as jo,pl as Cx,cE as HE,pm as zE,pn as Sx,po as Bs,pp as Vy,pq as Mp,pr as Ex,ps as $E,pt as qE,pu as _x,pv as Ix,pw as Py,px as Dx,py as Ax,pz as St,pA as ct,pB as So,pC as Fr,pD as Tx,pE as Qt,pF as Wr,pG as kx,pH as nh,pI as Xb,pJ as ti,pK as wl,pL as xx,pM as Lx,pN as gg,pO as Vn,pP as jE,pQ as YE,pR as _a,pS as Rx,pT as Vx,pU as Px,pV as Ox,pW as Mx,pX as aa,pY as Jb,pZ as fg,p_ as Oy,p$ as ro,q0 as bl,q1 as so,q2 as sf,q3 as My,q4 as Kd,q5 as XE,q6 as JE,q7 as Nx,q8 as Fx,q9 as ZE,qa as Bx,qb as Ny,gM as QE,qc as Ud,qd as Fy,qe as By,qf as e_,qg as Gx,qh as Wx,qi as t_,qj as Kx,qk as Ux,c3 as Hx,ql as zx,qm as gs,qn as Gy,qo as $x,qp as Wy,qq as mg,qr as qx,qs as jx,qt as Yx,qu as Xx,qv as Jx,qw as Zx,qx as Qx,qy as i_,qz as eL,qA as s_,qB as no,qC as tL,qD as Ky,qE as kr,qF as Uy,qG as iL,qH as Hy,qI as zy,qJ as of,qK as o_,qL as Np,qM as il,qN as Ld,qO as sL,qP as oL,qQ as rL,qR as nL,qS as aL,qT as r_,qU as n_,qV as dL,qW as cL,qX as lL,qY as hL,qZ as uL,q_ as pL,q$ as gL,r0 as fL,r1 as mL,r2 as wL,r3 as sl,r4 as Fp,r5 as bL,r6 as vL,r7 as yL,r8 as ed,r9 as Zb,ra as CL,rb as SL,rc as a_,rd as Sc,re as wg,rf as Ad,gK as EL,rg as $y,rh as _L,ri as IL,gj as DL,gR as qy,rj as jy,cv as d_,rk as AL,rl as Pn,rm as TL,rn as kL,ah as Hd,ro as Yy,rp as xL,rq as it,rr as Bp,rs as LL,w as xl,rt as RL,ru as c_,rv as VL,rw as fi,rx as Qb,ry as ev,rz as tv,rA as l_,rB as fo,rC as vl,rD as PL,rE as Xy,rF as OL,rG as xr,rH as Jy,rI as ML,rJ as rf,rK as bg,rL as Zy,rM as yl,rN as NL,rO as FL,rP as Qy,rQ as h_,rR as u_,rS as Cl,rT as BL,rU as GL,rV as WL,rW as KL,rX as UL,rY as HL,rZ as zL,r_ as p_,r$ as g_,s0 as f_,s1 as ah,s2 as $L,s3 as eC,s4 as qL,s5 as da,s6 as vg,s7 as jL,s8 as YL,s9 as dh,sa as XL,sb as Ke,sc as wd,sd as Gp,se as iv,sf as JL,sg as ZL,sh as m_,si as QL,sj as tC,sk as Zo,sl as eR,sm as tR,sn as Sl,so as zd,sp as iR,sq as w_,sr as sR,f4 as iC,ss as oR,f6 as rR,f7 as nR,st as aR,fk as dR,su as nf,sv as af,sw as df,sx as cR,sy as lR,sz as hR,sA as uR,sB as pR,sC as gR,sD as sv,sE as fR,sF as sC,sG as mR,sH as oC,sI as b_,sJ as v_,sK as wR,sL as bR,sM as vR,sN as yR,sO as CR,fZ as SR,sP as ER,sQ as yg,sR as y_,sS as Vi,sT as ov,sU as Is,sV as Ds,sW as ri,sX as _R,sY as IR,sZ as rv,s_ as ol,s$ as rl,t0 as nl,t1 as C_,t2 as DR,t3 as AR,t4 as TR,t5 as S_,t6 as kR,t7 as Wp,t8 as Cg,t9 as Sg,ta as E_,tb as xR,tc as LR,td as RR,te as VR,tf as al,tg as __,th as Kp,ti as bd,tj as Vo,tk as Po,tl as nv,tm as PR,tn as I_,to as OR,tp as MR,tq as NR,tr as FR,ts as BR,tt as GR,tu as WR,tv as Eg,gc as KR}from"./lspPlugin.CHzmpfo0.js";import{Z as _g}from"./framework.YNMxXZI1.js";import{A as UR,r as bt,S as Ks,f as D_,U as Ys,B as A_,F as td,T as HR}from"./fileCommands._save.DvtWo3YO.js";import{I as zR}from"./workbenchThemeService.service.BiwwaYjD.js";const $R=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),qR=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));let cf=class extends aD{constructor(e,t,i,s,o,r,n,d){super(e,t,o,i),this.storageService=i,this.instantiationService=s,this.contextMenuService=r,this.extensionService=n,this.contextService=d}create(e){super.create(e),this.viewPaneContainer=this._register(this.createViewPaneContainer(e)),this._register(this.viewPaneContainer.onTitleAreaUpdate(()=>this.updateTitleArea())),this.viewPaneContainer.create(e)}setVisible(e){super.setVisible(e),this.viewPaneContainer?.setVisible(e)}layout(e){this.viewPaneContainer?.layout(e)}setBoundarySashes(e){this.viewPaneContainer?.setBoundarySashes(e)}getOptimalWidth(){return this.viewPaneContainer?.getOptimalWidth()??0}openView(e,t){return this.viewPaneContainer?.openView(e,t)}getViewPaneContainer(){return this.viewPaneContainer}getActionsContext(){return this.getViewPaneContainer()?.getActionsContext()}getContextMenuActions(){return this.viewPaneContainer?.menuActions?.getContextMenuActions()??[]}getMenuIds(){const e=[];return this.viewPaneContainer?.menuActions&&(e.push(this.viewPaneContainer.menuActions.menuId),this.viewPaneContainer.isViewMergedWithContainer()&&e.push(this.viewPaneContainer.panes[0].menuActions.menuId)),e}getActions(){const e=[];if(this.viewPaneContainer?.menuActions&&(e.push(...this.viewPaneContainer.menuActions.getPrimaryActions()),this.viewPaneContainer.isViewMergedWithContainer())){const t=this.viewPaneContainer.panes[0];t.shouldShowFilterInHeader()&&e.push(dD),e.push(...t.menuActions.getPrimaryActions())}return e}getSecondaryActions(){if(!this.viewPaneContainer?.menuActions)return[];const e=this.viewPaneContainer.isViewMergedWithContainer()?this.viewPaneContainer.panes[0].menuActions.getSecondaryActions():[];let t=this.viewPaneContainer.menuActions.getSecondaryActions();const i=t.findIndex(s=>s instanceof cD&&s.item.submenu===hb);if(i!==-1){const s=t[i];s.actions.some(({enabled:o})=>o)?t.length===1&&e.length===0?t=s.actions.slice():i!==0&&(t=[s,...t.slice(0,i),...t.slice(i+1)]):t.splice(i,1)}return t.length&&e.length?[...t,new ys,...e]:t.length?t:e}getActionViewItem(e,t){return this.viewPaneContainer?.getActionViewItem(e,t)}getTitle(){return this.viewPaneContainer?.getTitle()??""}focus(){super.focus(),this.viewPaneContainer?.focus()}};cf=D([u(1,nt),u(2,ge),u(3,z),u(4,we),u(5,st),u(6,si),u(7,xt)],cf);class av extends nD{static create(e,t,i,s,o,r,n){return new av(e,t,i,s,o,r,n)}constructor(e,t,i,s,o,r,n){super(e,t,i,s,o,r),this.iconUrl=n}}const Us={Viewlets:"workbench.contributions.viewlets",Panels:"workbench.contributions.panels",Auxiliary:"workbench.contributions.auxiliary"};class dv extends lD{registerPaneComposite(e){super.registerComposite(e)}deregisterPaneComposite(e){super.deregisterComposite(e)}getPaneComposite(e){return this.getComposite(e)}getPaneComposites(){return this.getComposites()}}se.add(Us.Viewlets,new dv);se.add(Us.Panels,new dv);se.add(Us.Auxiliary,new dv);const jR=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));xe(jR);class YR extends $C{constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m,v,E,x){super(E,x,d,t,s),this.notificationService=e,this.storageService=t,this.contextMenuService=i,this.keybindingService=o,this.hoverService=r,this.instantiationService=n,this.registry=l,this.activeCompositeSettingsKey=h,this.defaultCompositeId=p,this.nameForTelemetry=g,this.compositeCSSClass=f,this.titleForegroundColor=m,this.titleBorderColor=v,this.onDidCompositeOpen=this._register(new A),this.onDidCompositeClose=this._register(new A),this.mapCompositeToCompositeContainer=new Map,this.mapActionsBindingToComposite=new Map,this.instantiatedCompositeItems=new Map,this.actionsListener=this._register(new Ae),this.lastActiveCompositeId=t.get(h,ee.WORKSPACE,this.defaultCompositeId),this.toolbarHoverDelegate=this._register(hD()),this.trailingSeparator=x.trailingSeparator??!1}openComposite(e,t){if(this.activeComposite?.getId()===e)return t&&this.activeComposite.focus(),this.activeComposite;if(this.element)return this.doOpenComposite(e,t)}doOpenComposite(e,t=!1){const i=uD.nextId();this.currentCompositeOpenToken=i,this.activeComposite&&this.hideActiveComposite(),this.updateTitle(e);const s=this.createComposite(e,!0);if(!(this.currentCompositeOpenToken!==i||this.activeComposite&&this.activeComposite.getId()!==s.getId()))return this.activeComposite?.getId()===s.getId()?(t&&s.focus(),this.onDidCompositeOpen.fire({composite:s,focus:t}),s):(this.showComposite(s),t&&s.focus(),s&&this.onDidCompositeOpen.fire({composite:s,focus:t}),s)}createComposite(e,t){const i=this.instantiatedCompositeItems.get(e);if(i)return i.composite;const s=this.registry.getComposite(e);if(s){const o=this,r=new pD(fe(this.progressBar),this._register(new class extends gD{constructor(){super(s.id,!!t),this._register(o.onDidCompositeOpen.event(h=>this.onScopeOpened(h.composite.getId()))),this._register(o.onDidCompositeClose.event(h=>this.onScopeClosed(h.getId())))}})),n=this._register(this.instantiationService.createChild(new _n([ub,r]))),d=s.instantiate(n),l=new B;return this.instantiatedCompositeItems.set(e,{composite:d,disposable:l,progress:r}),l.add(d.onTitleAreaUpdate(()=>this.onTitleAreaUpdate(d.getId()),this)),l.add(n),d}throw new Error(`Unable to find composite with id ${e}`)}showComposite(e){this.activeComposite=e;const t=this.activeComposite.getId();t!==this.defaultCompositeId?this.storageService.store(this.activeCompositeSettingsKey,t,ee.WORKSPACE,Ze.MACHINE):this.storageService.remove(this.activeCompositeSettingsKey,ee.WORKSPACE),this.lastActiveCompositeId=this.activeComposite.getId();let i=this.mapCompositeToCompositeContainer.get(e.getId());if(i||(i=N(".composite"),i.classList.add(...this.compositeCSSClass.split(" ")),i.id=e.getId(),e.create(i),e.updateStyles(),this.mapCompositeToCompositeContainer.set(e.getId(),i)),!this.activeComposite||e.getId()!==this.activeComposite.getId())return;this.contentArea?.appendChild(i),ja(i);const s=fe(this.toolBar);s.actionRunner=e.getActionRunner();const o=this.registry.getComposite(e.getId());o&&o.name!==e.getTitle()&&this.updateTitle(e.getId(),e.getTitle());let r=this.mapActionsBindingToComposite.get(e.getId());r||(r=this.collectCompositeActions(e),this.mapActionsBindingToComposite.set(e.getId(),r)),r(),this.actionsListener.value=s.actionRunner.onDidRun(n=>{n.error&&!dd(n.error)&&this.notificationService.error(n.error)}),e.setVisible(!0),!(!this.activeComposite||e.getId()!==this.activeComposite.getId())&&(this.contentAreaSize&&e.layout(this.contentAreaSize),this.boundarySashes&&e.setBoundarySashes(this.boundarySashes))}onTitleAreaUpdate(e){const t=this.instantiatedCompositeItems.get(e);if(t&&this.updateTitle(e,t.composite.getTitle()),this.activeComposite?.getId()===e){const i=this.collectCompositeActions(this.activeComposite);this.mapActionsBindingToComposite.set(this.activeComposite.getId(),i),i()}else this.mapActionsBindingToComposite.delete(e)}updateTitle(e,t){const i=this.registry.getComposite(e);if(!i||!this.titleLabel)return;t||(t=i.name);const s=this.keybindingService.lookupKeybinding(e);this.titleLabel.updateTitle(e,t,s?.getLabel()??void 0),fe(this.toolBar).setAriaLabel(c(3044,"{0} actions",t))}collectCompositeActions(e){const t=e?.getMenuIds(),i=e?.getActions().slice(0)||[],s=e?.getSecondaryActions().slice(0)||[],o=fe(this.toolBar);return o.context=this.actionsContextProvider(),()=>{o.setActions(Fl(i),Fl(s),t),this.titleArea?.classList.toggle("has-actions",i.length>0||s.length>0)}}getActiveComposite(){return this.activeComposite}getLastActiveCompositeId(){return this.lastActiveCompositeId}hideActiveComposite(){if(!this.activeComposite)return;const e=this.activeComposite;this.activeComposite=void 0;const t=this.mapCompositeToCompositeContainer.get(e.getId());return e.setVisible(!1),t&&(t.remove(),ur(t)),this.progressBar?.stop().hide(),this.toolBar&&this.collectCompositeActions()(),this.onDidCompositeClose.fire(e),e}createTitleArea(e){const t=ye(e,N(".composite"));t.classList.add("title"),this.titleLabel=this.createTitleLabel(t);const i=ye(t,N(".title-actions"));return this.toolBar=this._register(this.instantiationService.createInstance(qC,i,{actionViewItemProvider:(s,o)=>this.actionViewItemProvider(s,o),orientation:Fn.HORIZONTAL,getKeyBinding:s=>this.keybindingService.lookupKeybinding(s.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:c(3045,"Views and More Actions..."),telemetrySource:this.nameForTelemetry,hoverDelegate:this.toolbarHoverDelegate,trailingSeparator:this.trailingSeparator})),this.collectCompositeActions()(),t}createTitleLabel(e){const t=ye(e,N(".title-label")),i=ye(t,N("h2"));this.titleLabelElement=i;const s=this._register(this.hoverService.setupManagedHover(zc("mouse"),i,"")),o=this;return{updateTitle:(r,n,d)=>{(!this.activeComposite||this.activeComposite.getId()===r)&&(i.textContent=n,s.update(d?c(3046,"{0} ({1})",n,d):n))},updateStyles:()=>{i.style.color=o.titleForegroundColor&&o.getColor(o.titleForegroundColor)||"";const r=o.titleBorderColor?o.getColor(o.titleBorderColor):void 0;e.style.borderBottom=r?`1px solid ${r}`:""}}}createHeaderArea(){return N(".composite")}createFooterArea(){return N(".composite")}updateStyles(){super.updateStyles(),fe(this.titleLabel).updateStyles()}actionViewItemProvider(e,t){return this.activeComposite?this.activeComposite.getActionViewItem(e,t):mp(this.instantiationService,e,t)}actionsContextProvider(){return this.activeComposite?this.activeComposite.getActionsContext():null}createContentArea(e){const t=ye(e,N(".content"));return this.progressBar=this._register(new jC(t,YC)),this.progressBar.hide(),t}getProgressIndicator(e){const t=this.instantiatedCompositeItems.get(e);return t?t.progress:void 0}getTitleAreaDropDownAnchorAlignment(){return Bl.RIGHT}layout(e,t,i,s){super.layout(e,t,i,s),this.contentAreaSize=Be.lift(super.layoutContents(e,t).contentSize),this.activeComposite?.layout(this.contentAreaSize)}setBoundarySashes(e){this.boundarySashes=e,this.activeComposite?.setBoundarySashes(e)}removeComposite(e){if(this.activeComposite?.getId()===e)return!1;this.mapCompositeToCompositeContainer.delete(e),this.mapActionsBindingToComposite.delete(e);const t=this.instantiatedCompositeItems.get(e);return t&&(t.composite.dispose(),dt(t.disposable),this.instantiatedCompositeItems.delete(e)),!0}dispose(){this.mapCompositeToCompositeContainer.clear(),this.mapActionsBindingToComposite.clear(),this.instantiatedCompositeItems.forEach(e=>{e.composite.dispose(),dt(e.disposable)}),this.instantiatedCompositeItems.clear(),super.dispose()}}var lf;xe(qR);var Re;(function(a){a[a.TOP=0]="TOP",a[a.TITLE=1]="TITLE",a[a.BOTTOM=2]="BOTTOM"})(Re||(Re={}));var $r;let Ec=($r=class extends YR{get snap(){return this.layoutService.isVisible(this.partId)||!!this.paneCompositeBar.value?.getVisiblePaneCompositeIds().length}get onDidPaneCompositeOpen(){return K.map(this.onDidCompositeOpen.event,e=>e.composite)}constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m,v,E,x,G,W,Y,$){let H=ce.Sidebar,ie=Us.Viewlets,q=b.SidebarTitle;e===j.PANEL_PART?(H=ce.Panel,ie=Us.Panels,q=b.PanelTitle):e===j.AUXILIARYBAR_PART&&(H=ce.AuxiliaryBar,ie=Us.Auxiliary,q=b.AuxiliaryBarTitle),super(h,p,g,f,m,v,E,x,se.as(ie),i,G.getDefaultViewContainer(H)?.id||"",r,n,d,l,e,t),this.partId=e,this.activePaneContextKey=s,this.paneFocusContextKey=o,this.viewDescriptorService=G,this.contextKeyService=W,this.extensionService=Y,this.menuService=$,this.onDidPaneCompositeClose=this.onDidCompositeClose.event,this.headerFooterCompositeBarDispoables=this._register(new B),this.paneCompositeBar=this._register(new Ae),this.compositeBarPosition=void 0,this.blockOpening=void 0,this.location=H,this.globalActionsMenuId=q,this.registerListeners()}registerListeners(){this._register(this.onDidPaneCompositeOpen(e=>this.onDidOpen(e))),this._register(this.onDidPaneCompositeClose(this.onDidClose,this)),this._register(this.registry.onDidDeregister(e=>{const t=this.viewDescriptorService.getViewContainersByLocation(this.location).filter(i=>this.viewDescriptorService.getViewContainerModel(i).activeViewDescriptors.length>0);if(t.length){if(this.getActiveComposite()?.getId()===e.id){const i=this.viewDescriptorService.getDefaultViewContainer(this.location)?.id,s=t.filter(o=>o.id===i)[0]||t[0];this.doOpenPaneComposite(s.id)}}else this.layoutService.setPartHidden(!0,this.partId);this.removeComposite(e.id)})),this._register(this.extensionService.onDidRegisterExtensions(()=>{this.layoutCompositeBar()}))}onDidOpen(e){this.activePaneContextKey.set(e.getId())}onDidClose(e){const t=e.getId();this.activePaneContextKey.get()===t&&this.activePaneContextKey.reset()}showComposite(e){this.layoutEmptyMessage(!1),super.showComposite(e),this.layoutCompositeBar()}hideActiveComposite(){const e=super.hideActiveComposite();return this.layoutCompositeBar(),this.layoutEmptyMessage(!0),e}create(e){this.element=e,this.element.classList.add("pane-composite-part"),super.create(e),this.contentArea&&this.createEmptyPaneMessage(this.contentArea),this.updateCompositeBar();const t=this._register(Eo(e));this._register(t.onDidFocus(()=>this.paneFocusContextKey.set(!0))),this._register(t.onDidBlur(()=>this.paneFocusContextKey.set(!1)))}createEmptyPaneMessage(e){this.emptyPaneMessageElement=N(".empty-pane-message-area");const t=N(".empty-pane-message");t.textContent=c(3593,"Drag a view here to display."),this.emptyPaneMessageElement.appendChild(t),e.appendChild(this.emptyPaneMessageElement);const i=s=>{const o=!this.getActiveComposite()||!s,r=s&&this.theme.getColor(pb)?.toString()||"";this.titleContainer&&o&&(this.titleContainer.style.backgroundColor=r),this.headerFooterCompositeBarContainer&&o&&(this.headerFooterCompositeBarContainer.style.backgroundColor=r),this.emptyPaneMessageElement.style.backgroundColor=r};this._register(Gl.INSTANCE.registerTarget(this.element,{onDragOver:s=>{if(be.stop(s.eventData,!0),this.paneCompositeBar.value){const o=this.paneCompositeBar.value.dndHandler.onDragEnter(s.dragAndDropData,void 0,s.eventData);fD(s.eventData.dataTransfer,"move",o)}},onDragEnter:s=>{if(be.stop(s.eventData,!0),this.paneCompositeBar.value){const o=this.paneCompositeBar.value.dndHandler.onDragEnter(s.dragAndDropData,void 0,s.eventData);i(o)}},onDragLeave:s=>{be.stop(s.eventData,!0),i(!1)},onDragEnd:s=>{be.stop(s.eventData,!0),i(!1)},onDrop:s=>{if(be.stop(s.eventData,!0),i(!1),this.paneCompositeBar.value)this.paneCompositeBar.value.dndHandler.drop(s.dragAndDropData,void 0,s.eventData);else{const o=s.dragAndDropData.getData();if(o.type==="composite"){const r=this.viewDescriptorService.getViewContainerById(o.id);this.viewDescriptorService.moveViewContainerToLocation(r,this.location,void 0,"dnd"),this.openPaneComposite(r.id,!0)}else if(o.type==="view"){const r=this.viewDescriptorService.getViewDescriptorById(o.id);if(r.canMoveView){this.viewDescriptorService.moveViewToLocation(r,this.location,"dnd");const n=this.viewDescriptorService.getViewContainerByViewId(r.id);this.openPaneComposite(n.id,!0).then(d=>{d?.openView(r.id,!0)})}}}}}))}createTitleArea(e){const t=super.createTitleArea(e);this._register(X(t,Q.CONTEXT_MENU,s=>{this.onTitleAreaContextMenu(new uo(He(t),s))})),this._register(wc.addTarget(t)),this._register(X(t,ji.Contextmenu,s=>{this.onTitleAreaContextMenu(new uo(He(t),s))}));const i=t.appendChild(N(".global-actions"));return this.globalToolBar=this._register(this.instantiationService.createInstance(XC,i,this.globalActionsMenuId,{actionViewItemProvider:(s,o)=>this.actionViewItemProvider(s,o),orientation:Fn.HORIZONTAL,getKeyBinding:s=>this.keybindingService.lookupKeybinding(s.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:c(3594,"More Actions..."),hoverDelegate:this.toolbarHoverDelegate,hiddenItemStrategy:mD.NoHide,highlightToggledItems:!0,telemetrySource:this.nameForTelemetry})),t}createTitleLabel(e){this.titleContainer=e;const t=super.createTitleLabel(e);this.titleLabelElement.draggable=!0;const i=()=>({type:"composite",id:this.getActivePaneComposite().getId()});return this._register(Gl.INSTANCE.registerDraggable(this.titleLabelElement,i,{})),t}updateCompositeBar(e=!1){const t=this.compositeBarPosition!==void 0,i=this.shouldShowCompositeBar(),s=this.compositeBarPosition,o=i?this.getCompositeBarPosition():void 0;if(!e&&s===o)return;if(t){const n=s===Re.TITLE?this.titleContainer:this.headerFooterCompositeBarContainer;if(!this.paneCompositeBarContainer||!this.paneCompositeBar.value||!n)throw new Error("Composite bar containers should exist when removing the previous composite bar");this.paneCompositeBarContainer.remove(),this.paneCompositeBarContainer=void 0,this.paneCompositeBar.value=void 0,n.classList.remove("has-composite-bar"),s===Re.TOP?this.removeFooterHeaderArea(!0):s===Re.BOTTOM&&this.removeFooterHeaderArea(!1)}let r;switch(o){case Re.TOP:r=this.createHeaderArea();break;case Re.TITLE:r=this.titleContainer;break;case Re.BOTTOM:r=this.createFooterArea();break}if(i){if(this.paneCompositeBarContainer||this.paneCompositeBar.value||!r)throw new Error("Invalid composite bar state when creating the new composite bar");r.classList.add("has-composite-bar"),this.paneCompositeBarContainer=JC(r,N(".composite-bar-container")),this.paneCompositeBar.value=this.createCompositeBar(),this.paneCompositeBar.value.create(this.paneCompositeBarContainer),o===Re.TOP?this.setHeaderArea(r):o===Re.BOTTOM&&this.setFooterArea(r)}this.compositeBarPosition=o,e&&this.layoutCompositeBar()}createHeaderArea(){const e=super.createHeaderArea();return this.createHeaderFooterCompositeBarArea(e)}createFooterArea(){const e=super.createFooterArea();return this.createHeaderFooterCompositeBarArea(e)}createHeaderFooterCompositeBarArea(e){if(this.headerFooterCompositeBarContainer)throw new Error("Header or Footer composite bar already exists");return this.headerFooterCompositeBarContainer=e,this.headerFooterCompositeBarDispoables.add(X(e,Q.CONTEXT_MENU,t=>{this.onCompositeBarAreaContextMenu(new uo(He(e),t))})),this.headerFooterCompositeBarDispoables.add(wc.addTarget(e)),this.headerFooterCompositeBarDispoables.add(X(e,ji.Contextmenu,t=>{this.onCompositeBarAreaContextMenu(new uo(He(e),t))})),e}removeFooterHeaderArea(e){this.headerFooterCompositeBarContainer=void 0,this.headerFooterCompositeBarDispoables.clear(),e?this.removeHeaderArea():this.removeFooterArea()}createCompositeBar(){return this.instantiationService.createInstance(wD,this.getCompositeBarOptions(),this.partId,this)}onTitleAreaUpdate(e){super.onTitleAreaUpdate(e),this.layoutCompositeBar()}async openPaneComposite(e,t){if(typeof e=="string"&&this.getPaneComposite(e))return this.doOpenPaneComposite(e,t);if(await this.extensionService.whenInstalledExtensionsRegistered(),typeof e=="string"&&this.getPaneComposite(e))return this.doOpenPaneComposite(e,t)}async doOpenPaneComposite(e,t){if(this.blockOpening)return this.blockOpening.p;let i;if(!this.layoutService.isVisible(this.partId))try{i=this.blockOpening=new pr,this.layoutService.setPartHidden(!1,this.partId)}finally{this.blockOpening=void 0}try{const s=this.openComposite(e,t);return i?.complete(s),s}catch(s){throw i?.error(s),s}}getPaneComposite(e){return this.registry.getPaneComposite(e)}getPaneComposites(){return this.registry.getPaneComposites().sort((e,t)=>typeof e.order!="number"?1:typeof t.order!="number"?-1:e.order-t.order)}getPinnedPaneCompositeIds(){return this.paneCompositeBar.value?.getPinnedPaneCompositeIds()??[]}getVisiblePaneCompositeIds(){return this.paneCompositeBar.value?.getVisiblePaneCompositeIds()??[]}getPaneCompositeIds(){return this.paneCompositeBar.value?.getPaneCompositeIds()??[]}getActivePaneComposite(){return this.getActiveComposite()}getLastActivePaneCompositeId(){return this.getLastActiveCompositeId()}hideActivePaneComposite(){this.layoutService.isVisible(this.partId)&&this.layoutService.setPartHidden(!0,this.partId),this.hideActiveComposite()}focusCompositeBar(){this.paneCompositeBar.value?.focus()}layout(e,t,i,s){this.layoutService.isVisible(this.partId)&&(this.contentDimension=new Be(e,t),super.layout(this.contentDimension.width,this.contentDimension.height,i,s),this.layoutCompositeBar(),this.layoutEmptyMessage())}layoutCompositeBar(){if(this.contentDimension&&this.dimension&&this.paneCompositeBar.value){const e=this.compositeBarPosition===Re.TITLE?16:8,t=this.partId===j.PANEL_PART?0:1;let i=this.contentDimension.width-e-t;i=Math.max(lf.MIN_COMPOSITE_BAR_WIDTH,i-this.getToolbarWidth()),this.paneCompositeBar.value.layout(i,this.dimension.height)}}layoutEmptyMessage(e=!this.getActiveComposite()){this.element.classList.toggle("empty",e),e&&this.titleLabel?.updateTitle("","")}getToolbarWidth(){if(!this.toolBar||this.compositeBarPosition!==Re.TITLE||!this.getActivePaneComposite())return 0;const t=this.toolBar.getItemsWidth()+this.toolBar.getItemsLength()*4,i=this.globalToolBar?this.globalToolBar.getItemsWidth()+this.globalToolBar.getItemsLength()*4:0;return t+i+8}onTitleAreaContextMenu(e){if(this.shouldShowCompositeBar()&&this.getCompositeBarPosition()===Re.TITLE)return this.onCompositeBarContextMenu(e);{const t=this.getActivePaneComposite(),i=t?t.getContextMenuActions():[];i.length&&this.contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>i,getActionViewItem:(s,o)=>this.actionViewItemProvider(s,o),actionRunner:t.getActionRunner(),skipTelemetry:!0})}}onCompositeBarAreaContextMenu(e){return this.onCompositeBarContextMenu(e)}onCompositeBarContextMenu(e){if(this.paneCompositeBar.value){const t=[...this.paneCompositeBar.value.getContextMenuActions()];t.length&&this.contextMenuService.showContextMenu({getAnchor:()=>e,getActions:()=>t,skipTelemetry:!0})}}getViewsSubmenuAction(){const e=this.getActivePaneComposite()?.getViewPaneContainer();if(e){const t=new B,i=t.add(this.contextKeyService.createScoped(this.element));i.createKey("viewContainer",e.viewContainer.id);const s=this.menuService.getMenuActions(hb,i,{shouldForwardArgs:!0,renderShortTitle:!0}),o=Ng(s,()=>!0).primary;return t.dispose(),o.length>1&&o.some(r=>r.enabled)?new Wl("views",c(3595,"Views"),o):void 0}}},lf=$r,$r.MIN_COMPOSITE_BAR_WIDTH=50,$r);Ec=lf=D([u(9,Qe),u(10,ge),u(11,st),u(12,je),u(13,ot),u(14,oi),u(15,z),u(16,we),u(17,At),u(18,de),u(19,si),u(20,Js)],Ec);var ea;xe($R);var Ps;let hf=(Ps=class extends Ec{get preferredHeight(){return this.layoutService.mainContainerDimension.height*.4}get preferredWidth(){const e=this.getActivePaneComposite();if(!e)return;const t=e.getOptimalWidth();if(typeof t=="number")return Math.max(t,300)}constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m){super(j.AUXILIARYBAR_PART,{hasTitle:!0,trailingSeparator:!0,borderWidth:()=>this.getColor(Kl)||this.getColor(es)?1:0},ea.activeViewSettingsKey,bD.bindTo(h),vD.bindTo(h),"auxiliarybar","auxiliarybar",void 0,ZC,e,t,i,s,o,r,n,d,l,h,p,f),this.commandService=g,this.configurationService=m,this.minimumWidth=170,this.maximumWidth=Number.POSITIVE_INFINITY,this.minimumHeight=0,this.maximumHeight=Number.POSITIVE_INFINITY,this.priority=Vs.Low,this.configuration=this.resolveConfiguration(),this._register(m.onDidChangeConfiguration(v=>{v.affectsConfiguration(Ei.ACTIVITY_BAR_LOCATION)?(this.configuration=this.resolveConfiguration(),this.onDidChangeActivityBarLocation()):v.affectsConfiguration("workbench.secondarySideBar.showLabels")&&(this.configuration=this.resolveConfiguration(),this.updateCompositeBar(!0))}))}resolveConfiguration(){const e=this.configurationService.getValue(Ei.ACTIVITY_BAR_LOCATION),t=e!==at.TOP&&e!==at.BOTTOM,i=t&&this.configurationService.getValue("workbench.secondarySideBar.showLabels")!==!1;return{position:e,canShowLabels:t,showLabels:i}}onDidChangeActivityBarLocation(){this.updateCompositeBar();const e=this.getActiveComposite()?.getId();e&&this.onTitleAreaUpdate(e)}updateStyles(){super.updateStyles();const e=fe(this.getContainer());e.style.backgroundColor=this.getColor(ya)||"";const t=this.getColor(Kl)||this.getColor(es),i=this.layoutService.getSideBarPosition()===hi.RIGHT;e.style.color=this.getColor(QC)||"",e.style.borderLeftColor=t??"",e.style.borderRightColor=t??"",e.style.borderLeftStyle=t&&!i?"solid":"none",e.style.borderRightStyle=t&&i?"solid":"none",e.style.borderLeftWidth=t&&!i?"1px":"0px",e.style.borderRightWidth=t&&i?"1px":"0px"}getCompositeBarOptions(){const e=this;return{partContainerClass:"auxiliarybar",pinnedViewContainersKey:ea.pinnedViewsKey,placeholderViewContainersKey:ea.placeholdeViewContainersKey,viewContainersWorkspaceStateKey:ea.viewContainersWorkspaceStateKey,icon:!this.configuration.showLabels,orientation:Fn.HORIZONTAL,recomputeSizes:!0,activityHoverOptions:{position:()=>this.getCompositeBarPosition()===Re.BOTTOM?Ya.ABOVE:Ya.BELOW},fillExtraContextMenuActions:t=>this.fillExtraContextMenuActions(t),compositeSize:0,iconSize:16,get overflowActionSize(){return e.getCompositeBarPosition()===Re.TITLE?40:30},colors:t=>({activeBackgroundColor:t.getColor(ya),inactiveBackgroundColor:t.getColor(ya),get activeBorderBottomColor(){return e.getCompositeBarPosition()===Re.TITLE?t.getColor(dS):t.getColor(cS)},get activeForegroundColor(){return e.getCompositeBarPosition()===Re.TITLE?t.getColor(nS):t.getColor(aS)},get inactiveForegroundColor(){return e.getCompositeBarPosition()===Re.TITLE?t.getColor(oS):t.getColor(rS)},badgeBackground:t.getColor(sS),badgeForeground:t.getColor(iS),get dragAndDropBorder(){return e.getCompositeBarPosition()===Re.TITLE?t.getColor(eS):t.getColor(tS)}}),compact:!0}}fillExtraContextMenuActions(e){const t=this.layoutService.getSideBarPosition()===hi.LEFT;if(this.getCompositeBarPosition()===Re.TITLE){const r=this.getViewsSubmenuAction();r&&(e.push(new ys),e.push(r))}const i=this.menuService.getMenuActions(b.ActivityBarPositionMenu,this.contextKeyService,{shouldForwardArgs:!0,renderShortTitle:!0}),s=Ul(i).secondary,o=Gt({id:"workbench.action.auxiliarybar.toggleShowLabels",label:this.configuration.showLabels?c(3026,"Show Icons"):c(3027,"Show Labels"),enabled:this.configuration.canShowLabels,run:()=>this.configurationService.updateValue("workbench.secondarySideBar.showLabels",!this.configuration.showLabels)});e.push(new ys,new Wl("workbench.action.panel.position",c(3028,"Activity Bar Position"),s),Gt({id:Hv.ID,label:t?c(3029,"Move Secondary Side Bar Left"):c(3030,"Move Secondary Side Bar Right"),run:()=>this.commandService.executeCommand(Hv.ID)}),o,Gt({id:zv.ID,label:c(3031,"Hide Secondary Side Bar"),run:()=>this.commandService.executeCommand(zv.ID)}))}shouldShowCompositeBar(){return this.configuration.position!==at.HIDDEN}getCompositeBarPosition(){switch(this.configuration.position){case at.TOP:return Re.TOP;case at.BOTTOM:return Re.BOTTOM;case at.HIDDEN:return Re.TITLE;case at.DEFAULT:return Re.TITLE;default:return Re.TITLE}}toJSON(){return{type:j.AUXILIARYBAR_PART}}},ea=Ps,Ps.activeViewSettingsKey="workbench.auxiliarybar.activepanelid",Ps.pinnedViewsKey="workbench.auxiliarybar.pinnedPanels",Ps.placeholdeViewContainersKey="workbench.auxiliarybar.placeholderPanels",Ps.viewContainersWorkspaceStateKey="workbench.auxiliarybar.viewContainersWorkspaceState",Ps);hf=ea=D([u(0,Qe),u(1,ge),u(2,st),u(3,je),u(4,ot),u(5,oi),u(6,z),u(7,we),u(8,At),u(9,de),u(10,si),u(11,ke),u(12,Js),u(13,te)],hf);const T_=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));xe(T_);const XR={separatorBorder:ki.transparent};function Gs(a){return a===le.VERTICAL?le.HORIZONTAL:le.VERTICAL}class JR{constructor(e){this.isLayoutEnabled=e}}function ZR(a,e){return e===le.HORIZONTAL?{left:a.start,right:a.end,top:a.orthogonalStart,bottom:a.orthogonalEnd}:{top:a.start,bottom:a.end,left:a.orthogonalStart,right:a.orthogonalEnd}}function QR(a,e){return e===le.HORIZONTAL?{start:a.left,end:a.right,orthogonalStart:a.top,orthogonalEnd:a.bottom}:{start:a.top,end:a.bottom,orthogonalStart:a.left,orthogonalEnd:a.right}}function as(a,e){if(Math.abs(a)>e)throw new Error("Invalid index");return yD(a,e+1)}class Ye{get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}get absoluteOffset(){return this._absoluteOffset}get absoluteOrthogonalOffset(){return this._absoluteOrthogonalOffset}get styles(){return this._styles}get width(){return this.orientation===le.HORIZONTAL?this.size:this.orthogonalSize}get height(){return this.orientation===le.HORIZONTAL?this.orthogonalSize:this.size}get top(){return this.orientation===le.HORIZONTAL?this._absoluteOffset:this._absoluteOrthogonalOffset}get left(){return this.orientation===le.HORIZONTAL?this._absoluteOrthogonalOffset:this._absoluteOffset}get minimumSize(){return this.children.length===0?0:Math.max(...this.children.map((e,t)=>this.splitview.isViewVisible(t)?e.minimumOrthogonalSize:0))}get maximumSize(){return Math.min(...this.children.map((e,t)=>this.splitview.isViewVisible(t)?e.maximumOrthogonalSize:Number.POSITIVE_INFINITY))}get priority(){if(this.children.length===0)return Vs.Normal;const e=this.children.map(t=>typeof t.priority>"u"?Vs.Normal:t.priority);return e.some(t=>t===Vs.High)?Vs.High:e.some(t=>t===Vs.Low)?Vs.Low:Vs.Normal}get proportionalLayout(){return this.children.length===0?!0:this.children.every(e=>e.proportionalLayout)}get minimumOrthogonalSize(){return this.splitview.minimumSize}get maximumOrthogonalSize(){return this.splitview.maximumSize}get minimumWidth(){return this.orientation===le.HORIZONTAL?this.minimumOrthogonalSize:this.minimumSize}get minimumHeight(){return this.orientation===le.HORIZONTAL?this.minimumSize:this.minimumOrthogonalSize}get maximumWidth(){return this.orientation===le.HORIZONTAL?this.maximumOrthogonalSize:this.maximumSize}get maximumHeight(){return this.orientation===le.HORIZONTAL?this.maximumSize:this.maximumOrthogonalSize}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){if(!(this._boundarySashes.start===e.start&&this._boundarySashes.end===e.end&&this._boundarySashes.orthogonalStart===e.orthogonalStart&&this._boundarySashes.orthogonalEnd===e.orthogonalEnd)){this._boundarySashes=e,this.splitview.orthogonalStartSash=e.orthogonalStart,this.splitview.orthogonalEndSash=e.orthogonalEnd;for(let t=0;t<this.children.length;t++){const i=this.children[t],s=t===0,o=t===this.children.length-1;i.boundarySashes={start:e.orthogonalStart,end:e.orthogonalEnd,orthogonalStart:s?e.start:i.boundarySashes.orthogonalStart,orthogonalEnd:o?e.end:i.boundarySashes.orthogonalEnd}}}}get edgeSnapping(){return this._edgeSnapping}set edgeSnapping(e){if(this._edgeSnapping!==e){this._edgeSnapping=e;for(const t of this.children)t instanceof Ye&&(t.edgeSnapping=e);this.updateSplitviewEdgeSnappingEnablement()}}constructor(e,t,i,s,o=0,r=0,n=!1,d){if(this.orientation=e,this.layoutController=t,this.splitviewProportionalLayout=s,this.children=[],this._absoluteOffset=0,this._absoluteOrthogonalOffset=0,this.absoluteOrthogonalSize=0,this._onDidChange=new A,this.onDidChange=this._onDidChange.event,this._onDidVisibilityChange=new A,this.onDidVisibilityChange=this._onDidVisibilityChange.event,this.childrenVisibilityChangeDisposable=new B,this._onDidScroll=new A,this.onDidScrollDisposable=M.None,this.onDidScroll=this._onDidScroll.event,this.childrenChangeDisposable=M.None,this._onDidSashReset=new A,this.onDidSashReset=this._onDidSashReset.event,this.splitviewSashResetDisposable=M.None,this.childrenSashResetDisposable=M.None,this._boundarySashes={},this._edgeSnapping=!1,this._styles=i,this._size=o,this._orthogonalSize=r,this.element=N(".monaco-grid-branch-node"),!d)this.splitview=new bc(this.element,{orientation:e,styles:i,proportionalLayout:s}),this.splitview.layout(o,{orthogonalSize:r,absoluteOffset:0,absoluteOrthogonalOffset:0,absoluteSize:o,absoluteOrthogonalSize:r});else{const h={views:d.map(g=>({view:g.node,size:g.node.size,visible:g.visible!==!1})),size:this.orthogonalSize},p={proportionalLayout:s,orientation:e,styles:i};this.children=d.map(g=>g.node),this.splitview=new bc(this.element,{...p,descriptor:h}),this.children.forEach((g,f)=>{const m=f===0,v=f===this.children.length;g.boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:m?this.boundarySashes.start:this.splitview.sashes[f-1],orthogonalEnd:v?this.boundarySashes.end:this.splitview.sashes[f]}})}const l=K.map(this.splitview.onDidSashReset,h=>[h]);this.splitviewSashResetDisposable=l(this._onDidSashReset.fire,this._onDidSashReset),this.updateChildrenEvents()}style(e){this._styles=e,this.splitview.style(e);for(const t of this.children)t instanceof Ye&&t.style(e)}layout(e,t,i){if(this.layoutController.isLayoutEnabled){if(typeof i>"u")throw new Error("Invalid state");this._size=i.orthogonalSize,this._orthogonalSize=e,this._absoluteOffset=i.absoluteOffset+t,this._absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this.absoluteOrthogonalSize=i.absoluteOrthogonalSize,this.splitview.layout(i.orthogonalSize,{orthogonalSize:e,absoluteOffset:this._absoluteOrthogonalOffset,absoluteOrthogonalOffset:this._absoluteOffset,absoluteSize:i.absoluteOrthogonalSize,absoluteOrthogonalSize:i.absoluteSize}),this.updateSplitviewEdgeSnappingEnablement()}}setVisible(e){for(const t of this.children)t.setVisible(e)}addChild(e,t,i,s){i=as(i,this.children.length),this.splitview.addView(e,t,i,s),this.children.splice(i,0,e),this.updateBoundarySashes(),this.onDidChildrenChange()}removeChild(e,t){e=as(e,this.children.length);const i=this.splitview.removeView(e,t);return this.children.splice(e,1),this.updateBoundarySashes(),this.onDidChildrenChange(),i}removeAllChildren(){const e=this.splitview.removeAllViews();return this.children.splice(0,this.children.length),this.updateBoundarySashes(),this.onDidChildrenChange(),e}moveChild(e,t){e=as(e,this.children.length),t=as(t,this.children.length),e!==t&&(e<t&&(t-=1),this.splitview.moveView(e,t),this.children.splice(t,0,this.children.splice(e,1)[0]),this.updateBoundarySashes(),this.onDidChildrenChange())}swapChildren(e,t){e=as(e,this.children.length),t=as(t,this.children.length),e!==t&&(this.splitview.swapViews(e,t),[this.children[e].boundarySashes,this.children[t].boundarySashes]=[this.children[e].boundarySashes,this.children[t].boundarySashes],[this.children[e],this.children[t]]=[this.children[t],this.children[e]],this.onDidChildrenChange())}resizeChild(e,t){e=as(e,this.children.length),this.splitview.resizeView(e,t)}isChildExpanded(e){return this.splitview.isViewExpanded(e)}distributeViewSizes(e=!1){if(this.splitview.distributeViewSizes(),e)for(const t of this.children)t instanceof Ye&&t.distributeViewSizes(!0)}getChildSize(e){return e=as(e,this.children.length),this.splitview.getViewSize(e)}isChildVisible(e){return e=as(e,this.children.length),this.splitview.isViewVisible(e)}setChildVisible(e,t){if(e=as(e,this.children.length),this.splitview.isViewVisible(e)===t)return;const i=this.splitview.contentSize===0;this.splitview.setViewVisible(e,t);const s=this.splitview.contentSize===0;(t&&i||!t&&s)&&this._onDidVisibilityChange.fire(t)}getChildCachedVisibleSize(e){return e=as(e,this.children.length),this.splitview.getViewCachedVisibleSize(e)}updateBoundarySashes(){for(let e=0;e<this.children.length;e++)this.children[e].boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:e===0?this.boundarySashes.start:this.splitview.sashes[e-1],orthogonalEnd:e===this.children.length-1?this.boundarySashes.end:this.splitview.sashes[e]}}onDidChildrenChange(){this.updateChildrenEvents(),this._onDidChange.fire(void 0)}updateChildrenEvents(){const e=K.map(K.any(...this.children.map(s=>s.onDidChange)),()=>{});this.childrenChangeDisposable.dispose(),this.childrenChangeDisposable=e(this._onDidChange.fire,this._onDidChange);const t=K.any(...this.children.map((s,o)=>K.map(s.onDidSashReset,r=>[o,...r])));this.childrenSashResetDisposable.dispose(),this.childrenSashResetDisposable=t(this._onDidSashReset.fire,this._onDidSashReset);const i=K.any(K.signal(this.splitview.onDidScroll),...this.children.map(s=>s.onDidScroll));this.onDidScrollDisposable.dispose(),this.onDidScrollDisposable=i(this._onDidScroll.fire,this._onDidScroll),this.childrenVisibilityChangeDisposable.clear(),this.children.forEach((s,o)=>{s instanceof Ye&&this.childrenVisibilityChangeDisposable.add(s.onDidVisibilityChange(r=>{this.setChildVisible(o,r)}))})}trySet2x2(e){if(this.children.length!==2||e.children.length!==2)return M.None;if(this.getChildSize(0)!==e.getChildSize(0))return M.None;const[t,i]=this.children,[s,o]=e.children;if(!(t instanceof wt)||!(i instanceof wt))return M.None;if(!(s instanceof wt)||!(o instanceof wt))return M.None;this.orientation===le.VERTICAL?(i.linkedWidthNode=s.linkedHeightNode=t,t.linkedWidthNode=o.linkedHeightNode=i,o.linkedWidthNode=t.linkedHeightNode=s,s.linkedWidthNode=i.linkedHeightNode=o):(s.linkedWidthNode=i.linkedHeightNode=t,o.linkedWidthNode=t.linkedHeightNode=i,t.linkedWidthNode=o.linkedHeightNode=s,i.linkedWidthNode=s.linkedHeightNode=o);const r=this.splitview.sashes[0],n=e.splitview.sashes[0];return r.linkedSash=n,n.linkedSash=r,this._onDidChange.fire(void 0),e._onDidChange.fire(void 0),pe(()=>{r.linkedSash=n.linkedSash=void 0,t.linkedHeightNode=t.linkedWidthNode=void 0,i.linkedHeightNode=i.linkedWidthNode=void 0,s.linkedHeightNode=s.linkedWidthNode=void 0,o.linkedHeightNode=o.linkedWidthNode=void 0})}updateSplitviewEdgeSnappingEnablement(){this.splitview.startSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset>0,this.splitview.endSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset+this._size<this.absoluteOrthogonalSize}dispose(){for(const e of this.children)e.dispose();this._onDidChange.dispose(),this._onDidSashReset.dispose(),this._onDidVisibilityChange.dispose(),this.childrenVisibilityChangeDisposable.dispose(),this.splitviewSashResetDisposable.dispose(),this.childrenSashResetDisposable.dispose(),this.childrenChangeDisposable.dispose(),this.onDidScrollDisposable.dispose(),this.splitview.dispose()}}function eV(a){const[e,t]=K.split(a.onDidChange,Mr);return K.any(t,K.map(K.latch(K.map(e,i=>[a.minimumWidth,a.maximumWidth,a.minimumHeight,a.maximumHeight]),In),i=>{}))}class wt{get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}get linkedWidthNode(){return this._linkedWidthNode}set linkedWidthNode(e){this._onDidLinkedWidthNodeChange.input=e?e._onDidViewChange:K.None,this._linkedWidthNode=e,this._onDidSetLinkedNode.fire(void 0)}get linkedHeightNode(){return this._linkedHeightNode}set linkedHeightNode(e){this._onDidLinkedHeightNodeChange.input=e?e._onDidViewChange:K.None,this._linkedHeightNode=e,this._onDidSetLinkedNode.fire(void 0)}constructor(e,t,i,s,o=0){this.view=e,this.orientation=t,this.layoutController=i,this._size=0,this.absoluteOffset=0,this.absoluteOrthogonalOffset=0,this.onDidScroll=K.None,this.onDidSashReset=K.None,this._onDidLinkedWidthNodeChange=new Co,this._linkedWidthNode=void 0,this._onDidLinkedHeightNodeChange=new Co,this._linkedHeightNode=void 0,this._onDidSetLinkedNode=new A,this.disposables=new B,this._boundarySashes={},this.cachedWidth=0,this.cachedHeight=0,this.cachedTop=0,this.cachedLeft=0,this._orthogonalSize=s,this._size=o;const r=eV(e);this._onDidViewChange=K.map(r,n=>n&&(this.orientation===le.VERTICAL?n.width:n.height),this.disposables),this.onDidChange=K.any(this._onDidViewChange,this._onDidSetLinkedNode.event,this._onDidLinkedWidthNodeChange.event,this._onDidLinkedHeightNodeChange.event)}get width(){return this.orientation===le.HORIZONTAL?this.orthogonalSize:this.size}get height(){return this.orientation===le.HORIZONTAL?this.size:this.orthogonalSize}get top(){return this.orientation===le.HORIZONTAL?this.absoluteOffset:this.absoluteOrthogonalOffset}get left(){return this.orientation===le.HORIZONTAL?this.absoluteOrthogonalOffset:this.absoluteOffset}get element(){return this.view.element}get minimumWidth(){return this.linkedWidthNode?Math.max(this.linkedWidthNode.view.minimumWidth,this.view.minimumWidth):this.view.minimumWidth}get maximumWidth(){return this.linkedWidthNode?Math.min(this.linkedWidthNode.view.maximumWidth,this.view.maximumWidth):this.view.maximumWidth}get minimumHeight(){return this.linkedHeightNode?Math.max(this.linkedHeightNode.view.minimumHeight,this.view.minimumHeight):this.view.minimumHeight}get maximumHeight(){return this.linkedHeightNode?Math.min(this.linkedHeightNode.view.maximumHeight,this.view.maximumHeight):this.view.maximumHeight}get minimumSize(){return this.orientation===le.HORIZONTAL?this.minimumHeight:this.minimumWidth}get maximumSize(){return this.orientation===le.HORIZONTAL?this.maximumHeight:this.maximumWidth}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return this.view.snap}get minimumOrthogonalSize(){return this.orientation===le.HORIZONTAL?this.minimumWidth:this.minimumHeight}get maximumOrthogonalSize(){return this.orientation===le.HORIZONTAL?this.maximumWidth:this.maximumHeight}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.view.setBoundarySashes?.(ZR(e,this.orientation))}layout(e,t,i){if(this.layoutController.isLayoutEnabled){if(typeof i>"u")throw new Error("Invalid state");this._size=e,this._orthogonalSize=i.orthogonalSize,this.absoluteOffset=i.absoluteOffset+t,this.absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this._layout(this.width,this.height,this.top,this.left)}}_layout(e,t,i,s){this.cachedWidth===e&&this.cachedHeight===t&&this.cachedTop===i&&this.cachedLeft===s||(this.cachedWidth=e,this.cachedHeight=t,this.cachedTop=i,this.cachedLeft=s,this.view.layout(e,t,i,s))}setVisible(e){this.view.setVisible?.(e)}dispose(){this.disposables.dispose()}}function k_(a,e,t){if(a instanceof Ye){const i=new Ye(Gs(a.orientation),a.layoutController,a.styles,a.splitviewProportionalLayout,e,t,a.edgeSnapping);let s=0;for(let o=a.children.length-1;o>=0;o--){const r=a.children[o],n=r instanceof Ye?r.orthogonalSize:r.size;let d=a.size===0?0:Math.round(e*n/a.size);s+=d,o===0&&(d+=e-s),i.addChild(k_(r,t,d),d,0,!0)}return a.dispose(),i}else{const i=new wt(a.view,Gs(a.orientation),a.layoutController,t);return a.dispose(),i}}class Ia{get root(){return this._root}set root(e){const t=this._root;t&&(t.element.remove(),t.dispose()),this._root=e,this.element.appendChild(e.element),this.onDidSashResetRelay.input=e.onDidSashReset,this._onDidChange.input=K.map(e.onDidChange,()=>{}),this._onDidScroll.input=e.onDidScroll}get width(){return this.root.width}get height(){return this.root.height}get minimumWidth(){return this.root.minimumWidth}get minimumHeight(){return this.root.minimumHeight}get maximumWidth(){return this.root.maximumHeight}get maximumHeight(){return this.root.maximumHeight}get orientation(){return this._root.orientation}get boundarySashes(){return this._boundarySashes}set orientation(e){if(this._root.orientation===e)return;const{size:t,orthogonalSize:i,absoluteOffset:s,absoluteOrthogonalOffset:o}=this._root;this.root=k_(this._root,i,t),this.root.layout(t,0,{orthogonalSize:i,absoluteOffset:o,absoluteOrthogonalOffset:s,absoluteSize:t,absoluteOrthogonalSize:i}),this.boundarySashes=this.boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.root.boundarySashes=QR(e,this.orientation)}set edgeSnapping(e){this.root.edgeSnapping=e}constructor(e={}){this.onDidSashResetRelay=new Co,this._onDidScroll=new Co,this._onDidChange=new Co,this._boundarySashes={},this.disposable2x2=M.None,this.onDidSashReset=this.onDidSashResetRelay.event,this.onDidScroll=this._onDidScroll.event,this.onDidChange=this._onDidChange.event,this.maximizedNode=void 0,this._onDidChangeViewMaximized=new A,this.onDidChangeViewMaximized=this._onDidChangeViewMaximized.event,this.element=N(".monaco-grid-view"),this.styles=e.styles||XR,this.proportionalLayout=typeof e.proportionalLayout<"u"?!!e.proportionalLayout:!0,this.layoutController=new JR(!1),this.root=new Ye(le.VERTICAL,this.layoutController,this.styles,this.proportionalLayout)}style(e){this.styles=e,this.root.style(e)}layout(e,t,i=0,s=0){this.layoutController.isLayoutEnabled=!0;const[o,r,n,d]=this.root.orientation===le.HORIZONTAL?[t,e,i,s]:[e,t,s,i];this.root.layout(o,0,{orthogonalSize:r,absoluteOffset:n,absoluteOrthogonalOffset:d,absoluteSize:o,absoluteOrthogonalSize:r})}addView(e,t,i){this.hasMaximizedView()&&this.exitMaximizedView(),this.disposable2x2.dispose(),this.disposable2x2=M.None;const[s,o]=pt(i),[r,n]=this.getNode(s);if(n instanceof Ye){const d=new wt(e,Gs(n.orientation),this.layoutController,n.orthogonalSize);try{n.addChild(d,t,o)}catch(l){throw d.dispose(),l}}else{const[,d]=pt(r),[,l]=pt(s);let h=0;const p=d.getChildCachedVisibleSize(l);typeof p=="number"&&(h=Ai.Invisible(p)),d.removeChild(l).dispose();const f=new Ye(n.orientation,n.layoutController,this.styles,this.proportionalLayout,n.size,n.orthogonalSize,d.edgeSnapping);d.addChild(f,n.size,l);const m=new wt(n.view,d.orientation,this.layoutController,n.size);f.addChild(m,h,0),typeof t!="number"&&t.type==="split"&&(t=Ai.Split(0));const v=new wt(e,d.orientation,this.layoutController,n.size);f.addChild(v,t,o)}this.trySet2x2()}removeView(e,t){this.hasMaximizedView()&&this.exitMaximizedView(),this.disposable2x2.dispose(),this.disposable2x2=M.None;const[i,s]=pt(e),[o,r]=this.getNode(i);if(!(r instanceof Ye))throw new Error("Invalid location");const n=r.children[s];if(!(n instanceof wt))throw new Error("Invalid location");if(r.removeChild(s,t),n.dispose(),r.children.length===0)throw new Error("Invalid grid state");if(r.children.length>1)return this.trySet2x2(),n.view;if(o.length===0){const f=r.children[0];return f instanceof wt||(r.removeChild(0),r.dispose(),this.root=f,this.boundarySashes=this.boundarySashes,this.trySet2x2()),n.view}const[,d]=pt(o),[,l]=pt(i),h=r.isChildVisible(0),p=r.removeChild(0),g=d.children.map((f,m)=>d.getChildSize(m));if(d.removeChild(l,t),r.dispose(),p instanceof Ye){g.splice(l,1,...p.children.map(m=>m.size));const f=p.removeAllChildren();for(let m=0;m<f.length;m++)d.addChild(f[m],f[m].size,l+m)}else{const f=new wt(p.view,Gs(p.orientation),this.layoutController,p.size),m=h?p.orthogonalSize:Ai.Invisible(p.orthogonalSize);d.addChild(f,m,l)}p.dispose();for(let f=0;f<g.length;f++)d.resizeChild(f,g[f]);return this.trySet2x2(),n.view}moveView(e,t,i){this.hasMaximizedView()&&this.exitMaximizedView();const[,s]=this.getNode(e);if(!(s instanceof Ye))throw new Error("Invalid location");s.moveChild(t,i),this.trySet2x2()}swapViews(e,t){this.hasMaximizedView()&&this.exitMaximizedView();const[i,s]=pt(e),[,o]=this.getNode(i);if(!(o instanceof Ye))throw new Error("Invalid from location");const r=o.getChildSize(s),n=o.children[s];if(!(n instanceof wt))throw new Error("Invalid from location");const[d,l]=pt(t),[,h]=this.getNode(d);if(!(h instanceof Ye))throw new Error("Invalid to location");const p=h.getChildSize(l),g=h.children[l];if(!(g instanceof wt))throw new Error("Invalid to location");o===h?o.swapChildren(s,l):(o.removeChild(s),h.removeChild(l),o.addChild(g,r,s),h.addChild(n,p,l)),this.trySet2x2()}resizeView(e,t){this.hasMaximizedView()&&this.exitMaximizedView();const[i,s]=pt(e),[o,r]=this.getNode(i);if(!(r instanceof Ye))throw new Error("Invalid location");if(!t.width&&!t.height)return;const[n,d]=r.orientation===le.HORIZONTAL?[t.width,t.height]:[t.height,t.width];if(typeof d=="number"&&o.length>0){const[,l]=pt(o),[,h]=pt(i);l.resizeChild(h,d)}typeof n=="number"&&r.resizeChild(s,n),this.trySet2x2()}getViewSize(e){if(!e)return{width:this.root.width,height:this.root.height};const[,t]=this.getNode(e);return{width:t.width,height:t.height}}getViewCachedVisibleSize(e){const[t,i]=pt(e),[,s]=this.getNode(t);if(!(s instanceof Ye))throw new Error("Invalid location");return s.getChildCachedVisibleSize(i)}expandView(e){this.hasMaximizedView()&&this.exitMaximizedView();const[t,i]=this.getNode(e);if(!(i instanceof wt))throw new Error("Invalid location");for(let s=0;s<t.length;s++)t[s].resizeChild(e[s],Number.POSITIVE_INFINITY)}isViewExpanded(e){if(this.hasMaximizedView())return!1;const[t,i]=this.getNode(e);if(!(i instanceof wt))throw new Error("Invalid location");for(let s=0;s<t.length;s++)if(!t[s].isChildExpanded(e[s]))return!1;return!0}maximizeView(e){const[,t]=this.getNode(e);if(!(t instanceof wt))throw new Error("Location is not a LeafNode");if(this.maximizedNode===t)return;this.hasMaximizedView()&&this.exitMaximizedView();function i(s,o){for(let r=0;r<s.children.length;r++){const n=s.children[r];n instanceof wt?n!==o&&s.setChildVisible(r,!1):i(n,o)}}i(this.root,t),this.maximizedNode=t,this._onDidChangeViewMaximized.fire(!0)}exitMaximizedView(){if(!this.maximizedNode)return;this.maximizedNode=void 0;function e(t){for(let i=t.children.length-1;i>=0;i--){const s=t.children[i];s instanceof wt?t.setChildVisible(i,!0):e(s)}}e(this.root),this._onDidChangeViewMaximized.fire(!1)}hasMaximizedView(){return this.maximizedNode!==void 0}isViewMaximized(e){const[,t]=this.getNode(e);if(!(t instanceof wt))throw new Error("Location is not a LeafNode");return t===this.maximizedNode}distributeViewSizes(e){if(this.hasMaximizedView()&&this.exitMaximizedView(),!e){this.root.distributeViewSizes(!0);return}const[,t]=this.getNode(e);if(!(t instanceof Ye))throw new Error("Invalid location");t.distributeViewSizes(),this.trySet2x2()}isViewVisible(e){const[t,i]=pt(e),[,s]=this.getNode(t);if(!(s instanceof Ye))throw new Error("Invalid from location");return s.isChildVisible(i)}setViewVisible(e,t){if(this.hasMaximizedView()){this.exitMaximizedView();return}const[i,s]=pt(e),[,o]=this.getNode(i);if(!(o instanceof Ye))throw new Error("Invalid from location");o.setChildVisible(s,t)}getView(e){const t=e?this.getNode(e)[1]:this._root;return this._getViews(t,this.orientation)}static deserialize(e,t,i={}){if(typeof e.orientation!="number")throw new Error("Invalid JSON: 'orientation' property must be a number.");if(typeof e.width!="number")throw new Error("Invalid JSON: 'width' property must be a number.");if(typeof e.height!="number")throw new Error("Invalid JSON: 'height' property must be a number.");if(e.root?.type!=="branch")throw new Error("Invalid JSON: 'root' property must have 'type' value of branch.");const s=e.orientation,o=e.height,r=new Ia(i);return r._deserialize(e.root,s,t,o),r}_deserialize(e,t,i,s){this.root=this._deserializeNode(e,t,i,s)}_deserializeNode(e,t,i,s){let o;if(e.type==="branch"){const n=e.data.map(d=>({node:this._deserializeNode(d,Gs(t),i,e.size),visible:d.visible}));o=new Ye(t,this.layoutController,this.styles,this.proportionalLayout,e.size,s,void 0,n)}else o=new wt(i.fromJSON(e.data),t,this.layoutController,s,e.size),e.maximized&&!this.maximizedNode&&(this.maximizedNode=o,this._onDidChangeViewMaximized.fire(!0));return o}_getViews(e,t,i){const s={top:e.top,left:e.left,width:e.width,height:e.height};if(e instanceof wt)return{view:e.view,box:s,cachedVisibleSize:i,maximized:this.maximizedNode===e};const o=[];for(let r=0;r<e.children.length;r++){const n=e.children[r],d=e.getChildCachedVisibleSize(r);o.push(this._getViews(n,Gs(t),d))}return{children:o,box:s}}getNode(e,t=this.root,i=[]){if(e.length===0)return[i,t];if(!(t instanceof Ye))throw new Error("Invalid location");const[s,...o]=e;if(s<0||s>=t.children.length)throw new Error("Invalid location");const r=t.children[s];return i.push(t),this.getNode(o,r,i)}trySet2x2(){if(this.disposable2x2.dispose(),this.disposable2x2=M.None,this.root.children.length!==2)return;const[e,t]=this.root.children;!(e instanceof Ye)||!(t instanceof Ye)||(this.disposable2x2=e.trySet2x2(t))}getViewMap(e,t){t||(t=this.root),t instanceof Ye?t.children.forEach(i=>this.getViewMap(e,i)):e.set(t.view,t.element)}dispose(){this.onDidSashResetRelay.dispose(),this.root.dispose(),this.element.remove()}}xe(T_);var _e;(function(a){a[a.Up=0]="Up",a[a.Down=1]="Down",a[a.Left=2]="Left",a[a.Right=3]="Right"})(_e||(_e={}));function tV(a){switch(a){case _e.Up:return _e.Down;case _e.Down:return _e.Up;case _e.Left:return _e.Right;case _e.Right:return _e.Left}}function Kr(a){return!!a.children}function x_(a,e){if(e.length===0)return a;if(!Kr(a))throw new Error("Invalid location");const[t,...i]=e;return x_(a.children[t],i)}function iV(a,e){return!(a.start>=e.end||e.start>=a.end)}function L_(a,e){const t=cv(e),i=e===_e.Up?a.top:e===_e.Right?a.left+a.width:e===_e.Down?a.top+a.height:a.left,s={start:t===le.HORIZONTAL?a.top:a.left,end:t===le.HORIZONTAL?a.top+a.height:a.left+a.width};return{offset:i,range:s}}function sV(a,e,t){const i=[];function s(o,r,n){if(Kr(o))for(const d of o.children)s(d,r,n);else{const{offset:d,range:l}=L_(o.box,r);d===n.offset&&iV(l,n.range)&&i.push(o)}}return s(a,e,t),i}function uf(a,e){return e.length%2===0?Gs(a):a}function cv(a){return a===_e.Up||a===_e.Down?le.VERTICAL:le.HORIZONTAL}function rC(a,e,t){const i=uf(a,e),s=cv(t);if(i===s){let[o,r]=pt(e);return(t===_e.Right||t===_e.Down)&&(r+=1),[...o,r]}else{const o=t===_e.Right||t===_e.Down?1:0;return[...e,o]}}function oV(a){const e=a.parentElement;if(!e)throw new Error("Invalid grid element");let t=e.firstElementChild,i=0;for(;t!==a&&t!==e.lastElementChild&&t;)t=t.nextElementSibling,i++;return i}function R_(a){const e=a.parentElement;if(!e)throw new Error("Invalid grid element");if(/\bmonaco-grid-view\b/.test(e.className))return[];const t=oV(e),i=e.parentElement.parentElement.parentElement.parentElement;return[...R_(i),t]}var Da;(function(a){a.Distribute={type:"distribute"},a.Split={type:"split"},a.Auto={type:"auto"};function e(t){return{type:"invisible",cachedVisibleSize:t}}a.Invisible=e})(Da||(Da={}));class rV extends M{get orientation(){return this.gridview.orientation}set orientation(e){this.gridview.orientation=e}get width(){return this.gridview.width}get height(){return this.gridview.height}get minimumWidth(){return this.gridview.minimumWidth}get minimumHeight(){return this.gridview.minimumHeight}get maximumWidth(){return this.gridview.maximumWidth}get maximumHeight(){return this.gridview.maximumHeight}get boundarySashes(){return this.gridview.boundarySashes}set boundarySashes(e){this.gridview.boundarySashes=e}set edgeSnapping(e){this.gridview.edgeSnapping=e}get element(){return this.gridview.element}constructor(e,t={}){super(),this.views=new Map,this.didLayout=!1,e instanceof Ia?(this.gridview=e,this.gridview.getViewMap(this.views)):this.gridview=new Ia(t),this._register(this.gridview),this._register(this.gridview.onDidSashReset(this.onDidSashReset,this)),e instanceof Ia||this._addView(e,0,[0]),this.onDidChange=this.gridview.onDidChange,this.onDidScroll=this.gridview.onDidScroll,this.onDidChangeViewMaximized=this.gridview.onDidChangeViewMaximized}style(e){this.gridview.style(e)}layout(e,t,i=0,s=0){this.gridview.layout(e,t,i,s),this.didLayout=!0}addView(e,t,i,s){if(this.views.has(e))throw new Error("Can't add same view twice");const o=cv(s);this.views.size===1&&this.orientation!==o&&(this.orientation=o);const r=this.getViewLocation(i),n=rC(this.gridview.orientation,r,s);let d;if(typeof t=="number")d=t;else if(t.type==="split"){const[,l]=pt(r);d=Ai.Split(l)}else if(t.type==="distribute")d=Ai.Distribute;else if(t.type==="auto"){const[,l]=pt(r);d=Ai.Auto(l)}else d=t;this._addView(e,d,n)}addViewAt(e,t,i){if(this.views.has(e))throw new Error("Can't add same view twice");let s;typeof t=="number"?s=t:t.type==="distribute"?s=Ai.Distribute:s=t,this._addView(e,s,i)}_addView(e,t,i){this.views.set(e,e.element),this.gridview.addView(e,t,i)}removeView(e,t){if(this.views.size===1)throw new Error("Can't remove last view");const i=this.getViewLocation(e);let s;if(t?.type==="distribute")s=Ai.Distribute;else if(t?.type==="auto"){const o=i[i.length-1];s=Ai.Auto(o===0?1:o-1)}this.gridview.removeView(i,s),this.views.delete(e)}moveView(e,t,i,s){const o=this.getViewLocation(e),[r,n]=pt(o),d=this.getViewLocation(i),l=rC(this.gridview.orientation,d,s),[h,p]=pt(l);In(r,h)?this.gridview.moveView(r,n,p):(this.removeView(e,typeof t=="number"?void 0:t),this.addView(e,t,i,s))}moveViewTo(e,t){const i=this.getViewLocation(e),[s,o]=pt(i),[r,n]=pt(t);if(In(s,r))this.gridview.moveView(s,o,n);else{const d=this.getViewSize(e),l=uf(this.gridview.orientation,i),h=this.getViewCachedVisibleSize(e),p=typeof h>"u"?l===le.HORIZONTAL?d.width:d.height:Da.Invisible(h);this.removeView(e),this.addViewAt(e,p,t)}}swapViews(e,t){const i=this.getViewLocation(e),s=this.getViewLocation(t);return this.gridview.swapViews(i,s)}resizeView(e,t){const i=this.getViewLocation(e);return this.gridview.resizeView(i,t)}isViewExpanded(e){const t=this.getViewLocation(e);return this.gridview.isViewExpanded(t)}isViewMaximized(e){const t=this.getViewLocation(e);return this.gridview.isViewMaximized(t)}hasMaximizedView(){return this.gridview.hasMaximizedView()}getViewSize(e){if(!e)return this.gridview.getViewSize();const t=this.getViewLocation(e);return this.gridview.getViewSize(t)}getViewCachedVisibleSize(e){const t=this.getViewLocation(e);return this.gridview.getViewCachedVisibleSize(t)}maximizeView(e){if(this.views.size<2)throw new Error("At least two views are required to maximize a view");const t=this.getViewLocation(e);this.gridview.maximizeView(t)}exitMaximizedView(){this.gridview.exitMaximizedView()}expandView(e){const t=this.getViewLocation(e);this.gridview.expandView(t)}distributeViewSizes(){this.gridview.distributeViewSizes()}isViewVisible(e){const t=this.getViewLocation(e);return this.gridview.isViewVisible(t)}setViewVisible(e,t){const i=this.getViewLocation(e);this.gridview.setViewVisible(i,t)}getViews(){return this.gridview.getView()}getNeighborViews(e,t,i=!1){if(!this.didLayout)throw new Error("Can't call getNeighborViews before first layout");const s=this.getViewLocation(e),o=this.getViews(),r=x_(o,s);let n=L_(r.box,t);return i&&(t===_e.Up&&r.box.top===0?n={offset:o.box.top+o.box.height,range:n.range}:t===_e.Right&&r.box.left+r.box.width===o.box.width?n={offset:0,range:n.range}:t===_e.Down&&r.box.top+r.box.height===o.box.height?n={offset:0,range:n.range}:t===_e.Left&&r.box.left===0&&(n={offset:o.box.left+o.box.width,range:n.range})),sV(o,tV(t),n).map(d=>d.view)}getViewLocation(e){const t=this.views.get(e);if(!t)throw new Error("View not found");return R_(t)}onDidSashReset(e){const t=o=>{const r=this.gridview.getView(o);if(Kr(r))return!1;const n=uf(this.orientation,o),d=n===le.HORIZONTAL?r.view.preferredWidth:r.view.preferredHeight;if(typeof d!="number")return!1;const l=n===le.HORIZONTAL?{width:Math.round(d)}:{height:Math.round(d)};return this.gridview.resizeView(o,l),!0};if(t(e))return;const[i,s]=pt(e);t([...i,s+1])||this.gridview.distributeViewSizes(i)}}class Yo extends rV{constructor(){super(...arguments),this.initialLayoutContext=!0}static serializeNode(e,t){const i=t===le.VERTICAL?e.box.width:e.box.height;if(!Kr(e)){const o={type:"leaf",data:e.view.toJSON(),size:i};return typeof e.cachedVisibleSize=="number"?(o.size=e.cachedVisibleSize,o.visible=!1):e.maximized&&(o.maximized=!0),o}const s=e.children.map(o=>Yo.serializeNode(o,Gs(t)));return s.some(o=>o.visible!==!1)?{type:"branch",data:s,size:i}:{type:"branch",data:s,size:i,visible:!1}}static deserialize(e,t,i={}){if(typeof e.orientation!="number")throw new Error("Invalid JSON: 'orientation' property must be a number.");if(typeof e.width!="number")throw new Error("Invalid JSON: 'width' property must be a number.");if(typeof e.height!="number")throw new Error("Invalid JSON: 'height' property must be a number.");const s=Ia.deserialize(e,t,i);return new Yo(s,i)}static from(e,t={}){return Yo.deserialize(N_(e),{fromJSON:i=>i},t)}serialize(){return{root:Yo.serializeNode(this.getViews(),this.orientation),orientation:this.orientation,width:this.width,height:this.height}}layout(e,t,i=0,s=0){super.layout(e,t,i,s),this.initialLayoutContext&&(this.initialLayoutContext=!1,this.gridview.trySet2x2())}}function V_(a){return!!a.groups}function P_(a,e){if(!e&&a.groups&&a.groups.length<=1&&(a.groups=void 0),!V_(a))return;let t=0,i=0;for(const n of a.groups)P_(n,!1),n.size&&(t+=n.size,i++);const s=i>0?t:1,o=a.groups.length-i,r=s/o;for(const n of a.groups)n.size||(n.size=r)}function O_(a){return V_(a)?{type:"branch",data:a.groups.map(e=>O_(e)),size:a.size}:{type:"leaf",data:a.data,size:a.size}}function M_(a,e){if(a.type==="branch"){const t=a.data.map(i=>M_(i,Gs(e)));if(e===le.VERTICAL){const i=a.size||(t.length===0?void 0:Math.max(...t.map(o=>o.width||0))),s=t.length===0?void 0:t.reduce((o,r)=>o+(r.height||0),0);return{width:i,height:s}}else{const i=t.length===0?void 0:t.reduce((o,r)=>o+(r.width||0),0),s=a.size||(t.length===0?void 0:Math.max(...t.map(o=>o.height||0)));return{width:i,height:s}}}else{const t=e===le.VERTICAL?a.size:void 0,i=e===le.VERTICAL?void 0:a.size;return{width:t,height:i}}}function N_(a){P_(a,!0);const e=O_(a),{width:t,height:i}=M_(e,a.orientation);return{root:e,orientation:a.orientation,width:t||1,height:i||1}}const nV=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),aV=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class dV{constructor(e){this._container=e}set text(e){ms(this._container,...ws(e??""))}set title(e){!this.hover&&e?this.hover=CD().setupManagedHover(zc("mouse"),this._container,e):this.hover&&this.hover.update(e)}dispose(){this.hover?.dispose()}}var pf,Ll,gf;xe(aV);var qr;let _c=(qr=class extends gb{constructor(e,t,i,s,o){super(e,t,i,s,o),this.inputDisposable=this._register(new Ae)}createEditor(e){this.container=N(".monaco-editor-pane-placeholder",{tabIndex:0}),this.container.style.outline="none",this.scrollbar=this._register(new uS(this.container,{horizontal:fs.Auto,vertical:fs.Auto})),e.appendChild(this.scrollbar.getDomNode())}async setInput(e,t,i,s){await super.setInput(e,t,i,s),!s.isCancellationRequested&&(this.inputDisposable.value=await this.renderInput(e,t))}async renderInput(e,t){const[i,s]=Ho(this.container,this.scrollbar);Ut(i);const o=new B,{icon:r,label:n,actions:d}=await this.getContents(e,t,o),l=_D(n,pf.PLACEHOLDER_LABEL_MAX_LENGTH),h=i.appendChild(N(".editor-placeholder-icon-container")),p=o.add(new dV(h));p.text=r;const g=i.appendChild(N(".editor-placeholder-label-container")),f=N("span");if(f.textContent=l,g.appendChild(f),i.setAttribute("aria-label",`${fb(e,void 0,this.group,void 0)}, ${l}`),d.length){const m=i.appendChild(N(".editor-placeholder-buttons-container")),v=o.add(new mb(m));for(let E=0;E<d.length;E++){const x=o.add(v.addButton({...Xa,secondary:E!==0}));x.label=d[E].label,o.add(x.onDidClick(G=>{G&&be.stop(G,!0),d[E].run()}))}}return s.scanDomNode(),o}clearInput(){this.container&&Ut(this.container),this.inputDisposable.clear(),super.clearInput()}layout(e){const[t,i]=Ho(this.container,this.scrollbar);ID(t,e.width,e.height),i.scanDomNode(),t.classList.toggle("max-height-200px",e.height<=200)}focus(){super.focus(),this.container?.focus()}dispose(){this.container?.remove(),super.dispose()}},pf=qr,qr.PLACEHOLDER_LABEL_MAX_LENGTH=1024,qr);_c=pf=D([u(2,nt),u(3,we),u(4,ge)],_c);var $i;let ff=($i=class extends _c{constructor(e,t,i,s,o,r){super(Ll.ID,e,t,i,r),this.commandService=s,this.workspaceService=o}getTitle(){return Ll.LABEL}async getContents(){return{icon:"$(workspace-untrusted)",label:SD(ED(this.workspaceService.getWorkspace()))?c(3430,"The file is not displayed in the editor because trust has not been granted to the folder."):c(3431,"The file is not displayed in the editor because trust has not been granted to the workspace."),actions:[{label:c(3432,"Manage Workspace Trust"),run:()=>this.commandService.executeCommand("workbench.trust.manage")}]}}},Ll=$i,$i.ID="workbench.editors.workspaceTrustRequiredEditor",$i.LABEL=c(3429,"Workspace Trust Required"),$i.DESCRIPTOR=Oi.create($i,$i.ID,$i.LABEL),$i);ff=Ll=D([u(1,nt),u(2,we),u(3,ke),u(4,xt),u(5,ge)],ff);var qi;let mf=(qi=class extends _c{constructor(e,t,i,s,o,r,n){super(gf.ID,e,t,i,s),this.fileService=o,this.dialogService=r,this.commandService=n}async getContents(e,t,i){const s=e.resource,o=t.error,r=o?.fileOperationResult===Ms.FILE_NOT_FOUND;let n;r?n=c(3434,"The editor could not be opened because the file was not found."):Od(o)&&o.forceMessage?n=o.message:o?n=c(3435,"The editor could not be opened due to an unexpected error. Please consult the log for more details."):n=c(3436,"The editor could not be opened due to an unexpected error.");let d="$(error)";Od(o)&&(o.forceSeverity===Te.Info?d="$(info)":o.forceSeverity===Te.Warning&&(d="$(warning)"));let l;return Od(o)&&o.actions.length>0?l=o.actions.map(h=>({label:h.label,run:()=>{const p=h.run();p instanceof Promise&&p.catch(g=>this.dialogService.error(Hl(g)))}})):l=[{label:c(3437,"Try Again"),run:()=>this.group.openEditor(e,{...t,source:lS.USER})},{label:c(3438,"Show Logs"),run:()=>this.commandService.executeCommand(hS)}],r&&s&&this.fileService.hasProvider(s)&&i.add(this.fileService.onDidFilesChange(h=>{h.contains(s,zl.ADDED,zl.UPDATED)&&this.group.openEditor(e,t)})),{icon:d,label:n,actions:l??[]}}},gf=qi,qi.ID="workbench.editors.errorEditor",qi.LABEL=c(3433,"Error Editor"),qi.DESCRIPTOR=Oi.create(qi,qi.ID,qi.LABEL),qi);mf=gf=D([u(1,nt),u(2,we),u(3,ge),u(4,Ve),u(5,Bi),u(6,ke)],mf);let wf=class extends M{get minimumWidth(){return this._activeEditorPane?.minimumWidth??$l.width}get minimumHeight(){return this._activeEditorPane?.minimumHeight??$l.height}get maximumWidth(){return this._activeEditorPane?.maximumWidth??ql.width}get maximumHeight(){return this._activeEditorPane?.maximumHeight??ql.height}get activeEditorPane(){return this._activeEditorPane}constructor(e,t,i,s,o,r,n,d,l,h){super(),this.editorGroupParent=e,this.editorPanesParent=t,this.groupView=i,this.layoutService=s,this.instantiationService=o,this.workspaceTrustService=n,this.logService=d,this.dialogService=l,this.hostService=h,this._onDidFocus=this._register(new A),this.onDidFocus=this._onDidFocus.event,this._onDidChangeSizeConstraints=this._register(new A),this.onDidChangeSizeConstraints=this._onDidChangeSizeConstraints.event,this._activeEditorPane=null,this.editorPanes=[],this.mapEditorPaneToPendingSetInput=new Map,this.activeEditorPaneDisposables=this._register(new B),this.editorPanesRegistry=se.as(Lt.EditorPane),this.editorOperation=this._register(new DD(r)),this.registerListeners()}registerListeners(){this._register(this.workspaceTrustService.onDidChangeTrust(()=>this.onDidChangeWorkspaceTrust()))}onDidChangeWorkspaceTrust(){const e=this._activeEditorPane?.input,t=this._activeEditorPane?.options;e?.hasCapability(Xt.RequiresTrust)&&this.groupView.openEditor(e,t)}async openEditor(e,t,i,s=Object.create(null)){try{return await this.doOpenEditor(this.getEditorPaneDescriptor(e),e,t,i,s)}catch(o){return t?.ignoreError?{error:o}:this.doShowError(o,e,t,i,s)}}async doShowError(e,t,i,s,o){this.logService.error(e);let r=!1;if(i?.source===lS.USER&&(!Od(e)||e.allowDialog)&&(r=await this.doShowErrorDialog(e,t)),r)return{error:e};const n={...i};return dd(e)||(n.error=e),{...await this.doOpenEditor(mf.DESCRIPTOR,t,n,s,o),error:e}}async doShowErrorDialog(e,t){let i=Te.Error,s,o=Hl(e),r;Od(e)&&(r=e.actions,i=e.forceSeverity??Te.Error,e.forceMessage&&(s=e.message,o=void 0)),s||(s=c(3426,"Unable to open '{0}'",t.getName()));const n=[];if(r&&r.length>0)for(const p of r)n.push({label:p.label,run:()=>p});else n.push({label:c(3427,"&&OK"),run:()=>{}});let d;n.length===1&&(d={run:()=>{l=!0}});let l=!1;const{result:h}=await this.dialogService.prompt({type:i,message:s,detail:o,buttons:n,cancelButton:d});if(h){const p=h.run();p instanceof Promise&&p.catch(g=>this.dialogService.error(Hl(g))),l=!0}return l}async doOpenEditor(e,t,i,s,o=Object.create(null)){const r=this.doShowEditorPane(e),n=Hs(),{changed:d,cancelled:l}=await this.doSetInput(r,t,i,o);return l||(!i?.preserveFocus&&this.shouldRestoreFocus(n)?r.focus():s?.preserveWindowOrder||this.hostService.moveTop($c(this.groupView.windowId,!0).window)),{pane:r,changed:d,cancelled:l}}shouldRestoreFocus(e){if(!this.layoutService.isRestored()||!e)return!0;const t=Hs();return!!(!t||t===e.ownerDocument.body||e===t||!AD(t)||Ja(t,this.editorGroupParent))}getEditorPaneDescriptor(e){return e.hasCapability(Xt.RequiresTrust)&&!this.workspaceTrustService.isWorkspaceTrusted()?ff.DESCRIPTOR:fe(this.editorPanesRegistry.getEditorPane(e))}doShowEditorPane(e){if(this._activeEditorPane&&e.describes(this._activeEditorPane))return this._activeEditorPane;this.doHideActiveEditorPane();const t=this.doCreateEditorPane(e);this.doSetActiveEditorPane(t);const i=fe(t.getContainer());return this.editorPanesParent.appendChild(i),ja(i),t.setVisible(!0),this.pagePosition&&t.layout(new Be(this.pagePosition.width,this.pagePosition.height),{top:this.pagePosition.top,left:this.pagePosition.left}),this.boundarySashes&&t.setBoundarySashes(this.boundarySashes),t}doCreateEditorPane(e){const t=this.doInstantiateEditorPane(e);if(!t.getContainer()){const i=N(".editor-instance");this.editorPanesParent.appendChild(i);try{t.create(i)}catch(s){throw i.remove(),ur(i),s}}return t}doInstantiateEditorPane(e){const t=this.editorPanes.find(s=>e.describes(s));if(t)return t;const i=this._register(e.instantiate(this.instantiationService,this.groupView));return this.editorPanes.push(i),i}doSetActiveEditorPane(e){this._activeEditorPane=e,this.activeEditorPaneDisposables.clear(),e&&(this.activeEditorPaneDisposables.add(e.onDidChangeSizeConstraints(t=>this._onDidChangeSizeConstraints.fire(t))),this.activeEditorPaneDisposables.add(e.onDidFocus(()=>this._onDidFocus.fire()))),this._onDidChangeSizeConstraints.fire(void 0)}async doSetInput(e,t,i,s){let o=e.input?.matches(t);if(o&&!i?.forceReload)return this.mapEditorPaneToPendingSetInput.has(e)&&await this.mapEditorPaneToPendingSetInput.get(e),o=e.input?.matches(t),o&&e.setOptions(i),{changed:!1,cancelled:!o};const r=this.editorOperation.start(this.layoutService.isRestored()?800:3200);let n=!1;try{e.clearInput();const d=e.setInput(t,i,s,r.token);this.mapEditorPaneToPendingSetInput.set(e,d),await d,r.isCurrent()||(n=!0)}catch(d){if(!r.isCurrent())n=!0;else throw d}finally{r.isCurrent()&&this.mapEditorPaneToPendingSetInput.delete(e),r.stop()}return{changed:!o,cancelled:n}}doHideActiveEditorPane(){if(!this._activeEditorPane)return;this.editorOperation.stop(),this.safeRun(()=>this._activeEditorPane?.clearInput()),this.safeRun(()=>this._activeEditorPane?.setVisible(!1)),this.mapEditorPaneToPendingSetInput.delete(this._activeEditorPane);const e=this._activeEditorPane.getContainer();e&&(e.remove(),ur(e)),this.doSetActiveEditorPane(null)}closeEditor(e){this._activeEditorPane?.input&&e.matches(this._activeEditorPane.input)&&this.doHideActiveEditorPane()}setVisible(e){this.safeRun(()=>this._activeEditorPane?.setVisible(e))}layout(e){this.pagePosition=e,this.safeRun(()=>this._activeEditorPane?.layout(new Be(e.width,e.height),e))}setBoundarySashes(e){this.boundarySashes=e,this.safeRun(()=>this._activeEditorPane?.setBoundarySashes(e))}safeRun(e){try{e()}catch(t){this.logService.error(t)}}};wf=D([u(3,je),u(4,z),u(5,ub),u(6,TD),u(7,et),u(8,Bi),u(9,Rt)],wf);var ao;const nC=I.and(I.equals("chatSetupHidden",!1),I.equals("chatSetupDisabled",!1)),cV={text:c(3414,"Open Chat"),id:"workbench.action.chat.open",when:{native:nC,web:nC}},lV={text:c(3415,"Show All Commands"),id:"workbench.action.showCommands"},hV={text:c(3416,"Go to File"),id:"workbench.action.quickOpen"},uV={text:c(3417,"Open File"),id:"workbench.action.files.openFile"},pV={text:c(3418,"Open Folder"),id:"workbench.action.files.openFolder"},gV={text:c(3419,"Open File or Folder"),id:"workbench.action.files.openFileFolder"},fV={text:c(3420,"Open Recent"),id:"workbench.action.openRecent"},mV={text:c(3421,"New Untitled Text File"),id:"workbench.action.files.newUntitledFile"},wV={text:c(3422,"Find in Files"),id:"workbench.action.findInFiles"},bV={text:c(3423,"Toggle Terminal"),id:"workbench.action.terminal.toggleTerminal",when:{web:I.equals("terminalProcessSupported",!0)}},vV={text:c(3424,"Start Debugging"),id:"workbench.action.debug.start",when:{web:I.equals("terminalProcessSupported",!0)}},yV={text:c(3425,"Open Settings"),id:"workbench.action.openSettings"},F_=[cV,lV],aC=Mi([...F_,...Ge&&!ei?[gV]:[uV,pV],fV,Ge&&!ei?mV:void 0]),dC=[...F_],cC=[hV,wV,vV,bV,yV];var bo;let bf=(bo=class extends M{constructor(e,t,i,s,o,r){super(),this.keybindingService=t,this.contextService=i,this.contextKeyService=s,this.configurationService=o,this.storageService=r,this.transientDisposables=this._register(new B),this.keybindingLabels=this._register(new B),this.enabled=!1,this.cachedWhen=this.storageService.getObject(ao.CACHED_WHEN,ee.PROFILE,Object.create(null)),this.workbenchState=this.contextService.getWorkbenchState();const n=Ct(".editor-group-watermark",[Ct(".watermark-container",[Ct(".letterpress"),Ct(".shortcuts@shortcuts")])]);ye(e,n.root),this.shortcuts=n.shortcuts,this.registerListeners(),this.render()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(ao.SETTINGS_KEY)&&this.enabled!==this.configurationService.getValue(ao.SETTINGS_KEY)&&this.render()})),this._register(this.contextService.onDidChangeWorkbenchState(e=>{this.workbenchState!==e&&(this.workbenchState=e,this.render())})),this._register(this.storageService.onWillSaveState(e=>{if(e.reason===kD.SHUTDOWN){const t=[...aC,...dC,...cC];for(const i of t){const s=ei?i.when?.web:i.when?.native;s&&(this.cachedWhen[i.id]=this.contextKeyService.contextMatchesRules(s))}this.storageService.store(ao.CACHED_WHEN,JSON.stringify(this.cachedWhen),ee.PROFILE,Ze.MACHINE)}}))}render(){if(this.enabled=this.configurationService.getValue(ao.SETTINGS_KEY),Ut(this.shortcuts),this.transientDisposables.clear(),!this.enabled)return;const e=this.filterEntries(this.workbenchState!==Ns.EMPTY?dC:aC);if(e.length<ao.MINIMUM_ENTRIES){const s=this.filterEntries(cC);xD(s),e.push(...s.slice(0,ao.MINIMUM_ENTRIES-e.length))}const t=ye(this.shortcuts,N(".watermark-box")),i=()=>{Ut(t),this.keybindingLabels.clear();for(const s of e){const o=this.keybindingService.lookupKeybinding(s.id);if(!o)continue;const r=ye(t,N("dl")),n=ye(r,N("dt"));n.textContent=s.text;const d=ye(r,N("dd"));this.keybindingLabels.add(new Fg(d,pi,{renderUnboundKeybindings:!0,...Bg})).set(o)}};i(),this.transientDisposables.add(this.keybindingService.onDidUpdateKeybindings(i))}filterEntries(e){return e.filter(i=>{if(this.cachedWhen[i.id])return!0;const s=ei?i.when?.web:i.when?.native;return!s||this.contextKeyService.contextMatchesRules(s)}).filter(i=>!!re.getCommand(i.id)).filter(i=>!!this.keybindingService.lookupKeybinding(i.id))}},ao=bo,bo.CACHED_WHEN="editorGroupWatermark.whenConditions",bo.SETTINGS_KEY="workbench.tips.enabled",bo.MINIMUM_ENTRIES=3,bo);bf=ao=D([u(1,ot),u(2,xt),u(3,de),u(4,te),u(5,ge)],bf);const CV=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),SV=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));xe(SV);class lv{}class EV{constructor(e,t,i=fs.Auto,s,o){this._disposables=new B,this._onDidSelectItem=new A,this._onDidFocusItem=new A,this._onDidChangeFocus=new A,this.onDidSelectItem=this._onDidSelectItem.event,this.onDidFocusItem=this._onDidFocusItem.event,this.onDidChangeFocus=this._onDidChangeFocus.event,this._items=new Array,this._nodes=new Array,this._freeNodes=new Array,this._enabled=!0,this._focusedItemIdx=-1,this._selectedItemIdx=-1,this._domNode=ve("div"),this._domNode.className="monaco-breadcrumbs",this._domNode.tabIndex=0,this._domNode.setAttribute("role","list"),this._scrollable=new uS(this._domNode,{vertical:fs.Hidden,horizontal:i,horizontalScrollbarSize:t,useShadows:!1,scrollYToX:!0}),this._separatorIcon=s,this._disposables.add(this._scrollable),this._disposables.add(wb(this._domNode,"click",d=>this._onClick(d))),e.appendChild(this._scrollable.getDomNode());const r=wp(this._domNode);this._style(r,o);const n=Eo(this._domNode);this._disposables.add(n),this._disposables.add(n.onDidBlur(d=>this._onDidChangeFocus.fire(!1))),this._disposables.add(n.onDidFocus(d=>this._onDidChangeFocus.fire(!0)))}setHorizontalScrollbarSize(e){this._scrollable.updateOptions({horizontalScrollbarSize:e})}setHorizontalScrollbarVisibility(e){this._scrollable.updateOptions({horizontal:e})}dispose(){this._disposables.dispose(),this._pendingLayout?.dispose(),this._pendingDimLayout?.dispose(),this._onDidSelectItem.dispose(),this._onDidFocusItem.dispose(),this._onDidChangeFocus.dispose(),this._domNode.remove(),this._nodes.length=0,this._freeNodes.length=0}layout(e){e&&Be.equals(e,this._dimension)||(e?(this._pendingDimLayout?.dispose(),this._pendingDimLayout=this._updateDimensions(e)):(this._pendingLayout?.dispose(),this._pendingLayout=this._updateScrollbar()))}_updateDimensions(e){const t=new B;return t.add(LD(He(this._domNode),()=>{this._dimension=e,this._domNode.style.width=`${e.width}px`,this._domNode.style.height=`${e.height}px`,t.add(this._updateScrollbar())})),t}_updateScrollbar(){return $v(He(this._domNode),()=>{$v(He(this._domNode),()=>{this._scrollable.setRevealOnScroll(!1),this._scrollable.scanDomNode(),this._scrollable.setRevealOnScroll(!0)})})}_style(e,t){let i="";t.breadcrumbsBackground&&(i+=`.monaco-breadcrumbs { background-color: ${t.breadcrumbsBackground}}`),t.breadcrumbsForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item { color: ${t.breadcrumbsForeground}}
`),t.breadcrumbsFocusForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused { color: ${t.breadcrumbsFocusForeground}}
`),t.breadcrumbsFocusAndSelectionForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused.selected { color: ${t.breadcrumbsFocusAndSelectionForeground}}
`),t.breadcrumbsHoverForeground&&(i+=`.monaco-breadcrumbs:not(.disabled	) .monaco-breadcrumb-item:hover:not(.focused):not(.selected) { color: ${t.breadcrumbsHoverForeground}}
`),e.textContent=i}setEnabled(e){this._enabled=e,this._domNode.classList.toggle("disabled",!this._enabled)}domFocus(){const e=this._focusedItemIdx>=0?this._focusedItemIdx:this._items.length-1;e>=0&&e<this._items.length?this._focus(e,void 0):this._domNode.focus()}isDOMFocused(){return pS(this._domNode)}getFocused(){return this._items[this._focusedItemIdx]}setFocused(e,t){this._focus(this._items.indexOf(e),t)}focusPrev(e){this._focusedItemIdx>0&&this._focus(this._focusedItemIdx-1,e)}focusNext(e){this._focusedItemIdx+1<this._nodes.length&&this._focus(this._focusedItemIdx+1,e)}_focus(e,t){this._focusedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){const s=this._nodes[i];i!==e?s.classList.remove("focused"):(this._focusedItemIdx=i,s.classList.add("focused"),s.focus())}this._reveal(this._focusedItemIdx,!0),this._onDidFocusItem.fire({type:"focus",item:this._items[this._focusedItemIdx],node:this._nodes[this._focusedItemIdx],payload:t})}reveal(e){const t=this._items.indexOf(e);t>=0&&this._reveal(t,!1)}revealLast(){this._reveal(this._items.length-1,!1)}_reveal(e,t){if(e<0||e>=this._nodes.length)return;const i=this._nodes[e];if(!i)return;const{width:s}=this._scrollable.getScrollDimensions(),{scrollLeft:o}=this._scrollable.getScrollPosition();(!t||i.offsetLeft>o+s||i.offsetLeft<o)&&(this._scrollable.setRevealOnScroll(!1),this._scrollable.setScrollPosition({scrollLeft:i.offsetLeft}),this._scrollable.setRevealOnScroll(!0))}getSelection(){return this._items[this._selectedItemIdx]}setSelection(e,t){this._select(this._items.indexOf(e),t)}_select(e,t){this._selectedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){const s=this._nodes[i];i!==e?s.classList.remove("selected"):(this._selectedItemIdx=i,s.classList.add("selected"))}this._onDidSelectItem.fire({type:"select",item:this._items[this._selectedItemIdx],node:this._nodes[this._selectedItemIdx],payload:t})}getItems(){return this._items}setItems(e){let t,i=[];try{t=RD(this._items,e,(s,o)=>s.equals(o)),i=this._items.splice(t,this._items.length-t,...e.slice(t)),this._render(t),dt(i),dt(e.slice(0,t)),this._focus(-1,void 0)}catch(s){const o=new Error(`BreadcrumbsItem#setItems: newItems: ${e.length}, prefix: ${t}, removed: ${i.length}`);throw o.name=s.name,o.stack=s.stack,o}}_render(e){let t=!1;for(;e<this._items.length&&e<this._nodes.length;e++){const i=this._items[e],s=this._nodes[e];this._renderItem(i,s),t=!0}for(;e<this._nodes.length;){const i=this._nodes.pop();i&&(this._freeNodes.push(i),i.remove(),t=!0)}for(;e<this._items.length;e++){const i=this._items[e],s=this._freeNodes.length>0?this._freeNodes.pop():ve("div");s&&(this._renderItem(i,s),this._domNode.appendChild(s),this._nodes.push(s),t=!0)}t&&this.layout(void 0)}_renderItem(e,t){Ut(t),t.className="";try{e.render(t)}catch(s){t.textContent="<<RENDER ERROR>>",console.error(s)}t.tabIndex=-1,t.setAttribute("role","listitem"),t.classList.add("monaco-breadcrumb-item");const i=N(Se.asCSSSelector(this._separatorIcon));t.appendChild(i)}_onClick(e){if(this._enabled)for(let t=e.target;t;t=t.parentElement){const i=this._nodes.indexOf(t);if(i>=0){this._focus(i,e),this._select(i,e);break}}}}class _V{constructor(){this._map=new Map}register(e,t){if(this._map.has(e))throw new Error(`group (${e}) has already a widget`);return this._map.set(e,t),{dispose:()=>this._map.delete(e)}}getWidget(e){return this._map.get(e)}}const ht=class ht{constructor(){}static _stub(e){return{bindTo(t){const i=new A,s=t.onDidChangeConfiguration(o=>{o.affectsConfiguration(e)&&i.fire(void 0)});return new class{constructor(){this.name=e,this.onDidChange=i.event}getValue(o){return o?t.getValue(e,o):t.getValue(e)}updateValue(o,r){return r?t.updateValue(e,o,r):t.updateValue(e,o)}dispose(){s.dispose(),i.dispose()}}}}}};ht.IsEnabled=ht._stub("breadcrumbs.enabled"),ht.UseQuickPick=ht._stub("breadcrumbs.useQuickPick"),ht.FilePath=ht._stub("breadcrumbs.filePath"),ht.SymbolPath=ht._stub("breadcrumbs.symbolPath"),ht.SymbolSortOrder=ht._stub("breadcrumbs.symbolSortOrder"),ht.SymbolPathSeparator=ht._stub("breadcrumbs.symbolPathSeparator"),ht.Icons=ht._stub("breadcrumbs.icons"),ht.TitleScrollbarSizing=ht._stub("workbench.editor.titleScrollbarSizing"),ht.TitleScrollbarVisibility=ht._stub("workbench.editor.titleScrollbarVisibility"),ht.FileExcludes=ht._stub("files.exclude");let xi=ht;se.as(Lo.Configuration).registerConfiguration({id:"breadcrumbs",title:c(3056,"Breadcrumb Navigation"),order:101,type:"object",properties:{"breadcrumbs.enabled":{description:c(3057,"Enable/disable navigation breadcrumbs."),type:"boolean",default:!0},"breadcrumbs.filePath":{description:c(3058,"Controls whether and how file paths are shown in the breadcrumbs view."),type:"string",default:"on",enum:["on","off","last"],enumDescriptions:[c(3059,"Show the file path in the breadcrumbs view."),c(3060,"Do not show the file path in the breadcrumbs view."),c(3061,"Only show the last element of the file path in the breadcrumbs view.")]},"breadcrumbs.symbolPath":{description:c(3062,"Controls whether and how symbols are shown in the breadcrumbs view."),type:"string",default:"on",enum:["on","off","last"],enumDescriptions:[c(3063,"Show all symbols in the breadcrumbs view."),c(3064,"Do not show symbols in the breadcrumbs view."),c(3065,"Only show the current symbol in the breadcrumbs view.")]},"breadcrumbs.symbolSortOrder":{description:c(3066,"Controls how symbols are sorted in the breadcrumbs outline view."),type:"string",default:"position",scope:Me.LANGUAGE_OVERRIDABLE,enum:["position","name","type"],enumDescriptions:[c(3067,"Show symbol outline in file position order."),c(3068,"Show symbol outline in alphabetical order."),c(3069,"Show symbol outline in symbol type order.")]},"breadcrumbs.icons":{description:c(3070,"Render breadcrumb items with icons."),type:"boolean",default:!0},"breadcrumbs.symbolPathSeparator":{description:c(3071,"The separator used when copying the breadcrumb symbol path."),type:"string",default:".",scope:Me.LANGUAGE_OVERRIDABLE},"breadcrumbs.showFiles":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3072,"When enabled breadcrumbs show `file`-symbols.")},"breadcrumbs.showModules":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3073,"When enabled breadcrumbs show `module`-symbols.")},"breadcrumbs.showNamespaces":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3074,"When enabled breadcrumbs show `namespace`-symbols.")},"breadcrumbs.showPackages":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3075,"When enabled breadcrumbs show `package`-symbols.")},"breadcrumbs.showClasses":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3076,"When enabled breadcrumbs show `class`-symbols.")},"breadcrumbs.showMethods":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3077,"When enabled breadcrumbs show `method`-symbols.")},"breadcrumbs.showProperties":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3078,"When enabled breadcrumbs show `property`-symbols.")},"breadcrumbs.showFields":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3079,"When enabled breadcrumbs show `field`-symbols.")},"breadcrumbs.showConstructors":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3080,"When enabled breadcrumbs show `constructor`-symbols.")},"breadcrumbs.showEnums":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3081,"When enabled breadcrumbs show `enum`-symbols.")},"breadcrumbs.showInterfaces":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3082,"When enabled breadcrumbs show `interface`-symbols.")},"breadcrumbs.showFunctions":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3083,"When enabled breadcrumbs show `function`-symbols.")},"breadcrumbs.showVariables":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3084,"When enabled breadcrumbs show `variable`-symbols.")},"breadcrumbs.showConstants":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3085,"When enabled breadcrumbs show `constant`-symbols.")},"breadcrumbs.showStrings":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3086,"When enabled breadcrumbs show `string`-symbols.")},"breadcrumbs.showNumbers":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3087,"When enabled breadcrumbs show `number`-symbols.")},"breadcrumbs.showBooleans":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3088,"When enabled breadcrumbs show `boolean`-symbols.")},"breadcrumbs.showArrays":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3089,"When enabled breadcrumbs show `array`-symbols.")},"breadcrumbs.showObjects":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3090,"When enabled breadcrumbs show `object`-symbols.")},"breadcrumbs.showKeys":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3091,"When enabled breadcrumbs show `key`-symbols.")},"breadcrumbs.showNull":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3092,"When enabled breadcrumbs show `null`-symbols.")},"breadcrumbs.showEnumMembers":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3093,"When enabled breadcrumbs show `enumMember`-symbols.")},"breadcrumbs.showStructs":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3094,"When enabled breadcrumbs show `struct`-symbols.")},"breadcrumbs.showEvents":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3095,"When enabled breadcrumbs show `event`-symbols.")},"breadcrumbs.showOperators":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3096,"When enabled breadcrumbs show `operator`-symbols.")},"breadcrumbs.showTypeParameters":{type:"boolean",default:!0,scope:Me.LANGUAGE_OVERRIDABLE,markdownDescription:c(3097,"When enabled breadcrumbs show `typeParameter`-symbols.")}}});let ch=class{constructor(e,t){this.uri=e,this.kind=t}};class vf{constructor(e,t){this.element=e,this.outline=t}}let yf=class{constructor(e,t,i,s,o){this.resource=e,this.editor=t,this._workspaceService=s,this._outlineService=o,this._disposables=new B,this._currentOutline=new Ae,this._outlineDisposables=new B,this._onDidUpdate=new A,this.onDidUpdate=this._onDidUpdate.event,this._cfgFilePath=xi.FilePath.bindTo(i),this._cfgSymbolPath=xi.SymbolPath.bindTo(i),this._disposables.add(this._cfgFilePath.onDidChange(r=>this._onDidUpdate.fire(this))),this._disposables.add(this._cfgSymbolPath.onDidChange(r=>this._onDidUpdate.fire(this))),this._workspaceService.onDidChangeWorkspaceFolders(this._onDidChangeWorkspaceFolders,this,this._disposables),this._fileInfo=this._initFilePathInfo(e),t&&(this._bindToEditor(t),this._disposables.add(o.onDidChange(()=>this._bindToEditor(t))),this._disposables.add(t.onDidChangeControl(()=>this._bindToEditor(t)))),this._onDidUpdate.fire(this)}dispose(){this._disposables.dispose(),this._cfgFilePath.dispose(),this._cfgSymbolPath.dispose(),this._currentOutline.dispose(),this._outlineDisposables.dispose(),this._onDidUpdate.dispose()}isRelative(){return!!this._fileInfo.folder}getElements(){let e=[];if(this._cfgFilePath.getValue()==="on"?e=e.concat(this._fileInfo.path):this._cfgFilePath.getValue()==="last"&&this._fileInfo.path.length>0&&(e=e.concat(this._fileInfo.path.slice(-1))),this._cfgSymbolPath.getValue()==="off"||!this._currentOutline.value)return e;const t=this._currentOutline.value.config.breadcrumbsDataSource.getBreadcrumbElements();for(let i=this._cfgSymbolPath.getValue()==="last"&&t.length>0?t.length-1:0;i<t.length;i++)e.push(new vf(t[i].element,this._currentOutline.value));return t.length===0&&!this._currentOutline.value.isEmpty&&e.push(new vf(this._currentOutline.value,this._currentOutline.value)),e}_initFilePathInfo(e){if(VD(e,ue.untitled,ue.data))return{folder:void 0,path:[]};const t={folder:this._workspaceService.getWorkspaceFolder(e)??void 0,path:[]};let i=e;for(;i&&i.path!=="/"&&!(t.folder&&qe(t.folder.uri,i));){t.path.unshift(new ch(i,t.path.length===0?$t.FILE:$t.FOLDER));const s=i.path.length;if(i=qc(i),i.path.length===s)break}return t.folder&&this._workspaceService.getWorkbenchState()===Ns.WORKSPACE&&t.path.unshift(new ch(t.folder.uri,$t.ROOT_FOLDER)),t}_onDidChangeWorkspaceFolders(){this._fileInfo=this._initFilePathInfo(this.resource),this._onDidUpdate.fire(this)}_bindToEditor(e){const t=new _o;this._currentOutline.clear(),this._outlineDisposables.clear(),this._outlineDisposables.add(pe(()=>t.dispose(!0))),this._outlineService.createOutline(e,gS.Breadcrumbs,t.token).then(i=>{t.token.isCancellationRequested&&(i?.dispose(),i=void 0),this._currentOutline.value=i,this._onDidUpdate.fire(this),i&&this._outlineDisposables.add(i.onDidChange(()=>this._onDidUpdate.fire(this)))}).catch(i=>{this._onDidUpdate.fire(this),gr(i)})}};yf=D([u(2,te),u(3,xt),u(4,fS)],yf);const B_=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));xe(B_);let lh=class{constructor(e,t,i,s,o){this.resource=t,this._instantiationService=i,this._themeService=s,this._configurationService=o,this._disposables=new B,this._fakeEvent=new UIEvent("fakeEvent"),this._onWillPickElement=new A,this.onWillPickElement=this._onWillPickElement.event,this._previewDispoables=new Ae,this._domNode=ve("div"),this._domNode.className="monaco-breadcrumbs-picker show-file-icons",e.appendChild(this._domNode)}dispose(){this._disposables.dispose(),this._previewDispoables.dispose(),this._onWillPickElement.dispose(),this._domNode.remove(),setTimeout(()=>this._tree.dispose(),0)}async show(e,t,i,s,o){const n=this._themeService.getColorTheme().getColor(mS);this._arrow=ve("div"),this._arrow.className="arrow",this._arrow.style.borderColor=`transparent transparent ${n?n.toString():""}`,this._domNode.appendChild(this._arrow),this._treeContainer=ve("div"),this._treeContainer.style.background=n?n.toString():"",this._treeContainer.style.paddingTop="2px",this._treeContainer.style.borderRadius="3px",this._treeContainer.style.boxShadow=`0 0 8px 2px ${this._themeService.getColorTheme().getColor(bS)}`,this._treeContainer.style.border=`1px solid ${this._themeService.getColorTheme().getColor(PD)}`,this._domNode.appendChild(this._treeContainer),this._layoutInfo={maxHeight:t,width:i,arrowSize:s,arrowOffset:o,inputHeight:0},this._tree=this._createTree(this._treeContainer,e),this._disposables.add(this._tree.onDidOpen(async d=>{const{element:l,editorOptions:h,sideBySide:p}=d;await this._revealElement(l,{...h,preserveFocus:!1},p)})),this._disposables.add(this._tree.onDidChangeFocus(d=>{this._previewDispoables.value=this._previewElement(d.elements[0])})),this._disposables.add(this._tree.onDidChangeContentHeight(()=>{this._layout()})),this._domNode.focus();try{await this._setInput(e),this._layout()}catch(d){gr(d)}}_layout(){const e=2*this._layoutInfo.arrowSize,t=Math.min(this._layoutInfo.maxHeight-e,this._tree.contentHeight),i=t+e;this._domNode.style.height=`${i}px`,this._domNode.style.width=`${this._layoutInfo.width}px`,this._arrow.style.top=`-${2*this._layoutInfo.arrowSize}px`,this._arrow.style.borderWidth=`${this._layoutInfo.arrowSize}px`,this._arrow.style.marginLeft=`${this._layoutInfo.arrowOffset}px`,this._treeContainer.style.height=`${t}px`,this._treeContainer.style.width=`${this._layoutInfo.width}px`,this._tree.layout(t,this._layoutInfo.width)}restoreViewState(){}};lh=D([u(2,z),u(3,we),u(4,te)],lh);class IV{getHeight(e){return 22}getTemplateId(e){return"FileStat"}}class DV{getId(e){return F.isUri(e)?e.toString():Gg(e)?e.id:zs(e)?e.uri.toString():e.resource.toString()}}let Cf=class{constructor(e){this._fileService=e}hasChildren(e){return F.isUri(e)||Gg(e)||zs(e)||e.isDirectory}async getChildren(e){if(Gg(e))return e.folders;let t;return zs(e)?t=e.uri:F.isUri(e)?t=e:t=e.resource,(await this._fileService.resolve(t)).children??[]}};Cf=D([u(0,Ve)],Cf);let Sf=class{constructor(e,t){this._labels=e,this._configService=t,this.templateId="FileStat"}renderTemplate(e){return this._labels.create(e,{supportHighlights:!0})}renderElement(e,t,i){const s=this._configService.getValue("explorer.decorations"),{element:o}=e;let r,n;zs(o)?(r=o.uri,n=$t.ROOT_FOLDER):(r=o.resource,n=o.isDirectory?$t.FOLDER:$t.FILE),i.setFile(r,{fileKind:n,hidePath:!0,fileDecorations:s,matches:An(e.filterData),extraClasses:["picker-item"]})}disposeTemplate(e){e.dispose()}};Sf=D([u(1,te)],Sf);class AV{getKeyboardNavigationLabel(e){return e.name}}class TV{getWidgetAriaLabel(){return c(3110,"Breadcrumbs")}getAriaLabel(e){return e.name}}let Ef=class{constructor(e,t,i){this._workspaceService=e,this._cachedExpressions=new Map,this._disposables=new B;const s=xi.FileExcludes.bindTo(t),o=()=>{e.getWorkspace().folders.forEach(r=>{const n=s.getValue({resource:r.uri});if(!n)return;const d={};for(const h in n){if(typeof n[h]!="boolean")continue;const p=h.indexOf("**/")!==0?vS.join(r.uri.path,h):h;d[p]=n[h]}const l=!i.hasCapability(r.uri,vb.PathCaseSensitive);this._cachedExpressions.set(r.uri.toString(),ND(d,{ignoreCase:l}))})};o(),this._disposables.add(s),this._disposables.add(s.onDidChange(o)),this._disposables.add(e.onDidChangeWorkspaceFolders(o))}dispose(){this._disposables.dispose()}filter(e,t){if(zs(e))return!0;const i=this._workspaceService.getWorkspaceFolder(e.resource);return!i||!this._cachedExpressions.has(i.uri.toString())?!0:!this._cachedExpressions.get(i.uri.toString())(MD(i.uri.path,e.resource.path),Dt(e.resource))}};Ef=D([u(0,xt),u(1,te),u(2,Ve)],Ef);class kV{compare(e,t){return zs(e)&&zs(t)?e.index-t.index:e.isDirectory===t.isDirectory?OD(e.name,t.name):e.isDirectory?-1:1}}let _f=class extends lh{constructor(e,t,i,s,o,r,n){super(e,t,i,s,o),this._workspaceService=r,this._editorService=n}_createTree(e){this._treeContainer.classList.add("file-icon-themable-tree"),this._treeContainer.classList.add("show-file-icons");const t=s=>{this._treeContainer.classList.toggle("align-icons-and-twisties",s.hasFileIcons&&!s.hasFolderIcons),this._treeContainer.classList.toggle("hide-arrows",s.hidesExplorerArrows===!0)};this._disposables.add(this._themeService.onDidFileIconThemeChange(t)),t(this._themeService.getFileIconTheme());const i=this._instantiationService.createInstance(jc,bb);return this._disposables.add(i),this._instantiationService.createInstance(cd,"BreadcrumbsFilePicker",e,new IV,[this._instantiationService.createInstance(Sf,i)],this._instantiationService.createInstance(Cf),{multipleSelectionSupport:!1,sorter:new kV,filter:this._instantiationService.createInstance(Ef),identityProvider:new DV,keyboardNavigationLabelProvider:new AV,accessibilityProvider:this._instantiationService.createInstance(TV),showNotFoundMessage:!1,overrideStyles:{listBackground:mS}})}async _setInput(e){const{uri:t,kind:i}=e;let s;i===$t.ROOT_FOLDER?s=this._workspaceService.getWorkspace():s=qc(t);const o=this._tree;await o.setInput(s);let r;for(const{element:n}of o.getNode().children)if(zs(n)&&qe(n.uri,t)){r=n;break}else if(qe(n.resource,t)){r=n;break}r&&(o.reveal(r,.5),o.setFocus([r],this._fakeEvent)),o.domFocus()}_previewElement(e){return M.None}async _revealElement(e,t,i){return!zs(e)&&e.isFile?(this._onWillPickElement.fire(),await this._editorService.openEditor({resource:e.resource,options:t},i?Dn:void 0),!0):!1}};_f=D([u(2,z),u(3,we),u(4,te),u(5,xt),u(6,O)],_f);let If=class{constructor(e,t,i){this.comparator=e,this._order=i.getValue(t,"breadcrumbs.symbolSortOrder")}compare(e,t){return this._order==="name"?this.comparator.compareByName(e,t):this._order==="type"?this.comparator.compareByType(e,t):this.comparator.compareByPosition(e,t)}};If=D([u(2,Cs)],If);class xV extends lh{_createTree(e,t){const{config:i}=t.outline;return this._instantiationService.createInstance(wS,"BreadcrumbsOutlinePicker",e,i.delegate,i.renderers,i.treeDataSource,{...i.options,sorter:this._instantiationService.createInstance(If,i.comparator,void 0),collapseByDefault:!0,expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,showNotFoundMessage:!1})}_setInput(e){const t=e.outline.captureViewState();this.restoreViewState=()=>{t.dispose()};const i=this._tree;return i.setInput(e.outline),e.element!==e.outline&&(i.reveal(e.element,.5),i.setFocus([e.element],this._fakeEvent)),i.domFocus(),Promise.resolve()}_previewElement(e){return this._tree.getInput().preview(e)}async _revealElement(e,t,i){return this._onWillPickElement.fire(),await this._tree.getInput().reveal(e,t,i,!1),!0}}var Df,Af,Wi;xe(B_);let hh=Df=class extends lv{constructor(e,t,i,s){super(),this.model=e,this.element=t,this.options=i,this._instantiationService=s,this._disposables=new B}dispose(){this._disposables.dispose()}equals(e){return e instanceof Df?this.element.element===e.element.element&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons:!1}render(e){const{element:t,outline:i}=this.element;if(t===i){const n=N("span",void 0,"");e.appendChild(n);return}const s=i.config.delegate.getTemplateId(t),o=i.config.renderers.find(n=>n.templateId===s);if(!o){e.textContent="<<NO RENDERER>>";return}const r=o.renderTemplate(e);o.renderElement({element:t,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:0,collapsible:!1,collapsed:!1,visible:!0,filterData:void 0},0,r,void 0),this.options.showSymbolIcons||ur(r.iconClass),this._disposables.add(pe(()=>{o.disposeTemplate(r)})),t instanceof BD&&i.uri&&this._disposables.add(this._instantiationService.invokeFunction(n=>G_(n,e,t.symbol.name,{symbol:t.symbol,uri:i.uri},this.model,this.options.dragEditor)))}};hh=Df=D([u(3,z)],hh);let uh=Af=class extends lv{constructor(e,t,i,s,o,r){super(),this.model=e,this.element=t,this.options=i,this._labels=s,this._hoverDelegate=o,this._instantiationService=r,this._disposables=new B}dispose(){this._disposables.dispose()}equals(e){return e instanceof Af?Kg.isEqual(this.element.uri,e.element.uri)&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons:!1}render(e){const t=this._labels.create(e,{hoverDelegate:this._hoverDelegate});t.setFile(this.element.uri,{hidePath:!0,hideIcon:this.element.kind===$t.FOLDER||!this.options.showFileIcons,fileKind:this.element.kind,fileDecorations:{colors:this.options.showDecorationColors,badges:!1}}),e.classList.add($t[this.element.kind].toLowerCase()),this._disposables.add(t),this._disposables.add(this._instantiationService.invokeFunction(i=>G_(i,e,Dt(this.element.uri),this.element.uri,this.model,this.options.dragEditor)))}};uh=Af=D([u(5,z)],uh);function G_(a,e,t,i,s,o){const r=a.get(z);return e.draggable=!0,new vc(e,{onDragStart:n=>{n.dataTransfer&&(n.dataTransfer.effectAllowed="copyMove",r.invokeFunction(d=>{F.isUri(i)?jl(d,[i],n):(jl(d,[{resource:i.uri,selection:i.symbol.range}],n),GD([{name:i.symbol.name,fsPath:i.uri.fsPath,range:i.symbol.range,kind:i.symbol.kind}],n)),o&&s.editor?.input&&Ws.getInstance().setData([new yt({editor:s.editor.input,groupId:s.editor.group.id})],yt.prototype)}),yb(n,e,t))}})}const LV=Ee("breadcrumb-separator",P.chevronRight,c(3098,"Icon for the separator in the breadcrumbs."));var Yt;let We=(Yt=class{get onDidVisibilityChange(){return this._onDidVisibilityChange.event}constructor(e,t,i,s,o,r,n,d,l,h,p,g){this._options=t,this._editorGroup=i,this._contextKeyService=s,this._contextViewService=o,this._instantiationService=r,this._quickInputService=n,this._fileService=d,this._editorService=l,this._labelService=h,this._disposables=new B,this._breadcrumbsDisposables=new B,this._model=new Ae,this._breadcrumbsPickerShowing=!1,this._onDidVisibilityChange=this._disposables.add(new A),this.domNode=ve("div"),this.domNode.classList.add("breadcrumbs-control"),ye(e,this.domNode),this._cfUseQuickPick=xi.UseQuickPick.bindTo(p),this._cfShowIcons=xi.Icons.bindTo(p),this._cfTitleScrollbarSizing=xi.TitleScrollbarSizing.bindTo(p),this._cfTitleScrollbarVisibility=xi.TitleScrollbarVisibility.bindTo(p),this._labels=this._instantiationService.createInstance(jc,bb);const f=this._cfTitleScrollbarSizing.getValue()??"default",m=t.widgetStyles??yS,v=this._cfTitleScrollbarVisibility?.getValue()??"auto";this._widget=new EV(this.domNode,Wi.SCROLLBAR_SIZES[f],Wi.SCROLLBAR_VISIBILITY[v],LV,m),this._widget.onDidSelectItem(this._onSelectEvent,this,this._disposables),this._widget.onDidFocusItem(this._onFocusEvent,this,this._disposables),this._widget.onDidChangeFocus(this._updateCkBreadcrumbsActive,this,this._disposables),this._ckBreadcrumbsPossible=Wi.CK_BreadcrumbsPossible.bindTo(this._contextKeyService),this._ckBreadcrumbsVisible=Wi.CK_BreadcrumbsVisible.bindTo(this._contextKeyService),this._ckBreadcrumbsActive=Wi.CK_BreadcrumbsActive.bindTo(this._contextKeyService),this._hoverDelegate=zc("mouse"),this._disposables.add(g.register(this._editorGroup.id,this._widget)),this.hide()}dispose(){this._disposables.dispose(),this._breadcrumbsDisposables.dispose(),this._model.dispose(),this._ckBreadcrumbsPossible.reset(),this._ckBreadcrumbsVisible.reset(),this._ckBreadcrumbsActive.reset(),this._cfUseQuickPick.dispose(),this._cfShowIcons.dispose(),this._cfTitleScrollbarSizing.dispose(),this._cfTitleScrollbarVisibility.dispose(),this._widget.dispose(),this._labels.dispose(),this.domNode.remove()}get model(){return this._model.value}layout(e){this._widget.layout(e)}isHidden(){return this.domNode.classList.contains("hidden")}hide(){const e=this.isHidden();this._breadcrumbsDisposables.clear(),this._ckBreadcrumbsVisible.set(!1),this.domNode.classList.toggle("hidden",!0),e||this._onDidVisibilityChange.fire()}show(){const e=this.isHidden();this._ckBreadcrumbsVisible.set(!0),this.domNode.classList.toggle("hidden",!1),e&&this._onDidVisibilityChange.fire()}revealLast(){this._widget.revealLast()}update(){this._breadcrumbsDisposables.clear();const e=Ue.getCanonicalUri(this._editorGroup.activeEditor,{supportSideBySide:Le.PRIMARY}),t=this.isHidden();if(!e||!this._fileService.hasProvider(e))return this._ckBreadcrumbsPossible.set(!1),t?!1:(this.hide(),!0);const i=Ue.getOriginalUri(this._editorGroup.activeEditor,{supportSideBySide:Le.PRIMARY});this.show(),this._ckBreadcrumbsPossible.set(!0);const s=this._instantiationService.createInstance(yf,i??e,this._editorGroup.activeEditorPane);this._model.value=s,this.domNode.classList.toggle("backslash-path",this._labelService.getSeparator(e.scheme,e.authority)==="\\");const o=()=>{this.domNode.classList.toggle("relative-path",s.isRelative());const p=this._cfShowIcons.getValue(),g={...this._options,showFileIcons:this._options.showFileIcons&&p,showSymbolIcons:this._options.showSymbolIcons&&p},f=s.getElements().map(m=>m instanceof ch?this._instantiationService.createInstance(uh,s,m,g,this._labels,this._hoverDelegate):this._instantiationService.createInstance(hh,s,m,g));f.length===0?(this._widget.setEnabled(!1),this._widget.setItems([new class extends lv{render(m){m.textContent=c(3102,"no elements")}equals(m){return m===this}dispose(){}}])):(this._widget.setEnabled(!0),this._widget.setItems(f),this._widget.reveal(f[f.length-1]))},r=s.onDidUpdate(o),n=this._cfShowIcons.onDidChange(o);o(),this._breadcrumbsDisposables.clear(),this._breadcrumbsDisposables.add(r),this._breadcrumbsDisposables.add(pe(()=>this._model.clear())),this._breadcrumbsDisposables.add(n),this._breadcrumbsDisposables.add(pe(()=>this._widget.setItems([])));const d=()=>{const p=this._cfTitleScrollbarSizing.getValue()??"default",g=this._cfTitleScrollbarVisibility?.getValue()??"auto";this._widget.setHorizontalScrollbarSize(Wi.SCROLLBAR_SIZES[p]),this._widget.setHorizontalScrollbarVisibility(Wi.SCROLLBAR_VISIBILITY[g])};d();const l=this._cfTitleScrollbarSizing.onDidChange(d),h=this._cfTitleScrollbarVisibility.onDidChange(d);return this._breadcrumbsDisposables.add(l),this._breadcrumbsDisposables.add(h),this._breadcrumbsDisposables.add({dispose:()=>{this._breadcrumbsPickerShowing&&this._contextViewService.hideContextView({source:this})}}),t!==this.isHidden()}_onFocusEvent(e){e.item&&this._breadcrumbsPickerShowing&&(this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setSelection(e.item))}_onSelectEvent(e){if(!e.item)return;if(e.item===this._breadcrumbsPickerIgnoreOnceItem){this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setFocused(void 0),this._widget.setSelection(void 0);return}const{element:t}=e.item;this._editorGroup.focus();const i=this._getEditorGroup(e.payload);if(i!==void 0){this._widget.setFocused(void 0),this._widget.setSelection(void 0),this._revealInEditor(e,t,i);return}if(this._cfUseQuickPick.getValue()){this._widget.setFocused(void 0),this._widget.setSelection(void 0),this._quickInputService.quickAccess.show(t instanceof vf?"@":"");return}let s,o;this._contextViewService.showContextView({render:r=>{e.item instanceof uh?s=this._instantiationService.createInstance(_f,r,e.item.model.resource):e.item instanceof hh&&(s=this._instantiationService.createInstance(xV,r,e.item.model.resource));const n=s.onWillPickElement(()=>this._contextViewService.hideContextView({source:this,didPick:!0})),d=FD.getInstance(He(this.domNode)).onDidChange(()=>this._contextViewService.hideContextView({source:this})),l=Eo(r),h=l.onDidBlur(()=>{this._breadcrumbsPickerIgnoreOnceItem=this._widget.isDOMFocused()?e.item:void 0,this._contextViewService.hideContextView({source:this})});return this._breadcrumbsPickerShowing=!0,this._updateCkBreadcrumbsActive(),Wg(s,n,d,l,h)},getAnchor:()=>{if(!o){const r=He(this.domNode),n=r.innerWidth-8;let d=Math.min(r.innerHeight*.7,300);const l=Math.min(n,Math.max(240,n/4.17)),h=8;let p;const g=CS(e.node.firstChild),f=g.top+g.height+h;f+d>=r.innerHeight&&(d=r.innerHeight-f-30);let m=g.left;if(m+l>=n&&(m=n-l),e.payload instanceof uo){const v=l-2*h;p=e.payload.posx-m,p>v&&(m=Math.min(n-l,m+p-v),p=v)}else p=g.left+g.width*.3-m;s.show(t,d,l,h,Math.max(0,p)),o={x:m,y:f}}return o},onHide:r=>{r?.didPick||s.restoreViewState(),this._breadcrumbsPickerShowing=!1,this._updateCkBreadcrumbsActive(),r?.source===this&&(this._widget.setFocused(void 0),this._widget.setSelection(void 0)),s.dispose()}})}_updateCkBreadcrumbsActive(){const e=this._widget.isDOMFocused()||this._breadcrumbsPickerShowing;this._ckBreadcrumbsActive.set(e)}async _revealInEditor(e,t,i,s=!1){if(t instanceof ch)if(t.kind===$t.FILE)await this._editorService.openEditor({resource:t.uri,options:{pinned:s}},i);else{const o=this._widget.getItems(),r=o.indexOf(e.item);this._widget.setFocused(o[r+1]),this._widget.setSelection(o[r+1],Wi.Payload_Pick)}else t.outline.reveal(t,{pinned:s},i===Dn,!1)}_getEditorGroup(e){return e===Wi.Payload_RevealAside?Dn:e===Wi.Payload_Reveal?SS:void 0}},Wi=Yt,Yt.HEIGHT=22,Yt.SCROLLBAR_SIZES={default:3,large:8},Yt.SCROLLBAR_VISIBILITY={auto:fs.Auto,visible:fs.Visible,hidden:fs.Hidden},Yt.Payload_Reveal={},Yt.Payload_RevealAside={},Yt.Payload_Pick={},Yt.CK_BreadcrumbsPossible=new oe("breadcrumbsPossible",!1,c(3099,"Whether the editor can show breadcrumbs")),Yt.CK_BreadcrumbsVisible=new oe("breadcrumbsVisible",!1,c(3100,"Whether breadcrumbs are currently visible")),Yt.CK_BreadcrumbsActive=new oe("breadcrumbsActive",!1,c(3101,"Whether breadcrumbs have focus")),Yt);We=Wi=D([u(3,de),u(4,Bn),u(5,z),u(6,lt),u(7,Ve),u(8,O),u(9,rs),u(10,te),u(11,Zs)],We);let ph=class{get control(){return this._control}get onDidEnablementChange(){return this._onDidEnablementChange.event}get onDidVisibilityChange(){return this._onDidVisibilityChange.event}constructor(e,t,i,s,o,r){this._container=e,this._editorGroup=t,this._options=i,this._instantiationService=o,this._disposables=new B,this._controlDisposables=new B,this._onDidEnablementChange=this._disposables.add(new A),this._onDidVisibilityChange=this._disposables.add(new A);const n=this._disposables.add(xi.IsEnabled.bindTo(s));this._disposables.add(n.onDidChange(()=>{const d=n.getValue();!d&&this._control?(this._controlDisposables.clear(),this._control=void 0,this._onDidEnablementChange.fire()):d&&!this._control&&(this._control=this.createControl(),this._control.update(),this._onDidEnablementChange.fire())})),n.getValue()&&(this._control=this.createControl()),this._disposables.add(r.onDidChangeFileSystemProviderRegistrations(d=>{this._control?.model&&this._control.model.resource.scheme!==d.scheme||this._control?.update()&&this._onDidEnablementChange.fire()}))}createControl(){const e=this._controlDisposables.add(this._instantiationService.createInstance(We,this._container,this._options,this._editorGroup));return this._controlDisposables.add(e.onDidVisibilityChange(()=>this._onDidVisibilityChange.fire())),e}dispose(){this._disposables.dispose(),this._controlDisposables.dispose()}};ph=D([u(3,te),u(4,z),u(5,Ve)],ph);S(class extends R{constructor(){super({id:"breadcrumbs.toggle",title:y(3103,"Toggle Breadcrumbs"),shortTitle:y(3104,"Breadcrumbs"),category:T.View,toggled:{condition:I.equals("config.breadcrumbs.enabled",!0),title:c(3105,"Breadcrumbs"),mnemonicTitle:c(3106,"&&Breadcrumbs")},menu:[{id:b.CommandPalette},{id:b.MenubarAppearanceMenu,group:"4_editor",order:2},{id:b.NotebookToolbar,group:"notebookLayout",order:2},{id:b.StickyScrollContext},{id:b.NotebookStickyScrollContext,group:"notebookView",order:2},{id:b.NotebookToolbarContext,group:"notebookView",order:2}]})}run(e){const t=e.get(te),i=xi.IsEnabled.bindTo(t),s=i.getValue();i.updateValue(!s),i.dispose()}});function hv(a,e){const t=a.get(U),s=a.get(Zs).getWidget(t.activeGroup.id);if(s){const o=s.getItems().at(-1);s.setFocused(o),e&&s.setSelection(o,We.Payload_Pick)}}S(class extends R{constructor(){super({id:"breadcrumbs.focusAndSelect",title:y(3107,"Focus and Select Breadcrumbs"),precondition:We.CK_BreadcrumbsVisible,keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|C.Shift|w.Period,when:We.CK_BreadcrumbsPossible},f1:!0})}run(e,...t){hv(e,!0)}});S(class extends R{constructor(){super({id:"breadcrumbs.focus",title:y(3108,"Focus Breadcrumbs"),precondition:We.CK_BreadcrumbsVisible,keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|C.Shift|w.Semicolon,when:We.CK_BreadcrumbsPossible},f1:!0})}run(e,...t){hv(e,!1)}});Z.registerCommandAndKeybindingRule({id:"breadcrumbs.toggleToOn",weight:L.WorkbenchContrib,primary:C.CtrlCmd|C.Shift|w.Period,when:I.not("config.breadcrumbs.enabled"),handler:async a=>{const e=a.get(z),t=a.get(te),i=xi.IsEnabled.bindTo(t);return i.getValue()||(await i.updateValue(!0),await fr(50)),i.dispose(),e.invokeFunction(hv,!0)}});Z.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNext",weight:L.WorkbenchContrib,primary:w.RightArrow,secondary:[C.CtrlCmd|w.RightArrow],mac:{primary:w.RightArrow,secondary:[C.Alt|w.RightArrow]},when:I.and(We.CK_BreadcrumbsVisible,We.CK_BreadcrumbsActive),handler(a){const e=a.get(U),i=a.get(Zs).getWidget(e.activeGroup.id);i&&i.focusNext()}});Z.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPrevious",weight:L.WorkbenchContrib,primary:w.LeftArrow,secondary:[C.CtrlCmd|w.LeftArrow],mac:{primary:w.LeftArrow,secondary:[C.Alt|w.LeftArrow]},when:I.and(We.CK_BreadcrumbsVisible,We.CK_BreadcrumbsActive),handler(a){const e=a.get(U),i=a.get(Zs).getWidget(e.activeGroup.id);i&&i.focusPrev()}});Z.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNextWithPicker",weight:L.WorkbenchContrib+1,primary:C.CtrlCmd|w.RightArrow,mac:{primary:C.Alt|w.RightArrow},when:I.and(We.CK_BreadcrumbsVisible,We.CK_BreadcrumbsActive,Pe),handler(a){const e=a.get(U),i=a.get(Zs).getWidget(e.activeGroup.id);i&&i.focusNext()}});Z.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPreviousWithPicker",weight:L.WorkbenchContrib+1,primary:C.CtrlCmd|w.LeftArrow,mac:{primary:C.Alt|w.LeftArrow},when:I.and(We.CK_BreadcrumbsVisible,We.CK_BreadcrumbsActive,Pe),handler(a){const e=a.get(U),i=a.get(Zs).getWidget(e.activeGroup.id);i&&i.focusPrev()}});Z.registerCommandAndKeybindingRule({id:"breadcrumbs.selectFocused",weight:L.WorkbenchContrib,primary:w.Enter,secondary:[w.DownArrow],when:I.and(We.CK_BreadcrumbsVisible,We.CK_BreadcrumbsActive),handler(a){const e=a.get(U),i=a.get(Zs).getWidget(e.activeGroup.id);i&&i.setSelection(i.getFocused(),We.Payload_Pick)}});Z.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocused",weight:L.WorkbenchContrib,primary:w.Space,secondary:[C.CtrlCmd|w.Enter],when:I.and(We.CK_BreadcrumbsVisible,We.CK_BreadcrumbsActive),handler(a){const e=a.get(U),i=a.get(Zs).getWidget(e.activeGroup.id);i&&i.setSelection(i.getFocused(),We.Payload_Reveal)}});Z.registerCommandAndKeybindingRule({id:"breadcrumbs.selectEditor",weight:L.WorkbenchContrib+1,primary:w.Escape,when:I.and(We.CK_BreadcrumbsVisible,We.CK_BreadcrumbsActive),handler(a){const e=a.get(U),i=a.get(Zs).getWidget(e.activeGroup.id);i&&(i.setFocused(void 0),i.setSelection(void 0),e.activeGroup.activeEditorPane?.focus())}});Z.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocusedFromTreeAside",weight:L.WorkbenchContrib,primary:C.CtrlCmd|w.Enter,when:I.and(We.CK_BreadcrumbsVisible,We.CK_BreadcrumbsActive,Pe),handler(a){const e=a.get(O),i=a.get(ne).lastFocusedList;if(!(i instanceof wS)&&!(i instanceof cd))return;const s=i.getFocus()[0];if(F.isUri(s?.resource))return e.openEditor({resource:s.resource,options:{pinned:!0}},Dn);const o=i.getInput();if(o&&typeof o.outlineKind=="string")return o.reveal(s,{pinned:!0,preserveFocus:!1},!0,!1)}});S(class extends R{constructor(){super({id:"breadcrumbs.copyPath",title:y(3109,"Copy Breadcrumbs Path"),category:T.View,precondition:We.CK_BreadcrumbsVisible,f1:!0,menu:[{id:b.EditorTitleContext,group:"1_cutcopypaste",order:100,when:We.CK_BreadcrumbsPossible}]})}async run(e){const t=e.get(U),i=e.get(yc),s=e.get(te),o=e.get(fS);if(!t.activeGroup.activeEditorPane)return;const r=await o.createOutline(t.activeGroup.activeEditorPane,gS.Breadcrumbs,Ni.None);if(!r)return;const d=r.config.breadcrumbsDataSource.getBreadcrumbElements().map(f=>f.label).filter(Boolean);if(r.dispose(),d.length===0)return;const l=t.activeGroup.activeEditorPane.input.resource,h=xi.SymbolPathSeparator.bindTo(s),p=h.getValue(l&&{resource:l})??".";h.dispose();const g=d.join(p);await i.writeText(g)}});const RV=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),VV=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),PV=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var Tf,kf,xf;xe(PV);let Ic=class extends WD{constructor(e,t,i,s,o){super(e,{canAcceptInBackground:!0,noResultsPick:{label:c(3439,"No matching editors"),groupId:-1}}),this.editorGroupService=t,this.editorService=i,this.modelService=s,this.languageService=o,this.pickState=new class{constructor(){this.scorerCache=Object.create(null),this.isQuickNavigating=void 0}reset(r){r||(this.scorerCache=Object.create(null)),this.isQuickNavigating=r}}}provide(e,t){return this.pickState.reset(!!e.quickNavigate),super.provide(e,t)}_getPicks(e){const t=KD(e),i=this.doGetEditorPickItems().filter(o=>{if(!t.normalized)return!0;const r=UD(o,t,!0,qv,this.pickState.scorerCache);return r.score?(o.highlights={label:r.labelMatch,description:r.descriptionMatch},!0):!1});if(t.normalized){const o=this.editorGroupService.getGroups(Ne.GRID_APPEARANCE).map(r=>r.id);i.sort((r,n)=>r.groupId!==n.groupId?o.indexOf(r.groupId)-o.indexOf(n.groupId):HD(r,n,t,!0,qv,this.pickState.scorerCache))}const s=[];if(this.editorGroupService.count>1){let o;for(const r of i){if(typeof o!="number"||o!==r.groupId){const n=this.editorGroupService.getGroup(r.groupId);n&&s.push({type:"separator",label:n.label}),o=r.groupId}s.push(r)}}else s.push(...i);return s}doGetEditorPickItems(){const e=this.doGetEditors(),t=new Map;for(const{groupId:i}of e)if(!t.has(i)){const s=this.editorGroupService.getGroup(i);s&&t.set(i,s.ariaLabel)}return this.doGetEditors().map(({editor:i,groupId:s})=>{const o=Ue.getOriginalUri(i,{supportSideBySide:Le.PRIMARY}),r=i.isDirty()&&!i.isSaving(),n=i.getDescription(),d=n?`${i.getName()} ${n}`:i.getName();return{groupId:s,resource:o,label:i.getName(),ariaLabel:t.size>1?r?c(3440,"{0}, unsaved changes, {1}",d,t.get(s)):c(3441,"{0}, {1}",d,t.get(s)):r?c(3442,"{0}, unsaved changes",d):d,description:n,iconClasses:ES(this.modelService,this.languageService,o,void 0,i.getIcon()).concat(i.getLabelExtraClasses()),italic:!this.editorGroupService.getGroup(s)?.isPinned(i),buttons:[{iconClass:r?"dirty-editor "+Se.asClassName(P.closeDirty):Se.asClassName(P.close),tooltip:c(3443,"Close Editor"),alwaysVisible:r}],trigger:async()=>{const l=this.editorGroupService.getGroup(s);return l&&(await l.closeEditor(i,{preserveFocus:!0}),!l.contains(i))?jv.REMOVE_ITEM:jv.NO_ACTION},accept:(l,h)=>this.editorGroupService.getGroup(s)?.openEditor(i,{preserveFocus:h.inBackground})}})}};Ic=D([u(1,U),u(2,O),u(3,Ro),u(4,Es)],Ic);var jr;let vr=(jr=class extends Ic{constructor(e,t,i,s){super(Tf.PREFIX,e,t,i,s)}doGetEditors(){const e=this.editorGroupService.activeGroup;return e.getEditors(Ie.MOST_RECENTLY_ACTIVE).map(t=>({editor:t,groupId:e.id}))}},Tf=jr,jr.PREFIX="edt active ",jr);vr=Tf=D([u(0,U),u(1,O),u(2,Ro),u(3,Es)],vr);var Yr;let Dc=(Yr=class extends Ic{constructor(e,t,i,s){super(kf.PREFIX,e,t,i,s)}doGetEditors(){const e=[];for(const t of this.editorGroupService.getGroups(Ne.GRID_APPEARANCE))for(const i of t.getEditors(Ie.SEQUENTIAL))e.push({editor:i,groupId:t.id});return e}},kf=Yr,Yr.PREFIX="edt ",Yr);Dc=kf=D([u(0,U),u(1,O),u(2,Ro),u(3,Es)],Dc);var Xr;let On=(Xr=class extends Ic{constructor(e,t,i,s){super(xf.PREFIX,e,t,i,s)}doGetEditors(){const e=[];for(const t of this.editorService.getEditors(Ie.MOST_RECENTLY_ACTIVE))e.push(t);return e}},xf=Xr,Xr.PREFIX="edt mru ",Xr);On=xf=D([u(0,U),u(1,O),u(2,Ro),u(3,Es)],On);var Lf,Jr;let Ac=(Jr=class extends UR{constructor(e,t,i,s,o,r,n,d,l,h){super(e,t,Lf.VIEW_STATE_PREFERENCE_KEY,i,s,o,r,n,d,l),this.fileService=h,this._onDidChangeSelection=this._register(new A),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeScroll=this._register(new A),this.onDidChangeScroll=this._onDidChangeScroll.event,this.inputListener=this._register(new Ae),this._register(this.textResourceConfigurationService.onDidChangeConfiguration(p=>this.handleConfigurationChangeEvent(p))),this._register(K.any(this.editorGroupService.onDidAddGroup,this.editorGroupService.onDidRemoveGroup)(()=>{const p=this.computeAriaLabel();this.editorContainer?.setAttribute("aria-label",p),this.updateEditorControlOptions({ariaLabel:p})})),this._register(this.fileService.onDidChangeFileSystemProviderCapabilities(p=>this.onDidChangeFileSystemProvider(p.scheme))),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(p=>this.onDidChangeFileSystemProvider(p.scheme)))}handleConfigurationChangeEvent(e){const t=this.getActiveResource();this.shouldHandleConfigurationChangeEvent(e,t)&&(this.isVisible()?this.updateEditorConfiguration(t):this.hasPendingConfigurationChange=!0)}shouldHandleConfigurationChangeEvent(e,t){return e.affectsConfiguration(t,"editor")||e.affectsConfiguration(t,"problems.visibility")}consumePendingConfigurationChangeEvent(){this.hasPendingConfigurationChange&&(this.updateEditorConfiguration(),this.hasPendingConfigurationChange=!1)}computeConfiguration(e){const t=bp(e.editor)?Cb(e.editor):Object.create(null);return Object.assign(t,this.getConfigurationOverrides(e)),t.ariaLabel=this.computeAriaLabel(),t}computeAriaLabel(){return this.input?fb(this.input,void 0,this.group,this.editorGroupService.count):c(3512,"Editor")}onDidChangeFileSystemProvider(e){this.input&&this.getActiveResource()?.scheme===e&&this.updateReadonly(this.input)}onDidChangeInputCapabilities(e){this.input===e&&this.updateReadonly(e)}updateReadonly(e){this.updateEditorControlOptions({...this.getReadonlyConfiguration(e.isReadonly())})}getReadonlyConfiguration(e){return{readOnly:!!e,readOnlyMessage:typeof e!="boolean"?e:void 0}}getConfigurationOverrides(e){return{overviewRulerLanes:3,lineNumbersMinChars:3,fixedOverflowWidgets:!0,...this.getReadonlyConfiguration(this.input?.isReadonly()),renderValidationDecorations:e.problems?.visibility!==!1?"on":"off"}}createEditor(e){this.editorContainer=e,this.createEditorControl(e,this.computeConfiguration(this.textResourceConfigurationService.getValue(this.getActiveResource()))),this.registerCodeEditorListeners()}registerCodeEditorListeners(){const e=this.getMainControl();e&&(this._register(e.onDidChangeModelLanguage(()=>this.updateEditorConfiguration())),this._register(e.onDidChangeModel(()=>this.updateEditorConfiguration())),this._register(e.onDidChangeCursorPosition(t=>this._onDidChangeSelection.fire({reason:this.toEditorPaneSelectionChangeReason(t)}))),this._register(e.onDidChangeModelContent(()=>this._onDidChangeSelection.fire({reason:zt.EDIT}))),this._register(e.onDidScrollChange(()=>this._onDidChangeScroll.fire())))}toEditorPaneSelectionChangeReason(e){switch(e.source){case sg.PROGRAMMATIC:return zt.PROGRAMMATIC;case sg.NAVIGATION:return zt.NAVIGATION;case sg.JUMP:return zt.JUMP;default:return zt.USER}}getSelection(){const e=this.getMainControl();if(e){const t=e.getSelection();if(t)return new Rf(t)}}async setInput(e,t,i,s){await super.setInput(e,t,i,s),this.inputListener.value=e.onDidChangeCapabilities(()=>this.onDidChangeInputCapabilities(e)),this.updateEditorConfiguration(),fe(this.editorContainer).setAttribute("aria-label",this.computeAriaLabel())}clearInput(){this.inputListener.clear(),super.clearInput()}getScrollPosition(){const e=this.getMainControl();if(!e)throw new Error("Control has not yet been initialized");return{scrollTop:e.getScrollTop()-e.getTopForLineNumber(1),scrollLeft:e.getScrollLeft()}}setScrollPosition(e){const t=this.getMainControl();if(!t)throw new Error("Control has not yet been initialized");t.setScrollTop(e.scrollTop),e.scrollLeft&&t.setScrollLeft(e.scrollLeft)}setEditorVisible(e){e&&this.consumePendingConfigurationChangeEvent(),super.setEditorVisible(e)}toEditorViewStateResource(e){return e.resource}updateEditorConfiguration(e=this.getActiveResource()){let t;if(e&&(t=this.textResourceConfigurationService.getValue(e)),!t)return;const i=this.computeConfiguration(t);let s=i;this.lastAppliedEditorOptions&&(s=zD(this.lastAppliedEditorOptions,s)),Object.keys(s).length>0&&(this.lastAppliedEditorOptions=i,this.updateEditorControlOptions(s))}getActiveResource(){const e=this.getMainControl();if(e){const t=e.getModel();if(t)return t.uri}if(this.input)return this.input.resource}dispose(){this.lastAppliedEditorOptions=void 0,super.dispose()}},Lf=Jr,Jr.VIEW_STATE_PREFERENCE_KEY="textEditorViewState",Jr);Ac=Lf=D([u(2,nt),u(3,z),u(4,ge),u(5,Cs),u(6,we),u(7,O),u(8,U),u(9,Ve)],Ac);const sc=class sc{constructor(e){this.textSelection=e}compare(e){if(!(e instanceof sc))return zo.DIFFERENT;const t=Math.min(this.textSelection.selectionStartLineNumber,this.textSelection.positionLineNumber),i=Math.min(e.textSelection.selectionStartLineNumber,e.textSelection.positionLineNumber);return t===i?zo.IDENTICAL:Math.abs(t-i)<sc.TEXT_EDITOR_SELECTION_THRESHOLD?zo.SIMILAR:zo.DIFFERENT}restore(e){return{...e,selection:this.textSelection,selectionRevealType:$D.CenterIfOutsideViewport}}log(){return`line: ${this.textSelection.startLineNumber}-${this.textSelection.endLineNumber}, col:  ${this.textSelection.startColumn}-${this.textSelection.endColumn}`}};sc.TEXT_EDITOR_SELECTION_THRESHOLD=10;let Rf=sc;var Vf,Zr;let Qo=(Zr=class extends Ac{get scopedContextKeyService(){if(!this.diffEditorControl)return;const e=this.diffEditorControl.getOriginalEditor(),t=this.diffEditorControl.getModifiedEditor();return(e.hasTextFocus()?e:t).invokeWithinContext(i=>i.get(de))}constructor(e,t,i,s,o,r,n,d,l,h){super(Vf.ID,e,t,i,s,o,n,r,d,l),this.preferencesService=h,this.diffEditorControl=void 0,this.inputLifecycleStopWatch=void 0,this._previousViewModel=null}getTitle(){return this.input?this.input.getName():c(3509,"Text Diff Editor")}createEditorControl(e,t){this.diffEditorControl=this._register(this.instantiationService.createInstance(Yv,e,t,{}))}updateEditorControlOptions(e){this.diffEditorControl?.updateOptions(e)}getMainControl(){return this.diffEditorControl?.getModifiedEditor()}async setInput(e,t,i,s){this._previousViewModel&&(this._previousViewModel.dispose(),this._previousViewModel=null),this.inputLifecycleStopWatch=void 0,await super.setInput(e,t,i,s);try{const o=await e.resolve();if(s.isCancellationRequested)return;if(!(o instanceof qD)){this.openAsBinary(e,t);return}const r=fe(this.diffEditorControl),n=o,d=n.textDiffEditorModel?r.createViewModel(n.textDiffEditorModel):null;this._previousViewModel=d,await d?.waitForDiff(),r.setModel(d);let l=!1;Sb(t?.viewState)||(l=this.restoreTextDiffEditorViewState(e,t,i,r));let h=!1;t&&(h=Tn(t,r,Nt.Immediate)),!h&&!l&&r.revealFirstDiff(),r.updateOptions({...this.getReadonlyConfiguration(n.modifiedModel?.isReadonly()),originalEditable:!n.originalModel?.isReadonly()}),r.handleInitialized(),this.inputLifecycleStopWatch=new jD(!1)}catch(o){await this.handleSetInputError(o,e,t)}}async handleSetInputError(e,t,i){if(this.isFileBinaryError(e))return this.openAsBinary(t,i);if(e.fileOperationResult===Ms.FILE_TOO_LARGE){let s;throw e instanceof IS?s=c(3510,"At least one file is not displayed in the text compare editor because it is very large ({0}).",vp.formatSize(e.size)):s=c(3511,"At least one file is not displayed in the text compare editor because it is very large."),DS(this.group,t,i,s,this.preferencesService)}throw e}restoreTextDiffEditorViewState(e,t,i,s){const o=this.loadEditorViewState(e,i);return o?(t?.selection&&o.modified&&(o.modified.cursorState=[]),s.restoreViewState(o),t?.revealIfVisible&&s.revealFirstDiff(),!0):!1}openAsBinary(e,t){const i=e.original,s=e.modified,o=this.instantiationService.createInstance(Jt,e.getName(),e.getDescription(),i,s,!0),r=se.as(Lt.EditorFactory).getFileEditorFactory();r.isFileEditor(i)&&i.setForceOpenAsBinary(),r.isFileEditor(s)&&s.setForceOpenAsBinary(),this.group.replaceEditors([{editor:e,replacement:o,options:{...t,activation:ho.PRESERVE,pinned:this.group.isPinned(e),sticky:this.group.isSticky(e)}}])}setOptions(e){super.setOptions(e),e&&Tn(e,fe(this.diffEditorControl),Nt.Smooth)}shouldHandleConfigurationChangeEvent(e,t){return super.shouldHandleConfigurationChangeEvent(e,t)?!0:e.affectsConfiguration(t,"diffEditor")||e.affectsConfiguration(t,"accessibility.verbosity.diffEditor")}computeConfiguration(e){const t=super.computeConfiguration(e);if(bp(e.diffEditor)){const s=Cb(e.diffEditor);s.diffCodeLens=s.codeLens,delete s.codeLens,s.diffWordWrap=s.wordWrap,delete s.wordWrap,Object.assign(t,s)}const i=e.accessibility?.verbosity?.diffEditor??!1;return t.accessibilityVerbose=i,t}getConfigurationOverrides(e){return{...super.getConfigurationOverrides(e),...this.getReadonlyConfiguration(this.input?.isReadonly()),originalEditable:this.input instanceof Jt&&!this.input.original.isReadonly(),lineDecorationsWidth:"2ch"}}updateReadonly(e){e instanceof Jt?this.diffEditorControl?.updateOptions({...this.getReadonlyConfiguration(e.isReadonly()),originalEditable:!e.original.isReadonly()}):super.updateReadonly(e)}isFileBinaryError(e){return Array.isArray(e)?e.some(i=>this.isFileBinaryError(i)):e.textFileOperationResult===AS.FILE_IS_BINARY}clearInput(){this._previousViewModel&&(this._previousViewModel.dispose(),this._previousViewModel=null),super.clearInput();const e=this.inputLifecycleStopWatch?.elapsed();this.inputLifecycleStopWatch=void 0,typeof e=="number"&&this.logInputLifecycleTelemetry(e,this.getControl()?.getModel()?.modified?.getLanguageId()),this.diffEditorControl?.setModel(null)}logInputLifecycleTelemetry(e,t){let i=!1;this.diffEditorControl instanceof Yv&&(i=this.diffEditorControl.collapseUnchangedRegions),this.telemetryService.publicLog2("diffEditor.editorVisibleTime",{editorVisibleTimeMs:e,languageId:t??"",collapseUnchangedRegions:i})}getControl(){return this.diffEditorControl}focus(){super.focus(),this.diffEditorControl?.focus()}hasFocus(){return this.diffEditorControl?.hasTextFocus()||super.hasFocus()}setEditorVisible(e){super.setEditorVisible(e),e?this.diffEditorControl?.onVisible():this.diffEditorControl?.onHide()}layout(e){this.diffEditorControl?.layout(e)}setBoundarySashes(e){this.diffEditorControl?.setBoundarySashes(e)}tracksEditorViewState(e){return e instanceof Jt}computeEditorViewState(e){if(!this.diffEditorControl)return;const t=this.diffEditorControl.getModel();if(!t?.modified||!t.original)return;const i=this.toEditorViewStateResource(t);if(i&&qe(i,e))return this.diffEditorControl.saveViewState()??void 0}toEditorViewStateResource(e){let t,i;if(e instanceof Jt?(t=e.original.resource,i=e.modified.resource):It(e)||(t=e.original.uri,i=e.modified.uri),!(!t||!i))return F.from({scheme:"diff",path:`${Xv(t.toString())}${Xv(i.toString())}`})}},Vf=Zr,Zr.ID=_S,Zr);Qo=Vf=D([u(1,nt),u(2,z),u(3,ge),u(4,Cs),u(5,O),u(6,we),u(7,U),u(8,Ve),u(9,ld)],Qo);const Pf="toggle.diff.renderSideBySide",Of="workbench.action.compareEditor.nextChange",Mf="workbench.action.compareEditor.previousChange",W_="workbench.action.compareEditor.focusPrimarySide",K_="workbench.action.compareEditor.focusSecondarySide",U_="workbench.action.compareEditor.focusOtherSide",lC="workbench.action.compareEditor.openSide",H_="toggle.diff.ignoreTrimWhitespace",Nf="workbench.action.compareEditor.swapSides";function OV(){Z.registerCommandAndKeybindingRule({id:lC,weight:L.WorkbenchContrib,when:mr.inDiffEditor,primary:Ce(C.CtrlCmd|w.KeyK,C.Shift|w.KeyO),handler:async n=>{const d=n.get(O),l=n.get(U),h=d.activeEditor,p=d.activeTextEditorControl;if(!TS(p)||!(h instanceof Jt))return;let g;return p.getOriginalEditor().hasTextFocus()?g=h.original:g=h.modified,l.activeGroup.openEditor(g)}}),_.appendMenuItem(b.CommandPalette,{command:{id:lC,title:y(3111,"Open Active Diff Side")}}),Z.registerCommandAndKeybindingRule({id:Of,weight:L.WorkbenchContrib,when:Ug,primary:C.Alt|w.F5,handler:(n,...d)=>e(n,d,!0)}),_.appendMenuItem(b.CommandPalette,{command:{id:Of,title:y(3112,"Go to Next Change")}}),Z.registerCommandAndKeybindingRule({id:Mf,weight:L.WorkbenchContrib,when:Ug,primary:C.Alt|C.Shift|w.F5,handler:(n,...d)=>e(n,d,!1)}),_.appendMenuItem(b.CommandPalette,{command:{id:Mf,title:y(3113,"Go to Previous Change")}});function a(n,d){const l=n.get(O),h=d.length>0&&d[0]instanceof F?d[0]:void 0;for(const p of[l.activeEditorPane,...l.visibleEditorPanes])if(p instanceof Qo&&(!h||p.input instanceof Jt&&qe(p.input.primary.resource,h)))return p}function e(n,d,l){const h=a(n,d);h&&h.getControl()?.goToDiff(l?"next":"previous")}let t;(function(n){n[n.Original=0]="Original",n[n.Modified=1]="Modified",n[n.Toggle=2]="Toggle"})(t||(t={}));function i(n,d,l){const h=a(n,d);if(h)switch(l){case t.Original:h.getControl()?.getOriginalEditor().focus();break;case t.Modified:h.getControl()?.getModifiedEditor().focus();break;case t.Toggle:return h.getControl()?.getModifiedEditor().hasWidgetFocus()?i(n,d,t.Original):i(n,d,t.Modified)}}function s(n,d){const l=n.get(Cs),p=a(n,d)?.getControl()?.getModifiedEditor()?.getModel();if(!p)return;const g="diffEditor.renderSideBySide",f=l.getValue(p.uri,g);l.updateValue(p.uri,g,!f)}function o(n,d){const l=n.get(Cs),p=a(n,d)?.getControl()?.getModifiedEditor()?.getModel();if(!p)return;const g="diffEditor.ignoreTrimWhitespace",f=l.getValue(p.uri,g);l.updateValue(p.uri,g,!f)}async function r(n,d){const l=n.get(O),h=a(n,d),p=h?.group,g=h?.input;if(!h||typeof p>"u"||!(g instanceof Jt)||!g.modified.resource)return;const f=g.toUntyped({preserveViewState:p.id,preserveResource:!0});if(f){if(g.modified.isModified()&&l.findEditors({resource:g.modified.resource,typeId:g.modified.typeId,editorId:g.modified.editorId}).length===0){const m={...f.modified};m.options||(m.options={}),m.options.pinned=!0,m.options.inactive=!0,await l.openEditor(m,p)}await l.replaceEditors([{editor:g,replacement:{...f,original:f.modified,modified:f.original,options:{...f.options,pinned:!0}}}],p)}}Z.registerCommandAndKeybindingRule({id:Pf,weight:L.WorkbenchContrib,when:void 0,primary:void 0,handler:(n,...d)=>s(n,d)}),Z.registerCommandAndKeybindingRule({id:W_,weight:L.WorkbenchContrib,when:void 0,primary:void 0,handler:(n,...d)=>i(n,d,t.Modified)}),Z.registerCommandAndKeybindingRule({id:K_,weight:L.WorkbenchContrib,when:void 0,primary:void 0,handler:(n,...d)=>i(n,d,t.Original)}),Z.registerCommandAndKeybindingRule({id:U_,weight:L.WorkbenchContrib,when:void 0,primary:void 0,handler:(n,...d)=>i(n,d,t.Toggle)}),Z.registerCommandAndKeybindingRule({id:H_,weight:L.WorkbenchContrib,when:void 0,primary:void 0,handler:(n,...d)=>o(n,d)}),Z.registerCommandAndKeybindingRule({id:Nf,weight:L.WorkbenchContrib,when:void 0,primary:void 0,handler:(n,...d)=>r(n,d)}),_.appendMenuItem(b.CommandPalette,{command:{id:Pf,title:y(3114,"Toggle Inline View"),category:c(3115,"Compare")},when:Ri}),_.appendMenuItem(b.CommandPalette,{command:{id:Nf,title:y(3116,"Swap Left and Right Editor Side"),category:c(3115,"Compare")},when:I.and(Ri,Eb)})}const Up="workbench.action.closeUnmodifiedEditors",vd="workbench.action.closeEditorsInGroup",z_="workbench.action.closeEditorsAndGroup",uv="workbench.action.closeEditorsToTheRight",to="workbench.action.closeActiveEditor",$_="workbench.action.closeActivePinnedEditor",pv="workbench.action.closeGroup",gv="workbench.action.closeOtherEditors",Oo="moveActiveEditor",Mo="copyActiveEditor",No="layoutEditorGroups",fv="workbench.action.keepEditor",q_="workbench.action.toggleKeepEditors",mv="workbench.action.toggleEditorGroupLock",wv="workbench.action.lockEditorGroup",yd="workbench.action.unlockEditorGroup",j_="workbench.action.showEditorsInGroup",bv="workbench.action.reopenWithEditor",MV="reopenActiveEditorWith",vv="workbench.action.pinEditor",jn="workbench.action.unpinEditor",Cd="workbench.action.splitEditor",Mn="workbench.action.splitEditorUp",yr="workbench.action.splitEditorDown",Nn="workbench.action.splitEditorLeft",Cr="workbench.action.splitEditorRight",gh="workbench.action.moveEditorToAboveGroup",fh="workbench.action.moveEditorToBelowGroup",mh="workbench.action.moveEditorToLeftGroup",wh="workbench.action.moveEditorToRightGroup",Hp="workbench.action.toggleMaximizeEditorGroup",yv="workbench.action.splitEditorInGroup",NV="workbench.action.toggleSplitEditorInGroup",Cv="workbench.action.joinEditorInGroup",Y_="workbench.action.toggleSplitEditorInGroupLayout",X_="workbench.action.focusFirstSideEditor",J_="workbench.action.focusSecondSideEditor",FV="workbench.action.focusOtherSideEditor",BV="workbench.action.focusLeftGroupWithoutWrap",GV="workbench.action.focusRightGroupWithoutWrap",WV="workbench.action.focusAboveGroupWithoutWrap",KV="workbench.action.focusBelowGroupWithoutWrap",hC="workbench.action.openEditorAtIndex",Sv="workbench.action.moveEditorToNewWindow",Ev="workbench.action.copyEditorToNewWindow",Z_="workbench.action.moveEditorGroupToNewWindow",Q_="workbench.action.copyEditorGroupToNewWindow",eI="workbench.action.newEmptyEditorWindow",Ff="_workbench.open",Bf="_workbench.diff",UV="_workbench.openWith",HV=[Cd,to,jn,yd,Hp],uC=function(a){return!(!bp(a)||!Za(a.to)||!Mr(a.by)&&!Za(a.by)||!Mr(a.value)&&!YD(a.value))};function zV(){const a={type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right"]},by:{type:"string",enum:["tab","group"]},value:{type:"number"}}};Z.registerCommandAndKeybindingRule({id:Oo,weight:L.WorkbenchContrib,when:mr.editorTextFocus,primary:0,handler:(o,r)=>e(!0,r,o),metadata:{description:c(3380,"Move the active editor by tabs or groups"),args:[{name:c(3381,"Active editor move argument"),description:c(3382,`Argument Properties:
	* 'to': String value providing where to move.
	* 'by': String value providing the unit for move (by tab or by group).
	* 'value': Number value providing how many positions or an absolute position to move.`),constraint:uC,schema:a}]}}),Z.registerCommandAndKeybindingRule({id:Mo,weight:L.WorkbenchContrib,when:mr.editorTextFocus,primary:0,handler:(o,r)=>e(!1,r,o),metadata:{description:c(3383,"Copy the active editor by groups"),args:[{name:c(3384,"Active editor copy argument"),description:c(3385,`Argument Properties:
	* 'to': String value providing where to copy.
	* 'value': Number value providing how many positions or an absolute position to copy.`),constraint:uC,schema:a}]}}),[{id:gh,to:"up"},{id:fh,to:"down"},{id:mh,to:"left"},{id:wh,to:"right"}].forEach(({id:o,to:r})=>{re.registerCommand(o,function(n,...d){const l=bt(d,n.get(O),n.get(U),n.get(ne));l.groupedEditors.length&&s(!0,{to:r},l.groupedEditors[0].group,l.groupedEditors[0].editors,n)})});function e(o,r=Object.create(null),n){r.to=r.to||"right",r.by=r.by||"tab",r.value=typeof r.value=="number"?r.value:1;const d=n.get(U).activeGroup,l=d.selectedEditors;if(l.length>0)switch(r.by){case"tab":if(o)return t(r,d,l);break;case"group":return s(o,r,d,l,n)}}function t(o,r,n){const d=o.to;d==="first"||d==="right"?n=[...n].reverse():d==="position"&&(o.value??1)<r.getIndexOfEditor(n[0])&&(n=[...n].reverse());for(const l of n)i(o,r,l)}function i(o,r,n){let d=r.getIndexOfEditor(n);switch(o.to){case"first":d=0;break;case"last":d=r.count-1;break;case"left":d=d-(o.value??1);break;case"right":d=d+(o.value??1);break;case"center":d=Math.round(r.count/2)-1;break;case"position":d=(o.value??1)-1;break}d=d<0?0:d>=r.count?r.count-1:d,r.moveEditor(n,r,{index:d})}function s(o,r,n,d,l){const h=l.get(U),p=l.get(te);let g;switch(r.to){case"left":g=h.findGroup({direction:J.LEFT},n),g||(g=h.addGroup(n,J.LEFT));break;case"right":g=h.findGroup({direction:J.RIGHT},n),g||(g=h.addGroup(n,J.RIGHT));break;case"up":g=h.findGroup({direction:J.UP},n),g||(g=h.addGroup(n,J.UP));break;case"down":g=h.findGroup({direction:J.DOWN},n),g||(g=h.addGroup(n,J.DOWN));break;case"first":g=h.findGroup({location:Xe.FIRST},n);break;case"last":g=h.findGroup({location:Xe.LAST},n);break;case"previous":if(g=h.findGroup({location:Xe.PREVIOUS},n),!g){const f=Cc(p)===J.RIGHT?J.LEFT:J.UP;g=h.addGroup(n,f)}break;case"next":g=h.findGroup({location:Xe.NEXT},n),g||(g=h.addGroup(n,Cc(p)));break;case"center":g=h.getGroups(Ne.GRID_APPEARANCE)[h.count/2-1];break;case"position":g=h.getGroups(Ne.GRID_APPEARANCE)[(r.value??1)-1];break}if(g){const f=yp(n,d);o?n.moveEditors(f,g):n.id!==g.id&&n.copyEditors(f,g),g.focus()}}}function $V(){function a(e,t){if(!t||typeof t!="object")return;e.get(U).applyLayout(t)}re.registerCommand(No,(e,t)=>{a(e,t)}),re.registerCommand({id:"vscode.setEditorLayout",handler:(e,t)=>a(e,t),metadata:{description:`Set the editor layout. Editor layout is represented as a tree of groups in which the first group is the root group of the layout.
					The orientation of the first group is 0 (horizontal) by default unless specified otherwise. The other orientations are 1 (vertical).
					The orientation of subsequent groups is the opposite of the orientation of the group that contains it.
					Here are some examples: A layout representing 1 row and 2 columns: { orientation: 0, groups: [{}, {}] }.
					A layout representing 3 rows and 1 column: { orientation: 1, groups: [{}, {}, {}] }.
					A layout representing 3 rows and 1 column in which the second row has 2 columns: { orientation: 1, groups: [{}, { groups: [{}, {}] }, {}] }
					`,args:[{name:"args",schema:{type:"object",required:["groups"],properties:{orientation:{type:"number",default:0,description:"The orientation of the root group in the layout. 0 for horizontal, 1 for vertical.",enum:[0,1],enumDescriptions:[c(3386,"Horizontal"),c(3387,"Vertical")]},groups:{$ref:"#/definitions/editorGroupsSchema",default:[{},{}]}}}}]}}),re.registerCommand({id:"vscode.getEditorLayout",handler:e=>e.get(U).getLayout(),metadata:{description:"Get Editor Layout",args:[],returns:"An editor layout object, in the same format as vscode.setEditorLayout"}})}function qV(){function a(e,t,i){return e?[{...e.editorOptions,...t??Object.create(null)},e.sideBySide?Dn:i]:[t,i]}re.registerCommand({id:"vscode.open",handler:(e,t)=>{e.get(ke).executeCommand(Ff,t)},metadata:{description:"Opens the provided resource in the editor.",args:[{name:"Uri"}]}}),re.registerCommand(Ff,async function(e,t,i,s,o){const r=e.get(O),n=e.get(U),d=e.get(tt),l=e.get(Gn),h=e.get(te),p=e.get(_b),g=typeof t=="string"?t:F.from(t,!0),[f,m]=i??[];if(m||typeof f=="number"||Md(g,ue.untitled)){const[v,E]=a(o,m,f),x=F.isUri(g)?g:F.parse(g);let G;p.isUntitledWithAssociatedResource(x)?G={resource:x.with({scheme:l.defaultUriScheme}),forceUntitled:!0,options:v,label:s}:G={resource:x,options:v,label:s},await r.openEditor(G,og(n,h,E))}else{if(Md(g,ue.command))return;await d.open(g,{openToSide:o?.sideBySide,editorOptions:o?.editorOptions})}}),re.registerCommand({id:"vscode.diff",handler:(e,t,i,s)=>{e.get(ke).executeCommand(Bf,t,i,s)},metadata:{description:"Opens the provided resources in the diff editor to compare their contents.",args:[{name:"left",description:"Left-hand side resource of the diff editor"},{name:"right",description:"Right-hand side resource of the diff editor"},{name:"title",description:"Human readable title for the diff editor"}]}}),re.registerCommand(Bf,async function(e,t,i,s,o,r){const n=e.get(O),d=e.get(U),l=e.get(te),[h,p]=o??[],[g,f]=a(r,p,h);let m,v;typeof s=="string"?m=s:s&&(m=s.label,v=s.description),await n.openEditor({original:{resource:F.from(t,!0)},modified:{resource:F.from(i,!0)},label:m,description:v,options:g},og(d,l,f))}),re.registerCommand(UV,async(e,t,i,s)=>{const o=e.get(O),r=e.get(U),n=e.get(te),[d,l]=s??[];await o.openEditor({resource:F.from(t,!0),options:{pinned:!0,...l,override:i}},og(r,n,d))}),re.registerCommand({id:"vscode.changes",handler:(e,t,i)=>{e.get(ke).executeCommand("_workbench.changes",t,i)},metadata:{description:"Opens a list of resources in the changes editor to compare their contents.",args:[{name:"title",description:"Human readable title for the diff editor"},{name:"resources",description:"List of resources to open in the changes editor"}]}}),re.registerCommand("_workbench.changes",async(e,t,i)=>{const s=e.get(O),o=[];for(const[r,n,d]of i)o.push({resource:F.revive(r),original:{resource:F.revive(n)},modified:{resource:F.revive(d)}});await s.openEditor({resources:o,label:t})}),re.registerCommand("_workbench.openMultiDiffEditor",async(e,t)=>{const i=e.get(O),s=t.resources?.map(d=>({original:{resource:F.revive(d.originalUri)},modified:{resource:F.revive(d.modifiedUri)}})),o=t.reveal?.modifiedUri?F.revive(t.reveal.modifiedUri):void 0,r=o&&s?s.find(d=>qe(d.modified.resource,o)):void 0;t.reveal&&!r&&console.error("Reveal resource not found");const n={viewState:r?{revealData:{resource:{original:r.original.resource,modified:r.modified.resource},range:t.reveal?.range}}:void 0};await i.openEditor({multiDiffSource:t.multiDiffSourceUri?F.revive(t.multiDiffSourceUri):void 0,resources:s,label:t.title,options:n})})}function jV(){const a=(t,i)=>{const s=t.get(O),o=s.activeEditorPane;if(o&&typeof i=="number"){const r=o.group.getEditorByIndex(i);r&&s.openEditor(r)}};re.registerCommand({id:hC,handler:a});for(let t=0;t<9;t++){const i=t,s=t+1;Z.registerCommandAndKeybindingRule({id:hC+s,weight:L.WorkbenchContrib,when:void 0,primary:C.Alt|e(s),mac:{primary:C.WinCtrl|e(s)},handler:o=>a(o,i)})}function e(t){switch(t){case 0:return w.Digit0;case 1:return w.Digit1;case 2:return w.Digit2;case 3:return w.Digit3;case 4:return w.Digit4;case 5:return w.Digit5;case 6:return w.Digit6;case 7:return w.Digit7;case 8:return w.Digit8;case 9:return w.Digit9}throw new Error("invalid index")}}function YV(){for(let t=1;t<8;t++)Z.registerCommandAndKeybindingRule({id:a(t),weight:L.WorkbenchContrib,when:void 0,primary:C.CtrlCmd|e(t),handler:i=>{const s=i.get(U),o=i.get(te);if(t>s.count)return;const r=s.getGroups(Ne.GRID_APPEARANCE);if(r[t])return r[t].focus();const n=Cc(o),d=s.findGroup({location:Xe.LAST});if(!d)return;s.addGroup(d,n).focus()}});function a(t){switch(t){case 1:return"workbench.action.focusSecondEditorGroup";case 2:return"workbench.action.focusThirdEditorGroup";case 3:return"workbench.action.focusFourthEditorGroup";case 4:return"workbench.action.focusFifthEditorGroup";case 5:return"workbench.action.focusSixthEditorGroup";case 6:return"workbench.action.focusSeventhEditorGroup";case 7:return"workbench.action.focusEighthEditorGroup"}throw new Error("Invalid index")}function e(t){switch(t){case 1:return w.Digit2;case 2:return w.Digit3;case 3:return w.Digit4;case 4:return w.Digit5;case 5:return w.Digit6;case 6:return w.Digit7;case 7:return w.Digit8}throw new Error("Invalid index")}}function tI(a,e,t){if(!t.groupedEditors.length)return;const{group:i,editors:s}=t.groupedEditors[0],o=t.preserveFocus,r=a.addGroup(i,e);for(const n of s)n&&!n.hasCapability(Xt.Singleton)&&i.copyEditor(n,r,{preserveFocus:o});r.focus()}function XV(){[{id:Mn,direction:J.UP},{id:yr,direction:J.DOWN},{id:Nn,direction:J.LEFT},{id:Cr,direction:J.RIGHT}].forEach(({id:a,direction:e})=>{re.registerCommand(a,function(t,...i){const s=bt(i,t.get(O),t.get(U),t.get(ne));tI(t.get(U),e,s)})})}function JV(){function a(t,i,...s){const o=t.get(U),r=t.get(O);let n;if(i||s.length?n=!1:n=o.partOptions.preventPinnedEditorClose==="keyboard"||o.partOptions.preventPinnedEditorClose==="keyboardAndMouse",n){const h=o.activeGroup,p=h.activeEditor;if(p&&h.isSticky(p)){const g=h.getEditors(Ie.MOST_RECENTLY_ACTIVE,{excludeSticky:!0})[0];if(g)return h.openEditor(g);const f=r.getEditors(Ie.MOST_RECENTLY_ACTIVE,{excludeSticky:!0})[0];if(f)return Promise.resolve(o.getGroup(f.groupId)?.openEditor(f.editor))}}const d=bt(s,t.get(O),t.get(U),t.get(ne)),l=d.preserveFocus;return Promise.all(d.groupedEditors.map(async({group:h,editors:p})=>{const g=p.filter(f=>!n||!h.isSticky(f));await h.closeEditors(g,{preserveFocus:l})}))}Z.registerCommandAndKeybindingRule({id:to,weight:L.WorkbenchContrib,when:void 0,primary:C.CtrlCmd|w.KeyW,win:{primary:C.CtrlCmd|w.F4,secondary:[C.CtrlCmd|w.KeyW]},handler:(t,...i)=>a(t,!1,...i)}),re.registerCommand($_,(t,...i)=>a(t,!0,...i)),Z.registerCommandAndKeybindingRule({id:vd,weight:L.WorkbenchContrib,when:void 0,primary:Ce(C.CtrlCmd|w.KeyK,w.KeyW),handler:(t,...i)=>{const s=bt(i,t.get(O),t.get(U),t.get(ne));return Promise.all(s.groupedEditors.map(async({group:o})=>{await o.closeAllEditors({excludeSticky:!0})}))}}),Z.registerCommandAndKeybindingRule({id:pv,weight:L.WorkbenchContrib,when:I.and(Ib,vi),primary:C.CtrlCmd|w.KeyW,win:{primary:C.CtrlCmd|w.F4,secondary:[C.CtrlCmd|w.KeyW]},handler:(t,...i)=>{const s=t.get(U),o=bt(i,t.get(O),s,t.get(ne));o.groupedEditors.length&&s.removeGroup(o.groupedEditors[0].group)}}),Z.registerCommandAndKeybindingRule({id:Up,weight:L.WorkbenchContrib,when:void 0,primary:Ce(C.CtrlCmd|w.KeyK,w.KeyU),handler:(t,...i)=>{const s=bt(i,t.get(O),t.get(U),t.get(ne));return Promise.all(s.groupedEditors.map(async({group:o})=>{await o.closeEditors({savedOnly:!0,excludeSticky:!0},{preserveFocus:s.preserveFocus})}))}}),Z.registerCommandAndKeybindingRule({id:gv,weight:L.WorkbenchContrib,when:void 0,primary:void 0,mac:{primary:C.CtrlCmd|C.Alt|w.KeyT},handler:(t,...i)=>{const s=bt(i,t.get(O),t.get(U),t.get(ne));return Promise.all(s.groupedEditors.map(async({group:o,editors:r})=>{const n=o.getEditors(Ie.SEQUENTIAL,{excludeSticky:!0}).filter(d=>!r.includes(d));for(const d of r)d&&o.pinEditor(d);await o.closeEditors(n,{preserveFocus:s.preserveFocus})}))}}),Z.registerCommandAndKeybindingRule({id:uv,weight:L.WorkbenchContrib,when:void 0,primary:void 0,handler:async(t,...i)=>{const s=bt(i,t.get(O),t.get(U),t.get(ne));if(s.groupedEditors.length){const{group:o,editors:r}=s.groupedEditors[0];o.activeEditor&&o.pinEditor(o.activeEditor),await o.closeEditors({direction:Db.RIGHT,except:r[0],excludeSticky:!0},{preserveFocus:s.preserveFocus})}}}),Z.registerCommandAndKeybindingRule({id:bv,weight:L.WorkbenchContrib,when:void 0,primary:void 0,handler:(t,...i)=>e(t,Ca.PICK,...i)}),Z.registerCommandAndKeybindingRule({id:MV,weight:L.WorkbenchContrib,when:void 0,primary:void 0,handler:(t,i,...s)=>e(t,i??Ca.PICK,...s)});async function e(t,i,...s){const o=t.get(O),r=t.get(Qs),n=t.get(nt),d=bt(s,o,t.get(U),t.get(ne)),l=new Map;for(const{group:h,editors:p}of d.groupedEditors)for(const g of p){const f=g.toUntyped();if(!f)return;f.options={...o.activeEditorPane?.options,override:i};const m=await r.resolveEditor(f,h);if(!Hg(m))return;let v=l.get(h);v||(v=[],l.set(h,v)),v.push({editor:g,replacement:m.editor,forceReplaceDirty:g.resource?.scheme===ue.untitled,options:m.options}),n.publicLog2("workbenchEditorReopen",{scheme:g.resource?.scheme??"",ext:g.resource?Yi(g.resource):"",from:g.editorId??"",to:m.editor.editorId??""})}for(const[h,p]of l)await h.replaceEditors(p),await h.openEditor(p[0].replacement)}re.registerCommand(z_,async(t,...i)=>{const s=t.get(U),o=bt(i,t.get(O),s,t.get(ne));if(o.groupedEditors.length){const{group:r}=o.groupedEditors[0];await r.closeAllEditors(),r.count===0&&s.getGroup(r.id)&&s.removeGroup(r)}})}function ZV(){const a=[{id:BV,direction:J.LEFT},{id:GV,direction:J.RIGHT},{id:WV,direction:J.UP},{id:KV,direction:J.DOWN}];for(const e of a)re.registerCommand(e.id,async t=>{const i=t.get(U);(i.findGroup({direction:e.direction},i.activeGroup,!1)??i.activeGroup).focus()})}function QV(){async function a(t,i){const s=t.get(z);if(!i.groupedEditors.length)return;const{group:o,editors:r}=i.groupedEditors[0],n=r[0];n&&await o.replaceEditors([{editor:n,replacement:s.createInstance(Zt,void 0,void 0,n,n),forceReplaceDirty:!0}])}S(class extends R{constructor(){super({id:yv,title:y(3388,"Split Editor in Group"),category:T.View,precondition:Br,f1:!0,keybinding:{weight:L.WorkbenchContrib,when:Br,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|C.Shift|w.Backslash)}})}run(t,...i){return a(t,bt(i,t.get(O),t.get(U),t.get(ne)))}});async function e(t){if(!t.groupedEditors.length)return;const{group:i,editors:s}=t.groupedEditors[0],o=s[0];if(!o||!(o instanceof Zt))return;let r;const n=i.activeEditorPane;if(n instanceof Ks&&i.activeEditor===o){for(const d of[n.getPrimaryEditorPane(),n.getSecondaryEditorPane()])if(d?.hasFocus()){r={viewState:d.getViewState()};break}}await i.replaceEditors([{editor:o,replacement:o.primary,options:r}])}S(class extends R{constructor(){super({id:Cv,title:y(3389,"Join Editor in Group"),category:T.View,precondition:gi,f1:!0,keybinding:{weight:L.WorkbenchContrib,when:gi,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|C.Shift|w.Backslash)}})}run(t,...i){return e(bt(i,t.get(O),t.get(U),t.get(ne)))}}),S(class extends R{constructor(){super({id:NV,title:y(3390,"Toggle Split Editor in Group"),category:T.View,precondition:I.or(Br,gi),f1:!0})}async run(t,...i){const s=bt(i,t.get(O),t.get(U),t.get(ne));if(!s.groupedEditors.length)return;const{editors:o}=s.groupedEditors[0];o[0]instanceof Zt?await e(s):o[0]&&await a(t,s)}}),S(class extends R{constructor(){super({id:Y_,title:y(3391,"Toggle Layout of Split Editor in Group"),category:T.View,precondition:gi,f1:!0})}async run(t){const i=t.get(te),s=i.getValue(Ks.SIDE_BY_SIDE_LAYOUT_SETTING);let o;return s!=="horizontal"?o="horizontal":o="vertical",i.updateValue(Ks.SIDE_BY_SIDE_LAYOUT_SETTING,o)}})}function eP(){S(class extends R{constructor(){super({id:X_,title:y(3392,"Focus First Side in Active Editor"),category:T.View,precondition:I.or(gi,Ri),f1:!0})}async run(a){const e=a.get(O),t=a.get(ke),i=e.activeEditorPane;i instanceof Ks?i.getSecondaryEditorPane()?.focus():i instanceof Qo&&await t.executeCommand(K_)}}),S(class extends R{constructor(){super({id:J_,title:y(3393,"Focus Second Side in Active Editor"),category:T.View,precondition:I.or(gi,Ri),f1:!0})}async run(a){const e=a.get(O),t=a.get(ke),i=e.activeEditorPane;i instanceof Ks?i.getPrimaryEditorPane()?.focus():i instanceof Qo&&await t.executeCommand(W_)}}),S(class extends R{constructor(){super({id:FV,title:y(3394,"Focus Other Side in Active Editor"),category:T.View,precondition:I.or(gi,Ri),f1:!0})}async run(a){const e=a.get(O),t=a.get(ke),i=e.activeEditorPane;i instanceof Ks?i.getPrimaryEditorPane()?.hasFocus()?i.getSecondaryEditorPane()?.focus():i.getPrimaryEditorPane()?.focus():i instanceof Qo&&await t.executeCommand(U_)}})}function tP(){Z.registerCommandAndKeybindingRule({id:fv,weight:L.WorkbenchContrib,when:void 0,primary:Ce(C.CtrlCmd|w.KeyK,w.Enter),handler:async(e,...t)=>{const i=bt(t,e.get(O),e.get(U),e.get(ne));for(const{group:s,editors:o}of i.groupedEditors)for(const r of o)s.pinEditor(r)}}),re.registerCommand({id:q_,handler:e=>{const t=e.get(te),s=t.getValue("workbench.editor.enablePreview")!==!0;t.updateValue("workbench.editor.enablePreview",s)}});function a(e,t,...i){const o=bt(i,e.get(O),e.get(U),e.get(ne)).groupedEditors[0]?.group;o?.lock(t??!o.isLocked)}S(class extends R{constructor(){super({id:mv,title:y(3395,"Toggle Editor Group Lock"),category:T.View,f1:!0})}async run(e,...t){a(e,void 0,...t)}}),S(class extends R{constructor(){super({id:wv,title:y(3396,"Lock Editor Group"),category:T.View,precondition:$s.toNegated(),f1:!0})}async run(e,...t){a(e,!0,...t)}}),S(class extends R{constructor(){super({id:yd,title:y(3397,"Unlock Editor Group"),precondition:$s,category:T.View,f1:!0})}async run(e,...t){a(e,!1,...t)}}),Z.registerCommandAndKeybindingRule({id:vv,weight:L.WorkbenchContrib,when:qs.toNegated(),primary:Ce(C.CtrlCmd|w.KeyK,C.Shift|w.Enter),handler:async(e,...t)=>{const i=bt(t,e.get(O),e.get(U),e.get(ne));for(const{group:s,editors:o}of i.groupedEditors)for(const r of o)s.stickEditor(r)}}),Z.registerCommandAndKeybindingRule({id:jn,weight:L.WorkbenchContrib,when:qs,primary:Ce(C.CtrlCmd|w.KeyK,C.Shift|w.Enter),handler:async(e,...t)=>{const i=bt(t,e.get(O),e.get(U),e.get(ne));for(const{group:s,editors:o}of i.groupedEditors)for(const r of o)s.unstickEditor(r)}}),Z.registerCommandAndKeybindingRule({id:j_,weight:L.WorkbenchContrib,when:void 0,primary:void 0,handler:(e,...t)=>{const i=e.get(U),s=e.get(lt),r=bt(t,e.get(O),i,e.get(ne)).groupedEditors[0]?.group;return r&&i.activateGroup(r),s.quickAccess.show(vr.PREFIX)}})}function iP(){zV(),$V(),OV(),qV(),jV(),JV(),tP(),QV(),eP(),YV(),XV(),ZV()}var Rl;xe(VV);class iI extends Ab{constructor(e){super(),this.context=e}run(e,t){let i=this.context;return t?.preserveFocus&&(i={...this.context,preserveFocus:!0}),super.run(e,i)}}var Qr;let Tc=(Qr=class extends Yc{constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m){super(g),this.parent=e,this.editorPartsView=t,this.groupsView=i,this.groupView=s,this.tabsModel=o,this.contextMenuService=r,this.instantiationService=n,this.contextKeyService=d,this.keybindingService=l,this.notificationService=h,this.quickInputService=p,this.editorResolverService=f,this.hostService=m,this.editorTransfer=Ws.getInstance(),this.groupTransfer=Ws.getInstance(),this.treeItemsTransfer=Ws.getInstance(),this.editorActionsToolbarDisposables=this._register(new B),this.editorActionsDisposables=this._register(new B),this.renderDropdownAsChildElement=!1;const v=this.create(e);this.contextMenuContextKeyService=this._register(this.contextKeyService.createScoped(v));const E=this._register(this.instantiationService.createChild(new _n([de,this.contextMenuContextKeyService])));this.resourceContext=this._register(E.createInstance(kS)),this.editorPinnedContext=Tb.bindTo(this.contextMenuContextKeyService),this.editorIsFirstContext=xS.bindTo(this.contextMenuContextKeyService),this.editorIsLastContext=Cp.bindTo(this.contextMenuContextKeyService),this.editorStickyContext=qs.bindTo(this.contextMenuContextKeyService),this.editorAvailableEditorIds=hd.bindTo(this.contextMenuContextKeyService),this.editorCanSplitInGroupContext=Br.bindTo(this.contextMenuContextKeyService),this.sideBySideEditorContext=gi.bindTo(this.contextMenuContextKeyService),this.groupLockedContext=$s.bindTo(this.contextMenuContextKeyService)}create(e){return this.updateTabHeight(),e}get editorActionsEnabled(){return this.groupsView.partOptions.editorActionsLocation==="default"&&this.groupsView.partOptions.showTabs!=="none"}createEditorActionsToolBar(e,t){this.editorActionsToolbarContainer=N("div"),this.editorActionsToolbarContainer.classList.add(...t),e.appendChild(this.editorActionsToolbarContainer),this.handleEditorActionToolBarVisibility(this.editorActionsToolbarContainer)}handleEditorActionToolBarVisibility(e){const t=this.editorActionsEnabled,i=!!this.editorActionsToolbar;t&&!i?this.doCreateEditorActionsToolBar(e):!t&&i&&(this.editorActionsToolbar?.getElement().remove(),this.editorActionsToolbar=void 0,this.editorActionsToolbarDisposables.clear(),this.editorActionsDisposables.clear()),e.classList.toggle("hidden",!t)}doCreateEditorActionsToolBar(e){const t={groupId:this.groupView.id};this.editorActionsToolbar=this.editorActionsToolbarDisposables.add(this.instantiationService.createInstance(qC,e,{actionViewItemProvider:(i,s)=>this.actionViewItemProvider(i,s),orientation:Fn.HORIZONTAL,ariaLabel:c(3504,"Editor actions"),getKeyBinding:i=>this.getKeybinding(i),actionRunner:this.editorActionsToolbarDisposables.add(new iI(t)),anchorAlignmentProvider:()=>Bl.RIGHT,renderDropdownAsChildElement:this.renderDropdownAsChildElement,telemetrySource:"editorPart",resetMenu:b.EditorTitle,overflowBehavior:{maxItems:9,exempted:HV},highlightToggledItems:!0})),this.editorActionsToolbar.context=t,this.editorActionsToolbarDisposables.add(this.editorActionsToolbar.actionRunner.onDidRun(i=>{i.error&&!dd(i.error)&&this.notificationService.error(i.error)}))}actionViewItemProvider(e,t){const i=this.groupView.activeEditorPane;if(i instanceof gb){const s=i.getActionViewItem(e,t);if(s)return s}return mp(this.instantiationService,e,{...t,menuAsChild:this.renderDropdownAsChildElement})}updateEditorActionsToolbar(){if(!this.editorActionsEnabled)return;this.editorActionsDisposables.clear();const e=this.groupView.createEditorActions(this.editorActionsDisposables);this.editorActionsDisposables.add(e.onDidChange(()=>this.updateEditorActionsToolbar()));const t=fe(this.editorActionsToolbar),{primary:i,secondary:s}=this.prepareEditorActions(e.actions);t.setActions(Fl(i),Fl(s))}getEditorPaneAwareContextKeyService(){return this.groupView.activeEditorPane?.scopedContextKeyService??this.contextKeyService}clearEditorActionsToolbar(){if(!this.editorActionsEnabled)return;fe(this.editorActionsToolbar).setActions([],[])}onGroupDragStart(e,t){if(e.target!==t)return!1;const i=this.isNewWindowOperation(e);this.groupTransfer.setData([new Ht(this.groupView.id)],Ht.prototype),e.dataTransfer&&(e.dataTransfer.effectAllowed="copyMove");let s=!1;if(this.groupsView.partOptions.showTabs==="multiple"?s=this.doFillResourceDataTransfers(this.groupView.getEditors(Ie.SEQUENTIAL),e,i):this.groupView.activeEditor&&(s=this.doFillResourceDataTransfers([this.groupView.activeEditor],e,i)),!s&&LS&&e.dataTransfer?.setData(Sa.TEXT,String(this.groupView.label)),this.groupView.activeEditor){let o=this.groupView.activeEditor.getName();this.groupsView.partOptions.showTabs==="multiple"&&this.groupView.count>1&&(o=c(3505,"{0} (+{1})",o,this.groupView.count-1)),yb(e,t,o)}return i}async onGroupDragEnd(e,t,i,s){if(this.groupTransfer.clearData(Ht.prototype),e.target!==i||!s||RS())return;const o=await this.maybeCreateAuxiliaryEditorPartAt(e,i);if(!o)return;const r=o.activeGroup;this.groupsView.mergeGroup(this.groupView,r.id,{mode:this.isMoveOperation(t??e,r.id)?kn.MOVE_EDITORS:kn.COPY_EDITORS}),r.focus()}async maybeCreateAuxiliaryEditorPartAt(e,t){const{point:i,display:s}=await this.hostService.getCursorScreenPoint()??{point:{x:e.screenX,y:e.screenY}},o=wr();if(o.document.visibilityState==="visible"&&o.document.hasFocus()&&i.x>=o.screenX&&i.x<=o.screenX+o.outerWidth&&i.y>=o.screenY&&i.y<=o.screenY+o.outerHeight)return;const r=t.offsetWidth/2,n=30+t.offsetHeight/2,d={x:i.x-r,y:i.y-n};return s&&(d.x<s.x&&(d.x=s.x),d.y<s.y&&(d.y=s.y)),this.editorPartsView.createAuxiliaryEditorPart({bounds:d})}isNewWindowOperation(e){return this.groupsView.partOptions.dragToOpenWindow?!e.altKey:e.altKey}isMoveOperation(e,t,i){return i?.hasCapability(Xt.Singleton)?!0:!(e.ctrlKey&&!Ge||e.altKey&&Ge)||t===this.groupView.id}doFillResourceDataTransfers(e,t,i){return e.length?(this.instantiationService.invokeFunction(jl,e.map(s=>({editor:s,groupId:this.groupView.id})),t,{disableStandardTransfer:i}),!0):!1}onTabContextMenu(e,t,i){this.resourceContext.set(Ue.getOriginalUri(e,{supportSideBySide:Le.PRIMARY})),this.editorPinnedContext.set(this.tabsModel.isPinned(e)),this.editorIsFirstContext.set(this.tabsModel.isFirst(e)),this.editorIsLastContext.set(this.tabsModel.isLast(e)),this.editorStickyContext.set(this.tabsModel.isSticky(e)),this.groupLockedContext.set(this.tabsModel.isLocked),this.editorCanSplitInGroupContext.set(e.hasCapability(Xt.CanSplitInGroup)),this.sideBySideEditorContext.set(e.typeId===Zt.ID),VS(this.editorAvailableEditorIds,e,this.editorResolverService);let s=i;na(t)&&(s=new uo(He(i),t)),this.contextMenuService.showContextMenu({getAnchor:()=>s,menuId:b.EditorTitleContext,menuActionOptions:{shouldForwardArgs:!0,arg:this.resourceContext.get()},contextKeyService:this.contextMenuContextKeyService,getActionsContext:()=>({groupId:this.groupView.id,editorIndex:this.groupView.getIndexOfEditor(e)}),getKeyBinding:o=>this.keybindingService.lookupKeybinding(o.id,this.contextMenuContextKeyService),onHide:()=>this.groupsView.activeGroup.focus()})}getKeybinding(e){return this.keybindingService.lookupKeybinding(e.id,this.getEditorPaneAwareContextKeyService())}getKeybindingLabel(e){const t=this.getKeybinding(e);return t?t.getLabel()??void 0:void 0}get tabHeight(){return this.groupsView.partOptions.tabHeight!=="compact"?Rl.EDITOR_TAB_HEIGHT.normal:Rl.EDITOR_TAB_HEIGHT.compact}getHoverTitle(e){const t=e.getTitle(ds.LONG);return this.tabsModel.isPinned(e)?t:{markdown:new Zi("",{supportThemeIcons:!0,isTrusted:!0}).appendText(t).appendMarkdown(' (_preview_ [$(gear)](command:workbench.action.openSettings?%5B%22workbench.editor.enablePreview%22%5D "Configure Preview Mode"))'),markdownNotSupportedFallback:t+" (preview)"}}updateTabHeight(){this.parent.style.setProperty("--editor-group-tab-height",`${this.tabHeight}px`)}updateOptions(e,t){e.tabHeight!==t.tabHeight&&this.updateTabHeight(),(e.editorActionsLocation!==t.editorActionsLocation||e.showTabs!==t.showTabs)&&this.editorActionsToolbarContainer&&(this.handleEditorActionToolBarVisibility(this.editorActionsToolbarContainer),this.updateEditorActionsToolbar())}},Rl=Qr,Qr.EDITOR_TAB_HEIGHT={normal:35,compact:22},Qr);Tc=Rl=D([u(5,st),u(6,z),u(7,de),u(8,ot),u(9,Qe),u(10,lt),u(11,we),u(12,Qs),u(13,Rt)],Tc);class Oe extends R{constructor(e,t,i){super(e),this.commandId=t,this.commandArgs=i}run(e){return e.get(ke).executeCommand(this.commandId,this.commandArgs)}}class sI extends R{getDirection(e){return Cc(e)}async run(e,...t){const i=e.get(U),s=e.get(te),o=e.get(O),r=e.get(ne),n=this.getDirection(s),d=bt(t,o,i,r);tI(i,n,d)}}const Nu=class Nu extends sI{constructor(){super({id:Nu.ID,title:y(3252,"Split Editor"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|w.Backslash},category:T.View})}};Nu.ID=Cd;let Gf=Nu;class sP extends sI{constructor(){super({id:"workbench.action.splitEditorOrthogonal",title:y(3253,"Split Editor Orthogonal"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.Backslash)},category:T.View})}getDirection(e){return Cc(e)===J.RIGHT?J.DOWN:J.RIGHT}}class oP extends Oe{constructor(){super({id:Nn,title:y(3254,"Split Editor Left"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.Backslash)},category:T.View},Nn)}}class rP extends Oe{constructor(){super({id:Cr,title:y(3255,"Split Editor Right"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.Backslash)},category:T.View},Cr)}}const Kv=class Kv extends Oe{constructor(){super({id:Mn,title:y(3256,"Split Editor Up"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.Backslash)},category:T.View},Mn)}};Kv.LABEL=c(3256,"Split Editor Up");let Wf=Kv;const Uv=class Uv extends Oe{constructor(){super({id:yr,title:y(3257,"Split Editor Down"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.Backslash)},category:T.View},yr)}};Uv.LABEL=c(3257,"Split Editor Down");let Kf=Uv;class nP extends R{constructor(){super({id:"workbench.action.joinTwoGroups",title:y(3258,"Join Editor Group with Next Group"),f1:!0,category:T.View})}async run(e,t){const i=e.get(U);let s;if(t&&typeof t.groupId=="number"?s=i.getGroup(t.groupId):s=i.activeGroup,s){const o=[J.RIGHT,J.DOWN,J.LEFT,J.UP];for(const r of o){const n=i.findGroup({direction:r},s);if(n&&s!==n){i.mergeGroup(s,n);break}}}}}class aP extends R{constructor(){super({id:"workbench.action.joinAllGroups",title:y(3259,"Join All Editor Groups"),f1:!0,category:T.View})}async run(e){const t=e.get(U);t.mergeAllGroups(t.activeGroup)}}class dP extends R{constructor(){super({id:"workbench.action.navigateEditorGroups",title:y(3260,"Navigate Between Editor Groups"),f1:!0,category:T.View})}async run(e){const t=e.get(U);t.findGroup({location:Xe.NEXT},t.activeGroup,!0)?.focus()}}class cP extends R{constructor(){super({id:"workbench.action.focusActiveEditorGroup",title:y(3261,"Focus Active Editor Group"),f1:!0,category:T.View})}async run(e){e.get(U).activeGroup.focus()}}class Dr extends R{constructor(e,t){super(e),this.scope=t}async run(e){const t=e.get(U);t.findGroup(this.scope,t.activeGroup,!0)?.focus()}}class lP extends Dr{constructor(){super({id:"workbench.action.focusFirstEditorGroup",title:y(3262,"Focus First Editor Group"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|w.Digit1},category:T.View},{location:Xe.FIRST})}}class hP extends Dr{constructor(){super({id:"workbench.action.focusLastEditorGroup",title:y(3263,"Focus Last Editor Group"),f1:!0,category:T.View},{location:Xe.LAST})}}class uP extends Dr{constructor(){super({id:"workbench.action.focusNextGroup",title:y(3264,"Focus Next Editor Group"),f1:!0,category:T.View},{location:Xe.NEXT})}}class pP extends Dr{constructor(){super({id:"workbench.action.focusPreviousGroup",title:y(3265,"Focus Previous Editor Group"),f1:!0,category:T.View},{location:Xe.PREVIOUS})}}class gP extends Dr{constructor(){super({id:"workbench.action.focusLeftGroup",title:y(3266,"Focus Left Editor Group"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.LeftArrow)},category:T.View},{direction:J.LEFT})}}class fP extends Dr{constructor(){super({id:"workbench.action.focusRightGroup",title:y(3267,"Focus Right Editor Group"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.RightArrow)},category:T.View},{direction:J.RIGHT})}}class mP extends Dr{constructor(){super({id:"workbench.action.focusAboveGroup",title:y(3268,"Focus Editor Group Above"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.UpArrow)},category:T.View},{direction:J.UP})}}class wP extends Dr{constructor(){super({id:"workbench.action.focusBelowGroup",title:y(3269,"Focus Editor Group Below"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.DownArrow)},category:T.View},{direction:J.DOWN})}}var en;let pC=(en=class extends Je{constructor(e,t,i){super(e,t,Se.asClassName(P.close)),this.commandService=i}run(e){return this.commandService.executeCommand(to,void 0,e)}},en.ID="workbench.action.closeActiveEditor",en.LABEL=c(3270,"Close Editor"),en);pC=D([u(2,ke)],pC);var tn;let $d=(tn=class extends Je{constructor(e,t,i){super(e,t,Se.asClassName(P.pinned)),this.commandService=i}run(e){return this.commandService.executeCommand(jn,void 0,e)}},tn.ID="workbench.action.unpinActiveEditor",tn.LABEL=c(3271,"Unpin Editor"),tn);$d=D([u(2,ke)],$d);var sn;let qd=(sn=class extends Je{constructor(e,t,i){super(e,t,Se.asClassName(P.close)),this.editorGroupService=i}async run(e){const t=e?this.editorGroupService.getGroup(e.groupId):this.editorGroupService.activeGroup;if(!t)return;const i=e?.editorIndex!==void 0?t.getEditorByIndex(e.editorIndex):t.activeEditor;if(!i)return;const s=[];t.isSelected(i)?s.push(...t.selectedEditors):s.push(i);for(const o of s)await t.closeEditor(o,{preserveFocus:e?.preserveFocus})}},sn.ID="workbench.action.closeActiveEditor",sn.LABEL=c(3272,"Close"),sn);qd=D([u(2,U)],qd);class bP extends R{constructor(){super({id:"workbench.action.revertAndCloseActiveEditor",title:y(3273,"Revert and Close Editor"),f1:!0,category:T.View})}async run(e){const t=e.get(O),i=e.get(et),s=t.activeEditorPane;if(s){const o=s.input,r=s.group;try{await t.revert({editor:o,groupId:r.id})}catch(n){i.error(n),await t.revert({editor:o,groupId:r.id},{soft:!0})}await r.closeEditor(o)}}}class vP extends R{constructor(){super({id:"workbench.action.closeEditorsToTheLeft",title:y(3274,"Close Editors to the Left in Group"),f1:!0,category:T.View})}async run(e,t){const i=e.get(U),{group:s,editor:o}=this.getTarget(i,t);s&&o&&await s.closeEditors({direction:Db.LEFT,except:o,excludeSticky:!0})}getTarget(e,t){return t?{editor:t.editor,group:e.getGroup(t.groupId)}:{group:e.activeGroup,editor:e.activeGroup.activeEditor}}}class oI extends R{groupsToClose(e){const t=[],i=e.getGroups(Ne.GRID_APPEARANCE);for(let s=i.length-1;s>=0;s--)t.push(i[s]);return t}async run(e){const t=e.get(O),i=e.get(et),s=e.get(Xc),o=e.get(U),r=e.get(ud),n=e.get(yi),d=new Set,l=new Set,h=new Set,p=new Map;for(const{editor:g,groupId:f}of t.getEditors(Ie.SEQUENTIAL,{excludeSticky:this.excludeSticky})){let m=!1,v=!1;if(g.closeHandler)try{m=g.closeHandler.showConfirm()}catch(E){i.error(E),v=!0}if((!g.closeHandler||v)&&(m=g.isDirty()&&!g.isSaving()),!!m)if(typeof g.closeHandler?.confirm=="function"){let E=p.get(g.typeId);E||(E=new Set,p.set(g.typeId,E)),E.add({editor:g,groupId:f})}else!g.hasCapability(Xt.Untitled)&&r.getAutoSaveMode(g).mode===Yl.ON_FOCUS_CHANGE?l.add({editor:g,groupId:f}):kb&&(mi||xn)&&!g.hasCapability(Xt.Untitled)&&r.getAutoSaveMode(g).mode===Yl.ON_WINDOW_CHANGE?h.add({editor:g,groupId:f}):d.add({editor:g,groupId:f})}if(d.size>0){const g=Array.from(d.values());switch(await this.revealEditorsToConfirm(g,o),await n.showSaveConfirm(g.map(({editor:m})=>m instanceof Zt?m.primary.getName():m.getName()))){case Ii.CANCEL:return;case Ii.DONT_SAVE:await this.revertEditors(t,i,s,g);break;case Ii.SAVE:await t.save(g,{reason:Ji.EXPLICIT});break}}for(const[,g]of p){const f=Array.from(g.values());await this.revealEditorsToConfirm(f,o);const m=await f.at(0)?.editor.closeHandler?.confirm?.(f);if(typeof m=="number")switch(m){case Ii.CANCEL:return;case Ii.DONT_SAVE:await this.revertEditors(t,i,s,f);break;case Ii.SAVE:await t.save(f,{reason:Ji.EXPLICIT});break}}if(l.size>0){const g=Array.from(l.values());await t.save(g,{reason:Ji.FOCUS_CHANGE})}if(h.size>0){const g=Array.from(h.values());await t.save(g,{reason:Ji.WINDOW_CHANGE})}return this.doCloseAll(o)}revertEditors(e,t,i,s){return i.withProgress({location:oo.Window,delay:800,title:c(3275,"Reverting Editors...")},()=>this.doRevertEditors(e,t,s))}async doRevertEditors(e,t,i){try{await e.revert(i)}catch(s){t.error(s),await e.revert(i,{soft:!0})}}async revealEditorsToConfirm(e,t){try{const i=new Set;for(const{editor:s,groupId:o}of e){if(i.has(o))continue;i.add(o),await t.getGroup(o)?.openEditor(s)}}catch{}}async doCloseAll(e){await Promise.all(this.groupsToClose(e).map(t=>t.closeAllEditors({excludeSticky:this.excludeSticky})))}}const ua=class ua extends oI{constructor(){super({id:ua.ID,title:ua.LABEL,f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.KeyW)},icon:P.closeAll,category:T.View})}get excludeSticky(){return!0}};ua.ID="workbench.action.closeAllEditors",ua.LABEL=y(3276,"Close All Editors");let Uf=ua;class yP extends oI{constructor(){super({id:"workbench.action.closeAllGroups",title:y(3277,"Close All Editor Groups"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|C.Shift|w.KeyW)},category:T.View})}get excludeSticky(){return!1}async doCloseAll(e){await super.doCloseAll(e);for(const t of this.groupsToClose(e))e.removeGroup(t)}}class CP extends R{constructor(){super({id:"workbench.action.closeEditorsInOtherGroups",title:y(3278,"Close Editors in Other Groups"),f1:!0,category:T.View})}async run(e,t){const i=e.get(U),s=t?i.getGroup(t.groupId):i.activeGroup;await Promise.all(i.getGroups(Ne.MOST_RECENTLY_ACTIVE).map(async o=>{if(!(s&&o.id===s.id))return o.closeAllEditors({excludeSticky:!0})}))}}class SP extends R{constructor(){super({id:"workbench.action.closeEditorInAllGroups",title:y(3279,"Close Editor in All Groups"),f1:!0,category:T.View})}async run(e){const t=e.get(O),i=e.get(U),s=t.activeEditor;s&&await Promise.all(i.getGroups(Ne.MOST_RECENTLY_ACTIVE).map(o=>o.closeEditor(s)))}}class rI extends R{constructor(e,t,i){super(e),this.direction=t,this.isMove=i}async run(e,t){const i=e.get(U);let s;if(t&&typeof t.groupId=="number"?s=i.getGroup(t.groupId):s=i.activeGroup,s){let o;if(this.isMove){const r=this.findTargetGroup(i,s);r&&(o=i.moveGroup(s,r,this.direction))}else o=i.copyGroup(s,s,this.direction);o&&i.activateGroup(o)}}findTargetGroup(e,t){const i=[this.direction];switch(this.direction){case J.LEFT:case J.RIGHT:i.push(J.UP,J.DOWN);break;case J.UP:case J.DOWN:i.push(J.LEFT,J.RIGHT);break}for(const s of i){const o=e.findGroup({direction:s},t);if(o)return o}}}class zp extends rI{constructor(e,t){super(e,t,!0)}}class EP extends zp{constructor(){super({id:"workbench.action.moveActiveEditorGroupLeft",title:y(3280,"Move Editor Group Left"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,w.LeftArrow)},category:T.View},J.LEFT)}}class _P extends zp{constructor(){super({id:"workbench.action.moveActiveEditorGroupRight",title:y(3281,"Move Editor Group Right"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,w.RightArrow)},category:T.View},J.RIGHT)}}class IP extends zp{constructor(){super({id:"workbench.action.moveActiveEditorGroupUp",title:y(3282,"Move Editor Group Up"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,w.UpArrow)},category:T.View},J.UP)}}class DP extends zp{constructor(){super({id:"workbench.action.moveActiveEditorGroupDown",title:y(3283,"Move Editor Group Down"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,w.DownArrow)},category:T.View},J.DOWN)}}class $p extends rI{constructor(e,t){super(e,t,!1)}}class AP extends $p{constructor(){super({id:"workbench.action.duplicateActiveEditorGroupLeft",title:y(3284,"Duplicate Editor Group Left"),f1:!0,category:T.View},J.LEFT)}}class TP extends $p{constructor(){super({id:"workbench.action.duplicateActiveEditorGroupRight",title:y(3285,"Duplicate Editor Group Right"),f1:!0,category:T.View},J.RIGHT)}}class kP extends $p{constructor(){super({id:"workbench.action.duplicateActiveEditorGroupUp",title:y(3286,"Duplicate Editor Group Up"),f1:!0,category:T.View},J.UP)}}class xP extends $p{constructor(){super({id:"workbench.action.duplicateActiveEditorGroupDown",title:y(3287,"Duplicate Editor Group Down"),f1:!0,category:T.View},J.DOWN)}}class LP extends R{constructor(){super({id:"workbench.action.minimizeOtherEditors",title:y(3288,"Expand Editor Group"),f1:!0,category:T.View,precondition:vi})}async run(e){e.get(U).arrangeGroups(Hi.EXPAND)}}class RP extends R{constructor(){super({id:"workbench.action.minimizeOtherEditorsHideSidebar",title:y(3289,"Expand Editor Group and Hide Side Bars"),f1:!0,category:T.View,precondition:I.or(vi,xb,OS)})}async run(e){const t=e.get(U),i=e.get(je);i.setPartHidden(!0,j.SIDEBAR_PART),i.setPartHidden(!0,j.AUXILIARYBAR_PART),t.arrangeGroups(Hi.EXPAND)}}class VP extends R{constructor(){super({id:"workbench.action.evenEditorWidths",title:y(3290,"Reset Editor Group Sizes"),f1:!0,category:T.View})}async run(e){e.get(U).arrangeGroups(Hi.EVEN)}}class PP extends R{constructor(){super({id:"workbench.action.toggleEditorWidths",title:y(3291,"Toggle Editor Group Sizes"),f1:!0,category:T.View})}async run(e){e.get(U).toggleExpandGroup()}}class OP extends R{constructor(){super({id:"workbench.action.maximizeEditorHideSidebar",title:y(3292,"Maximize Editor Group and Hide Side Bars"),f1:!0,category:T.View,precondition:I.or(I.and($o.negate(),Jc),xb,OS)})}async run(e){const t=e.get(je),i=e.get(U);e.get(O).activeEditor&&(t.setPartHidden(!0,j.SIDEBAR_PART),t.setPartHidden(!0,j.AUXILIARYBAR_PART),i.arrangeGroups(Hi.MAXIMIZE))}}class MP extends R{constructor(){super({id:Hp,title:y(3293,"Toggle Maximize Editor Group"),f1:!0,category:T.View,precondition:I.or(Jc,$o),keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.KeyM)},menu:[{id:b.EditorTitle,order:-1e4,group:"navigation",when:$o},{id:b.EmptyEditorGroup,order:-1e4,group:"navigation",when:$o}],icon:P.screenFull,toggled:{condition:$o,title:c(3294,"Unmaximize Group")}})}async run(e,...t){const i=e.get(U),s=e.get(O),o=e.get(ne),r=bt(t,s,i,o);r.groupedEditors.length&&i.toggleMaximizeGroup(r.groupedEditors[0].group)}}class Sd extends R{async run(e){const t=e.get(U),i=this.navigate(t);if(!i)return;const{groupId:s,editor:o}=i;if(!o)return;const r=t.getGroup(s);r&&await r.openEditor(o)}}class NP extends Sd{constructor(){super({id:"workbench.action.nextEditor",title:y(3295,"Open Next Editor"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|w.PageDown,mac:{primary:C.CtrlCmd|C.Alt|w.RightArrow,secondary:[C.CtrlCmd|C.Shift|w.BracketRight]}},category:T.View})}navigate(e){const t=e.activeGroup,i=t.getEditors(Ie.SEQUENTIAL),s=t.activeEditor?i.indexOf(t.activeEditor):-1;if(s+1<i.length)return{editor:i[s+1],groupId:t.id};const o=new Set;let r=e.activeGroup;for(;r&&!o.has(r.id);)if(r=e.findGroup({location:Xe.NEXT},r,!0),r){o.add(r.id);const n=r.getEditors(Ie.SEQUENTIAL);if(n.length>0)return{editor:n[0],groupId:r.id}}}}class FP extends Sd{constructor(){super({id:"workbench.action.previousEditor",title:y(3296,"Open Previous Editor"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|w.PageUp,mac:{primary:C.CtrlCmd|C.Alt|w.LeftArrow,secondary:[C.CtrlCmd|C.Shift|w.BracketLeft]}},category:T.View})}navigate(e){const t=e.activeGroup,i=t.getEditors(Ie.SEQUENTIAL),s=t.activeEditor?i.indexOf(t.activeEditor):-1;if(s>0)return{editor:i[s-1],groupId:t.id};const o=new Set;let r=e.activeGroup;for(;r&&!o.has(r.id);)if(r=e.findGroup({location:Xe.PREVIOUS},r,!0),r){o.add(r.id);const n=r.getEditors(Ie.SEQUENTIAL);if(n.length>0)return{editor:n[n.length-1],groupId:r.id}}}}class BP extends Sd{constructor(){super({id:"workbench.action.nextEditorInGroup",title:y(3297,"Open Next Editor in Group"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.PageDown),mac:{primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|C.Alt|w.RightArrow)}},category:T.View})}navigate(e){const t=e.activeGroup,i=t.getEditors(Ie.SEQUENTIAL),s=t.activeEditor?i.indexOf(t.activeEditor):-1;return{editor:s+1<i.length?i[s+1]:i[0],groupId:t.id}}}class GP extends Sd{constructor(){super({id:"workbench.action.previousEditorInGroup",title:y(3298,"Open Previous Editor in Group"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.PageUp),mac:{primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|C.Alt|w.LeftArrow)}},category:T.View})}navigate(e){const t=e.activeGroup,i=t.getEditors(Ie.SEQUENTIAL),s=t.activeEditor?i.indexOf(t.activeEditor):-1;return{editor:s>0?i[s-1]:i[i.length-1],groupId:t.id}}}class WP extends Sd{constructor(){super({id:"workbench.action.firstEditorInGroup",title:y(3299,"Open First Editor in Group"),f1:!0,category:T.View})}navigate(e){const t=e.activeGroup;return{editor:t.getEditors(Ie.SEQUENTIAL)[0],groupId:t.id}}}class KP extends Sd{constructor(){super({id:"workbench.action.lastEditorInGroup",title:y(3300,"Open Last Editor in Group"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:C.Alt|w.Digit0,secondary:[C.CtrlCmd|w.Digit9],mac:{primary:C.WinCtrl|w.Digit0,secondary:[C.CtrlCmd|w.Digit9]}},category:T.View})}navigate(e){const t=e.activeGroup,i=t.getEditors(Ie.SEQUENTIAL);return{editor:i[i.length-1],groupId:t.id}}}const oc=class oc extends R{constructor(){super({id:oc.ID,title:{...y(3301,"Go Forward"),mnemonicTitle:c(3302,"&&Forward")},f1:!0,icon:P.arrowRight,precondition:I.has("canNavigateForward"),keybinding:{weight:L.WorkbenchContrib,win:{primary:C.Alt|w.RightArrow,secondary:[w.BrowserForward]},mac:{primary:C.WinCtrl|C.Shift|w.Minus,secondary:[w.BrowserForward]},linux:{primary:C.CtrlCmd|C.Shift|w.Minus,secondary:[w.BrowserForward]}},menu:[{id:b.MenubarGoMenu,group:"1_history_nav",order:2},{id:b.CommandCenter,order:2,when:I.has("config.workbench.navigationControl.enabled")}]})}async run(e){await e.get(mt).goForward(Fe.NONE)}};oc.ID="workbench.action.navigateForward",oc.LABEL=c(3301,"Go Forward");let kc=oc;const rc=class rc extends R{constructor(){super({id:rc.ID,title:{...y(3303,"Go Back"),mnemonicTitle:c(3304,"&&Back")},f1:!0,precondition:I.has("canNavigateBack"),icon:P.arrowLeft,keybinding:{weight:L.WorkbenchContrib,win:{primary:C.Alt|w.LeftArrow,secondary:[w.BrowserBack]},mac:{primary:C.WinCtrl|w.Minus,secondary:[w.BrowserBack]},linux:{primary:C.CtrlCmd|C.Alt|w.Minus,secondary:[w.BrowserBack]}},menu:[{id:b.MenubarGoMenu,group:"1_history_nav",order:1},{id:b.CommandCenter,order:1,when:I.has("config.workbench.navigationControl.enabled")}]})}async run(e){await e.get(mt).goBack(Fe.NONE)}};rc.ID="workbench.action.navigateBack",rc.LABEL=c(3303,"Go Back");let xc=rc;class UP extends R{constructor(){super({id:"workbench.action.navigateLast",title:y(3305,"Go Previous"),f1:!0})}async run(e){await e.get(mt).goPrevious(Fe.NONE)}}class HP extends R{constructor(){super({id:"workbench.action.navigateForwardInEditLocations",title:y(3306,"Go Forward in Edit Locations"),f1:!0})}async run(e){await e.get(mt).goForward(Fe.EDITS)}}class zP extends R{constructor(){super({id:"workbench.action.navigateBackInEditLocations",title:y(3307,"Go Back in Edit Locations"),f1:!0})}async run(e){await e.get(mt).goBack(Fe.EDITS)}}class $P extends R{constructor(){super({id:"workbench.action.navigatePreviousInEditLocations",title:y(3308,"Go Previous in Edit Locations"),f1:!0})}async run(e){await e.get(mt).goPrevious(Fe.EDITS)}}class qP extends R{constructor(){super({id:"workbench.action.navigateToLastEditLocation",title:y(3309,"Go to Last Edit Location"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.KeyQ)}})}async run(e){await e.get(mt).goLast(Fe.EDITS)}}class jP extends R{constructor(){super({id:"workbench.action.navigateForwardInNavigationLocations",title:y(3310,"Go Forward in Navigation Locations"),f1:!0})}async run(e){await e.get(mt).goForward(Fe.NAVIGATION)}}class YP extends R{constructor(){super({id:"workbench.action.navigateBackInNavigationLocations",title:y(3311,"Go Back in Navigation Locations"),f1:!0})}async run(e){await e.get(mt).goBack(Fe.NAVIGATION)}}class XP extends R{constructor(){super({id:"workbench.action.navigatePreviousInNavigationLocations",title:y(3312,"Go Previous in Navigation Locations"),f1:!0})}async run(e){await e.get(mt).goPrevious(Fe.NAVIGATION)}}class JP extends R{constructor(){super({id:"workbench.action.navigateToLastNavigationLocation",title:y(3313,"Go to Last Navigation Location"),f1:!0})}async run(e){await e.get(mt).goLast(Fe.NAVIGATION)}}const Fu=class Fu extends R{constructor(){super({id:Fu.ID,title:y(3314,"Reopen Closed Editor"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|C.Shift|w.KeyT},category:T.View})}async run(e){await e.get(mt).reopenLastClosedEditor()}};Fu.ID="workbench.action.reopenClosedEditor";let bh=Fu;const Bu=class Bu extends R{constructor(){super({id:Bu.ID,title:y(3315,"Clear Recently Opened..."),f1:!0,category:T.File})}async run(e){const t=e.get(Bi),i=e.get(Wn),s=e.get(mt),{confirmed:o}=await t.confirm({type:"warning",message:c(3316,"Do you want to clear all recently opened files and workspaces?"),detail:c(3317,"This action is irreversible!"),primaryButton:c(3318,"&&Clear")});o&&(i.clearRecentlyOpened(),s.clearRecentlyOpened())}};Bu.ID="workbench.action.clearRecentFiles";let vh=Bu;const Gu=class Gu extends R{constructor(){super({id:Gu.ID,title:y(3319,"Show Editors in Active Group By Most Recently Used"),f1:!0,category:T.View})}async run(e){e.get(lt).quickAccess.show(vr.PREFIX)}};Gu.ID="workbench.action.showEditorsInActiveGroup";let yh=Gu;const Wu=class Wu extends R{constructor(){super({id:Wu.ID,title:y(3320,"Show All Editors By Appearance"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.KeyP),mac:{primary:C.CtrlCmd|C.Alt|w.Tab}},category:T.File})}async run(e){e.get(lt).quickAccess.show(Dc.PREFIX)}};Wu.ID="workbench.action.showAllEditors";let Ch=Wu;const Ku=class Ku extends R{constructor(){super({id:Ku.ID,title:y(3321,"Show All Editors By Most Recently Used"),f1:!0,category:T.View})}async run(e){e.get(lt).quickAccess.show(On.PREFIX)}};Ku.ID="workbench.action.showAllEditorsByMostRecentlyUsed";let Sh=Ku;class qp extends R{constructor(e,t,i){super(e),this.prefix=t,this.itemActivation=i}async run(e){const t=e.get(ot),i=e.get(lt),s=t.lookupKeybindings(this.desc.id);i.quickAccess.show(this.prefix,{quickNavigateConfiguration:{keybindings:s},itemActivation:this.itemActivation})}}class ZP extends qp{constructor(){super({id:"workbench.action.quickOpenPreviousRecentlyUsedEditor",title:y(3322,"Quick Open Previous Recently Used Editor"),f1:!0,category:T.View},On.PREFIX,void 0)}}class QP extends qp{constructor(){super({id:"workbench.action.quickOpenLeastRecentlyUsedEditor",title:y(3323,"Quick Open Least Recently Used Editor"),f1:!0,category:T.View},On.PREFIX,void 0)}}class eO extends qp{constructor(){super({id:"workbench.action.quickOpenPreviousRecentlyUsedEditorInGroup",title:y(3324,"Quick Open Previous Recently Used Editor in Group"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|w.Tab,mac:{primary:C.WinCtrl|w.Tab}},precondition:Ib.toNegated(),category:T.View},vr.PREFIX,void 0)}}class tO extends qp{constructor(){super({id:"workbench.action.quickOpenLeastRecentlyUsedEditorInGroup",title:y(3325,"Quick Open Least Recently Used Editor in Group"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|C.Shift|w.Tab,mac:{primary:C.WinCtrl|C.Shift|w.Tab}},precondition:Ib.toNegated(),category:T.View},vr.PREFIX,PS.LAST)}}const nc=class nc extends R{constructor(){super({id:nc.ID,title:y(3326,"Quick Open Previous Editor from History"),f1:!0})}async run(e){const t=e.get(ot),i=e.get(lt),s=e.get(U),o=t.lookupKeybindings(nc.ID);let r;s.activeGroup.count===0&&(r=PS.FIRST),i.quickAccess.show("",{quickNavigateConfiguration:{keybindings:o},itemActivation:r})}};nc.ID="workbench.action.openPreviousEditorFromHistory";let Hf=nc;class iO extends R{constructor(){super({id:"workbench.action.openNextRecentlyUsedEditor",title:y(3327,"Open Next Recently Used Editor"),f1:!0,category:T.View})}async run(e){e.get(mt).openNextRecentlyUsedEditor()}}class sO extends R{constructor(){super({id:"workbench.action.openPreviousRecentlyUsedEditor",title:y(3328,"Open Previous Recently Used Editor"),f1:!0,category:T.View})}async run(e){e.get(mt).openPreviouslyUsedEditor()}}class oO extends R{constructor(){super({id:"workbench.action.openNextRecentlyUsedEditorInGroup",title:y(3329,"Open Next Recently Used Editor In Group"),f1:!0,category:T.View})}async run(e){const t=e.get(mt),i=e.get(U);t.openNextRecentlyUsedEditor(i.activeGroup.id)}}class rO extends R{constructor(){super({id:"workbench.action.openPreviousRecentlyUsedEditorInGroup",title:y(3330,"Open Previous Recently Used Editor In Group"),f1:!0,category:T.View})}async run(e){const t=e.get(mt),i=e.get(U);t.openPreviouslyUsedEditor(i.activeGroup.id)}}class nO extends R{constructor(){super({id:"workbench.action.clearEditorHistoryWithoutConfirm",title:y(3331,"Clear Editor History without Confirmation"),f1:!0,precondition:XD})}async run(e){e.get(mt).clear()}}class aO extends R{constructor(){super({id:"workbench.action.clearEditorHistory",title:y(3332,"Clear Editor History"),f1:!0})}async run(e){const t=e.get(Bi),i=e.get(mt),{confirmed:s}=await t.confirm({type:"warning",message:c(3333,"Do you want to clear the history of recently opened editors?"),detail:c(3317,"This action is irreversible!"),primaryButton:c(3318,"&&Clear")});s&&i.clear()}}class dO extends Oe{constructor(){super({id:"workbench.action.moveEditorLeftInGroup",title:y(3334,"Move Editor Left"),keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|C.Shift|w.PageUp,mac:{primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|C.Shift|w.LeftArrow)}},f1:!0,category:T.View},Oo,{to:"left"})}}class cO extends Oe{constructor(){super({id:"workbench.action.moveEditorRightInGroup",title:y(3335,"Move Editor Right"),keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|C.Shift|w.PageDown,mac:{primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|C.Shift|w.RightArrow)}},f1:!0,category:T.View},Oo,{to:"right"})}}class lO extends Oe{constructor(){super({id:"workbench.action.moveEditorToStart",title:y(3336,"Move Editor to Start"),f1:!0,category:T.View},Oo,{to:"first"})}}class hO extends Oe{constructor(){super({id:"workbench.action.moveEditorToEnd",title:y(3337,"Move Editor to End"),f1:!0,category:T.View},Oo,{to:"last"})}}class uO extends Oe{constructor(){super({id:"workbench.action.moveEditorToPreviousGroup",title:y(3338,"Move Editor into Previous Group"),keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|C.Alt|w.LeftArrow,mac:{primary:C.CtrlCmd|C.WinCtrl|w.LeftArrow}},f1:!0,category:T.View},Oo,{to:"previous",by:"group"})}}class pO extends Oe{constructor(){super({id:"workbench.action.moveEditorToNextGroup",title:y(3339,"Move Editor into Next Group"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|C.Alt|w.RightArrow,mac:{primary:C.CtrlCmd|C.WinCtrl|w.RightArrow}},category:T.View},Oo,{to:"next",by:"group"})}}class gO extends Oe{constructor(){super({id:gh,title:y(3340,"Move Editor into Group Above"),f1:!0,category:T.View},gh)}}class fO extends Oe{constructor(){super({id:fh,title:y(3341,"Move Editor into Group Below"),f1:!0,category:T.View},fh)}}class mO extends Oe{constructor(){super({id:mh,title:y(3342,"Move Editor into Left Group"),f1:!0,category:T.View},mh)}}class wO extends Oe{constructor(){super({id:wh,title:y(3343,"Move Editor into Right Group"),f1:!0,category:T.View},wh)}}class bO extends Oe{constructor(){super({id:"workbench.action.moveEditorToFirstGroup",title:y(3344,"Move Editor into First Group"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:C.Shift|C.Alt|w.Digit1,mac:{primary:C.CtrlCmd|C.WinCtrl|w.Digit1}},category:T.View},Oo,{to:"first",by:"group"})}}class vO extends Oe{constructor(){super({id:"workbench.action.moveEditorToLastGroup",title:y(3345,"Move Editor into Last Group"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:C.Shift|C.Alt|w.Digit9,mac:{primary:C.CtrlCmd|C.WinCtrl|w.Digit9}},category:T.View},Oo,{to:"last",by:"group"})}}class yO extends Oe{constructor(){super({id:"workbench.action.splitEditorToPreviousGroup",title:y(3346,"Split Editor into Previous Group"),f1:!0,category:T.View},Mo,{to:"previous",by:"group"})}}class CO extends Oe{constructor(){super({id:"workbench.action.splitEditorToNextGroup",title:y(3347,"Split Editor into Next Group"),f1:!0,category:T.View},Mo,{to:"next",by:"group"})}}class SO extends Oe{constructor(){super({id:"workbench.action.splitEditorToAboveGroup",title:y(3348,"Split Editor into Group Above"),f1:!0,category:T.View},Mo,{to:"up",by:"group"})}}class EO extends Oe{constructor(){super({id:"workbench.action.splitEditorToBelowGroup",title:y(3349,"Split Editor into Group Below"),f1:!0,category:T.View},Mo,{to:"down",by:"group"})}}const Uu=class Uu extends Oe{constructor(){super({id:"workbench.action.splitEditorToLeftGroup",title:y(3350,"Split Editor into Left Group"),f1:!0,category:T.View},Mo,{to:"left",by:"group"})}};Uu.ID="workbench.action.splitEditorToLeftGroup",Uu.LABEL=c(3350,"Split Editor into Left Group");let zf=Uu;class _O extends Oe{constructor(){super({id:"workbench.action.splitEditorToRightGroup",title:y(3351,"Split Editor into Right Group"),f1:!0,category:T.View},Mo,{to:"right",by:"group"})}}class IO extends Oe{constructor(){super({id:"workbench.action.splitEditorToFirstGroup",title:y(3352,"Split Editor into First Group"),f1:!0,category:T.View},Mo,{to:"first",by:"group"})}}class DO extends Oe{constructor(){super({id:"workbench.action.splitEditorToLastGroup",title:y(3353,"Split Editor into Last Group"),f1:!0,category:T.View},Mo,{to:"last",by:"group"})}}const Hu=class Hu extends Oe{constructor(){super({id:Hu.ID,title:y(3354,"Single Column Editor Layout"),f1:!0,category:T.View},No,{groups:[{}],orientation:ui.HORIZONTAL})}};Hu.ID="workbench.action.editorLayoutSingle";let Eh=Hu;const zu=class zu extends Oe{constructor(){super({id:zu.ID,title:y(3355,"Two Columns Editor Layout"),f1:!0,category:T.View},No,{groups:[{},{}],orientation:ui.HORIZONTAL})}};zu.ID="workbench.action.editorLayoutTwoColumns";let _h=zu;const $u=class $u extends Oe{constructor(){super({id:$u.ID,title:y(3356,"Three Columns Editor Layout"),f1:!0,category:T.View},No,{groups:[{},{},{}],orientation:ui.HORIZONTAL})}};$u.ID="workbench.action.editorLayoutThreeColumns";let Ih=$u;const qu=class qu extends Oe{constructor(){super({id:qu.ID,title:y(3357,"Two Rows Editor Layout"),f1:!0,category:T.View},No,{groups:[{},{}],orientation:ui.VERTICAL})}};qu.ID="workbench.action.editorLayoutTwoRows";let Dh=qu;const ju=class ju extends Oe{constructor(){super({id:ju.ID,title:y(3358,"Three Rows Editor Layout"),f1:!0,category:T.View},No,{groups:[{},{},{}],orientation:ui.VERTICAL})}};ju.ID="workbench.action.editorLayoutThreeRows";let Ah=ju;const Yu=class Yu extends Oe{constructor(){super({id:Yu.ID,title:y(3359,"Grid Editor Layout (2x2)"),f1:!0,category:T.View},No,{groups:[{groups:[{},{}]},{groups:[{},{}]}],orientation:ui.HORIZONTAL})}};Yu.ID="workbench.action.editorLayoutTwoByTwoGrid";let Th=Yu;const Xu=class Xu extends Oe{constructor(){super({id:Xu.ID,title:y(3360,"Two Columns Bottom Editor Layout"),f1:!0,category:T.View},No,{groups:[{},{groups:[{},{}]}],orientation:ui.VERTICAL})}};Xu.ID="workbench.action.editorLayoutTwoColumnsBottom";let kh=Xu;const Ju=class Ju extends Oe{constructor(){super({id:Ju.ID,title:y(3361,"Two Rows Right Editor Layout"),f1:!0,category:T.View},No,{groups:[{},{groups:[{},{}]}],orientation:ui.HORIZONTAL})}};Ju.ID="workbench.action.editorLayoutTwoRowsRight";let xh=Ju;class jp extends R{constructor(e,t){super(e),this.direction=t}async run(e){const t=e.get(U),i=e.get(je),s=Zn(),o=i.hasFocus(j.EDITOR_PART)||s.activeElement===s.body,r=t.addGroup(t.activeGroup,this.direction);t.activateGroup(r),o&&r.focus()}}class AO extends jp{constructor(){super({id:"workbench.action.newGroupLeft",title:y(3362,"New Editor Group to the Left"),f1:!0,category:T.View},J.LEFT)}}class TO extends jp{constructor(){super({id:"workbench.action.newGroupRight",title:y(3363,"New Editor Group to the Right"),f1:!0,category:T.View},J.RIGHT)}}class kO extends jp{constructor(){super({id:"workbench.action.newGroupAbove",title:y(3364,"New Editor Group Above"),f1:!0,category:T.View},J.UP)}}class xO extends jp{constructor(){super({id:"workbench.action.newGroupBelow",title:y(3365,"New Editor Group Below"),f1:!0,category:T.View},J.DOWN)}}class LO extends R{constructor(){super({id:"workbench.action.toggleEditorType",title:y(3366,"Toggle Editor Type"),f1:!0,category:T.View,precondition:hd})}async run(e){const t=e.get(O),i=e.get(Qs),s=t.activeEditorPane;if(!s)return;const o=Ue.getCanonicalUri(s.input);if(!o)return;const r=i.getEditors(o).map(n=>n.id).filter(n=>n!==s.input.editorId);r.length!==0&&await t.replaceEditors([{editor:s.input,replacement:{resource:o,options:{override:r[0]}}}],s.group)}}class RO extends R{constructor(){super({id:"workbench.action.reopenTextEditor",title:y(3367,"Reopen Editor with Text Editor"),f1:!0,category:T.View,precondition:hd})}async run(e){const t=e.get(O),i=t.activeEditorPane;if(!i)return;const s=Ue.getCanonicalUri(i.input);s&&await t.replaceEditors([{editor:i.input,replacement:{resource:s,options:{override:Mt.id}}}],i.group)}}class nI extends R{constructor(e,t,i,s){super({id:e,title:t,category:T.View,precondition:NS,keybinding:i,f1:!0}),this.move=s}async run(e,...t){const i=e.get(U),s=e.get(O),o=e.get(ne),r=bt(t,s,i,o);if(!r.groupedEditors.length)return;const n=await i.createAuxiliaryEditorPart(),{group:d,editors:l}=r.groupedEditors[0],h=yp(d,l,r.preserveFocus);this.move?d.moveEditors(h,n.activeGroup):d.copyEditors(h,n.activeGroup),n.activeGroup.focus()}}class VO extends nI{constructor(){super(Sv,{...y(3368,"Move Editor into New Window"),mnemonicTitle:c(3369,"&&Move Editor into New Window")},void 0,!0)}}class PO extends nI{constructor(){super(Ev,{...y(3370,"Copy Editor into New Window"),mnemonicTitle:c(3371,"&&Copy Editor into New Window")},{primary:Ce(C.CtrlCmd|w.KeyK,w.KeyO),weight:L.WorkbenchContrib},!1)}}class aI extends R{constructor(e,t,i){super({id:e,title:t,category:T.View,f1:!0}),this.move=i}async run(e){const t=e.get(U),i=t.activeGroup,s=await t.createAuxiliaryEditorPart();t.mergeGroup(i,s.activeGroup,{mode:this.move?kn.MOVE_EDITORS:kn.COPY_EDITORS}),s.activeGroup.focus()}}class OO extends aI{constructor(){super(Z_,{...y(3372,"Move Editor Group into New Window"),mnemonicTitle:c(3373,"&&Move Editor Group into New Window")},!0)}}class MO extends aI{constructor(){super(Q_,{...y(3374,"Copy Editor Group into New Window"),mnemonicTitle:c(3375,"&&Copy Editor Group into New Window")},!1)}}class NO extends R{constructor(){super({id:"workbench.action.restoreEditorsToMainWindow",title:{...y(3376,"Restore Editors into Main Window"),mnemonicTitle:c(3377,"&&Restore Editors into Main Window")},f1:!0,precondition:MS,category:T.View})}async run(e){const t=e.get(U);t.mergeAllGroups(t.mainPart.activeGroup)}}class FO extends R{constructor(){super({id:eI,title:{...y(3378,"New Empty Editor Window"),mnemonicTitle:c(3379,"&&New Empty Editor Window")},f1:!0,category:T.View})}async run(e){(await e.get(U).createAuxiliaryEditorPart()).activeGroup.focus()}}class dI extends M{constructor(e){super(),this.model=e,this._onDidModelChange=this._register(new A),this.onDidModelChange=this._onDidModelChange.event,this._register(this.model.onDidModelChange(t=>{const i=t.editorIndex??t.editor;i!==void 0&&!this.filter(i)||this._onDidModelChange.fire(t)}))}get id(){return this.model.id}get isLocked(){return this.model.isLocked}get stickyCount(){return this.model.stickyCount}get activeEditor(){return this.model.activeEditor&&this.filter(this.model.activeEditor)?this.model.activeEditor:null}get previewEditor(){return this.model.previewEditor&&this.filter(this.model.previewEditor)?this.model.previewEditor:null}get selectedEditors(){return this.model.selectedEditors.filter(e=>this.filter(e))}isPinned(e){return this.model.isPinned(e)}isTransient(e){return this.model.isTransient(e)}isSticky(e){return this.model.isSticky(e)}isActive(e){return this.model.isActive(e)}isSelected(e){return this.model.isSelected(e)}isFirst(e){return this.model.isFirst(e,this.getEditors(Ie.SEQUENTIAL))}isLast(e){return this.model.isLast(e,this.getEditors(Ie.SEQUENTIAL))}getEditors(e,t){return this.model.getEditors(e,t).filter(s=>this.filter(s))}findEditor(e,t){const i=this.model.findEditor(e,t);if(i)return this.filter(i[1])?i:void 0}}class cI extends dI{get count(){return this.model.stickyCount}getEditors(e,t){return t?.excludeSticky?[]:e===Ie.SEQUENTIAL?this.model.getEditors(Ie.SEQUENTIAL).slice(0,this.model.stickyCount):super.getEditors(e,t)}isSticky(e){return!0}getEditorByIndex(e){return e<this.count?this.model.getEditorByIndex(e):void 0}indexOf(e,t,i){const s=this.model.indexOf(e,t,i);return s<0||s>=this.model.stickyCount?-1:s}contains(e,t){const i=this.model.indexOf(e,void 0,t);return i>=0&&i<this.model.stickyCount}filter(e){return this.model.isSticky(e)}}class lI extends dI{get count(){return this.model.count-this.model.stickyCount}get stickyCount(){return 0}isSticky(e){return!1}getEditors(e,t){return e===Ie.SEQUENTIAL?this.model.getEditors(Ie.SEQUENTIAL).slice(this.model.stickyCount):super.getEditors(e,t)}getEditorByIndex(e){return e>=0?this.model.getEditorByIndex(e+this.model.stickyCount):void 0}indexOf(e,t,i){const s=this.model.indexOf(e,t,i);return s<this.model.stickyCount||s>=this.model.count?-1:s-this.model.stickyCount}contains(e,t){const i=this.model.indexOf(e,void 0,t);return i>=this.model.stickyCount&&i<this.model.count}filter(e){return!this.model.isSticky(e)}}var Si;xe(RV);var us;let Lc=(us=class extends Tc{constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m,v,E,x){super(e,t,i,s,o,r,n,d,l,h,p,g,E,x),this.editorService=f,this.pathService=m,this.treeViewsDragAndDropService=v,this.closeEditorAction=this._register(this.instantiationService.createInstance(qd,qd.ID,qd.LABEL)),this.unpinEditorAction=this._register(this.instantiationService.createInstance($d,$d.ID,$d.LABEL)),this.tabResourceLabels=this._register(this.instantiationService.createInstance(jc,bb)),this.tabLabels=[],this.tabActionBars=[],this.tabDisposables=[],this.dimensions={container:Be.None,available:Be.None},this.layoutScheduler=this._register(new Ae),this.path=mi?hA:vS,this.lastMouseWheelEventTime=0,this.isMouseOverTabs=!1,this.updateEditorLabelScheduler=this._register(new pd(()=>this.doUpdateEditorLabels(),0)),(async()=>this.path=await this.pathService.path)(),this._register(this.tabResourceLabels.onDidChangeDecorations(()=>this.doHandleDecorationsChange()))}create(e){return super.create(e),this.titleContainer=e,this.tabsAndActionsContainer=N(".tabs-and-actions-container"),this.titleContainer.appendChild(this.tabsAndActionsContainer),this.tabsContainer=N(".tabs-container",{role:"tablist",draggable:!0}),this._register(wc.addTarget(this.tabsContainer)),this.tabSizingFixedDisposables=this._register(new B),this.updateTabSizing(!1),this.tabsScrollbar=this.createTabsScrollbar(this.tabsContainer),this.tabsAndActionsContainer.appendChild(this.tabsScrollbar.getDomNode()),this.registerTabsContainerListeners(this.tabsContainer,this.tabsScrollbar),this.createEditorActionsToolBar(this.tabsAndActionsContainer,["editor-actions"]),this.updateTabsControlVisibility(),this.tabsAndActionsContainer}createTabsScrollbar(e){const t=this._register(new JD(e,{horizontal:this.getTabsScrollbarVisibility(),horizontalScrollbarSize:this.getTabsScrollbarSizing(),vertical:fs.Hidden,scrollYToX:!0,useShadows:!1}));return this._register(t.onScroll(i=>{i.scrollLeftChanged&&(e.scrollLeft=i.scrollLeft)})),t}updateTabsScrollbarSizing(){this.tabsScrollbar?.updateOptions({horizontalScrollbarSize:this.getTabsScrollbarSizing()})}updateTabsScrollbarVisibility(){this.tabsScrollbar?.updateOptions({horizontal:this.getTabsScrollbarVisibility()})}updateTabSizing(e){const[t,i]=Ho(this.tabsContainer,this.tabSizingFixedDisposables);i.clear();const s=this.groupsView.partOptions;s.tabSizing==="fixed"?(t.style.setProperty("--tab-sizing-fixed-min-width",`${s.tabSizingFixedMinWidth}px`),t.style.setProperty("--tab-sizing-fixed-max-width",`${s.tabSizingFixedMaxWidth}px`),i.add(X(t,Q.MOUSE_ENTER,()=>{this.isMouseOverTabs=!0})),i.add(X(t,Q.MOUSE_LEAVE,()=>{this.isMouseOverTabs=!1,this.updateTabsFixedWidth(!1)}))):e&&(t.style.removeProperty("--tab-sizing-fixed-min-width"),t.style.removeProperty("--tab-sizing-fixed-max-width"),this.updateTabsFixedWidth(!1))}updateTabsFixedWidth(e){this.forEachTab((t,i,s)=>{if(e){const{width:o}=s.getBoundingClientRect();s.style.setProperty("--tab-sizing-current-width",`${o}px`)}else s.style.removeProperty("--tab-sizing-current-width")})}getTabsScrollbarSizing(){return this.groupsView.partOptions.titleScrollbarSizing!=="large"?Si.SCROLLBAR_SIZES.default:Si.SCROLLBAR_SIZES.large}getTabsScrollbarVisibility(){switch(this.groupsView.partOptions.titleScrollbarVisibility){case"visible":return fs.Visible;case"hidden":return fs.Hidden;default:return fs.Auto}}registerTabsContainerListeners(e,t){this._register(X(e,Q.SCROLL,()=>{e.classList.contains("scroll")&&t.setScrollPosition({scrollLeft:e.scrollLeft})}));for(const r of[ji.Tap,Q.DBLCLICK])this._register(X(e,r,n=>{if(r===Q.DBLCLICK){if(n.target!==e)return}else if(n.tapCount!==2||n.initialTarget!==e)return;be.stop(n),this.editorService.openEditor({resource:void 0,options:{pinned:!0,index:this.groupView.count,override:Mt.id}},this.groupView.id)}));this._register(X(e,Q.MOUSE_DOWN,r=>{r.button===1&&r.preventDefault()})),xn&&this._register(X(e,Q.MOUSE_UP,r=>{r.button===1&&r.preventDefault()}));let i,s=!1;this._register(new vc(e,{onDragStart:r=>{s=this.onGroupDragStart(r,e)},onDrag:r=>{i=r},onDragEnter:r=>{if(e.classList.add("scroll"),r.target===e){if(!this.isSupportedDropTransfer(r)){r.dataTransfer&&(r.dataTransfer.dropEffect="none");return}this.editorTransfer.hasData(yt.prototype)||r.dataTransfer&&(r.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0,r)}},onDragLeave:r=>{this.updateDropFeedback(e,!1,r),e.classList.remove("scroll")},onDragEnd:r=>{this.updateDropFeedback(e,!1,r),e.classList.remove("scroll"),this.onGroupDragEnd(r,i,e,s)},onDrop:r=>{if(this.updateDropFeedback(e,!1,r),e.classList.remove("scroll"),r.target===e){const n=this.groupTransfer.hasData(Ht.prototype);this.onDrop(r,n?this.groupView.count:this.tabsModel.count,e)}}})),this._register(X(e,Q.MOUSE_WHEEL,r=>{const n=this.groupView.activeEditor;if(!n||this.groupView.count<2)return;if(this.groupsView.partOptions.scrollToSwitchTabs===!0){if(r.shiftKey)return}else if(!r.shiftKey)return;const d=Date.now();if(d-this.lastMouseWheelEventTime<Si.MOUSE_WHEEL_EVENT_THRESHOLD-2*(Math.abs(r.deltaX)+Math.abs(r.deltaY)))return;this.lastMouseWheelEventTime=d;let l;if(r.deltaX+r.deltaY<-Si.MOUSE_WHEEL_DISTANCE_THRESHOLD)l=-1;else if(r.deltaX+r.deltaY>Si.MOUSE_WHEEL_DISTANCE_THRESHOLD)l=1;else return;const h=this.groupView.getEditorByIndex(this.groupView.getIndexOfEditor(n)+l);h&&(this.groupView.openEditor(h),be.stop(r,!0))}));const o=r=>{be.stop(r);let n=e;na(r)&&(n=new uo(He(this.parent),r)),this.contextMenuService.showContextMenu({getAnchor:()=>n,menuId:b.EditorTabsBarContext,contextKeyService:this.contextKeyService,menuActionOptions:{shouldForwardArgs:!0},getActionsContext:()=>({groupId:this.groupView.id}),getKeyBinding:d=>this.getKeybinding(d),onHide:()=>this.groupView.focus()})};this._register(X(e,ji.Contextmenu,r=>o(r))),this._register(X(e,Q.CONTEXT_MENU,r=>o(r)))}doHandleDecorationsChange(){this.layout(this.dimensions)}updateEditorActionsToolbar(){super.updateEditorActionsToolbar(),this.layout(this.dimensions)}openEditor(e,t){const i=this.handleOpenedEditors();return t?.focusTabControl&&this.withTab(e,(s,o,r)=>r.focus()),i}openEditors(e){return this.handleOpenedEditors()}handleOpenedEditors(){this.updateTabsControlVisibility();const[e,t]=Ho(this.tabsContainer,this.tabsScrollbar);for(let r=e.children.length;r<this.tabsModel.count;r++)e.appendChild(this.createTab(r,e,t));const i=this.didActiveEditorChange(),s=this.tabLabels;this.computeTabLabels();let o=!1;return i||s.length!==this.tabLabels.length||s.some((r,n)=>!this.equalsEditorInputLabel(r,this.tabLabels.at(n)))?(this.redraw({forceRevealActiveTab:!0}),o=!0):this.layout(this.dimensions,{forceRevealActiveTab:!0}),o}didActiveEditorChange(){return!!(!this.activeTabLabel?.editor&&this.tabsModel.activeEditor||this.activeTabLabel?.editor&&!this.tabsModel.activeEditor||!this.activeTabLabel?.editor||!this.tabsModel.isActive(this.activeTabLabel.editor))}equalsEditorInputLabel(e,t){return e===t?!0:!e||!t?!1:e.name===t.name&&e.description===t.description&&e.forceDescription===t.forceDescription&&e.title===t.title&&e.ariaLabel===t.ariaLabel}beforeCloseEditor(e){if(this.isMouseOverTabs&&this.groupsView.partOptions.tabSizing==="fixed"){const t=this.tabsModel.isLast(e);this.updateTabsFixedWidth(!t)}}closeEditor(e){this.handleClosedEditors()}closeEditors(e){this.handleClosedEditors()}handleClosedEditors(){if(this.tabsModel.count){const e=fe(this.tabsContainer);for(;e.children.length>this.tabsModel.count;)e.lastChild?.remove(),dt(this.tabDisposables.pop());this.computeTabLabels(),this.redraw({forceRevealActiveTab:!0})}else this.tabsContainer&&Ut(this.tabsContainer),this.tabDisposables=dt(this.tabDisposables),this.tabResourceLabels.clear(),this.tabLabels=[],this.activeTabLabel=void 0,this.tabActionBars=[],this.clearEditorActionsToolbar(),this.updateTabsControlVisibility()}moveEditor(e,t,i){const s=this.tabLabels[t];this.tabLabels.splice(t,1),this.tabLabels.splice(i,0,s),this.forEachTab((o,r,n,d,l,h)=>{this.redrawTab(o,r,n,d,l,h)},Math.min(t,i),Math.max(t,i)),this.layout(this.dimensions,{forceRevealActiveTab:!0})}pinEditor(e){this.withTab(e,(t,i,s,o,r)=>this.redrawTabLabel(t,i,s,o,r))}stickEditor(e){this.doHandleStickyEditorChange(e)}unstickEditor(e){this.doHandleStickyEditorChange(e)}doHandleStickyEditorChange(e){this.withTab(e,(t,i,s,o,r,n)=>this.redrawTab(t,i,s,o,r,n)),this.forEachTab((t,i,s,o,r)=>{this.redrawTabBorders(i,s)}),this.layout(this.dimensions,{forceRevealActiveTab:!0})}setActive(e){this.forEachTab((t,i,s,o,r,n)=>{this.redrawTabSelectedActiveAndDirty(e,t,s,n)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,{forceRevealActiveTab:!0})}updateEditorSelections(){this.forEachTab((e,t,i,s,o,r)=>{this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,e,i,r)})}updateEditorLabel(e){this.updateEditorLabelScheduler.schedule()}doUpdateEditorLabels(){this.computeTabLabels(),this.forEachTab((e,t,i,s,o)=>{this.redrawTabLabel(e,t,i,s,o)}),this.layout(this.dimensions)}updateEditorDirty(e){this.withTab(e,(t,i,s,o,r,n)=>this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,t,s,n))}updateOptions(e,t){super.updateOptions(e,t),e.labelFormat!==t.labelFormat&&this.computeTabLabels(),e.titleScrollbarSizing!==t.titleScrollbarSizing&&this.updateTabsScrollbarSizing(),e.titleScrollbarVisibility!==t.titleScrollbarVisibility&&this.updateTabsScrollbarVisibility(),e.alwaysShowEditorActions!==t.alwaysShowEditorActions&&this.updateEditorActionsToolbar(),(e.tabSizingFixedMinWidth!==t.tabSizingFixedMinWidth||e.tabSizingFixedMaxWidth!==t.tabSizingFixedMaxWidth||e.tabSizing!==t.tabSizing)&&this.updateTabSizing(!0),(e.labelFormat!==t.labelFormat||e.tabActionLocation!==t.tabActionLocation||e.tabActionCloseVisibility!==t.tabActionCloseVisibility||e.tabActionUnpinVisibility!==t.tabActionUnpinVisibility||e.tabSizing!==t.tabSizing||e.pinnedTabSizing!==t.pinnedTabSizing||e.showIcons!==t.showIcons||e.hasIcons!==t.hasIcons||e.highlightModifiedTabs!==t.highlightModifiedTabs||e.wrapTabs!==t.wrapTabs||e.showTabIndex!==t.showTabIndex||!Sp(e.decorations,t.decorations))&&this.redraw()}updateStyles(){this.redraw()}forEachTab(e,t,i){this.tabsModel.getEditors(Ie.SEQUENTIAL).forEach((s,o)=>{typeof t=="number"&&t>o||typeof i=="number"&&i<o||this.doWithTab(o,s,e)})}withTab(e,t){this.doWithTab(this.tabsModel.indexOf(e),e,t)}doWithTab(e,t,i){const o=fe(this.tabsContainer).children[e],r=this.tabResourceLabels.get(e),n=this.tabLabels[e],d=this.tabActionBars[e];o&&r&&n&&i(t,e,o,r,n,d)}createTab(e,t,i){const s=N(".tab",{draggable:!0,role:"tab"}),o=wc.addTarget(s),r=N(".tab-border-top-container");s.appendChild(r);const n=this.tabResourceLabels.create(s,{hoverTargetOverride:s}),d=N(".tab-actions");s.appendChild(d);const l=this,h=new iI({groupId:this.groupView.id,get editorIndex(){return l.toEditorIndex(e)}}),p=new Sr(d,{ariaLabel:c(3506,"Tab actions"),actionRunner:h}),g=p.onWillRun(x=>{x.action.id===this.closeEditorAction.id&&this.blockRevealActiveTabOnce()}),f=Wg(h,p,g,pe(FS(this.tabActionBars,p))),m=N(".tab-fade-hider");s.appendChild(m);const v=N(".tab-border-bottom-container");s.appendChild(v);const E=this.registerTabListeners(s,e,t,i);return this.tabDisposables.push(Wg(o,E,f,n)),s}toEditorIndex(e){const t=fe(this.tabsModel.getEditorByIndex(e));return this.groupView.getIndexOfEditor(t)}registerTabListeners(e,t,i,s){const o=new B,r=async(h,p)=>{if(e.blur(),na(h)&&(h.button!==0||Ge&&h.ctrlKey)){h.button===1&&h.preventDefault();return}if(this.originatesFromTabActionBar(h))return;const g=this.tabsModel.getEditorByIndex(t);if(g)if(h.shiftKey){let f;if(this.lastSingleSelectSelectedEditor&&this.tabsModel.isSelected(this.lastSingleSelectSelectedEditor))f=this.lastSingleSelectSelectedEditor;else{const m=fe(this.groupView.activeEditor);this.lastSingleSelectSelectedEditor=m,f=m}await this.selectEditorsBetween(g,f)}else if(h.ctrlKey&&!Ge||h.metaKey&&Ge)this.tabsModel.isSelected(g)?await this.unselectEditor(g):(await this.selectEditor(g),this.lastSingleSelectSelectedEditor=g);else{const f=this.tabsModel.isSelected(g)?this.groupView.selectedEditors.filter(m=>!m.matches(g)):[];await this.groupView.openEditor(g,{preserveFocus:p,activation:ho.ACTIVATE},{inactiveSelection:f,focusTabControl:!0})}},n=h=>{be.stop(h);const p=this.tabsModel.getEditorByIndex(t);p&&this.onTabContextMenu(p,h,e)};o.add(X(e,Q.MOUSE_DOWN,h=>r(h,!1))),o.add(X(e,ji.Tap,h=>r(h,!0))),o.add(X(e,ji.Change,h=>{s.setScrollPosition({scrollLeft:s.getScrollPosition().scrollLeft-h.translationX})})),o.add(X(e,Q.MOUSE_UP,async h=>{if(be.stop(h),e.blur(),na(h)&&(h.button!==0||Ge&&h.ctrlKey)||this.originatesFromTabActionBar(h))return;!(h.ctrlKey&&!Ge||h.metaKey&&Ge)&&!h.shiftKey&&this.groupView.selectedEditors.length>1&&await this.unselectAllEditors()})),o.add(X(e,Q.AUXCLICK,h=>{if(h.button===1){be.stop(h,!0);const p=this.tabsModel.getEditorByIndex(t);if(p){if(BS(this.tabsModel,p,GS.MOUSE,this.groupsView.partOptions))return;this.blockRevealActiveTabOnce(),this.closeEditorAction.run({groupId:this.groupView.id,editorIndex:this.groupView.getIndexOfEditor(p)})}}})),o.add(X(e,Q.KEY_DOWN,h=>{const p=new br(h);p.shiftKey&&p.keyCode===w.F10&&n(h)})),o.add(X(e,ji.Contextmenu,h=>{n(h)})),o.add(X(e,Q.KEY_UP,h=>{const p=new br(h);let g=!1;if(p.equals(w.Enter)||p.equals(w.Space)){g=!0;const f=this.tabsModel.getEditorByIndex(t);f&&this.groupView.openEditor(f)}else if([w.LeftArrow,w.RightArrow,w.UpArrow,w.DownArrow,w.Home,w.End].some(f=>p.equals(f))){let f=this.toEditorIndex(t);p.equals(w.LeftArrow)||p.equals(w.UpArrow)?f=f-1:p.equals(w.RightArrow)||p.equals(w.DownArrow)?f=f+1:p.equals(w.Home)?f=0:f=this.groupView.count-1;const m=this.groupView.getEditorByIndex(f);m&&(g=!0,this.groupView.openEditor(m,{preserveFocus:!0},{focusTabControl:!0}))}g&&be.stop(h,!0),s.setScrollPosition({scrollLeft:i.scrollLeft})}));for(const h of[ji.Tap,Q.DBLCLICK])o.add(X(e,h,p=>{if(h===Q.DBLCLICK)be.stop(p);else if(p.tapCount!==2)return;const g=this.tabsModel.getEditorByIndex(t);if(g&&this.tabsModel.isPinned(g))switch(this.groupsView.partOptions.doubleClickTabToToggleEditorGroupSizes){case"maximize":this.groupsView.toggleMaximizeGroup(this.groupView);break;case"expand":this.groupsView.toggleExpandGroup(this.groupView);break}else this.groupView.pinEditor(g)}));o.add(X(e,Q.CONTEXT_MENU,h=>{be.stop(h,!0);const p=this.tabsModel.getEditorByIndex(t);p&&this.onTabContextMenu(p,h,e)},!0));let d,l=!1;return o.add(new vc(e,{onDragStart:h=>{const p=this.tabsModel.getEditorByIndex(t);if(!p)return;l=this.isNewWindowOperation(h);const g=this.groupView.selectedEditors;if(this.editorTransfer.setData(g.map(f=>new yt({editor:f,groupId:this.groupView.id})),yt.prototype),h.dataTransfer)if(h.dataTransfer.effectAllowed="copyMove",g.length>1){const f=`${p.getName()} + ${g.length-1}`;yb(h,e,f)}else h.dataTransfer.setDragImage(e,0,0);this.doFillResourceDataTransfers(g,h,l),Jv(He(this.parent),()=>this.updateDropFeedback(e,!1,h,t))},onDrag:h=>{d=h},onDragEnter:h=>{if(!this.isSupportedDropTransfer(h)){h.dataTransfer&&(h.dataTransfer.dropEffect="none");return}this.editorTransfer.hasData(yt.prototype)||h.dataTransfer&&(h.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0,h,t)},onDragOver:(h,p)=>{if(p>=Si.DRAG_OVER_OPEN_TAB_THRESHOLD){const g=this.tabsModel.getEditorByIndex(t);g&&this.tabsModel.activeEditor!==g&&this.groupView.openEditor(g,{preserveFocus:!0})}this.updateDropFeedback(e,!0,h,t)},onDragEnd:async h=>{this.updateDropFeedback(e,!1,h,t);const p=this.editorTransfer.getData(yt.prototype);if(this.editorTransfer.clearData(yt.prototype),!l||RS()||!p||p.length===0)return;const g=await this.maybeCreateAuxiliaryEditorPartAt(h,e);if(!g)return;const f=g.activeGroup,m=yp(this.groupView,p.map(v=>v.identifier.editor));this.isMoveOperation(d??h,f.id,p[0].identifier.editor)?this.groupView.moveEditors(m,f):this.groupView.copyEditors(m,f),f.focus()},onDrop:h=>{this.updateDropFeedback(e,!1,h,t);let p=t;this.getTabDragOverLocation(h,e)==="right"&&p++,this.onDrop(h,p,i)}})),o}isSupportedDropTransfer(e){if(this.groupTransfer.hasData(Ht.prototype)){const t=this.groupTransfer.getData(Ht.prototype);return!(Array.isArray(t)&&t.length>0&&t[0].identifier===this.groupView.id)}return!!(this.editorTransfer.hasData(yt.prototype)||e.dataTransfer&&e.dataTransfer.types.length>0)}updateDropFeedback(e,t,i,s){const o=typeof s=="number";let r;t?o?r=this.computeDropTarget(i,s,e):r={leftElement:e.lastElementChild,rightElement:void 0}:r=void 0,this.updateDropTarget(r)}updateDropTarget(e){const t=this.dropTarget;if(t===e||t&&e&&t.leftElement===e.leftElement&&t.rightElement===e.rightElement)return;const i="drop-target-left",s="drop-target-right";t&&(t.leftElement?.classList.remove(i),t.rightElement?.classList.remove(s)),e&&(e.leftElement?.classList.add(i),e.rightElement?.classList.add(s)),this.dropTarget=e}getTabDragOverLocation(e,t){const i=t.getBoundingClientRect();return e.clientX-i.left<=i.width/2?"left":"right"}computeDropTarget(e,t,i){const s=this.getTabDragOverLocation(e,i)==="left",o=t===this.tabsModel.count-1;if(s&&t===0)return{leftElement:void 0,rightElement:i};if(!s&&o)return{leftElement:i,rightElement:void 0};const n=s?i.previousElementSibling:i,d=s?i:i.nextElementSibling;return{leftElement:n,rightElement:d}}async selectEditor(e){this.groupView.isActive(e)||await this.groupView.setSelection(e,this.groupView.selectedEditors)}async selectEditorsBetween(e,t){const i=this.groupView.getIndexOfEditor(e);if(i===-1)throw new Qa;const s=this.groupView.getIndexOfEditor(t);if(s===-1)throw new Qa;let o=this.groupView.selectedEditors,r=s;for(;r>=0&&r<=this.groupView.count-1;){r=s<i?r-1:r+1;const p=this.groupView.getEditorByIndex(r);if(!p||!this.groupView.isSelected(p))break;o=o.filter(g=>!g.matches(p))}const n=s<i?s:i,d=s<i?i:s,l=this.groupView.getEditors(Ie.SEQUENTIAL).slice(n,d+1);for(const p of l)this.groupView.isSelected(p)||o.push(p);const h=o.filter(p=>!p.matches(e));await this.groupView.setSelection(e,h)}async unselectEditor(e){const t=this.groupView.isActive(e);if(t&&this.groupView.selectedEditors.length===1)return;let i=fe(this.groupView.activeEditor);if(t){const o=this.groupView.getEditors(Ie.MOST_RECENTLY_ACTIVE);for(let r=1;r<o.length;r++){const n=o[r];if(this.groupView.isSelected(n)){i=n;break}}}const s=this.groupView.selectedEditors.filter(o=>!o.matches(e)&&!o.matches(i));await this.groupView.setSelection(i,s)}async unselectAllEditors(){if(this.groupView.selectedEditors.length>1){const e=fe(this.groupView.activeEditor);await this.groupView.setSelection(e,[])}}computeTabLabels(){const{labelFormat:e}=this.groupsView.partOptions,{verbosity:t,shortenDuplicates:i}=this.getLabelConfigFlags(e),s=[];let o=-1;this.tabsModel.getEditors(Ie.SEQUENTIAL).forEach((r,n)=>{s.push({editor:r,name:r.getName(),description:r.getDescription(t),forceDescription:r.hasCapability(Xt.ForceDescription),title:r.getTitle(ds.LONG),ariaLabel:fb(r,n,this.groupView,this.editorPartsView.count)}),r===this.tabsModel.activeEditor&&(o=n)}),i&&this.shortenTabLabels(s),this.tabLabels=s,this.activeTabLabel=s[o]}shortenTabLabels(e){const t=new Map;for(const i of e)typeof i.description=="string"?rg(t,i.name,[]).push(i):i.description="";for(const[,i]of t){if(i.length===1&&!i[0].forceDescription){i[0].description="";continue}const s=new Map;for(const d of i)rg(s,d.description,[]).push(d);let o=!1;for(const[,d]of s)if(!o&&d.length>1){const[l,...h]=d.map(({editor:p})=>p.getDescription(ds.LONG));o=h.some(p=>p!==l)}if(o){s.clear();for(const d of i)d.description=d.editor.getDescription(ds.LONG),rg(s,d.description,[]).push(d)}const r=[];for(const[d]of s)r.push(d);if(r.length===1){for(const d of s.get(r[0])||[])d.forceDescription||(d.description="");continue}const n=ZD(r,this.path.sep);r.forEach((d,l)=>{for(const h of s.get(d)||[])h.description=n[l]})}}getLabelConfigFlags(e){switch(e){case"short":return{verbosity:ds.SHORT,shortenDuplicates:!1};case"medium":return{verbosity:ds.MEDIUM,shortenDuplicates:!1};case"long":return{verbosity:ds.LONG,shortenDuplicates:!1};default:return{verbosity:ds.MEDIUM,shortenDuplicates:!0}}}redraw(e){if(this.tabsAndActionsContainer){let t=this.getColor(QD);!t&&WS(this.theme.type)&&(t=this.getColor(zg)||this.getColor(es)),t?(this.tabsAndActionsContainer.classList.add("tabs-border-bottom"),this.tabsAndActionsContainer.style.setProperty("--tabs-border-bottom-color",t.toString())):(this.tabsAndActionsContainer.classList.remove("tabs-border-bottom"),this.tabsAndActionsContainer.style.removeProperty("--tabs-border-bottom-color"))}this.forEachTab((t,i,s,o,r,n)=>{this.redrawTab(t,i,s,o,r,n)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,e)}redrawTab(e,t,i,s,o,r){const n=this.tabsModel.isSticky(t),d=this.groupsView.partOptions;this.redrawTabLabel(e,t,i,s,o);const l=n&&d.tabActionUnpinVisibility,h=!l&&d.tabActionCloseVisibility,p=l||h;let g;p?g=l?this.unpinEditorAction:this.closeEditorAction:g=n?this.unpinEditorAction:this.closeEditorAction,r.hasAction(g)||(r.isEmpty()||r.clear(),r.push(g,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(g)})),i.classList.toggle("pinned-action-off",n&&!l),i.classList.toggle("close-action-off",!l&&!h);for(const m of["left","right"])i.classList.toggle(`tab-actions-${m}`,p&&d.tabActionLocation===m);const f=n&&d.pinnedTabSizing==="shrink"?"shrink":d.tabSizing;for(const m of["fit","shrink","fixed"])i.classList.toggle(`sizing-${m}`,f===m);i.classList.toggle("has-icon",d.showIcons&&d.hasIcons),i.classList.toggle("sticky",n);for(const m of["normal","compact","shrink"])i.classList.toggle(`sticky-${m}`,n&&d.pinnedTabSizing===m);if(!d.wrapTabs&&n&&d.pinnedTabSizing!=="normal"){let m=0;switch(d.pinnedTabSizing){case"compact":m=Si.TAB_WIDTH.compact;break;case"shrink":m=Si.TAB_WIDTH.shrink;break}i.style.left=`${t*m}px`}else i.style.left="auto";this.redrawTabBorders(t,i),this.redrawTabSelectedActiveAndDirty(this.groupsView.activeGroup===this.groupView,e,i,r)}redrawTabLabel(e,t,i,s,o){const r=this.groupsView.partOptions;let n,d,l=!1,h=!!r.decorations?.badges;const p=!!r.decorations?.colors;let g;r.pinnedTabSizing==="compact"&&this.tabsModel.isSticky(t)?(n=r.showIcons&&r.hasIcons?"":o.name?.charAt(0).toUpperCase(),g="",l=!0,h=!1):(n=o.name,d=r.showTabIndex?`${this.toEditorIndex(t)+1}: `:void 0,g=o.description||""),o.ariaLabel&&(i.setAttribute("aria-label",o.ariaLabel),i.setAttribute("aria-description","")),s.setResource({name:n,description:g,resource:Ue.getOriginalUri(e,{supportSideBySide:Le.BOTH})},{title:this.getHoverTitle(e),extraClasses:Mi(["tab-label",h?"tab-label-has-badge":void 0].concat(e.getLabelExtraClasses())),italic:!this.tabsModel.isPinned(e),forceLabel:l,fileDecorations:{colors:p,badges:h},icon:e.getIcon(),hideIcon:r.showIcons===!1,namePrefix:d});const f=Ue.getOriginalUri(e,{supportSideBySide:Le.PRIMARY});f?i.setAttribute("data-resource-name",eA(f)):i.removeAttribute("data-resource-name")}redrawTabSelectedActiveAndDirty(e,t,i,s){const o=this.tabsModel.isActive(t),r=this.doRedrawTabDirty(e,o,t,i);this.doRedrawTabActive(e,!r,t,i,s)}doRedrawTabActive(e,t,i,s,o){const r=this.tabsModel.isActive(i),n=this.tabsModel.isSelected(i);if(s.classList.toggle("active",r),s.classList.toggle("selected",n),s.setAttribute("aria-selected",r?"true":"false"),s.tabIndex=r?0:-1,o.setFocusable(r),r){const l=this.getColor(e?tA:iA);s.classList.toggle("tab-border-bottom",!!l),s.style.setProperty("--tab-border-bottom-color",l??"")}let d=null;t&&(r&&(d=this.getColor(e?sA:oA)),d===null&&n&&(d=this.getColor(rA))),s.classList.toggle("tab-border-top",!!d),s.style.setProperty("--tab-border-top-color",d??"")}doRedrawTabDirty(e,t,i,s){let o=!1;if(i.isDirty()&&!i.isSaving())if(s.classList.add("dirty"),this.groupsView.partOptions.highlightModifiedTabs){let r;e&&t?r=this.getColor(nA):e&&!t?r=this.getColor(aA):!e&&t?r=this.getColor(dA):r=this.getColor(cA),r&&(o=!0,s.classList.add("dirty-border-top"),s.style.setProperty("--tab-dirty-border-top-color",r))}else s.classList.remove("dirty-border-top"),s.style.removeProperty("--tab-dirty-border-top-color");else s.classList.remove("dirty","dirty-border-top"),s.style.removeProperty("--tab-dirty-border-top-color");return o}redrawTabBorders(e,t){const s=this.tabsModel.isSticky(e)&&this.tabsModel.stickyCount===e+1,o=this.tabsModel.stickyCount!==this.tabsModel.count,r=(s&&o?this.getColor(lA):void 0)||this.getColor(zg)||this.getColor(es);t.style.borderRight=r?`1px solid ${r}`:"",t.style.outlineColor=this.getColor(Lb)||""}prepareEditorActions(e){return this.groupsView.activeGroup===this.groupView?e:{primary:this.groupsView.partOptions.alwaysShowEditorActions?e.primary:e.primary.filter(i=>i.id===yd),secondary:e.secondary}}getHeight(){return this.dimensions.used?this.dimensions.used.height:this.computeHeight()}computeHeight(){let e;return this.visible?this.groupsView.partOptions.wrapTabs&&this.tabsAndActionsContainer?.classList.contains("wrapping")?e=this.tabsAndActionsContainer.offsetHeight:e=this.tabHeight:e=0,e}layout(e,t){if(Object.assign(this.dimensions,e),this.visible){if(!this.layoutScheduler.value){const i=Jv(He(this.parent),()=>{this.doLayout(this.dimensions,this.layoutScheduler.value?.options),this.layoutScheduler.clear()});this.layoutScheduler.value={options:t,dispose:()=>i.dispose()}}t?.forceRevealActiveTab&&(this.layoutScheduler.value.options={...this.layoutScheduler.value.options,forceRevealActiveTab:!0})}return this.dimensions.used||(this.dimensions.used=new Be(e.container.width,this.computeHeight())),this.dimensions.used}doLayout(e,t){e.container!==Be.None&&e.available!==Be.None&&this.doLayoutTabs(e,t);const i=this.dimensions.used,s=this.dimensions.used=new Be(e.container.width,this.computeHeight());i&&i.height!==s.height&&this.groupView.relayout()}doLayoutTabs(e,t){this.doLayoutTabsWrapping(e)||this.doLayoutTabsNonWrapping(t)}doLayoutTabsWrapping(e){const[t,i,s,o]=Ho(this.tabsAndActionsContainer,this.tabsContainer,this.editorActionsToolbarContainer,this.tabsScrollbar),r=t.classList.contains("wrapping");let n=r;function d(l){n=l,t.classList.toggle("wrapping",n),i.style.setProperty("--last-tab-margin-right",n?`${s.offsetWidth}px`:"0");for(const h of i.children)h.classList.remove("last-in-row")}if(this.groupsView.partOptions.wrapTabs){const l=i.offsetWidth,h=i.scrollWidth,p=()=>{const g=this.getLastTab();return g?!(g.offsetWidth+s.offsetWidth-e.available.width>1):!0};(n||h>l&&p())&&d(!0),n&&(i.offsetHeight>e.available.height||h===l&&i.offsetHeight===this.tabHeight||!p())&&d(!1)}else r&&d(!1);if(n&&!r){const l=i.offsetWidth;o.setScrollDimensions({width:l,scrollWidth:l})}if(n){const l=new Map;let h,p;for(const g of i.children){const f=g,m=f.offsetTop;m!==h&&(h=m,p&&l.set(p,!0)),p=f,l.set(f,!1)}p&&l.set(p,!0);for(const[g,f]of l)g.classList.toggle("last-in-row",f)}return n}doLayoutTabsNonWrapping(e){const[t,i]=Ho(this.tabsContainer,this.tabsScrollbar),s=t.offsetWidth,o=t.scrollWidth;let r=0;if(this.tabsModel.stickyCount>0){let Y=0;switch(this.groupsView.partOptions.pinnedTabSizing){case"compact":Y=Si.TAB_WIDTH.compact;break;case"shrink":Y=Si.TAB_WIDTH.shrink;break}r=this.tabsModel.stickyCount*Y}const n=this.tabsModel.activeEditor?this.getTabAndIndex(this.tabsModel.activeEditor):void 0,[d,l]=n??[void 0,void 0];let h=this.groupsView.partOptions.pinnedTabSizing!=="normal"&&typeof l=="number"&&this.tabsModel.isSticky(l),p=s-r;this.tabsModel.stickyCount>0&&p<Si.TAB_WIDTH.fit?(t.classList.add("disable-sticky-tabs"),p=s,r=0,h=!1):t.classList.remove("disable-sticky-tabs");let g,f;!this.blockRevealActiveTab&&d&&(g=d.offsetLeft,f=d.offsetWidth);const{width:m,scrollWidth:v}=i.getScrollDimensions();i.setScrollDimensions({width:s,scrollWidth:o});const E=m!==s||v!==o;if(this.blockRevealActiveTab||typeof g!="number"||typeof f!="number"||h||!E&&!e?.forceRevealActiveTab){this.blockRevealActiveTab=!1;return}const x=i.getScrollPosition().scrollLeft,G=f<=p,W=g-r;G&&x+p<W+f?i.setScrollPosition({scrollLeft:x+(W+f-(x+p))}):(x>W||!G)&&i.setScrollPosition({scrollLeft:W})}updateTabsControlVisibility(){fe(this.tabsAndActionsContainer).classList.toggle("empty",!this.visible),!this.visible&&this.dimensions&&(this.dimensions.used=void 0)}get visible(){return this.tabsModel.count>0}getTabAndIndex(e){const t=this.tabsModel.indexOf(e),i=this.getTabAtIndex(t);if(i)return[i,t]}getTabAtIndex(e){if(e>=0)return fe(this.tabsContainer).children[e]}getLastTab(){return this.getTabAtIndex(this.tabsModel.count-1)}blockRevealActiveTabOnce(){this.blockRevealActiveTab=!0}originatesFromTabActionBar(e){let t;return na(e)?t=e.target||e.srcElement:t=e.initialTarget,!!Xl(t,"action-item","tab")}async onDrop(e,t,i){be.stop(e,!0),this.updateDropFeedback(i,!1,e,t),i.classList.remove("scroll");let s=this.tabsModel instanceof lI?t+this.groupView.stickyCount:t;const o={sticky:this.tabsModel instanceof cI&&this.tabsModel.stickyCount===s,index:s};if(this.groupTransfer.hasData(Ht.prototype)){const r=this.groupTransfer.getData(Ht.prototype);if(Array.isArray(r)&&r.length>0){const n=this.editorPartsView.getGroup(r[0].identifier);if(n){const d={index:s};this.isMoveOperation(e,n.id)||(d.mode=kn.COPY_EDITORS),this.groupsView.mergeGroup(n,this.groupView,d)}this.groupView.focus(),this.groupTransfer.clearData(Ht.prototype)}}else if(this.editorTransfer.hasData(yt.prototype)){const r=this.editorTransfer.getData(yt.prototype);if(Array.isArray(r)&&r.length>0){const n=this.editorPartsView.getGroup(r[0].identifier.groupId);if(n)for(const d of r){const l=d.identifier.editor;if(n.id!==d.identifier.groupId)continue;const h=n.getIndexOfEditor(l);n===this.groupView&&h<s&&s--,this.isMoveOperation(e,d.identifier.groupId,l)?n.moveEditor(l,this.groupView,{...o,index:s}):n.copyEditor(l,this.groupView,{...o,index:s}),s++}}this.groupView.focus(),this.editorTransfer.clearData(yt.prototype)}else if(this.treeItemsTransfer.hasData(Fs.prototype)){const r=this.treeItemsTransfer.getData(Fs.prototype);if(Array.isArray(r)&&r.length>0){const n=[];for(const d of r){const l=await this.treeViewsDragAndDropService.removeDragOperationTransfer(d.identifier);if(l){const h=await KS(l);n.push(...h.map(p=>({...p,options:{...p.options,pinned:!0,index:s}})))}}this.editorService.openEditors(n,this.groupView,{validateTrust:!0})}this.treeItemsTransfer.clearData(Fs.prototype)}else this.instantiationService.createInstance(US,{allowWorkspaceOpen:!1}).handleDrop(e,He(this.parent),()=>this.groupView,()=>this.groupView.focus(),o)}dispose(){super.dispose(),this.tabDisposables=dt(this.tabDisposables)}},Si=us,us.SCROLLBAR_SIZES={default:3,large:10},us.TAB_WIDTH={compact:38,shrink:80,fit:120},us.DRAG_OVER_OPEN_TAB_THRESHOLD=1500,us.MOUSE_WHEEL_EVENT_THRESHOLD=150,us.MOUSE_WHEEL_DISTANCE_THRESHOLD=1.5,us);Lc=Si=D([u(5,st),u(6,z),u(7,de),u(8,ot),u(9,Qe),u(10,lt),u(11,we),u(12,O),u(13,Gn),u(14,Rb),u(15,Qs),u(16,Rt)],Lc);Vb((a,e)=>{const t=a.getColor(zg);t&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title > .tabs-and-actions-container.wrapping .tabs-container > .tab {
				border-bottom: 1px solid ${t};
			}
		`);const i=a.getColor(Lb);i&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active,
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:hover  {
				outline: 1px solid;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.selected:not(.active):not(:hover)  {
				outline: 1px dotted;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:focus {
				outline-style: dashed;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active {
				outline: 1px dotted;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {
				outline: 1px dashed;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active:hover > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.dirty > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.sticky > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-actions .action-label {
				opacity: 1 !important;
			}
		`);const s=a.getColor(es);s&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .editor-actions {
				outline: 1px solid ${s}
			}
		`);const o=a.getColor(uA);o&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:not(.selected):hover {
				background-color: ${o} !important;
			}
		`);const r=a.getColor(pA);r&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:not(.selected):hover  {
				background-color: ${r} !important;
			}
		`);const n=a.getColor(gA);n&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:not(.selected):hover  {
				color: ${n} !important;
			}
		`);const d=a.getColor(fA);d&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:not(.selected):hover  {
				color: ${d} !important;
			}
		`);const l=a.getColor(mA);l&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover > .tab-border-bottom-container {
				display: block;
				position: absolute;
				left: 0;
				pointer-events: none;
				width: 100%;
				z-index: 10;
				bottom: 0;
				height: 1px;
				background-color: ${l};
			}
		`);const h=a.getColor(wA);if(h&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-border-bottom-container  {
				display: block;
				position: absolute;
				left: 0;
				pointer-events: none;
				width: 100%;
				z-index: 10;
				bottom: 0;
				height: 1px;
				background-color: ${h};
			}
		`),!WS(a.type)&&!Pb&&!i){const p=HS(a),g=a.getColor(Ob),f=a.getColor(zS),m=a.getColor(pb);let v;f&&g&&(v=f.flatten(g,g,p));let E;f&&g&&m&&g&&(E=f.flatten(g,m,g,p));const x=(ie,q,ae=!1)=>`
			.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${ae?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,
			.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${ae?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {
				background: linear-gradient(to left, ${ie}, transparent) !important;
			}

			.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${ae?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,
			.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${ae?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {
				background: linear-gradient(to left, ${q}, transparent) !important;
			}
		`;if(o&&v&&E){const ie=o.flatten(v),q=o.flatten(E);e.addRule(x(ie,q,!0))}if(r&&v&&E){const ie=r.flatten(v),q=r.flatten(E);e.addRule(x(ie,q))}if(m&&E){const ie=m.flatten(E);e.addRule(`
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${ie}, transparent) !important;
				}
		`)}const G=(ie,q,ae,$e)=>`
				.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${ae?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${$e?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${ae?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${$e?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${ie}, transparent);
				}

				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${ae?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${$e?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${ae?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${$e?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${q}, transparent);
				}
		`,W=a.getColor(bA);if(W&&v&&E){const ie=W.flatten(v),q=W.flatten(E);e.addRule(G(ie,q,!0,!0))}const Y=a.getColor(vA);if(Y&&v&&E){const ie=Y.flatten(v),q=Y.flatten(E);e.addRule(G(ie,q,!1,!0))}const $=a.getColor(yA);if($&&v&&E){const ie=$.flatten(v),q=$.flatten(E);e.addRule(G(ie,q,!0,!1))}const H=a.getColor(CA);if(H&&v&&E){const ie=H.flatten(v),q=H.flatten(E);e.addRule(G(ie,q,!1,!1))}}});const hI=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));xe(hI);class BO extends Tc{constructor(){super(...arguments),this.activeLabel=Object.create(null)}get breadcrumbsControl(){return this.breadcrumbsControlFactory?.control}create(e){super.create(e);const t=this.titleContainer=e;t.draggable=!0,this.registerContainerListeners(t),this._register(wc.addTarget(t));const i=N(".label-container");return t.appendChild(i),this.editorLabel=this._register(this.instantiationService.createInstance(SA,i,{})).element,this._register(X(this.editorLabel.element,Q.CLICK,s=>this.onTitleLabelClick(s))),this.breadcrumbsControlFactory=this._register(this.instantiationService.createInstance(ph,i,this.groupView,{showFileIcons:!1,showSymbolIcons:!0,showDecorationColors:!1,widgetStyles:{...yS,breadcrumbsBackground:ki.transparent.toString()},showPlaceholder:!1,dragEditor:!0})),this._register(this.breadcrumbsControlFactory.onDidEnablementChange(()=>this.handleBreadcrumbsEnablementChange())),t.classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this._register(pe(()=>t.classList.remove("breadcrumbs"))),this.createEditorActionsToolBar(t,["title-actions"]),t}registerContainerListeners(e){let t,i=!1;this._register(new vc(e,{onDragStart:s=>{i=this.onGroupDragStart(s,e)},onDrag:s=>{t=s},onDragEnd:s=>{this.onGroupDragEnd(s,t,e,i)}})),this._register(X(e,Q.DBLCLICK,s=>this.onTitleDoubleClick(s))),this._register(X(e,Q.AUXCLICK,s=>this.onTitleAuxClick(s))),this._register(X(e,ji.Tap,s=>this.onTitleTap(s)));for(const s of[Q.CONTEXT_MENU,ji.Contextmenu])this._register(X(e,s,o=>{this.tabsModel.activeEditor&&this.onTabContextMenu(this.tabsModel.activeEditor,o,e)}))}onTitleLabelClick(e){be.stop(e,!1),setTimeout(()=>this.quickInputService.quickAccess.show())}onTitleDoubleClick(e){be.stop(e),this.groupView.pinEditor()}onTitleAuxClick(e){e.button===1&&this.tabsModel.activeEditor&&(be.stop(e,!0),BS(this.tabsModel,this.tabsModel.activeEditor,GS.MOUSE,this.groupsView.partOptions)||this.groupView.closeEditor(this.tabsModel.activeEditor))}onTitleTap(e){const t=e.initialTarget;!Ln(t)||!this.editorLabel||!Ja(t,this.editorLabel.element)||setTimeout(()=>this.quickInputService.quickAccess.show(),50)}openEditor(e){return this.doHandleOpenEditor()}openEditors(e){return this.doHandleOpenEditor()}doHandleOpenEditor(){const e=this.ifActiveEditorChanged(()=>this.redraw());return e||this.ifActiveEditorPropertiesChanged(()=>this.redraw()),e}beforeCloseEditor(e){}closeEditor(e){this.ifActiveEditorChanged(()=>this.redraw())}closeEditors(e){this.ifActiveEditorChanged(()=>this.redraw())}moveEditor(e,t,i){this.ifActiveEditorChanged(()=>this.redraw())}pinEditor(e){this.ifEditorIsActive(e,()=>this.redraw())}stickEditor(e){}unstickEditor(e){}setActive(e){this.redraw()}updateEditorSelections(){}updateEditorLabel(e){this.ifEditorIsActive(e,()=>this.redraw())}updateEditorDirty(e){this.ifEditorIsActive(e,()=>{const t=fe(this.titleContainer);e.isDirty()&&!e.isSaving()?t.classList.add("dirty"):t.classList.remove("dirty")})}updateOptions(e,t){super.updateOptions(e,t),(e.labelFormat!==t.labelFormat||!Sp(e.decorations,t.decorations))&&this.redraw()}updateStyles(){this.redraw()}handleBreadcrumbsEnablementChange(){fe(this.titleContainer).classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this.redraw()}ifActiveEditorChanged(e){return!this.activeLabel.editor&&this.tabsModel.activeEditor||this.activeLabel.editor&&!this.tabsModel.activeEditor||!this.activeLabel.editor||!this.tabsModel.isActive(this.activeLabel.editor)?(e(),!0):!1}ifActiveEditorPropertiesChanged(e){!this.activeLabel.editor||!this.tabsModel.activeEditor||this.activeLabel.pinned!==this.tabsModel.isPinned(this.tabsModel.activeEditor)&&e()}ifEditorIsActive(e,t){this.tabsModel.isActive(e)&&t()}redraw(){const e=this.tabsModel.activeEditor??void 0,t=this.groupsView.partOptions,i=e?this.tabsModel.isPinned(e):!1,s=this.groupsView.activeGroup===this.groupView;this.activeLabel={editor:e,pinned:i},this.breadcrumbsControl&&(s?(this.breadcrumbsControl.update(),this.breadcrumbsControl.domNode.classList.toggle("preview",!i)):this.breadcrumbsControl.hide());const[o,r]=Ho(this.titleContainer,this.editorLabel);if(!e)o.classList.remove("dirty"),r.clear(),this.clearEditorActionsToolbar();else{this.updateEditorDirty(e);const{labelFormat:n}=this.groupsView.partOptions;let d;this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()||n==="default"&&!s?d="":d=e.getDescription(this.getVerbosity(n))||"",r.setResource({resource:Ue.getOriginalUri(e,{supportSideBySide:Le.BOTH}),name:e.getName(),description:d},{title:this.getHoverTitle(e),italic:!i,extraClasses:["single-tab","title-label"].concat(e.getLabelExtraClasses()),fileDecorations:{colors:!!t.decorations?.colors,badges:!!t.decorations?.badges},icon:e.getIcon(),hideIcon:t.showIcons===!1}),s?o.style.color=this.getColor(EA)||"":o.style.color=this.getColor(_A)||"",this.updateEditorActionsToolbar()}}getVerbosity(e){switch(e){case"short":return ds.SHORT;case"long":return ds.LONG;default:return ds.MEDIUM}}prepareEditorActions(e){return this.groupsView.activeGroup===this.groupView?e:{primary:this.groupsView.partOptions.alwaysShowEditorActions?e.primary:e.primary.filter(i=>i.id===to||i.id===yd),secondary:e.secondary}}getHeight(){return this.tabHeight}layout(e){return this.breadcrumbsControl?.layout(void 0),new Be(e.container.width,this.getHeight())}}let $f=class extends M{constructor(e,t,i,s,o,r){super(),this.parent=e,this.groupsView=i,this.groupView=s,this.model=o,this.instantiationService=r;const n=this._register(new cI(this.model)),d=this._register(new lI(this.model));this.stickyEditorTabsControl=this._register(this.instantiationService.createInstance(Lc,this.parent,t,this.groupsView,this.groupView,n)),this.unstickyEditorTabsControl=this._register(this.instantiationService.createInstance(Lc,this.parent,t,this.groupsView,this.groupView,d)),this.handleTabBarsStateChange()}handleTabBarsStateChange(){this.activeControl=this.model.activeEditor?this.getEditorTabsController(this.model.activeEditor):void 0,this.handleTabBarsLayoutChange()}handleTabBarsLayoutChange(){if(this.groupView.count===0)return;const e=this.parent.classList.contains("two-tab-bars"),t=this.groupView.count!==this.groupView.stickyCount&&this.groupView.stickyCount>0;this.parent.classList.toggle("two-tab-bars",t),e!==t&&this.groupView.relayout()}didActiveControlChange(){return this.activeControl!==(this.model.activeEditor?this.getEditorTabsController(this.model.activeEditor):void 0)}getEditorTabsController(e){return this.model.isSticky(e)?this.stickyEditorTabsControl:this.unstickyEditorTabsControl}openEditor(e,t){const i=this.didActiveControlChange(),o=this.getEditorTabsController(e).openEditor(e,t)||i;return o&&this.handleOpenedEditors(),o}openEditors(e){const t=e.filter(d=>this.model.isSticky(d)),i=e.filter(d=>!this.model.isSticky(d)),s=this.didActiveControlChange(),o=this.stickyEditorTabsControl.openEditors(t),r=this.unstickyEditorTabsControl.openEditors(i),n=o||r||s;return n&&this.handleOpenedEditors(),n}handleOpenedEditors(){this.handleTabBarsStateChange()}beforeCloseEditor(e){this.getEditorTabsController(e).beforeCloseEditor(e)}closeEditor(e){this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.closeEditor(e),this.handleClosedEditors()}closeEditors(e){const t=e.filter(s=>this.model.isSticky(s)),i=e.filter(s=>!this.model.isSticky(s));this.stickyEditorTabsControl.closeEditors(t),this.unstickyEditorTabsControl.closeEditors(i),this.handleClosedEditors()}handleClosedEditors(){this.handleTabBarsStateChange()}moveEditor(e,t,i,s){s?(this.model.isSticky(e)?(this.stickyEditorTabsControl.openEditor(e),this.unstickyEditorTabsControl.closeEditor(e)):(this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.openEditor(e)),this.handleTabBarsStateChange()):this.model.isSticky(e)?this.stickyEditorTabsControl.moveEditor(e,t,i,s):this.unstickyEditorTabsControl.moveEditor(e,t-this.model.stickyCount,i-this.model.stickyCount,s)}pinEditor(e){this.getEditorTabsController(e).pinEditor(e)}stickEditor(e){this.unstickyEditorTabsControl.closeEditor(e),this.stickyEditorTabsControl.openEditor(e),this.handleTabBarsStateChange()}unstickEditor(e){this.stickyEditorTabsControl.closeEditor(e),this.unstickyEditorTabsControl.openEditor(e),this.handleTabBarsStateChange()}setActive(e){this.stickyEditorTabsControl.setActive(e),this.unstickyEditorTabsControl.setActive(e)}updateEditorSelections(){this.stickyEditorTabsControl.updateEditorSelections(),this.unstickyEditorTabsControl.updateEditorSelections()}updateEditorLabel(e){this.getEditorTabsController(e).updateEditorLabel(e)}updateEditorDirty(e){this.getEditorTabsController(e).updateEditorDirty(e)}updateOptions(e,t){this.stickyEditorTabsControl.updateOptions(e,t),this.unstickyEditorTabsControl.updateOptions(e,t)}layout(e){const t=this.stickyEditorTabsControl.layout(e),i={container:e.container,available:new Be(e.available.width,e.available.height-t.height)},s=this.unstickyEditorTabsControl.layout(i);return new Be(e.container.width,t.height+s.height)}getHeight(){return this.stickyEditorTabsControl.getHeight()+this.unstickyEditorTabsControl.getHeight()}dispose(){this.parent.classList.toggle("two-tab-bars",!1),super.dispose()}};$f=D([u(5,z)],$f);xe(hI);class GO extends Tc{constructor(){super(...arguments),this.activeEditor=null}prepareEditorActions(e){return{primary:[],secondary:[]}}openEditor(e){return this.handleOpenedEditors()}openEditors(e){return this.handleOpenedEditors()}handleOpenedEditors(){const e=this.activeEditorChanged();return this.activeEditor=this.tabsModel.activeEditor,e}activeEditorChanged(){return!!(!this.activeEditor&&this.tabsModel.activeEditor||this.activeEditor&&!this.tabsModel.activeEditor||!this.activeEditor||!this.tabsModel.isActive(this.activeEditor))}beforeCloseEditor(e){}closeEditor(e){this.handleClosedEditors()}closeEditors(e){this.handleClosedEditors()}handleClosedEditors(){this.activeEditor=this.tabsModel.activeEditor}moveEditor(e,t,i){}pinEditor(e){}stickEditor(e){}unstickEditor(e){}setActive(e){}updateEditorSelections(){}updateEditorLabel(e){}updateEditorDirty(e){}getHeight(){return 0}layout(e){return new Be(e.container.width,this.getHeight())}}xe(CV);let qf=class extends Yc{get breadcrumbsControl(){return this.breadcrumbsControlFactory?.control}constructor(e,t,i,s,o,r,n){super(n),this.parent=e,this.editorPartsView=t,this.groupsView=i,this.groupView=s,this.model=o,this.instantiationService=r,this.editorTabsControlDisposable=this._register(new B),this.breadcrumbsControlDisposables=this._register(new B),this.editorTabsControl=this.createEditorTabsControl(),this.breadcrumbsControlFactory=this.createBreadcrumbsControl()}createEditorTabsControl(){let e;switch(this.groupsView.partOptions.showTabs){case"none":e=GO;break;case"single":e=BO;break;default:e=this.groupsView.partOptions.pinnedTabsOnSeparateRow?$f:Lc;break}const t=this.instantiationService.createInstance(e,this.parent,this.editorPartsView,this.groupsView,this.groupView,this.model);return this.editorTabsControlDisposable.add(t)}createBreadcrumbsControl(){if(this.groupsView.partOptions.showTabs==="single")return;const e=N(".breadcrumbs-below-tabs");this.parent.appendChild(e);const t=this.breadcrumbsControlDisposables.add(this.instantiationService.createInstance(ph,e,this.groupView,{showFileIcons:!0,showSymbolIcons:!0,showDecorationColors:!1,showPlaceholder:!0,dragEditor:!1}));return this.breadcrumbsControlDisposables.add(t.onDidEnablementChange(()=>this.groupView.relayout())),this.breadcrumbsControlDisposables.add(t.onDidVisibilityChange(()=>this.groupView.relayout())),t}openEditor(e,t){const i=this.editorTabsControl.openEditor(e,t);this.handleOpenedEditors(i)}openEditors(e){const t=this.editorTabsControl.openEditors(e);this.handleOpenedEditors(t)}handleOpenedEditors(e){e?this.breadcrumbsControl?.update():this.breadcrumbsControl?.revealLast()}beforeCloseEditor(e){return this.editorTabsControl.beforeCloseEditor(e)}closeEditor(e){this.editorTabsControl.closeEditor(e),this.handleClosedEditors()}closeEditors(e){this.editorTabsControl.closeEditors(e),this.handleClosedEditors()}handleClosedEditors(){this.groupView.activeEditor||this.breadcrumbsControl?.update()}moveEditor(e,t,i,s){return this.editorTabsControl.moveEditor(e,t,i,s)}pinEditor(e){return this.editorTabsControl.pinEditor(e)}stickEditor(e){return this.editorTabsControl.stickEditor(e)}unstickEditor(e){return this.editorTabsControl.unstickEditor(e)}setActive(e){return this.editorTabsControl.setActive(e)}updateEditorSelections(){this.editorTabsControl.updateEditorSelections()}updateEditorLabel(e){return this.editorTabsControl.updateEditorLabel(e)}updateEditorDirty(e){return this.editorTabsControl.updateEditorDirty(e)}updateOptions(e,t){e.showTabs!==t.showTabs||t.showTabs!=="single"&&e.pinnedTabsOnSeparateRow!==t.pinnedTabsOnSeparateRow?(this.editorTabsControlDisposable.clear(),this.breadcrumbsControlDisposables.clear(),Ut(this.parent),this.editorTabsControl=this.createEditorTabsControl(),this.breadcrumbsControlFactory=this.createBreadcrumbsControl()):this.editorTabsControl.updateOptions(e,t)}layout(e){const t=this.editorTabsControl.layout(e);let i;return this.breadcrumbsControl?.isHidden()===!1&&(i=new Be(e.container.width,We.HEIGHT),this.breadcrumbsControl.layout(i)),new Be(e.container.width,t.height+(i?i.height:0))}getHeight(){const e=this.editorTabsControl.getHeight(),t=this.breadcrumbsControl?.isHidden()===!1?We.HEIGHT:0;return{total:e+t,offset:e}}};qf=D([u(5,z),u(6,we)],qf);var Go;xe(nV);let ca=Go=class extends Yc{static createNew(e,t,i,s,o,r){return o.createInstance(Go,null,e,t,i,s,r)}static createFromSerialized(e,t,i,s,o,r,n){return r.createInstance(Go,e,t,i,s,o,n)}static createCopy(e,t,i,s,o,r,n){return r.createInstance(Go,e,t,i,s,o,n)}constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m,v,E,x,G,W,Y,$,H){super(l),this.editorPartsView=t,this.groupsView=i,this.groupsLabel=s,this._index=o,this.instantiationService=n,this.contextKeyService=d,this.telemetryService=h,this.keybindingService=p,this.menuService=g,this.contextMenuService=f,this.fileDialogService=m,this.editorService=v,this.filesConfigurationService=E,this.uriIdentityService=x,this.logService=G,this.editorResolverService=W,this.hostService=Y,this.dialogService=$,this.fileService=H,this._onDidFocus=this._register(new A),this.onDidFocus=this._onDidFocus.event,this._onWillDispose=this._register(new A),this.onWillDispose=this._onWillDispose.event,this._onDidModelChange=this._register(new A),this.onDidModelChange=this._onDidModelChange.event,this._onDidActiveEditorChange=this._register(new A),this.onDidActiveEditorChange=this._onDidActiveEditorChange.event,this._onDidOpenEditorFail=this._register(new A),this.onDidOpenEditorFail=this._onDidOpenEditorFail.event,this._onWillCloseEditor=this._register(new A),this.onWillCloseEditor=this._onWillCloseEditor.event,this._onDidCloseEditor=this._register(new A),this.onDidCloseEditor=this._onDidCloseEditor.event,this._onWillMoveEditor=this._register(new A),this.onWillMoveEditor=this._onWillMoveEditor.event,this._onWillOpenEditor=this._register(new A),this.onWillOpenEditor=this._onWillOpenEditor.event,this.disposedEditorsWorker=this._register(new $S(q=>this.handleDisposedEditors(q),0)),this.mapEditorToPendingConfirmation=new Map,this.containerToolBarMenuDisposable=this._register(new Ae),this.whenRestoredPromise=new pr,this.whenRestored=this.whenRestoredPromise.p,this._disposed=!1,this.element=N("div"),this._onDidChange=this._register(new Co),this.onDidChange=this._onDidChange.event,e instanceof Go?this.model=this._register(e.model.clone()):qS(e)?this.model=this._register(n.createInstance(Zv,e)):this.model=this._register(n.createInstance(Zv,void 0)),this.scopedContextKeyService=this._register(this.contextKeyService.createScoped(this.element)),this.element.classList.add(...Mi(["editor-group-container",this.model.isLocked?"locked":void 0])),this.registerContainerListeners(),this.createContainerToolbar(),this.createContainerContextMenu(),this._register(this.instantiationService.createInstance(bf,this.element)),this.progressBar=this._register(new jC(this.element,YC)),this.progressBar.hide(),this.scopedInstantiationService=this._register(this.instantiationService.createChild(new _n([de,this.scopedContextKeyService],[ub,this._register(new IA(this.progressBar,this))]))),this.resourceContext=this._register(this.scopedInstantiationService.createInstance(kS)),this.handleGroupContextKeys(),this.titleContainer=N(".title"),this.element.appendChild(this.titleContainer),this.titleControl=this._register(this.scopedInstantiationService.createInstance(qf,this.titleContainer,this.editorPartsView,this.groupsView,this,this.model)),this.editorContainer=N(".editor-container"),this.element.appendChild(this.editorContainer),this.editorPane=this._register(this.scopedInstantiationService.createInstance(wf,this.element,this.editorContainer,this)),this._onDidChange.input=this.editorPane.onDidChangeSizeConstraints,this.doTrackFocus(),this.updateTitleContainer(),this.updateContainer(),this.updateStyles(),(this.restoreEditors(e,r)??Promise.resolve()).finally(()=>{this.whenRestoredPromise.complete()}),this.registerListeners()}handleGroupContextKeys(){const e=this.editorPartsView.bind(Zc,this),t=this.editorPartsView.bind(Tb,this),i=this.editorPartsView.bind(xS,this),s=this.editorPartsView.bind(Cp,this),o=this.editorPartsView.bind(qs,this),r=this.editorPartsView.bind(jS,this),n=this.editorPartsView.bind($s,this),d=Qc.bindTo(this.scopedContextKeyService),l=DA.bindTo(this.scopedContextKeyService),h=AA.bindTo(this.scopedContextKeyService),p=this.editorPartsView.bind(NS,this),g=this.editorPartsView.bind(TA,this),f=this.editorPartsView.bind(kA,this),m=this.editorPartsView.bind(xA,this),v=this.editorPartsView.bind(Eb,this),E=this.editorPartsView.bind(Ug,this),x=this.editorPartsView.bind(Ri,this),G=this.editorPartsView.bind(hd,this),W=this.editorPartsView.bind(Br,this),Y=this.editorPartsView.bind(gi,this),$=this._register(new Ae),H=()=>{$.clear(),this.scopedContextKeyService.bufferChangeEvents(()=>{const q=this.activeEditor,ae=this.activeEditorPane;if(this.resourceContext.set(Ue.getOriginalUri(q,{supportSideBySide:Le.PRIMARY})),VS(G,q,this.editorResolverService),q?(W.set(q.hasCapability(Xt.CanSplitInGroup)),Y.set(q.typeId===Zt.ID),e.set(q.isDirty()&&!q.isSaving()),$.value=q.onDidChangeDirty(()=>{e.set(q.isDirty()&&!q.isSaving())})):(W.set(!1),Y.set(!1),e.set(!1)),ae){p.set(ae.getId()),f.set(!ae.input.hasCapability(Xt.Untitled)),g.set(!!ae.input.isReadonly());const $e=Ue.getOriginalUri(ae.input,{supportSideBySide:Le.PRIMARY}),vt=Ue.getOriginalUri(ae.input,{supportSideBySide:Le.SECONDARY});v.set(ae.input instanceof Jt&&!ae.input.original.isReadonly()&&!!$e&&(this.fileService.hasProvider($e)||$e.scheme===ue.untitled)&&!!vt&&(this.fileService.hasProvider(vt)||vt.scheme===ue.untitled)),m.set(!!$e&&this.fileService.hasProvider($e)&&!this.fileService.hasCapability($e,vb.Readonly));const Ci=ae?.getId()===_S;x.set(Ci),E.set(Ci)}else p.reset(),f.reset(),g.reset(),v.reset(),m.reset()})},ie=q=>{switch(q.kind){case ut.GROUP_LOCKED:n.set(this.isLocked);break;case ut.EDITOR_ACTIVE:i.set(this.model.isFirst(this.model.activeEditor)),s.set(this.model.isLast(this.model.activeEditor)),t.set(this.model.activeEditor?this.model.isPinned(this.model.activeEditor):!1),o.set(this.model.activeEditor?this.model.isSticky(this.model.activeEditor):!1);break;case ut.EDITOR_CLOSE:t.set(this.model.activeEditor?this.model.isPinned(this.model.activeEditor):!1),o.set(this.model.activeEditor?this.model.isSticky(this.model.activeEditor):!1);break;case ut.EDITOR_OPEN:case ut.EDITOR_MOVE:i.set(this.model.isFirst(this.model.activeEditor)),s.set(this.model.isLast(this.model.activeEditor));break;case ut.EDITOR_PIN:q.editor&&q.editor===this.model.activeEditor&&t.set(this.model.isPinned(this.model.activeEditor));break;case ut.EDITOR_STICKY:q.editor&&q.editor===this.model.activeEditor&&o.set(this.model.isSticky(this.model.activeEditor));break;case ut.EDITORS_SELECTION:d.set(this.model.selectedEditors.length>1),l.set(this.model.selectedEditors.length===2),h.set(this.model.selectedEditors.every(ae=>ae.resource&&(this.fileService.hasProvider(ae.resource)||ae.resource.scheme===ue.untitled)));break}r.set(this.count)};this._register(this.onDidModelChange(q=>ie(q))),this._register(this.onDidActiveEditorChange(()=>H())),H(),ie({kind:ut.EDITOR_ACTIVE}),ie({kind:ut.GROUP_LOCKED})}registerContainerListeners(){this._register(X(this.element,Q.DBLCLICK,e=>{this.isEmpty&&(be.stop(e),this.editorService.openEditor({resource:void 0,options:{pinned:!0,override:Mt.id}},this.id))})),this._register(X(this.element,Q.AUXCLICK,e=>{this.isEmpty&&e.button===1&&(be.stop(e,!0),this.groupsView.removeGroup(this))}))}createContainerToolbar(){const e=N(".editor-group-container-toolbar");this.element.appendChild(e);const t=this._register(new Sr(e,{ariaLabel:c(3407,"Empty editor group actions"),highlightToggledItems:!0})),i=this._register(this.menuService.createMenu(b.EmptyEditorGroup,this.scopedContextKeyService)),s=()=>{this.containerToolBarMenuDisposable.value=pe(()=>t.clear());const o=Ng(i.getActions({arg:{groupId:this.id},shouldForwardArgs:!0}),"navigation");for(const r of[...o.primary,...o.secondary]){const n=this.keybindingService.lookupKeybinding(r.id);t.push(r,{icon:!0,label:!1,keybinding:n?.getLabel()})}};s(),this._register(i.onDidChange(s))}createContainerContextMenu(){this._register(X(this.element,Q.CONTEXT_MENU,e=>this.onShowContainerContextMenu(e))),this._register(X(this.element,ji.Contextmenu,()=>this.onShowContainerContextMenu()))}onShowContainerContextMenu(e){if(!this.isEmpty)return;let t=this.element;e&&(t=new uo(He(this.element),e)),this.contextMenuService.showContextMenu({menuId:b.EmptyEditorGroupContext,contextKeyService:this.contextKeyService,getAnchor:()=>t,onHide:()=>this.focus()})}doTrackFocus(){const e=this._register(Eo(this.element));this._register(e.onDidFocus(()=>{this.isEmpty&&this._onDidFocus.fire()}));const t=i=>{let s;if(na(i)){if(i.button!==0||Ge&&i.ctrlKey)return;s=i.target}else s=i.initialTarget;Xl(s,"monaco-action-bar",this.titleContainer)||Xl(s,"monaco-breadcrumb-item",this.titleContainer)||setTimeout(()=>{this.focus()})};this._register(X(this.titleContainer,Q.MOUSE_DOWN,i=>t(i))),this._register(X(this.titleContainer,ji.Tap,i=>t(i))),this._register(this.editorPane.onDidFocus(()=>{this._onDidFocus.fire()}))}updateContainer(){this.isEmpty?(this.element.classList.add("empty"),this.element.tabIndex=0,this.element.setAttribute("aria-label",c(3408,"{0} (empty)",this.ariaLabel))):(this.element.classList.remove("empty"),this.element.removeAttribute("tabIndex"),this.element.removeAttribute("aria-label")),this.updateStyles()}updateTitleContainer(){this.titleContainer.classList.toggle("tabs",this.groupsView.partOptions.showTabs==="multiple"),this.titleContainer.classList.toggle("show-file-icons",this.groupsView.partOptions.showIcons)}restoreEditors(e,t){if(this.count===0)return;let i;e instanceof Go?i=Qv(e):i=Object.create(null);const s=this.model.activeEditor;if(!s)return;i.pinned=this.model.isPinned(s),i.sticky=this.model.isSticky(s),i.preserveFocus=!0;const o={preserveWindowOrder:!0,skipTitleUpdate:!0},r=Hs(),n=this.doShowEditor(s,{active:!0,isNew:!1},i,o).then(()=>{this.groupsView.activeGroup===this&&r&&Jl(r)&&!t?.preserveFocus&&this.focus()});return this.titleControl.openEditors(this.editors),n}registerListeners(){this._register(this.model.onDidModelChange(e=>this.onDidGroupModelChange(e))),this._register(this.groupsView.onDidChangeEditorPartOptions(e=>this.onDidChangeEditorPartOptions(e))),this._register(this.groupsView.onDidVisibilityChange(e=>this.onDidVisibilityChange(e))),this._register(this.onDidFocus(()=>this.onDidGainFocus()))}onDidGroupModelChange(e){switch(this._onDidModelChange.fire(e),e.kind){case ut.GROUP_LOCKED:this.element.classList.toggle("locked",this.isLocked);break;case ut.EDITORS_SELECTION:this.onDidChangeEditorSelection();break}if(e.editor)switch(e.kind){case ut.EDITOR_OPEN:RA(e)&&this.onDidOpenEditor(e.editor,e.editorIndex);break;case ut.EDITOR_CLOSE:LA(e)&&this.handleOnDidCloseEditor(e.editor,e.editorIndex,e.context,e.sticky);break;case ut.EDITOR_WILL_DISPOSE:this.onWillDisposeEditor(e.editor);break;case ut.EDITOR_DIRTY:this.onDidChangeEditorDirty(e.editor);break;case ut.EDITOR_TRANSIENT:this.onDidChangeEditorTransient(e.editor);break;case ut.EDITOR_LABEL:this.onDidChangeEditorLabel(e.editor);break}}onDidOpenEditor(e,t){this.telemetryService.publicLog("editorOpened",this.toEditorTelemetryDescriptor(e)),this.updateContainer()}handleOnDidCloseEditor(e,t,i,s){this._onWillCloseEditor.fire({groupId:this.id,editor:e,context:i,index:t,sticky:s});const o=[e];e instanceof Zt&&o.push(e.primary,e.secondary);for(const r of o)this.canDispose(r)&&r.dispose();this.updateContainer(),this._onDidCloseEditor.fire({groupId:this.id,editor:e,context:i,index:t,sticky:s})}canDispose(e){for(const t of this.editorPartsView.groups)if(t instanceof Go&&t.model.contains(e,{strictEquals:!0,supportSideBySide:Le.ANY}))return!1;return!0}toResourceTelemetryDescriptor(e){if(!e)return;const t=e?e.scheme===ue.file?e.fsPath:e.path:void 0;if(!t)return;let i=Yi(e);const s=i.indexOf("?");return i=s!==-1?i.substr(0,s):i,{mimeType:new YS(VA(e).join(", ")),scheme:e.scheme,ext:i,path:Ep(t)}}toEditorTelemetryDescriptor(e){const t=e.getTelemetryDescriptor(),i=Ue.getOriginalUri(e,{supportSideBySide:Le.BOTH});return F.isUri(i)?(t.resource=this.toResourceTelemetryDescriptor(i),t):(i&&(i.primary&&(t.resource=this.toResourceTelemetryDescriptor(i.primary)),i.secondary&&(t.resourceSecondary=this.toResourceTelemetryDescriptor(i.secondary))),t)}onWillDisposeEditor(e){this.disposedEditorsWorker.work(e)}handleDisposedEditors(e){let t;const i=[];for(const s of e){const o=this.model.findEditor(s);if(!o)continue;const r=o[0];r.isDisposed()&&(this.model.isActive(r)?t=r:i.push(r))}for(const s of i)this.doCloseEditor(s,!0);t&&this.doCloseEditor(t,!0)}onDidChangeEditorPartOptions(e){this.updateTitleContainer(),this.titleControl.updateOptions(e.oldPartOptions,e.newPartOptions),(e.oldPartOptions.showTabs!==e.newPartOptions.showTabs||e.oldPartOptions.tabHeight!==e.newPartOptions.tabHeight||e.oldPartOptions.showTabs==="multiple"&&e.oldPartOptions.pinnedTabsOnSeparateRow!==e.newPartOptions.pinnedTabsOnSeparateRow)&&(this.relayout(),this.model.activeEditor&&this.titleControl.openEditors(this.model.getEditors(Ie.SEQUENTIAL))),this.updateStyles(),e.oldPartOptions.enablePreview&&!e.newPartOptions.enablePreview&&this.model.previewEditor&&this.pinEditor(this.model.previewEditor)}onDidChangeEditorDirty(e){this.pinEditor(e),this.titleControl.updateEditorDirty(e)}onDidChangeEditorTransient(e){!this.model.isTransient(e)&&!this.groupsView.partOptions.enablePreview&&this.pinEditor(e)}onDidChangeEditorLabel(e){this.titleControl.updateEditorLabel(e)}onDidChangeEditorSelection(){this.titleControl.updateEditorSelections()}onDidVisibilityChange(e){this.editorPane.setVisible(e)}onDidGainFocus(){this.activeEditor&&this.model.setTransient(this.activeEditor,!1)}get index(){return this._index}get label(){return this.groupsLabel?c(3409,"{0}: Group {1}",this.groupsLabel,this._index+1):c(3410,"Group {0}",this._index+1)}get ariaLabel(){return this.groupsLabel?c(3411,"{0}: Editor Group {1}",this.groupsLabel,this._index+1):c(3412,"Editor Group {0}",this._index+1)}get disposed(){return this._disposed}get isEmpty(){return this.count===0}get titleHeight(){return this.titleControl.getHeight()}notifyIndexChanged(e){this._index!==e&&(this._index=e,this.model.setIndex(e))}notifyLabelChanged(e){this.groupsLabel!==e&&(this.groupsLabel=e,this.model.setLabel(e))}setActive(e){this.active=e,!e&&this.activeEditor&&this.selectedEditors.length>1&&this.setSelection(this.activeEditor,[]),this.element.classList.toggle("active",e),this.element.classList.toggle("inactive",!e),this.titleControl.setActive(e),this.updateStyles(),this.model.setActive(void 0)}get id(){return this.model.id}get windowId(){return this.groupsView.windowId}get editors(){return this.model.getEditors(Ie.SEQUENTIAL)}get count(){return this.model.count}get stickyCount(){return this.model.stickyCount}get activeEditorPane(){return this.editorPane?this.editorPane.activeEditorPane??void 0:void 0}get activeEditor(){return this.model.activeEditor}get selectedEditors(){return this.model.selectedEditors}get previewEditor(){return this.model.previewEditor}isPinned(e){return this.model.isPinned(e)}isSticky(e){return this.model.isSticky(e)}isSelected(e){return this.model.isSelected(e)}isTransient(e){return this.model.isTransient(e)}isActive(e){return this.model.isActive(e)}async setSelection(e,t){this.isActive(e)?this.model.setSelection(e,t):await this.openEditor(e,{activation:ho.ACTIVATE},{inactiveSelection:t})}contains(e,t){return this.model.contains(e,t)}getEditors(e,t){return this.model.getEditors(e,t)}findEditors(e,t){const i=this.uriIdentityService.asCanonicalUri(e);return this.getEditors(t?.order??Ie.SEQUENTIAL).filter(s=>{if(s.resource&&qe(s.resource,i))return!0;if(t?.supportSideBySide===Le.PRIMARY||t?.supportSideBySide===Le.ANY){const o=Ue.getCanonicalUri(s,{supportSideBySide:Le.PRIMARY});if(o&&qe(o,i))return!0}if(t?.supportSideBySide===Le.SECONDARY||t?.supportSideBySide===Le.ANY){const o=Ue.getCanonicalUri(s,{supportSideBySide:Le.SECONDARY});if(o&&qe(o,i))return!0}return!1})}getEditorByIndex(e){return this.model.getEditorByIndex(e)}getIndexOfEditor(e){return this.model.indexOf(e)}isFirst(e){return this.model.isFirst(e)}isLast(e){return this.model.isLast(e)}focus(){this.activeEditorPane?this.activeEditorPane.focus():this.element.focus(),this._onDidFocus.fire()}pinEditor(e=this.activeEditor||void 0){if(e&&!this.model.isPinned(e)){const t=this.model.pin(e);t&&this.titleControl.pinEditor(t)}}stickEditor(e=this.activeEditor||void 0){this.doStickEditor(e,!0)}unstickEditor(e=this.activeEditor||void 0){this.doStickEditor(e,!1)}doStickEditor(e,t){if(e&&this.model.isSticky(e)!==t){const i=this.getIndexOfEditor(e),s=t?this.model.stick(e):this.model.unstick(e);if(!s)return;const o=this.getIndexOfEditor(s);o!==i&&this.titleControl.moveEditor(s,i,o,!0),t?this.titleControl.stickEditor(s):this.titleControl.unstickEditor(s)}}async openEditor(e,t,i){return this.doOpenEditor(e,t,{...i,supportSideBySide:Le.BOTH})}async doOpenEditor(e,t,i){if(!e||e.isDisposed())return;this._onWillOpenEditor.fire({editor:e,groupId:this.id});const s=t?.sticky||!this.groupsView.partOptions.enablePreview&&!t?.transient||e.isDirty()||(t?.pinned??typeof t?.index=="number")||typeof t?.index=="number"&&this.model.isSticky(t.index)||e.hasCapability(Xt.Scratchpad),o={index:t?t.index:void 0,pinned:s,sticky:t?.sticky||typeof t?.index=="number"&&this.model.isSticky(t.index),transient:!!t?.transient,inactiveSelection:i?.inactiveSelection,active:this.count===0||!t?.inactive,supportSideBySide:i?.supportSideBySide};!o.active&&!o.pinned&&this.model.activeEditor&&!this.model.isPinned(this.model.activeEditor)&&(o.active=!0);let r=!1,n=!1;if(t?.activation===ho.ACTIVATE?r=!0:t?.activation===ho.RESTORE?n=!0:t?.activation===ho.PRESERVE?(r=!1,n=!1):o.active&&(r=!t?.preserveFocus,n=!r),typeof o.index=="number"){const p=this.model.indexOf(e);p!==-1&&p!==o.index&&this.doMoveEditorInsideGroup(e,o)}const{editor:d,isNew:l}=this.model.openEditor(e,o);l&&this.count===1&&this.editorPartsView.groups.length>1&&d.editorId&&this.groupsView.partOptions.autoLockGroups?.has(d.editorId)&&this.lock(!0);const h=this.doShowEditor(d,{active:!!o.active,isNew:l},t,i);return r?this.groupsView.activateGroup(this):n&&this.groupsView.restoreGroup(this),h}doShowEditor(e,t,i,s){let o;return t.active?o=(async()=>{const{pane:r,changed:n,cancelled:d,error:l}=await this.editorPane.openEditor(e,i,s,{newInGroup:t.isNew});if(!d)return n&&this._onDidActiveEditorChange.fire({editor:e}),l&&this._onDidOpenEditorFail.fire(e),!r&&this.activeEditor===e&&this.doCloseEditor(e,i?.preserveFocus,{fromError:!0}),r})():o=Promise.resolve(void 0),s?.skipTitleUpdate||this.titleControl.openEditor(e,s),o}async openEditors(e){const t=Mi(e).filter(({editor:n})=>!n.isDisposed()),i=t.at(0);if(!i)return;const s={supportSideBySide:Le.BOTH};await this.doOpenEditor(i.editor,i.options,s);const o=t.slice(1),r=this.getIndexOfEditor(i.editor)+1;return await _p.settled(o.map(({editor:n,options:d},l)=>this.doOpenEditor(n,{...d,inactive:!0,pinned:!0,index:r+l},{...s,skipTitleUpdate:!0}))),this.titleControl.openEditors(o.map(({editor:n})=>n)),this.editorPane.activeEditorPane??void 0}moveEditors(e,t){const i={skipTitleUpdate:this!==t};let s=!1;const o=new Set;for(const{editor:r,options:n}of e)this.moveEditor(r,t,n,i)?o.add(r):s=!0;return i.skipTitleUpdate&&(t.titleControl.openEditors(Array.from(o)),this.titleControl.closeEditors(Array.from(o))),!s}moveEditor(e,t,i,s){return this===t?(this.doMoveEditorInsideGroup(e,i),!0):this.doMoveOrCopyEditorAcrossGroups(e,t,i,{...s,keepCopy:!1})}doMoveEditorInsideGroup(e,t){const i=t?t.index:void 0;if(typeof i!="number")return;const s=this.model.indexOf(e),o=this.model.getEditorByIndex(s);if(o){if(s!==i){const r=this.model.stickyCount;this.model.moveEditor(o,i),this.model.pin(o),this.titleControl.moveEditor(o,s,i,r!==this.model.stickyCount),this.titleControl.pinEditor(o)}t?.sticky&&this.stickEditor(o)}}doMoveOrCopyEditorAcrossGroups(e,t,i,s){const o=s?.keepCopy;if(!o||e.hasCapability(Xt.Singleton)){const n=e.canMove(this.id,t.id);if(typeof n=="string")return this.dialogService.error(n,c(3413,"Try saving or reverting the editor first and then try again.")),!1}const r=Qv(this,e,{...i,pinned:!0,sticky:i?.sticky??(!o&&this.model.isSticky(e))});return o||this._onWillMoveEditor.fire({groupId:this.id,editor:e,target:t.id}),t.doOpenEditor(o?e.copy():e,r,s),o||this.doCloseEditor(e,!0,{...s,context:Vr.MOVE}),!0}copyEditors(e,t){const i={skipTitleUpdate:this!==t};for(const{editor:s,options:o}of e)this.copyEditor(s,t,o,i);if(i.skipTitleUpdate){const s=e.map(({editor:o})=>o);t.titleControl.openEditors(s)}}copyEditor(e,t,i,s){this===t?this.doMoveEditorInsideGroup(e,i):this.doMoveOrCopyEditorAcrossGroups(e,t,i,{...s,keepCopy:!0})}async closeEditor(e=this.activeEditor||void 0,t){return this.doCloseEditorWithConfirmationHandling(e,t)}async doCloseEditorWithConfirmationHandling(e=this.activeEditor||void 0,t,i){return!e||await this.handleCloseConfirmation([e])?!1:(this.doCloseEditor(e,t?.preserveFocus,i),!0)}doCloseEditor(e,t=this.groupsView.activeGroup!==this,i){i?.skipTitleUpdate||this.titleControl.beforeCloseEditor(e),this.model.isActive(e)?this.doCloseActiveEditor(t,i):this.doCloseInactiveEditor(e,i),i?.skipTitleUpdate||this.titleControl.closeEditor(e)}doCloseActiveEditor(e=this.groupsView.activeGroup!==this,t){const i=this.activeEditor,s=!e&&this.shouldRestoreFocus(this.element),o=this.groupsView.partOptions.closeEmptyGroups;if(o&&this.active&&this.count===1){const d=this.groupsView.getGroups(Ne.MOST_RECENTLY_ACTIVE)[1];d&&(s?d.focus():this.groupsView.activateGroup(d,!0))}i&&this.model.closeEditor(i,t?.context);const r=this.model.activeEditor;if(r){let n;e&&this.groupsView.activeGroup!==this&&(n=ho.PRESERVE);const d={preserveFocus:e,activation:n,ignoreError:t?.fromError},l={preserveWindowOrder:!0};this.doOpenEditor(r,d,l)}else i&&this.editorPane.closeEditor(i),s&&!o&&this.focus(),this._onDidActiveEditorChange.fire({editor:void 0}),o&&this.groupsView.removeGroup(this,e)}shouldRestoreFocus(e){const t=Hs();return t===PA(e)?!0:Ja(t,e)}doCloseInactiveEditor(e,t){this.model.closeEditor(e,t?.context)}async handleCloseConfirmation(e){if(!e.length)return!1;const t=e.shift();let i=this.mapEditorToPendingConfirmation.get(t);i||(i=this.doHandleCloseConfirmation(t),this.mapEditorToPendingConfirmation.set(t,i));let s;try{s=await i}finally{this.mapEditorToPendingConfirmation.delete(t)}return s||this.handleCloseConfirmation(e)}async doHandleCloseConfirmation(e,t){if(!this.shouldConfirmClose(e)||e instanceof Zt&&this.model.contains(e.primary)||this.editorPartsView.groups.some(r=>{if(r===this)return!1;const n=r;return!!(n.contains(e,{supportSideBySide:Le.BOTH})||e instanceof Zt&&n.contains(e.primary))}))return!1;let i=Ii.CANCEL,s=Ji.EXPLICIT,o=!1;if(!e.hasCapability(Xt.Untitled)&&!t?.skipAutoSave&&!e.closeHandler&&(this.filesConfigurationService.getAutoSaveMode(e).mode===Yl.ON_FOCUS_CHANGE?(o=!0,i=Ii.SAVE,s=Ji.FOCUS_CHANGE):kb&&(mi||xn)&&this.filesConfigurationService.getAutoSaveMode(e).mode===Yl.ON_WINDOW_CHANGE&&(o=!0,i=Ii.SAVE,s=Ji.WINDOW_CHANGE)),!o){this.activeEditor?.matches(e)||await this.doOpenEditor(e),await this.hostService.focus(He(this.element));let r=!1;if(typeof e.closeHandler?.confirm=="function")try{i=await e.closeHandler.confirm([{editor:e,groupId:this.id}])}catch(n){this.logService.error(n),r=!0}if(typeof e.closeHandler?.confirm!="function"||r){let n;e instanceof Zt?n=e.primary.getName():n=e.getName(),i=await this.fileDialogService.showSaveConfirm([n])}}if(!e.closeHandler&&!this.shouldConfirmClose(e))return i===Ii.CANCEL;switch(i){case Ii.SAVE:return!await e.save(this.id,{reason:s})&&o?this.doHandleCloseConfirmation(e,{skipAutoSave:!0}):e.isDirty();case Ii.DONT_SAVE:try{return await e.revert(this.id),e.isDirty()}catch(r){return this.logService.error(r),await e.revert(this.id,{soft:!0}),e.isDirty()}case Ii.CANCEL:return!0}}shouldConfirmClose(e){if(e.closeHandler)try{return e.closeHandler.showConfirm()}catch(t){this.logService.error(t)}return e.isDirty()&&!e.isSaving()}async closeEditors(e,t){if(this.isEmpty)return!0;const i=this.doGetEditorsToClose(e);return await this.handleCloseConfirmation(i.slice(0))?!1:(this.doCloseEditors(i,t),!0)}doGetEditorsToClose(e){if(Array.isArray(e))return e;const t=e,i=typeof t.direction=="number";let s=this.model.getEditors(i?Ie.SEQUENTIAL:Ie.MOST_RECENTLY_ACTIVE,t);return t.savedOnly?s=s.filter(o=>!o.isDirty()||o.isSaving()):i&&t.except?s=t.direction===Db.LEFT?s.slice(0,this.model.indexOf(t.except,s)):s.slice(this.model.indexOf(t.except,s)+1):t.except&&(s=s.filter(o=>t.except&&!o.matches(t.except))),s}doCloseEditors(e,t){let i=!1;for(const s of e)this.isActive(s)?i=!0:this.doCloseInactiveEditor(s);i&&this.doCloseActiveEditor(t?.preserveFocus),e.length&&this.titleControl.closeEditors(e)}closeAllEditors(e){return this.isEmpty?(this.groupsView.partOptions.closeEmptyGroups&&this.groupsView.removeGroup(this),!0):e?.excludeConfirming?(this.doCloseAllEditors(e),!0):this.handleCloseConfirmation(this.model.getEditors(Ie.MOST_RECENTLY_ACTIVE,e)).then(t=>t?!1:(this.doCloseAllEditors(e),!0))}doCloseAllEditors(e){let t=this.model.getEditors(Ie.SEQUENTIAL,e);e?.excludeConfirming&&(t=t.filter(s=>!this.shouldConfirmClose(s)));const i=[];for(const s of t)this.isActive(s)||this.doCloseInactiveEditor(s),i.push(s);this.activeEditor&&i.includes(this.activeEditor)&&this.doCloseActiveEditor(),i.length&&this.titleControl.closeEditors(i)}async replaceEditors(e){let t;const i=[];for(let{editor:s,replacement:o,forceReplaceDirty:r,options:n}of e){const d=this.getIndexOfEditor(s);if(d>=0){const l=this.isActive(s);n?n.index=d:n={index:d},n.inactive=!l,n.pinned=n.pinned??!0;const h={editor:s,replacement:o,forceReplaceDirty:r,options:n};l?t=h:i.push(h)}}for(const{editor:s,replacement:o,forceReplaceDirty:r,options:n}of i)if(await this.doOpenEditor(o,n),!s.matches(o)){let d=!1;if(r?(this.doCloseEditor(s,!0,{context:Vr.REPLACE}),d=!0):d=await this.doCloseEditorWithConfirmationHandling(s,{preserveFocus:!0},{context:Vr.REPLACE}),!d)return}if(t){const s=this.doOpenEditor(t.replacement,t.options);t.editor.matches(t.replacement)||(t.forceReplaceDirty?this.doCloseEditor(t.editor,!0,{context:Vr.REPLACE}):await this.doCloseEditorWithConfirmationHandling(t.editor,{preserveFocus:!0},{context:Vr.REPLACE})),await s}}get isLocked(){return this.model.isLocked}lock(e){this.model.lock(e)}createEditorActions(e,t=b.EditorTitle){let i={primary:[],secondary:[]},s;const o=this.activeEditorPane;if(o instanceof gb){const r=o.scopedContextKeyService??this.scopedContextKeyService,n=e.add(this.menuService.createMenu(t,r,{emitEventsForSubmenuChanges:!0,eventDebounceDelay:0}));s=n.onDidChange;const d=(l,h)=>h==="navigation"&&l.actions.length<=1;i=Ng(n.getActions({arg:this.resourceContext.get(),shouldForwardArgs:!0,renderShortTitle:!0}),"navigation",d)}else{const r=e.add(new A);s=r.event,e.add(this.onDidActiveEditorChange(()=>r.fire()))}return{actions:i,onDidChange:s}}updateStyles(){const e=this.isEmpty;e?this.element.style.backgroundColor=this.getColor(OA)||"":this.element.style.backgroundColor="";const t=this.getColor(MA)||this.getColor(es);!e&&t?(this.titleContainer.classList.add("title-border-bottom"),this.titleContainer.style.setProperty("--title-border-bottom-color",t)):(this.titleContainer.classList.remove("title-border-bottom"),this.titleContainer.style.removeProperty("--title-border-bottom-color"));const{showTabs:i}=this.groupsView.partOptions;this.titleContainer.style.backgroundColor=this.getColor(i==="multiple"?zS:NA)||"",this.editorContainer.style.backgroundColor=this.getColor(Ob)||""}get minimumWidth(){return this.editorPane.minimumWidth}get minimumHeight(){return this.editorPane.minimumHeight}get maximumWidth(){return this.editorPane.maximumWidth}get maximumHeight(){return this.editorPane.maximumHeight}get proportionalLayout(){return this.lastLayout?!(this.lastLayout.width===this.minimumWidth||this.lastLayout.height===this.minimumHeight):!0}layout(e,t,i,s){this.lastLayout={width:e,height:t,top:i,left:s},this.element.classList.toggle("max-height-478px",t<=478);const o=this.titleControl.layout({container:new Be(e,t),available:new Be(e,t-this.editorPane.minimumHeight)});this.progressBar.getContainer().style.top=`${Math.max(this.titleHeight.offset-2,0)}px`;const r=Math.max(0,t-o.height);this.editorContainer.style.height=`${r}px`,this.editorPane.layout({width:e,height:r,top:i+o.height,left:s})}relayout(){if(this.lastLayout){const{width:e,height:t,top:i,left:s}=this.lastLayout;this.layout(e,t,i,s)}}setBoundarySashes(e){this.editorPane.setBoundarySashes(e)}toJSON(){return this.model.serialize()}dispose(){this._disposed=!0,this._onWillDispose.fire(),super.dispose()}};ca=Go=D([u(6,z),u(7,de),u(8,we),u(9,nt),u(10,ot),u(11,Js),u(12,st),u(13,yi),u(14,O),u(15,ud),u(16,Kn),u(17,et),u(18,Qs),u(19,Rt),u(20,Bi),u(21,Ve)],ca);const WO=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var jf;xe(WO);function uI(a){return a.getValue("editor.dropIntoEditor.enabled")}function pI(a){return a.shiftKey}var on;let Yf=(on=class extends Yc{get disposed(){return!!this._disposed}constructor(e,t,i,s,o,r,n,d){super(t),this.groupView=e,this.configurationService=i,this.instantiationService=s,this.editorService=o,this.editorGroupService=r,this.treeViewsDragAndDropService=n,this.contextService=d,this.editorTransfer=Ws.getInstance(),this.groupTransfer=Ws.getInstance(),this.treeItemsTransfer=Ws.getInstance(),this.cleanupOverlayScheduler=this._register(new pd(()=>this.dispose(),300)),this.enableDropIntoEditor=uI(this.configurationService)&&this.isDropIntoActiveEditorEnabled(),this.create()}create(){const e=this.getOverlayOffsetHeight(),t=this.container=N("div",{id:jf.OVERLAY_ID});t.style.top=`${e}px`,this.groupView.element.appendChild(t),this.groupView.element.classList.add("dragged-over"),this._register(pe(()=>{t.remove(),this.groupView.element.classList.remove("dragged-over")})),this.overlay=N(".editor-group-overlay-indicator"),t.appendChild(this.overlay),this.enableDropIntoEditor&&(this.dropIntoPromptElement=GA(c(3406,"Hold __{0}__ to drop into editor",Ge?"":"Shift"),{}),this.dropIntoPromptElement.classList.add("editor-group-overlay-drop-into-prompt"),this.overlay.appendChild(this.dropIntoPromptElement)),this.registerListeners(t),this.updateStyles()}updateStyles(){const e=fe(this.overlay);e.style.backgroundColor=this.getColor(pb)||"";const t=this.getColor(Lb);if(e.style.outlineColor=t||"",e.style.outlineOffset=t?"-2px":"",e.style.outlineStyle=t?"dashed":"",e.style.outlineWidth=t?"2px":"",this.dropIntoPromptElement){this.dropIntoPromptElement.style.backgroundColor=this.getColor(WA)??"",this.dropIntoPromptElement.style.color=this.getColor(KA)??"";const i=this.getColor(UA);i?(this.dropIntoPromptElement.style.borderWidth="1px",this.dropIntoPromptElement.style.borderStyle="solid",this.dropIntoPromptElement.style.borderColor=i):this.dropIntoPromptElement.style.borderWidth="0"}}registerListeners(e){this._register(new vc(e,{onDragOver:t=>{if(this.enableDropIntoEditor&&pI(t)){this.dispose();return}const i=this.groupTransfer.hasData(Ht.prototype),s=this.editorTransfer.hasData(yt.prototype);!s&&!i&&t.dataTransfer&&(t.dataTransfer.dropEffect="copy");let o=!0;if(i)o=this.isCopyOperation(t);else if(s){const n=this.editorTransfer.getData(yt.prototype);Array.isArray(n)&&n.length>0&&(o=this.isCopyOperation(t,n[0].identifier))}if(!o){const n=this.findSourceGroupView();if(n===this.groupView&&(i||s&&n.count<2)){this.hideOverlay();return}}let r=!!this.editorGroupService.partOptions.splitOnDragAndDrop;this.isToggleSplitOperation(t)&&(r=!r),this.positionOverlay(t.offsetX,t.offsetY,i,r),this.cleanupOverlayScheduler.isScheduled()&&this.cleanupOverlayScheduler.cancel()},onDragLeave:t=>this.dispose(),onDragEnd:t=>this.dispose(),onDrop:t=>{be.stop(t,!0),this.dispose(),this.currentDropOperation&&this.handleDrop(t,this.currentDropOperation.splitDirection)}})),this._register(X(e,Q.MOUSE_OVER,()=>{this.cleanupOverlayScheduler.isScheduled()||this.cleanupOverlayScheduler.schedule()}))}isDropIntoActiveEditorEnabled(){return!!this.groupView.activeEditor?.hasCapability(Xt.CanDropIntoEditor)}findSourceGroupView(){if(this.groupTransfer.hasData(Ht.prototype)){const e=this.groupTransfer.getData(Ht.prototype);if(Array.isArray(e)&&e.length>0)return this.editorGroupService.getGroup(e[0].identifier)}else if(this.editorTransfer.hasData(yt.prototype)){const e=this.editorTransfer.getData(yt.prototype);if(Array.isArray(e)&&e.length>0)return this.editorGroupService.getGroup(e[0].identifier.groupId)}}async handleDrop(e,t){const i=()=>{let s;return typeof t=="number"?s=this.editorGroupService.addGroup(this.groupView,t):s=this.groupView,s};if(this.groupTransfer.hasData(Ht.prototype)){const s=this.groupTransfer.getData(Ht.prototype);if(Array.isArray(s)&&s.length>0){const o=this.editorGroupService.getGroup(s[0].identifier);if(o){if(typeof t!="number"&&o===this.groupView)return;let r;if(typeof t=="number")this.isCopyOperation(e)?r=this.editorGroupService.copyGroup(o,this.groupView,t):r=this.editorGroupService.moveGroup(o,this.groupView,t);else{let n;this.isCopyOperation(e)&&(n={mode:kn.COPY_EDITORS}),this.editorGroupService.mergeGroup(o,this.groupView,n)}r&&this.editorGroupService.activateGroup(r)}this.groupTransfer.clearData(Ht.prototype)}}else if(this.editorTransfer.hasData(yt.prototype)){const s=this.editorTransfer.getData(yt.prototype);if(Array.isArray(s)&&s.length>0){const o=s,r=s[0].identifier,n=this.editorGroupService.getGroup(r.groupId);if(n){const d=this.isCopyOperation(e,r);let l;if(this.editorGroupService.partOptions.closeEmptyGroups&&n.count===1&&typeof t=="number"&&!d)l=this.editorGroupService.moveGroup(n,this.groupView,t);else{if(l=i(),n===l)return;const h=yp(this.groupView,o.map(p=>p.identifier.editor));d?n.copyEditors(h,l):n.moveEditors(h,l)}l.focus()}this.editorTransfer.clearData(yt.prototype)}}else if(this.treeItemsTransfer.hasData(Fs.prototype)){const s=this.treeItemsTransfer.getData(Fs.prototype);if(Array.isArray(s)&&s.length>0){const o=[];for(const r of s){const n=await this.treeViewsDragAndDropService.removeDragOperationTransfer(r.identifier);if(n){const d=await KS(n);o.push(...d.map(l=>({...l,options:{...l.options,pinned:!0}})))}}o.length&&this.editorService.openEditors(o,i(),{validateTrust:!0})}this.treeItemsTransfer.clearData(Fs.prototype)}else this.instantiationService.createInstance(US,{allowWorkspaceOpen:!ei||HA(this.contextService.getWorkspace())}).handleDrop(e,He(this.groupView.element),()=>i(),o=>o?.focus())}isCopyOperation(e,t){return t?.editor.hasCapability(Xt.Singleton)?!1:e.ctrlKey&&!Ge||e.altKey&&Ge}isToggleSplitOperation(e){return e.altKey&&!Ge||e.shiftKey&&Ge}positionOverlay(e,t,i,s){const o=this.editorGroupService.partOptions.openSideBySideDirection==="right",r=this.groupView.element.clientWidth,n=this.groupView.element.clientHeight-this.getOverlayOffsetHeight();let d,l;s?(i?d=o?.3:.1:d=.1,i?l=o?.1:.3:l=.1):(d=0,l=0);const h=r*d,p=n*l,g=r/3,f=n/3;let m;switch(e>h&&e<r-h&&t>p&&t<n-p?m=void 0:o?e<g?m=J.LEFT:e>g*2?m=J.RIGHT:t<n/2?m=J.UP:m=J.DOWN:t<f?m=J.UP:t>f*2?m=J.DOWN:e<r/2?m=J.LEFT:m=J.RIGHT,m){case J.UP:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"50%"}),this.toggleDropIntoPrompt(!1);break;case J.DOWN:this.doPositionOverlay({top:"50%",left:"0",width:"100%",height:"50%"}),this.toggleDropIntoPrompt(!1);break;case J.LEFT:this.doPositionOverlay({top:"0",left:"0",width:"50%",height:"100%"}),this.toggleDropIntoPrompt(!1);break;case J.RIGHT:this.doPositionOverlay({top:"0",left:"50%",width:"50%",height:"100%"}),this.toggleDropIntoPrompt(!1);break;default:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"100%"}),this.toggleDropIntoPrompt(!0)}const v=fe(this.overlay);v.style.opacity="1",setTimeout(()=>v.classList.add("overlay-move-transition"),0),this.currentDropOperation={splitDirection:m}}doPositionOverlay(e){const[t,i]=Ho(this.container,this.overlay),s=this.getOverlayOffsetHeight();s?t.style.height=`calc(100% - ${s}px)`:t.style.height="100%",i.style.top=e.top,i.style.left=e.left,i.style.width=e.width,i.style.height=e.height}getOverlayOffsetHeight(){return!this.groupView.isEmpty&&this.editorGroupService.partOptions.showTabs==="multiple"?this.groupView.titleHeight.offset:0}hideOverlay(){const e=fe(this.overlay);this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"100%"}),e.style.opacity="0",e.classList.remove("overlay-move-transition"),this.currentDropOperation=void 0}toggleDropIntoPrompt(e){this.dropIntoPromptElement&&(this.dropIntoPromptElement.style.opacity=e?"1":"0")}contains(e){return e===this.container||e===this.overlay}dispose(){super.dispose(),this._disposed=!0}},jf=on,on.OVERLAY_ID="monaco-workbench-editor-drop-overlay",on);Yf=jf=D([u(1,we),u(2,te),u(3,z),u(4,O),u(5,U),u(6,Rb),u(7,xt)],Yf);let Xf=class extends Yc{constructor(e,t,i,s,o,r){super(s),this.container=e,this.delegate=t,this.editorGroupService=i,this.configurationService=o,this.instantiationService=r,this.counter=0,this.editorTransfer=Ws.getInstance(),this.groupTransfer=Ws.getInstance(),this.registerListeners()}get overlay(){if(this._overlay&&!this._overlay.disposed)return this._overlay}registerListeners(){this._register(X(this.container,Q.DRAG_ENTER,e=>this.onDragEnter(e))),this._register(X(this.container,Q.DRAG_LEAVE,()=>this.onDragLeave()));for(const e of[this.container,He(this.container)])this._register(X(e,Q.DRAG_END,()=>this.onDragEnd()))}onDragEnter(e){if(uI(this.configurationService)&&pI(e))return;if(this.counter++,!this.editorTransfer.hasData(yt.prototype)&&!this.groupTransfer.hasData(Ht.prototype)&&e.dataTransfer){const i=se.as(FA.DragAndDropContribution).getAll(),s=Array.from(i).map(o=>o.dataFormatKey);if(!BA(e,Sa.FILES,$g.FILES,Sa.RESOURCES,$g.EDITORS,...s)){e.dataTransfer.dropEffect="none";return}}this.updateContainer(!0);const t=e.target;if(t&&(this.overlay&&!this.overlay.contains(t)&&this.disposeOverlay(),!this.overlay)){const i=this.findTargetGroupView(t);i&&(this._overlay=this.instantiationService.createInstance(Yf,i))}}onDragLeave(){this.counter--,this.counter===0&&this.updateContainer(!1)}onDragEnd(){this.counter=0,this.updateContainer(!1),this.disposeOverlay()}findTargetGroupView(e){return this.editorGroupService.groups.find(i=>Ja(e,i.element)||this.delegate.containsGroup?.(i))}updateContainer(e){this.container.classList.toggle("dragged-over",e)}dispose(){super.dispose(),this.disposeOverlay()}disposeOverlay(){this.overlay&&(this.overlay.dispose(),this._overlay=void 0)}};Xf=D([u(2,U),u(3,we),u(4,te),u(5,z)],Xf);const Td={targetWidth:900,leftMarginRatio:.1909,rightMarginRatio:.1909},Ig={type:"distribute"};function gC(a){const e=N(".centered-layout-margin");return e.style.height="100%",a&&(e.style.backgroundColor=a.toString()),{element:e,layout:()=>{},minimumSize:60,maximumSize:Number.POSITIVE_INFINITY,onDidChange:K.None}}function KO(a,e){return{element:a.element,get maximumSize(){return a.maximumWidth},get minimumSize(){return a.minimumWidth},onDidChange:K.map(a.onDidChange,t=>t&&t.width),layout:(t,i,s)=>a.layout(t,e(),s?.top??0,(s?.left??0)+i)}}class UO{constructor(e,t,i={...Td},s=!1){this.container=e,this.view=t,this.state=i,this.centeredLayoutFixedWidth=s,this.lastLayoutPosition={width:0,height:0,left:0,top:0},this.didLayout=!1,this.splitViewDisposables=new B,this._boundarySashes={},this.container.appendChild(this.view.element),this.container.style.overflow="hidden"}get minimumWidth(){return this.splitView?this.splitView.minimumSize:this.view.minimumWidth}get maximumWidth(){return this.splitView?this.splitView.maximumSize:this.view.maximumWidth}get minimumHeight(){return this.view.minimumHeight}get maximumHeight(){return this.view.maximumHeight}get onDidChange(){return this.view.onDidChange}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.splitView&&(this.splitView.orthogonalStartSash=e.top,this.splitView.orthogonalEndSash=e.bottom)}layout(e,t,i,s){this.lastLayoutPosition={width:e,height:t,top:i,left:s},this.splitView?(this.splitView.layout(e,this.lastLayoutPosition),(!this.didLayout||this.centeredLayoutFixedWidth)&&this.resizeSplitViews()):this.view.layout(e,t,i,s),this.didLayout=!0}resizeSplitViews(){if(this.splitView)if(this.centeredLayoutFixedWidth){const e=Math.min(this.lastLayoutPosition.width,this.state.targetWidth),t=(this.lastLayoutPosition.width-e)/2;this.splitView.resizeView(0,Math.floor(t)),this.splitView.resizeView(1,e),this.splitView.resizeView(2,Math.ceil(t))}else{const e=this.state.leftMarginRatio*this.lastLayoutPosition.width,t=this.state.rightMarginRatio*this.lastLayoutPosition.width,i=this.lastLayoutPosition.width-e-t;this.splitView.resizeView(0,e),this.splitView.resizeView(1,i),this.splitView.resizeView(2,t)}}setFixedWidth(e){this.centeredLayoutFixedWidth=e,this.splitView&&(this.updateState(),this.resizeSplitViews())}updateState(){this.splitView&&(this.state.targetWidth=this.splitView.getViewSize(1),this.state.leftMarginRatio=this.splitView.getViewSize(0)/this.lastLayoutPosition.width,this.state.rightMarginRatio=this.splitView.getViewSize(2)/this.lastLayoutPosition.width)}isActive(){return!!this.splitView}styles(e){this.style=e,this.splitView&&this.emptyViews&&(this.splitView.style(this.style),this.emptyViews[0].element.style.backgroundColor=this.style.background.toString(),this.emptyViews[1].element.style.backgroundColor=this.style.background.toString())}activate(e){if(e!==this.isActive())if(e){this.view.element.remove(),this.splitView=new bc(this.container,{inverseAltBehavior:!0,orientation:le.HORIZONTAL,styles:this.style}),this.splitView.orthogonalStartSash=this.boundarySashes.top,this.splitView.orthogonalEndSash=this.boundarySashes.bottom,this.splitViewDisposables.add(this.splitView.onDidSashChange(()=>{this.splitView&&this.updateState()})),this.splitViewDisposables.add(this.splitView.onDidSashReset(()=>{this.state={...Td},this.resizeSplitViews()})),this.splitView.layout(this.lastLayoutPosition.width,this.lastLayoutPosition);const t=this.style?this.style.background:void 0;this.emptyViews=[gC(t),gC(t)],this.splitView.addView(this.emptyViews[0],Ig,0),this.splitView.addView(KO(this.view,()=>this.lastLayoutPosition.height),Ig,1),this.splitView.addView(this.emptyViews[1],Ig,2),this.resizeSplitViews()}else this.splitView?.el.remove(),this.splitViewDisposables.clear(),this.splitView?.dispose(),this.splitView=void 0,this.emptyViews=void 0,this.container.appendChild(this.view.element),this.view.layout(this.lastLayoutPosition.width,this.lastLayoutPosition.height,this.lastLayoutPosition.top,this.lastLayoutPosition.left)}isDefault(e){return this.centeredLayoutFixedWidth?e.targetWidth===Td.targetWidth:e.leftMarginRatio===Td.leftMarginRatio&&e.rightMarginRatio===Td.rightMarginRatio}dispose(){this.splitViewDisposables.dispose(),this.splitView&&(this.splitView.dispose(),this.splitView=void 0)}}var co;class HO{constructor(){this.element=N(".grid-view-container"),this._onDidChange=new Co,this.onDidChange=this._onDidChange.event}get minimumWidth(){return this.gridWidget?this.gridWidget.minimumWidth:0}get maximumWidth(){return this.gridWidget?this.gridWidget.maximumWidth:Number.POSITIVE_INFINITY}get minimumHeight(){return this.gridWidget?this.gridWidget.minimumHeight:0}get maximumHeight(){return this.gridWidget?this.gridWidget.maximumHeight:Number.POSITIVE_INFINITY}get gridWidget(){return this._gridWidget}set gridWidget(e){this.element.textContent="",e?(this.element.appendChild(e.element),this._onDidChange.input=e.onDidChange):this._onDidChange.input=K.None,this._gridWidget=e}layout(e,t,i,s){this.gridWidget?.layout(e,t,i,s)}dispose(){this._onDidChange.dispose()}}var tr;let Lh=(tr=class extends $C{constructor(e,t,i,s,o,r,n,d,l,h,p){super(t,{hasTitle:!1},r,d,l),this.editorPartsView=e,this.groupsLabel=i,this.windowId=s,this.instantiationService=o,this.configurationService=n,this.hostService=h,this.contextKeyService=p,this._onDidFocus=this._register(new A),this.onDidFocus=this._onDidFocus.event,this._onDidLayout=this._register(new A),this.onDidLayout=this._onDidLayout.event,this._onDidChangeActiveGroup=this._register(new A),this.onDidChangeActiveGroup=this._onDidChangeActiveGroup.event,this._onDidChangeGroupIndex=this._register(new A),this.onDidChangeGroupIndex=this._onDidChangeGroupIndex.event,this._onDidChangeGroupLabel=this._register(new A),this.onDidChangeGroupLabel=this._onDidChangeGroupLabel.event,this._onDidChangeGroupLocked=this._register(new A),this.onDidChangeGroupLocked=this._onDidChangeGroupLocked.event,this._onDidChangeGroupMaximized=this._register(new A),this.onDidChangeGroupMaximized=this._onDidChangeGroupMaximized.event,this._onDidActivateGroup=this._register(new A),this.onDidActivateGroup=this._onDidActivateGroup.event,this._onDidAddGroup=this._register(new qg),this.onDidAddGroup=this._onDidAddGroup.event,this._onDidRemoveGroup=this._register(new qg),this.onDidRemoveGroup=this._onDidRemoveGroup.event,this._onDidMoveGroup=this._register(new A),this.onDidMoveGroup=this._onDidMoveGroup.event,this.onDidSetGridWidget=this._register(new A),this._onDidChangeSizeConstraints=this._register(new Co),this.onDidChangeSizeConstraints=K.any(this.onDidSetGridWidget.event,this._onDidChangeSizeConstraints.event),this._onDidScroll=this._register(new Co),this.onDidScroll=K.any(this.onDidSetGridWidget.event,this._onDidScroll.event),this._onDidChangeEditorPartOptions=this._register(new A),this.onDidChangeEditorPartOptions=this._onDidChangeEditorPartOptions.event,this._onWillDispose=this._register(new A),this.onWillDispose=this._onWillDispose.event,this.workspaceMemento=this.getMemento(ee.WORKSPACE,Ze.USER),this.profileMemento=this.getMemento(ee.PROFILE,Ze.MACHINE),this.groupViews=new Map,this.mostRecentActiveGroups=[],this.container=N(".content"),this.gridWidgetDisposables=this._register(new B),this.gridWidgetView=this._register(new HO),this.enforcedPartOptions=[],this.top=0,this.left=0,this.sideGroup={openEditor:(g,f)=>{const[m]=this.scopedInstantiationService.invokeFunction(v=>D_(v,{editor:g,options:f},Dn));return m.openEditor(g,f)}},this._isReady=!1,this.whenReadyPromise=new pr,this.whenReady=this.whenReadyPromise.p,this.whenRestoredPromise=new pr,this.whenRestored=this.whenRestoredPromise.p,this._willRestoreState=!1,this.priority=Vs.High,this.scopedContextKeyService=this._register(this.contextKeyService.createScoped(this.container)),this.scopedInstantiationService=this._register(this.instantiationService.createChild(new _n([de,this.scopedContextKeyService]))),this._partOptions=ey(this.configurationService,this.themeService),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e))),this._register(this.themeService.onDidFileIconThemeChange(()=>this.handleChangedPartOptions())),this._register(this.onDidChangeMementoValue(ee.WORKSPACE,this._store)(e=>this.onDidChangeMementoState(e)))}onConfigurationUpdated(e){zA(e)&&this.handleChangedPartOptions()}handleChangedPartOptions(){const e=this._partOptions,t=ey(this.configurationService,this.themeService);for(const i of this.enforcedPartOptions)Object.assign(t,i);this._partOptions=t,this._onDidChangeEditorPartOptions.fire({oldPartOptions:e,newPartOptions:t})}get partOptions(){return this._partOptions}enforcePartOptions(e){return this.enforcedPartOptions.push(e),this.handleChangedPartOptions(),pe(()=>{this.enforcedPartOptions.splice(this.enforcedPartOptions.indexOf(e),1),this.handleChangedPartOptions()})}get contentDimension(){return this._contentDimension}get activeGroup(){return this._activeGroup}get groups(){return Array.from(this.groupViews.values())}get count(){return this.groupViews.size}get orientation(){return this.gridWidget&&this.gridWidget.orientation===le.VERTICAL?ui.VERTICAL:ui.HORIZONTAL}get isReady(){return this._isReady}get hasRestorableState(){return!!this.workspaceMemento[co.EDITOR_PART_UI_STATE_STORAGE_KEY]}get willRestoreState(){return this._willRestoreState}getGroups(e=Ne.CREATION_TIME){switch(e){case Ne.CREATION_TIME:return this.groups;case Ne.MOST_RECENTLY_ACTIVE:{const t=Mi(this.mostRecentActiveGroups.map(i=>this.getGroup(i)));return Xo([...t,...this.groups])}case Ne.GRID_APPEARANCE:{const t=[];return this.gridWidget&&this.fillGridNodes(t,this.gridWidget.getViews()),t}}}fillGridNodes(e,t){Kr(t)?t.children.forEach(i=>this.fillGridNodes(e,i)):e.push(t.view)}hasGroup(e){return this.groupViews.has(e)}getGroup(e){return this.groupViews.get(e)}findGroup(e,t=this.activeGroup,i){if(typeof e.direction=="number")return this.doFindGroupByDirection(e.direction,t,i);if(typeof e.location=="number")return this.doFindGroupByLocation(e.location,t,i);throw new Error("invalid arguments")}doFindGroupByDirection(e,t,i){const s=this.assertGroupView(t),o=this.gridWidget.getNeighborViews(s,this.toGridViewDirection(e),i);return o.sort(((r,n)=>this.mostRecentActiveGroups.indexOf(r.id)-this.mostRecentActiveGroups.indexOf(n.id))),o[0]}doFindGroupByLocation(e,t,i){const s=this.assertGroupView(t),o=this.getGroups(Ne.GRID_APPEARANCE),r=o.indexOf(s);switch(e){case Xe.FIRST:return o[0];case Xe.LAST:return o[o.length-1];case Xe.NEXT:{let n=o[r+1];return!n&&i&&(n=this.doFindGroupByLocation(Xe.FIRST,t)),n}case Xe.PREVIOUS:{let n=o[r-1];return!n&&i&&(n=this.doFindGroupByLocation(Xe.LAST,t)),n}}}activateGroup(e,t){const i=this.assertGroupView(e);return this.doSetGroupActive(i),t||this.hostService.moveTop(He(this.element)),i}restoreGroup(e){const t=this.assertGroupView(e);return this.doRestoreGroup(t),t}getSize(e){const t=this.assertGroupView(e);return this.gridWidget.getViewSize(t)}setSize(e,t){const i=this.assertGroupView(e);this.gridWidget.resizeView(i,t)}arrangeGroups(e,t=this.activeGroup){if(this.count<2||!this.gridWidget)return;const i=this.assertGroupView(t);switch(e){case Hi.EVEN:this.gridWidget.distributeViewSizes();break;case Hi.MAXIMIZE:if(this.groups.length<2)return;this.gridWidget.maximizeView(i),i.focus();break;case Hi.EXPAND:this.gridWidget.expandView(i);break}}toggleMaximizeGroup(e=this.activeGroup){this.hasMaximizedGroup()?this.unmaximizeGroup():this.arrangeGroups(Hi.MAXIMIZE,e)}toggleExpandGroup(e=this.activeGroup){this.isGroupExpanded(this.activeGroup)?this.arrangeGroups(Hi.EVEN):this.arrangeGroups(Hi.EXPAND,e)}unmaximizeGroup(){this.gridWidget.exitMaximizedView(),this._activeGroup.focus()}hasMaximizedGroup(){return this.gridWidget.hasMaximizedView()}isGroupMaximized(e){return this.gridWidget.isViewMaximized(e)}isGroupExpanded(e){return this.gridWidget.isViewExpanded(e)}setGroupOrientation(e){if(!this.gridWidget)return;const t=e===ui.HORIZONTAL?le.HORIZONTAL:le.VERTICAL;this.gridWidget.orientation!==t&&(this.gridWidget.orientation=t)}applyLayout(e){const t=this.shouldRestoreFocus(this.container);let i=0;function s(d){for(const l of d)Array.isArray(l.groups)?s(l.groups):i++}s(e.groups);let o=this.getGroups(Ne.GRID_APPEARANCE);if(i<o.length){const d=o[i-1];o.forEach((l,h)=>{h>=i&&this.mergeGroup(l,d)}),o=this.getGroups(Ne.GRID_APPEARANCE)}const r=this.activeGroup,n=N_({orientation:this.toGridViewOrientation(e.orientation,this.isTwoDimensionalGrid()?this.gridWidget.orientation:Gs(this.gridWidget.orientation)),groups:e.groups});this.doApplyGridState(n,r.id,o),t&&this._activeGroup.focus()}getLayout(){const e=this.gridWidget.serialize(),t=e.orientation===le.HORIZONTAL?ui.HORIZONTAL:ui.VERTICAL,i=this.serializedNodeToGroupLayoutArgument(e.root);return{orientation:t,groups:i.groups}}serializedNodeToGroupLayoutArgument(e){return e.type==="branch"?{size:e.size,groups:e.data.map(t=>this.serializedNodeToGroupLayoutArgument(t))}:{size:e.size}}shouldRestoreFocus(e){return e?Hs()===e.ownerDocument.body?!0:pS(e):!1}isTwoDimensionalGrid(){const e=this.gridWidget.getViews();return Kr(e)?e.children.some(t=>Kr(t)):!1}addGroup(e,t,i){const s=this.assertGroupView(e);let o;if(s.groupsView===this){const r=this.shouldRestoreFocus(s.element),n=this.groupViews.size>1&&this.isGroupExpanded(s);o=this.doCreateGroupView(i),this.gridWidget.addView(o,this.getSplitSizingStyle(),s,this.toGridViewDirection(t)),this.updateContainer(),this._onDidAddGroup.fire(o),this.notifyGroupIndexChange(),n&&this.arrangeGroups(Hi.EXPAND,o),r&&s.focus()}else o=s.groupsView.addGroup(s,t,i);return o}getSplitSizingStyle(){switch(this._partOptions.splitSizing){case"distribute":return Da.Distribute;case"split":return Da.Split;default:return Da.Auto}}doCreateGroupView(e,t){let i;e instanceof ca?i=ca.createCopy(e,this.editorPartsView,this,this.groupsLabel,this.count,this.scopedInstantiationService,t):qS(e)?i=ca.createFromSerialized(e,this.editorPartsView,this,this.groupsLabel,this.count,this.scopedInstantiationService,t):i=ca.createNew(this.editorPartsView,this,this.groupsLabel,this.count,this.scopedInstantiationService,t),this.groupViews.set(i.id,i);const s=new B;return s.add(i.onDidFocus(()=>{this.doSetGroupActive(i),this._onDidFocus.fire()})),s.add(i.onDidModelChange(o=>{switch(o.kind){case ut.GROUP_LOCKED:this._onDidChangeGroupLocked.fire(i);break;case ut.GROUP_INDEX:this._onDidChangeGroupIndex.fire(i);break;case ut.GROUP_LABEL:this._onDidChangeGroupLabel.fire(i);break}})),s.add(i.onDidActiveEditorChange(()=>{this.updateContainer()})),K.once(i.onWillDispose)(()=>{dt(s),this.groupViews.delete(i.id),this.doUpdateMostRecentActive(i)}),i}doSetGroupActive(e){if(this._activeGroup!==e){const t=this._activeGroup;this._activeGroup=e,this.doUpdateMostRecentActive(e,!0),t&&!t.disposed&&t.setActive(!1),e.setActive(!0),this.doRestoreGroup(e),this._onDidChangeActiveGroup.fire(e)}this._onDidActivateGroup.fire(e)}doRestoreGroup(e){if(this.gridWidget)try{this.hasMaximizedGroup()&&!this.isGroupMaximized(e)&&this.unmaximizeGroup();const t=this.gridWidget.getViewSize(e);(t.width===e.minimumWidth||t.height===e.minimumHeight)&&this.arrangeGroups(Hi.EXPAND,e)}catch{}}doUpdateMostRecentActive(e,t){const i=this.mostRecentActiveGroups.indexOf(e.id);i!==-1&&this.mostRecentActiveGroups.splice(i,1),t&&this.mostRecentActiveGroups.unshift(e.id)}toGridViewDirection(e){switch(e){case J.UP:return _e.Up;case J.DOWN:return _e.Down;case J.LEFT:return _e.Left;case J.RIGHT:return _e.Right}}toGridViewOrientation(e,t){return typeof e=="number"?e===ui.HORIZONTAL?le.HORIZONTAL:le.VERTICAL:t}removeGroup(e,t){const i=this.assertGroupView(e);this.count!==1&&(i.isEmpty?this.doRemoveEmptyGroup(i,t):this.doRemoveGroupWithEditors(i))}doRemoveGroupWithEditors(e){const t=this.getGroups(Ne.MOST_RECENTLY_ACTIVE);let i;this._activeGroup===e?i=t[1]:i=t[0],this.mergeGroup(e,i)}doRemoveEmptyGroup(e,t){const i=!t&&this.shouldRestoreFocus(this.container);if(this._activeGroup===e){const o=this.getGroups(Ne.MOST_RECENTLY_ACTIVE)[1];this.doSetGroupActive(o)}this.gridWidget.removeView(e,this.getSplitSizingStyle()),e.dispose(),i&&this._activeGroup.focus(),this.notifyGroupIndexChange(),this.updateContainer(),this._onDidRemoveGroup.fire(e)}moveGroup(e,t,i){const s=this.assertGroupView(e),o=this.assertGroupView(t);if(s.id===o.id)throw new Error("Cannot move group into its own");const r=this.shouldRestoreFocus(s.element);let n;return s.groupsView===o.groupsView?(this.gridWidget.moveView(s,this.getSplitSizingStyle(),o,this.toGridViewDirection(i)),n=s):(n=o.groupsView.addGroup(o,i,s),s.closeAllEditors(),this.removeGroup(s,r)),r&&n.focus(),this._onDidMoveGroup.fire(n),this.notifyGroupIndexChange(),n}copyGroup(e,t,i){const s=this.assertGroupView(e),o=this.assertGroupView(t),r=this.shouldRestoreFocus(s.element),n=this.addGroup(o,i,s);return r&&n.focus(),n}mergeGroup(e,t,i){const s=this.assertGroupView(e),o=this.assertGroupView(t),r=[];let n=i&&typeof i.index=="number"?i.index:o.count;for(const l of s.editors){const h=!s.isActive(l)||this._activeGroup!==s;let p;o.contains(l)&&(o.isSticky(l)||i?.preserveExistingIndex)||(p=n,n++),r.push({editor:l,options:{index:p,inactive:h,preserveFocus:h}})}let d=!0;return i?.mode===kn.COPY_EDITORS?s.copyEditors(r,o):d=s.moveEditors(r,o),s.isEmpty&&!s.disposed&&this.removeGroup(s,!0),d}mergeAllGroups(e,t){const i=this.assertGroupView(e);let s=!0;for(const o of this.getGroups(Ne.MOST_RECENTLY_ACTIVE)){if(o===i)continue;this.mergeGroup(o,i,t)||(s=!1)}return s}assertGroupView(e){let t;if(typeof e=="number"?t=this.editorPartsView.getGroup(e):t=e,!t)throw new Error("Invalid editor group provided!");return t}createEditorDropTarget(e,t){return $A(Ln(e)),this.scopedInstantiationService.createInstance(Xf,e,t)}get minimumWidth(){return Math.min(this.centeredLayoutWidget.minimumWidth,this.layoutService.getMaximumEditorDimensions(this.layoutService.getContainer(He(this.container))).width)}get maximumWidth(){return this.centeredLayoutWidget.maximumWidth}get minimumHeight(){return Math.min(this.centeredLayoutWidget.minimumHeight,this.layoutService.getMaximumEditorDimensions(this.layoutService.getContainer(He(this.container))).height)}get maximumHeight(){return this.centeredLayoutWidget.maximumHeight}get snap(){return this.layoutService.getPanelAlignment()==="center"}get onDidChange(){return K.any(this.centeredLayoutWidget.onDidChange,this.onDidSetGridWidget.event)}get gridSeparatorBorder(){return this.theme.getColor(qA)||this.theme.getColor(es)||ki.transparent}updateStyles(){this.container.style.backgroundColor=this.getColor(Ob)||"";const e={separatorBorder:this.gridSeparatorBorder,background:this.theme.getColor(jA)||ki.transparent};this.gridWidget.style(e),this.centeredLayoutWidget.styles(e)}createContentArea(e,t){return this.element=e,this.windowId!==me.vscodeWindowId&&this.container.classList.add("auxiliary"),e.appendChild(this.container),this._willRestoreState=!t||t.restorePreviousState,this.doCreateGridControl(),this.centeredLayoutWidget=this._register(new UO(this.container,this.gridWidgetView,this.profileMemento[co.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY],this._partOptions.centeredLayoutFixedWidth)),this._register(this.onDidChangeEditorPartOptions(i=>this.centeredLayoutWidget.setFixedWidth(i.newPartOptions.centeredLayoutFixedWidth??!1))),this.setupDragAndDropSupport(e,this.container),this.handleContextKeys(),this.whenReadyPromise.complete(),this._isReady=!0,_p.settled(this.groups.map(i=>i.whenRestored)).finally(()=>{this.whenRestoredPromise.complete()}),this.container}handleContextKeys(){Er.bindTo(this.scopedContextKeyService).set(this.windowId!==me.vscodeWindowId);const t=Jc.bindTo(this.scopedContextKeyService),i=$o.bindTo(this.scopedContextKeyService),s=()=>{this.count>1?t.set(!0):t.reset(),this.hasMaximizedGroup()?i.set(!0):i.reset()};s(),this._register(this.onDidAddGroup(()=>s())),this._register(this.onDidRemoveGroup(()=>s())),this._register(this.onDidChangeGroupMaximized(()=>s()))}setupDragAndDropSupport(e,t){this._register(this.createEditorDropTarget(t,Object.create(null)));const i=N(".drop-block-overlay");e.appendChild(i),this._register(YA(i,()=>i.classList.remove("visible"))),this._register(Gl.INSTANCE.registerTarget(this.element,{onDragStart:h=>i.classList.add("visible"),onDragEnd:h=>i.classList.remove("visible")}));let s,o,r,n;const d=h=>{!this.layoutService.isVisible(j.PANEL_PART)&&h===this.layoutService.getPanelPosition()?this.layoutService.setPartHidden(!1,j.PANEL_PART):!this.layoutService.isVisible(j.AUXILIARYBAR_PART)&&h===(this.layoutService.getSideBarPosition()===hi.RIGHT?hi.LEFT:hi.RIGHT)&&this.layoutService.setPartHidden(!1,j.AUXILIARYBAR_PART)},l=()=>{s&&(clearTimeout(s),s=void 0),o&&(clearTimeout(o),o=void 0)};this._register(Gl.INSTANCE.registerTarget(i,{onDragOver:h=>{be.stop(h.eventData,!0),h.eventData.dataTransfer&&(h.eventData.dataTransfer.dropEffect="none");const p=i.getBoundingClientRect();let g,f;const m=100;h.eventData.clientX<p.left+m&&(g=hi.LEFT),h.eventData.clientX>p.right-m&&(g=hi.RIGHT),h.eventData.clientY>p.bottom-m&&(f=hi.BOTTOM),h.eventData.clientY<p.top+m&&(f=hi.TOP),s&&g!==r&&(clearTimeout(s),s=void 0),o&&f!==n&&(clearTimeout(o),o=void 0),!s&&g!==void 0&&(r=g,s=setTimeout(()=>d(g),200)),!o&&f!==void 0&&(n=f,o=setTimeout(()=>d(f),200))},onDragLeave:()=>l(),onDragEnd:()=>l(),onDrop:()=>l()}))}centerLayout(e){this.centeredLayoutWidget.activate(e)}isLayoutCentered(){return this.centeredLayoutWidget?this.centeredLayoutWidget.isActive():!1}doCreateGridControl(){let e=!1;if(this._willRestoreState&&(e=!this.doCreateGridControlWithPreviousState()),!this.gridWidget||e){const t=this.doCreateGroupView();this.doSetGridWidget(new Yo(t)),this.doSetGroupActive(t)}this.updateContainer(),this.notifyGroupIndexChange()}doCreateGridControlWithPreviousState(){const e=this.loadState();if(e?.serializedGrid)try{this.mostRecentActiveGroups=e.mostRecentActiveGroups,this.doCreateGridControlWithState(e.serializedGrid,e.activeGroup)}catch(t){return gr(new Error(`Error restoring editor grid widget: ${t} (with state: ${JSON.stringify(e)})`)),this.disposeGroups(),!1}return!0}doCreateGridControlWithState(e,t,i,s){let o;i?o=i.slice(0):o=[];const r=[],n=Yo.deserialize(e,{fromJSON:d=>{let l;return o.length>0?l=o.shift():l=this.doCreateGroupView(d,s),r.push(l),l.id===t&&this.doSetGroupActive(l),l}},{styles:{separatorBorder:this.gridSeparatorBorder}});this._activeGroup||this.doSetGroupActive(r[0]),this.mostRecentActiveGroups.some(d=>!this.getGroup(d))&&(this.mostRecentActiveGroups=r.map(d=>d.id)),this.doSetGridWidget(n)}doSetGridWidget(e){let t={};this.gridWidget&&(t=this.gridWidget.boundarySashes,this.gridWidget.dispose()),this.gridWidget=e,this.gridWidget.boundarySashes=t,this.gridWidgetView.gridWidget=e,this._onDidChangeSizeConstraints.input=e.onDidChange,this._onDidScroll.input=e.onDidScroll,this.gridWidgetDisposables.clear(),this.gridWidgetDisposables.add(e.onDidChangeViewMaximized(i=>this._onDidChangeGroupMaximized.fire(i))),this.onDidSetGridWidget.fire(void 0)}updateContainer(){this.container.classList.toggle("empty",this.isEmpty)}notifyGroupIndexChange(){this.getGroups(Ne.GRID_APPEARANCE).forEach((e,t)=>e.notifyIndexChanged(t))}notifyGroupsLabelChange(e){for(const t of this.groups)t.notifyLabelChanged(e)}get isEmpty(){return this.count===1&&this._activeGroup.isEmpty}setBoundarySashes(e){this.gridWidget.boundarySashes=e,this.centeredLayoutWidget.boundarySashes=e}layout(e,t,i,s){this.top=i,this.left=s;const o=super.layoutContents(e,t).contentSize;this.doLayout(Be.lift(o),i,s)}doLayout(e,t=this.top,i=this.left){this._contentDimension=e,this.centeredLayoutWidget.layout(this._contentDimension.width,this._contentDimension.height,t,i),this._onDidLayout.fire(e)}saveState(){if(this.gridWidget&&(this.isEmpty?delete this.workspaceMemento[co.EDITOR_PART_UI_STATE_STORAGE_KEY]:this.workspaceMemento[co.EDITOR_PART_UI_STATE_STORAGE_KEY]=this.createState()),this.centeredLayoutWidget){const e=this.centeredLayoutWidget.state;this.centeredLayoutWidget.isDefault(e)?delete this.profileMemento[co.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY]:this.profileMemento[co.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY]=e}super.saveState()}loadState(){return this.workspaceMemento[co.EDITOR_PART_UI_STATE_STORAGE_KEY]}createState(){return{serializedGrid:this.gridWidget.serialize(),activeGroup:this._activeGroup.id,mostRecentActiveGroups:this.mostRecentActiveGroups}}applyState(e,t){return e==="empty"?this.doApplyEmptyState():this.doApplyState(e,t)}async doApplyState(e,t){const i=await this.doPrepareApplyState();this._onDidAddGroup.pause(),this._onDidRemoveGroup.pause(),this.disposeGroups(),this.mostRecentActiveGroups=e.mostRecentActiveGroups;try{this.doApplyGridState(e.serializedGrid,e.activeGroup,void 0,t)}finally{this._onDidRemoveGroup.resume(),this._onDidAddGroup.resume()}await this.activeGroup.openEditors(i.flatMap(s=>s.editors).filter(s=>this.editorPartsView.groups.every(o=>!o.contains(s))).map(s=>({editor:s,options:{pinned:!0,preserveFocus:!0,inactive:!0}})))}async doApplyEmptyState(){await this.doPrepareApplyState(),this.mergeAllGroups(this.activeGroup)}async doPrepareApplyState(){const e=this.getGroups(Ne.MOST_RECENTLY_ACTIVE);for(const t of e)await t.closeAllEditors({excludeConfirming:!0});return e}doApplyGridState(e,t,i,s){this.doCreateGridControlWithState(e,t,i,s),this.doLayout(this._contentDimension),this.updateContainer();for(const o of this.getGroups(Ne.GRID_APPEARANCE))i?.includes(o)||this._onDidAddGroup.fire(o);this.notifyGroupIndexChange()}onDidChangeMementoState(e){if(e.external&&e.scope===ee.WORKSPACE){this.reloadMemento(e.scope);const t=this.loadState();t&&this.applyState(t)}}toJSON(){return{type:j.EDITOR_PART}}disposeGroups(){for(const e of this.groups)e.dispose(),this._onDidRemoveGroup.fire(e);this.groupViews.clear(),this.mostRecentActiveGroups=[]}dispose(){this._onWillDispose.fire(),this.disposeGroups(),this.gridWidget?.dispose(),super.dispose()}},co=tr,tr.EDITOR_PART_UI_STATE_STORAGE_KEY="editorpart.state",tr.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY="editorpart.centeredview",tr);Lh=co=D([u(4,z),u(5,we),u(6,te),u(7,ge),u(8,je),u(9,Rt),u(10,de)],Lh);let Jf=class extends Lh{constructor(e,t,i,s,o,r,n,d){super(e,j.EDITOR_PART,"",me.vscodeWindowId,t,i,s,o,r,n,d)}};Jf=D([u(1,z),u(2,we),u(3,te),u(4,ge),u(5,je),u(6,Rt),u(7,de)],Jf);var ta,Zf;const Yp=JA(new A);S(class extends R{constructor(){super({id:"workbench.action.toggleCompactAuxiliaryWindow",title:y(3049,"Toggle Window Compact Mode"),category:T.View,f1:!0,precondition:MS})}async run(){Yp.fire({windowId:wr().vscodeWindowId,compact:"toggle"})}});S(class extends R{constructor(){super({id:"workbench.action.enableCompactAuxiliaryWindow",title:c(3050,"Turn On Compact Mode"),icon:P.screenFull,menu:{id:b.LayoutControlMenu,when:I.and(XS.toNegated(),Er),order:0}})}async run(){Yp.fire({windowId:wr().vscodeWindowId,compact:!0})}});S(class extends R{constructor(){super({id:"workbench.action.disableCompactAuxiliaryWindow",title:c(3051,"Turn Off Compact Mode"),icon:P.screenNormal,menu:{id:b.LayoutControlMenu,when:I.and(XS,Er),order:0}})}async run(){Yp.fire({windowId:wr().vscodeWindowId,compact:!1})}});var rn;let Qf=(rn=class{constructor(e,t,i,s,o,r,n,d,l){this.editorPartsView=e,this.instantiationService=t,this.auxiliaryWindowService=i,this.lifecycleService=s,this.configurationService=o,this.statusbarService=r,this.titleService=n,this.editorService=d,this.layoutService=l}async create(e,t){const i=this,s=new B;let o=!!t?.compact;function r(){let $=0;return G&&($+=x.height),m&&v&&($+=m.height),$}function n($){G?ja(x.container):ur(x.container),$&&h.layout()}function d($){m&&(v?ja(m.container):ur(m.container),$&&h.layout())}function l($){if($===o)return;o=$,h.updateOptions({compact:o}),m?.updateOptions({compact:o}),g.updateOptions({compact:o});const H=G;G=!o&&i.configurationService.getValue(ta.STATUS_BAR_VISIBILITY)!==!1,H!==G&&n(!0)}const h=s.add(await this.auxiliaryWindowService.open(t)),p=N(".part.editor",{role:"main"});p.style.position="relative",h.container.appendChild(p);const g=s.add(this.instantiationService.createInstance(em,h.window.vscodeWindowId,this.editorPartsView,t?.state,e));g.updateOptions({compact:o}),s.add(this.editorPartsView.registerPart(g)),g.create(p);const f=s.add(g.scopedInstantiationService.createChild(new _n([O,this.editorService.createScoped(g,s)])));let m,v=!1;if(kb&&QA()){m=s.add(this.titleService.createAuxiliaryTitlebarPart(h.container,g,f)),m.updateOptions({compact:o}),v=ty(this.configurationService,h.window,void 0);const $=()=>{const H=v;v=ty(this.configurationService,h.window,void 0),H!==v&&d(!0)};s.add(m.onDidChange(()=>h.layout())),s.add(this.layoutService.onDidChangePartVisibility(()=>$())),s.add(JS(H=>{H===h.window.vscodeWindowId&&$()})),d(!1)}else s.add(f.createInstance(XA,h.window));const x=s.add(this.statusbarService.createAuxiliaryStatusbarPart(h.container,f));let G=!o&&this.configurationService.getValue(ta.STATUS_BAR_VISIBILITY)!==!1;s.add(this.configurationService.onDidChangeConfiguration($=>{$.affectsConfiguration(ta.STATUS_BAR_VISIBILITY)&&(G=!o&&this.configurationService.getValue(ta.STATUS_BAR_VISIBILITY)!==!1,n(!0))})),n(!1);const W=s.add(K.once(g.onWillClose)(()=>h.window.close()));s.add(K.once(h.onUnload)(()=>{s.isDisposed||(W.dispose(),g.close(),s.dispose())})),s.add(K.once(this.lifecycleService.onDidShutdown)(()=>s.dispose())),s.add(h.onBeforeUnload($=>{for(const H of g.groups)for(const ie of H.editors){const q=ie.canMove(H.id,this.editorPartsView.mainPart.activeGroup.id);if(typeof q=="string"){H.openEditor(ie),$.veto(q);return}}})),s.add(h.onWillLayout($=>{const H=m?.height??0;m?.layout($.width,H,0,0);const ie=$.height-r();g.layout($.width,ie,H,0),x.layout($.width,x.height,$.height-x.height,0)})),h.layout(),s.add(Yp.event($=>{if($.windowId===h.window.vscodeWindowId){let H;typeof $.compact=="boolean"?H=$.compact:H=!o,l(H)}})),s.add(g.onDidAddGroup($=>{l(!1),s.add($.onDidActiveEditorChange(()=>{$.count>1&&l(!1)}))})),s.add(g.activeGroup.onDidActiveEditorChange(()=>{g.activeGroup.count>1&&l(!1)}));const Y=s.add(f.createChild(new _n([Ss,this.statusbarService.createScoped(x,s)])));return{part:g,instantiationService:Y,disposables:s}}},ta=rn,rn.STATUS_BAR_VISIBILITY="workbench.statusBar.visible",rn);Qf=ta=D([u(1,z),u(2,Mb),u(3,gd),u(4,te),u(5,Ss),u(6,ZA),u(7,O),u(8,je)],Qf);var nn;let em=(nn=class extends Lh{constructor(e,t,i,s,o,r,n,d,l,h,p){const g=Zf.COUNTER++;super(t,`workbench.parts.auxiliaryEditor.${g}`,s,e,o,r,n,d,l,h,p),this.state=i,this._onWillClose=this._register(new A),this.onWillClose=this._onWillClose.event,this.optionsDisposable=this._register(new Ae),this.isCompact=!1}updateOptions(e){this.isCompact=e.compact,e.compact?this.optionsDisposable.value||(this.optionsDisposable.value=this.enforcePartOptions({showTabs:"none",closeEmptyGroups:!0})):this.optionsDisposable.clear()}addGroup(e,t,i){return this.isCompact&&(e=this.editorPartsView.mainPart.activeGroup),super.addGroup(e,t,i)}removeGroup(e,t){const i=this.assertGroupView(e);this.count===1&&this.activeGroup===i?this.doRemoveLastGroup(t):super.removeGroup(e,t)}doRemoveLastGroup(e){const t=!e&&this.shouldRestoreFocus(this.container),s=this.editorPartsView.getGroups(Ne.MOST_RECENTLY_ACTIVE)[1];s&&(s.groupsView.activateGroup(s),t&&s.focus()),this.doClose(!1)}loadState(){return this.state}saveState(){}close(){return this.doClose(!0)}doClose(e){let t=!0;if(e){for(const i of this.groups)i.closeAllEditors({excludeConfirming:!0});t=this.mergeGroupsToMainPart()}return this._onWillClose.fire(),t}mergeGroupsToMainPart(){if(!this.groups.some(i=>i.count>0))return!0;let e;for(const i of this.editorPartsView.mainPart.getGroups(Ne.MOST_RECENTLY_ACTIVE))if(!i.isLocked){e=i;break}e||(e=this.editorPartsView.mainPart.addGroup(this.editorPartsView.mainPart.activeGroup,this.partOptions.openSideBySideDirection==="right"?J.RIGHT:J.DOWN));const t=this.mergeAllGroups(e,{preserveExistingIndex:!0});return e.focus(),t}},Zf=nn,nn.COUNTER=1,nn);em=Zf=D([u(4,z),u(5,we),u(6,te),u(7,ge),u(8,je),u(9,Rt),u(10,de)],em);var Lr,ir;let fC=(ir=class extends eT{constructor(e,t,i,s,o){super("workbench.editorParts",i,t),this.instantiationService=e,this.storageService=t,this.auxiliaryWindowService=s,this.contextKeyService=o,this.mapPartToInstantiationService=new Map,this._onDidCreateAuxiliaryEditorPart=this._register(new A),this.onDidCreateAuxiliaryEditorPart=this._onDidCreateAuxiliaryEditorPart.event,this.workspaceMemento=this.getMemento(ee.WORKSPACE,Ze.USER),this._isReady=!1,this.whenReadyPromise=new pr,this.whenReady=this.whenReadyPromise.p,this.whenRestoredPromise=new pr,this.whenRestored=this.whenRestoredPromise.p,this._onDidActiveGroupChange=this._register(new A),this.onDidChangeActiveGroup=this._onDidActiveGroupChange.event,this._onDidAddGroup=this._register(new A),this.onDidAddGroup=this._onDidAddGroup.event,this._onDidRemoveGroup=this._register(new A),this.onDidRemoveGroup=this._onDidRemoveGroup.event,this._onDidMoveGroup=this._register(new A),this.onDidMoveGroup=this._onDidMoveGroup.event,this._onDidActivateGroup=this._register(new A),this.onDidActivateGroup=this._onDidActivateGroup.event,this._onDidChangeGroupIndex=this._register(new A),this.onDidChangeGroupIndex=this._onDidChangeGroupIndex.event,this._onDidChangeGroupLocked=this._register(new A),this.onDidChangeGroupLocked=this._onDidChangeGroupLocked.event,this._onDidChangeGroupMaximized=this._register(new A),this.onDidChangeGroupMaximized=this._onDidChangeGroupMaximized.event,this.globalContextKeys=new Map,this.scopedContextKeys=new Map,this.contextKeyProviders=new Map,this.registeredContextKeys=new Map,this.contextKeyProviderDisposables=this._register(new Rn),this.editorWorkingSets=(()=>{const r=this.storageService.get(Lr.EDITOR_WORKING_SETS_STORAGE_KEY,ee.WORKSPACE);return r?JSON.parse(r):[]})(),this.mainPart=this._register(this.createMainEditorPart()),this._register(this.registerPart(this.mainPart)),this.mostRecentActiveParts=[this.mainPart],this.restoreParts(),this.registerListeners()}registerListeners(){this._register(this.onDidChangeMementoValue(ee.WORKSPACE,this._store)(e=>this.onDidChangeMementoState(e))),this.whenReady.then(()=>this.registerGroupsContextKeyListeners())}createMainEditorPart(){return this.instantiationService.createInstance(Jf,this)}getScopedInstantiationService(e){return e===this.mainPart&&(this.mapPartToInstantiationService.has(e.windowId)||this.instantiationService.invokeFunction(t=>{const i=t.get(O),s=t.get(Ss);this.mapPartToInstantiationService.set(e.windowId,this._register(this.mainPart.scopedInstantiationService.createChild(new _n([O,i.createScoped(this.mainPart,this._store)],[Ss,s.createScoped(s,this._store)]))))})),this.mapPartToInstantiationService.get(e.windowId)??this.instantiationService}async createAuxiliaryEditorPart(e){const{part:t,instantiationService:i,disposables:s}=await this.instantiationService.createInstance(Qf,this).create(this.getGroupsLabel(this._parts.size),e);return this.mapPartToInstantiationService.set(t.windowId,i),s.add(pe(()=>this.mapPartToInstantiationService.delete(t.windowId))),this._onDidAddGroup.fire(t.activeGroup),this._onDidCreateAuxiliaryEditorPart.fire(t),t}registerPart(e){const t=this._register(new B);return t.add(super.registerPart(e)),this.registerEditorPartListeners(e,t),t}unregisterPart(e){super.unregisterPart(e),this.parts.forEach((t,i)=>{t!==this.mainPart&&t.notifyGroupsLabelChange(this.getGroupsLabel(i))})}registerEditorPartListeners(e,t){t.add(e.onDidFocus(()=>{this.doUpdateMostRecentActive(e,!0),this._parts.size>1&&this._onDidActiveGroupChange.fire(this.activeGroup)})),t.add(pe(()=>{this.doUpdateMostRecentActive(e),e.windowId!==me.vscodeWindowId&&this._onDidActiveGroupChange.fire(this.activeGroup)})),t.add(e.onDidChangeActiveGroup(i=>this._onDidActiveGroupChange.fire(i))),t.add(e.onDidAddGroup(i=>this._onDidAddGroup.fire(i))),t.add(e.onDidRemoveGroup(i=>this._onDidRemoveGroup.fire(i))),t.add(e.onDidMoveGroup(i=>this._onDidMoveGroup.fire(i))),t.add(e.onDidActivateGroup(i=>this._onDidActivateGroup.fire(i))),t.add(e.onDidChangeGroupMaximized(i=>this._onDidChangeGroupMaximized.fire(i))),t.add(e.onDidChangeGroupIndex(i=>this._onDidChangeGroupIndex.fire(i))),t.add(e.onDidChangeGroupLocked(i=>this._onDidChangeGroupLocked.fire(i)))}doUpdateMostRecentActive(e,t){const i=this.mostRecentActiveParts.indexOf(e);i!==-1&&this.mostRecentActiveParts.splice(i,1),t&&this.mostRecentActiveParts.unshift(e)}getGroupsLabel(e){return c(3428,"Window {0}",e+1)}getPart(e){if(this._parts.size>1)if(Ln(e)){const t=e;return this.getPartByDocument(t.ownerDocument)}else{const t=e;let i;typeof t=="number"?i=t:i=t.id;for(const s of this._parts)if(s.hasGroup(i))return s}return this.mainPart}get isReady(){return this._isReady}async restoreParts(){if(await this.mainPart.whenReady,this.mainPart.willRestoreState){const t=this.loadState();t&&await this.restoreState(t)}this.mostRecentActiveParts.at(0)?.activeGroup.focus(),this._isReady=!0,this.whenReadyPromise.complete(),await Promise.allSettled(this.parts.map(t=>t.whenRestored)),this.whenRestoredPromise.complete()}loadState(){return this.workspaceMemento[Lr.EDITOR_PARTS_UI_STATE_STORAGE_KEY]}saveState(){const e=this.createState();e.auxiliary.length===0?delete this.workspaceMemento[Lr.EDITOR_PARTS_UI_STATE_STORAGE_KEY]:this.workspaceMemento[Lr.EDITOR_PARTS_UI_STATE_STORAGE_KEY]=e}createState(){return{auxiliary:this.parts.filter(e=>e!==this.mainPart).map(e=>{const t=this.auxiliaryWindowService.getWindow(e.windowId);return{state:e.createState(),...t?.createState()}}),mru:this.mostRecentActiveParts.map(e=>this.parts.indexOf(e))}}async restoreState(e){if(e.auxiliary.length){const t=[];for(const i of e.auxiliary)t.push(this.createAuxiliaryEditorPart(i));await Promise.allSettled(t),e.mru.length===this.parts.length?this.mostRecentActiveParts=e.mru.map(i=>this.parts[i]):this.mostRecentActiveParts=[...this.parts],await Promise.allSettled(this.parts.map(i=>i.whenReady))}}get hasRestorableState(){return this.parts.some(e=>e.hasRestorableState)}onDidChangeMementoState(e){if(e.external&&e.scope===ee.WORKSPACE){this.reloadMemento(e.scope);const t=this.loadState();t&&this.applyState(t)}}async applyState(e){for(const t of this.parts){if(t===this.mainPart)continue;for(const s of t.getGroups(Ne.MOST_RECENTLY_ACTIVE))await s.closeAllEditors({excludeConfirming:!0});if(!t.close())return!1}return e!=="empty"&&await this.restoreState(e),!0}saveWorkingSet(e){const t={id:fd(),name:e,main:this.mainPart.createState(),auxiliary:this.createState()};return this.editorWorkingSets.push(t),this.saveWorkingSets(),{id:t.id,name:t.name}}getWorkingSets(){return this.editorWorkingSets.map(e=>({id:e.id,name:e.name}))}deleteWorkingSet(e){const t=this.indexOfWorkingSet(e);typeof t=="number"&&(this.editorWorkingSets.splice(t,1),this.saveWorkingSets())}async applyWorkingSet(e,t){let i;if(e==="empty"?i="empty":i=this.editorWorkingSets[this.indexOfWorkingSet(e)??-1],!i||!await this.applyState(i==="empty"?i:i.auxiliary))return!1;if(await this.mainPart.applyState(i==="empty"?i:i.main,t),!t?.preserveFocus){const o=this.mostRecentActiveParts.at(0);o&&(await o.whenReady,o.activeGroup.focus())}return!0}indexOfWorkingSet(e){for(let t=0;t<this.editorWorkingSets.length;t++)if(this.editorWorkingSets[t].id===e.id)return t}saveWorkingSets(){this.storageService.store(Lr.EDITOR_WORKING_SETS_STORAGE_KEY,JSON.stringify(this.editorWorkingSets),ee.WORKSPACE,Ze.MACHINE)}get activeGroup(){return this.activePart.activeGroup}get sideGroup(){return this.activePart.sideGroup}get groups(){return this.getGroups()}get count(){return this.groups.length}getGroups(e=Ne.CREATION_TIME){if(this._parts.size>1){let t;switch(e){case Ne.GRID_APPEARANCE:case Ne.CREATION_TIME:t=this.parts;break;case Ne.MOST_RECENTLY_ACTIVE:t=Xo([...this.mostRecentActiveParts,...this.parts]);break}return t.flatMap(i=>i.getGroups(e))}return this.mainPart.getGroups(e)}getGroup(e){if(this._parts.size>1)for(const t of this._parts){const i=t.getGroup(e);if(i)return i}return this.mainPart.getGroup(e)}assertGroupView(e){let t;if(typeof e=="number"?t=this.getGroup(e):t=e,!t)throw new Error("Invalid editor group provided!");return t}activateGroup(e){return this.getPart(e).activateGroup(e)}getSize(e){return this.getPart(e).getSize(e)}setSize(e,t){this.getPart(e).setSize(e,t)}arrangeGroups(e,t=this.activePart.activeGroup){this.getPart(t).arrangeGroups(e,t)}toggleMaximizeGroup(e=this.activePart.activeGroup){this.getPart(e).toggleMaximizeGroup(e)}toggleExpandGroup(e=this.activePart.activeGroup){this.getPart(e).toggleExpandGroup(e)}restoreGroup(e){return this.getPart(e).restoreGroup(e)}applyLayout(e){this.activePart.applyLayout(e)}getLayout(){return this.activePart.getLayout()}get orientation(){return this.activePart.orientation}setGroupOrientation(e){this.activePart.setGroupOrientation(e)}findGroup(e,t=this.activeGroup,i){const s=this.getPart(t);if(this._parts.size>1){const o=this.getGroups(Ne.GRID_APPEARANCE);if(e.location===Xe.FIRST||e.location===Xe.LAST)return e.location===Xe.FIRST?o[0]:o[o.length-1];const r=s.findGroup(e,t,!1);if(r)return r;if(e.location===Xe.NEXT||e.location===Xe.PREVIOUS){const n=this.assertGroupView(t),d=o.indexOf(n);if(e.location===Xe.NEXT){let l=o[d+1];return!l&&i&&(l=o[0]),l}else{let l=o[d-1];return!l&&i&&(l=o[o.length-1]),l}}}return s.findGroup(e,t,i)}addGroup(e,t){return this.getPart(e).addGroup(e,t)}removeGroup(e){this.getPart(e).removeGroup(e)}moveGroup(e,t,i){return this.getPart(e).moveGroup(e,t,i)}mergeGroup(e,t,i){return this.getPart(e).mergeGroup(e,t,i)}mergeAllGroups(e,t){return this.activePart.mergeAllGroups(e,t)}copyGroup(e,t,i){return this.getPart(e).copyGroup(e,t,i)}createEditorDropTarget(e,t){return this.getPart(e).createEditorDropTarget(e,t)}registerGroupsContextKeyListeners(){this._register(this.onDidChangeActiveGroup(()=>this.updateGlobalContextKeys())),this.groups.forEach(e=>this.registerGroupContextKeyProvidersListeners(e)),this._register(this.onDidAddGroup(e=>this.registerGroupContextKeyProvidersListeners(e))),this._register(this.onDidRemoveGroup(e=>{this.scopedContextKeys.delete(e.id),this.registeredContextKeys.delete(e.id),this.contextKeyProviderDisposables.deleteAndDispose(e.id)}))}updateGlobalContextKeys(){const e=this.scopedContextKeys.get(this.activeGroup.id);if(e)for(const[t,i]of this.globalContextKeys){const s=e.get(t);s?i.set(s.get()):i.reset()}}bind(e,t){let i=this.globalContextKeys.get(e.key);i||(i=e.bindTo(this.contextKeyService),this.globalContextKeys.set(e.key,i));let s=this.scopedContextKeys.get(t.id);s||(s=new Map,this.scopedContextKeys.set(t.id,s));let o=s.get(e.key);o||(o=e.bindTo(t.scopedContextKeyService),s.set(e.key,o));const r=this;return{get(){return o.get()},set(n){r.activeGroup===t&&i.set(n),o.set(n)},reset(){r.activeGroup===t&&i.reset(),o.reset()}}}registerContextKeyProvider(e){if(this.contextKeyProviders.has(e.contextKey.key)||this.globalContextKeys.has(e.contextKey.key))throw new Error(`A context key provider for key ${e.contextKey.key} already exists.`);this.contextKeyProviders.set(e.contextKey.key,e);const t=()=>{for(const s of this.groups)this.updateRegisteredContextKey(s,e)};t();const i=e.onDidChange?.(()=>t());return pe(()=>{i?.dispose(),this.globalContextKeys.delete(e.contextKey.key),this.scopedContextKeys.forEach(s=>s.delete(e.contextKey.key)),this.contextKeyProviders.delete(e.contextKey.key),this.registeredContextKeys.forEach(s=>s.delete(e.contextKey.key))})}registerGroupContextKeyProvidersListeners(e){const t=e.onDidActiveEditorChange(()=>{for(const i of this.contextKeyProviders.values())this.updateRegisteredContextKey(e,i)});this.contextKeyProviderDisposables.set(e.id,t)}updateRegisteredContextKey(e,t){let i=this.registeredContextKeys.get(e.id);i||(i=new Map,this.registeredContextKeys.set(e.id,i));let s=i.get(t.contextKey.key);s||(s=this.bind(t.contextKey,e),i.set(t.contextKey.key,s)),s.set(t.getGroupContextKeyValue(e))}get partOptions(){return this.mainPart.partOptions}get onDidChangeEditorPartOptions(){return this.mainPart.onDidChangeEditorPartOptions}enforcePartOptions(e){return this.mainPart.enforcePartOptions(e)}},Lr=ir,ir.EDITOR_PARTS_UI_STATE_STORAGE_KEY="editorparts.state",ir.EDITOR_WORKING_SETS_STORAGE_KEY="editor.workingSets",ir);fC=Lr=D([u(0,z),u(1,ge),u(2,we),u(3,Mb),u(4,de)],fC);var tm;xe(nT);var an;let im=(an=class extends Ec{get preferredHeight(){return this.layoutService.mainContainerDimension.height*.4}get preferredWidth(){const e=this.getActivePaneComposite();if(!e)return;const t=e.getOptimalWidth();if(typeof t=="number")return Math.max(t,300)}constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m){super(j.PANEL_PART,{hasTitle:!0,trailingSeparator:!0},tm.activePanelSettingsKey,tT.bindTo(h),iT.bindTo(h),"panel","panel",void 0,sT,e,t,i,s,o,r,n,d,l,h,p,f),this.commandService=g,this.configurationService=m,this.minimumWidth=300,this.maximumWidth=Number.POSITIVE_INFINITY,this.minimumHeight=77,this.maximumHeight=Number.POSITIVE_INFINITY,this._register(this.configurationService.onDidChangeConfiguration(v=>{v.affectsConfiguration("workbench.panel.showLabels")&&this.updateCompositeBar(!0)}))}updateStyles(){super.updateStyles();const e=fe(this.getContainer());e.style.backgroundColor=this.getColor(ng)||"";const t=this.getColor(Zl)||this.getColor(es)||"";e.style.borderLeftColor=t,e.style.borderRightColor=t,e.style.borderBottomColor=t,this.titleArea&&(this.titleArea.style.borderTopColor=this.getColor(Zl)||this.getColor(es)||"")}getCompositeBarOptions(){return{partContainerClass:"panel",pinnedViewContainersKey:"workbench.panel.pinnedPanels",placeholderViewContainersKey:"workbench.panel.placeholderPanels",viewContainersWorkspaceStateKey:"workbench.panel.viewContainersWorkspaceState",icon:this.configurationService.getValue("workbench.panel.showLabels")===!1,orientation:Fn.HORIZONTAL,recomputeSizes:!0,activityHoverOptions:{position:()=>this.layoutService.getPanelPosition()===hi.BOTTOM&&!this.layoutService.isPanelMaximized()?Ya.ABOVE:Ya.BELOW},fillExtraContextMenuActions:e=>this.fillExtraContextMenuActions(e),compositeSize:0,iconSize:16,compact:!0,overflowActionSize:44,colors:e=>({activeBackgroundColor:e.getColor(ng),inactiveBackgroundColor:e.getColor(ng),activeBorderBottomColor:e.getColor(dS),activeForegroundColor:e.getColor(nS),inactiveForegroundColor:e.getColor(oS),badgeBackground:e.getColor(rT),badgeForeground:e.getColor(oT),dragAndDropBorder:e.getColor(eS)})}}fillExtraContextMenuActions(e){if(this.getCompositeBarPosition()===Re.TITLE){const d=this.getViewsSubmenuAction();d&&(e.push(new ys),e.push(d))}const t=this.menuService.getMenuActions(b.PanelPositionMenu,this.contextKeyService,{shouldForwardArgs:!0}),i=this.menuService.getMenuActions(b.PanelAlignmentMenu,this.contextKeyService,{shouldForwardArgs:!0}),s=Ul(t).secondary,o=Ul(i).secondary,r=this.configurationService.getValue("workbench.panel.showLabels"),n=Gt({id:"workbench.action.panel.toggleShowLabels",label:r?c(3632,"Show Icons"):c(3633,"Show Labels"),run:()=>this.configurationService.updateValue("workbench.panel.showLabels",!r)});e.push(new ys,new Wl("workbench.action.panel.position",c(3634,"Panel Position"),s),new Wl("workbench.action.panel.align",c(3635,"Align Panel"),o),n,Gt({id:iy.ID,label:c(3636,"Hide Panel"),run:()=>this.commandService.executeCommand(iy.ID)}))}layout(e,t,i,s){let o;switch(this.layoutService.getPanelPosition()){case hi.RIGHT:o=new Be(e-1,t);break;case hi.TOP:o=new Be(e,t-1);break;default:o=new Be(e,t);break}super.layout(o.width,o.height,i,s)}shouldShowCompositeBar(){return!0}getCompositeBarPosition(){return Re.TITLE}toJSON(){return{type:j.PANEL_PART}}},tm=an,an.activePanelSettingsKey="workbench.panelpart.activepanelid",an);im=tm=D([u(0,Qe),u(1,ge),u(2,st),u(3,je),u(4,ot),u(5,oi),u(6,z),u(7,we),u(8,At),u(9,de),u(10,si),u(11,ke),u(12,Js),u(13,te)],im);const gI=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));xe(gI);S(class extends R{constructor(){super({id:"workbench.action.closeSidebar",title:y(3637,"Close Primary Side Bar"),category:T.View,f1:!0,precondition:xb})}run(a){a.get(je).setPartHidden(!0,j.SIDEBAR_PART)}});class zO extends R{constructor(){super({id:"workbench.action.focusSideBar",title:y(3638,"Focus into Primary Side Bar"),category:T.View,f1:!0,keybinding:{weight:L.WorkbenchContrib,when:null,primary:C.CtrlCmd|w.Digit0}})}async run(e){const t=e.get(je),i=e.get(_r);t.isVisible(j.SIDEBAR_PART)||t.setPartHidden(!1,j.SIDEBAR_PART),i.getActivePaneComposite(ce.Sidebar)?.focus()}}S(zO);var sm;xe(gI);var dn;let om=(dn=class extends Ec{get snap(){return!0}get preferredWidth(){const e=this.getActivePaneComposite();if(!e)return;const t=e.getOptimalWidth();if(typeof t=="number")return Math.max(t,300)}constructor(e,t,i,s,o,r,n,d,l,h,p,g,f){super(j.SIDEBAR_PART,{hasTitle:!0,trailingSeparator:!1,borderWidth:()=>this.getColor(Kl)||this.getColor(es)?1:0},sm.activeViewletSettingsKey,aT.bindTo(h),dT.bindTo(h),"sideBar","viewlet",cT,ZC,e,t,i,s,o,r,n,d,l,h,p,f),this.configurationService=g,this.minimumWidth=170,this.maximumWidth=Number.POSITIVE_INFINITY,this.minimumHeight=0,this.maximumHeight=Number.POSITIVE_INFINITY,this.priority=Vs.Low,this.activityBarPart=this._register(this.instantiationService.createInstance(gl,this)),this.rememberActivityBarVisiblePosition(),this._register(g.onDidChangeConfiguration(m=>{m.affectsConfiguration(Ei.ACTIVITY_BAR_LOCATION)&&this.onDidChangeActivityBarLocation()})),this.registerActions()}onDidChangeActivityBarLocation(){this.activityBarPart.hide(),this.updateCompositeBar();const e=this.getActiveComposite()?.getId();e&&this.onTitleAreaUpdate(e),this.shouldShowActivityBar()&&this.activityBarPart.show(),this.rememberActivityBarVisiblePosition()}updateStyles(){super.updateStyles();const e=fe(this.getContainer());e.style.backgroundColor=this.getColor(ya)||"",e.style.color=this.getColor(QC)||"";const t=this.getColor(Kl)||this.getColor(es),i=this.layoutService.getSideBarPosition()===hi.LEFT;e.style.borderRightWidth=t&&i?"1px":"",e.style.borderRightStyle=t&&i?"solid":"",e.style.borderRightColor=i&&t||"",e.style.borderLeftWidth=t&&!i?"1px":"",e.style.borderLeftStyle=t&&!i?"solid":"",e.style.borderLeftColor=i?"":t||"",e.style.outlineColor=this.getColor(lT)??""}layout(e,t,i,s){this.layoutService.isVisible(j.SIDEBAR_PART)&&super.layout(e,t,i,s)}getTitleAreaDropDownAnchorAlignment(){return this.layoutService.getSideBarPosition()===hi.LEFT?Bl.LEFT:Bl.RIGHT}createCompositeBar(){return this.instantiationService.createInstance(hT,this.getCompositeBarOptions(),this.partId,this,!1)}getCompositeBarOptions(){return{partContainerClass:"sidebar",pinnedViewContainersKey:gl.pinnedViewContainersKey,placeholderViewContainersKey:gl.placeholderViewContainersKey,viewContainersWorkspaceStateKey:gl.viewContainersWorkspaceStateKey,icon:!0,orientation:Fn.HORIZONTAL,recomputeSizes:!0,activityHoverOptions:{position:()=>this.getCompositeBarPosition()===Re.BOTTOM?Ya.ABOVE:Ya.BELOW},fillExtraContextMenuActions:e=>{if(this.getCompositeBarPosition()===Re.TITLE){const t=this.getViewsSubmenuAction();t&&(e.push(new ys),e.push(t))}},compositeSize:0,iconSize:16,overflowActionSize:30,colors:e=>({activeBackgroundColor:e.getColor(ya),inactiveBackgroundColor:e.getColor(ya),activeBorderBottomColor:e.getColor(cS),activeForegroundColor:e.getColor(aS),inactiveForegroundColor:e.getColor(rS),badgeBackground:e.getColor(sS),badgeForeground:e.getColor(iS),dragAndDropBorder:e.getColor(tS)}),compact:!0}}shouldShowCompositeBar(){const e=this.configurationService.getValue(Ei.ACTIVITY_BAR_LOCATION);return e===at.TOP||e===at.BOTTOM}shouldShowActivityBar(){return this.shouldShowCompositeBar()?!1:this.configurationService.getValue(Ei.ACTIVITY_BAR_LOCATION)!==at.HIDDEN}getCompositeBarPosition(){switch(this.configurationService.getValue(Ei.ACTIVITY_BAR_LOCATION)){case at.TOP:return Re.TOP;case at.BOTTOM:return Re.BOTTOM;case at.HIDDEN:case at.DEFAULT:default:return Re.TITLE}}rememberActivityBarVisiblePosition(){const e=this.configurationService.getValue(Ei.ACTIVITY_BAR_LOCATION);e!==at.HIDDEN&&this.storageService.store(Ei.ACTIVITY_BAR_LOCATION,e,ee.PROFILE,Ze.USER)}getRememberedActivityBarVisiblePosition(){switch(this.storageService.get(Ei.ACTIVITY_BAR_LOCATION,ee.PROFILE)){case at.TOP:return at.TOP;case at.BOTTOM:return at.BOTTOM;default:return at.DEFAULT}}getPinnedPaneCompositeIds(){return this.shouldShowCompositeBar()?super.getPinnedPaneCompositeIds():this.activityBarPart.getPinnedPaneCompositeIds()}getVisiblePaneCompositeIds(){return this.shouldShowCompositeBar()?super.getVisiblePaneCompositeIds():this.activityBarPart.getVisiblePaneCompositeIds()}getPaneCompositeIds(){return this.shouldShowCompositeBar()?super.getPaneCompositeIds():this.activityBarPart.getPaneCompositeIds()}async focusActivityBar(){this.configurationService.getValue(Ei.ACTIVITY_BAR_LOCATION)===at.HIDDEN&&(await this.configurationService.updateValue(Ei.ACTIVITY_BAR_LOCATION,this.getRememberedActivityBarVisiblePosition()),this.onDidChangeActivityBarLocation()),this.shouldShowCompositeBar()?this.focusCompositeBar():(this.layoutService.isVisible(j.ACTIVITYBAR_PART)||this.layoutService.setPartHidden(!1,j.ACTIVITYBAR_PART),this.activityBarPart.show(!0))}registerActions(){const e=this;this._register(S(class extends R{constructor(){super({id:uT,title:y(3639,"Toggle Activity Bar Visibility")})}run(){const t=e.configurationService.getValue(Ei.ACTIVITY_BAR_LOCATION)===at.HIDDEN?e.getRememberedActivityBarVisiblePosition():at.HIDDEN;return e.configurationService.updateValue(Ei.ACTIVITY_BAR_LOCATION,t)}}))}toJSON(){return{type:j.SIDEBAR_PART}}},sm=dn,dn.activeViewletSettingsKey="workbench.sidebar.activeviewletid",dn);om=sm=D([u(0,Qe),u(1,ge),u(2,st),u(3,je),u(4,ot),u(5,oi),u(6,z),u(7,we),u(8,At),u(9,de),u(10,si),u(11,te),u(12,Js)],om);let rm=class extends M{constructor(e,t,i){super(),this.viewId=e,this.viewDescriptorService=t,this.activityService=i,this.activity=void 0,this.activityDisposable=M.None,this._register(K.filter(this.viewDescriptorService.onDidChangeContainer,s=>s.views.some(o=>o.id===e))(()=>this.update())),this._register(K.filter(this.viewDescriptorService.onDidChangeLocation,s=>s.views.some(o=>o.id===e))(()=>this.update()))}setActivity(e){this.activity=e,this.update()}clearActivity(){this.activity=void 0,this.update()}update(){this.activityDisposable.dispose();const e=this.viewDescriptorService.getViewContainerByViewId(this.viewId);e&&this.activity&&(this.activityDisposable=this.activityService.showViewContainerActivity(e.id,this.activity))}dispose(){this.activityDisposable.dispose(),super.dispose()}};rm=D([u(1,At),u(2,Ir)],rm);let nm=class extends M{constructor(e,t){super(),this.viewDescriptorService=e,this.instantiationService=t,this.viewActivities=new Map,this._onDidChangeActivity=this._register(new A),this.onDidChangeActivity=this._onDidChangeActivity.event,this.viewContainerActivities=new Map,this.globalActivities=new Map}showViewContainerActivity(e,t){const i=this.viewDescriptorService.getViewContainerById(e);if(!i)return M.None;let s=this.viewContainerActivities.get(e);return s||(s=[],this.viewContainerActivities.set(e,s)),s.push(t),this._onDidChangeActivity.fire(i),pe(()=>{s.splice(s.indexOf(t),1),s.length===0&&this.viewContainerActivities.delete(e),this._onDidChangeActivity.fire(i)})}getViewContainerActivities(e){return this.viewDescriptorService.getViewContainerById(e)?this.viewContainerActivities.get(e)??[]:[]}showViewActivity(e,t){let i=this.viewActivities.get(e);i?i.id++:(i={id:1,activity:this.instantiationService.createInstance(rm,e)},this.viewActivities.set(e,i));const s=i.id;i.activity.setActivity(t);const o=i;return pe(()=>{o.id===s&&(o.activity.dispose(),this.viewActivities.delete(e))})}showAccountsActivity(e){return this.showActivity(pT,e)}showGlobalActivity(e){return this.showActivity(gT,e)}getActivity(e){return this.globalActivities.get(e)??[]}showActivity(e,t){let i=this.globalActivities.get(e);return i||(i=[],this.globalActivities.set(e,i)),i.push(t),this._onDidChangeActivity.fire(e),pe(()=>{i.splice(i.indexOf(t),1),i.length===0&&this.globalActivities.delete(e),this._onDidChangeActivity.fire(e)})}};nm=D([u(0,At),u(1,z)],nm);class Rc{static _readModifiers(e){e=e.toLowerCase().trim();let t=!1,i=!1,s=!1,o=!1,r;do r=!1,/^ctrl(\+|\-)/.test(e)&&(t=!0,e=e.substr(5),r=!0),/^shift(\+|\-)/.test(e)&&(i=!0,e=e.substr(6),r=!0),/^alt(\+|\-)/.test(e)&&(s=!0,e=e.substr(4),r=!0),/^meta(\+|\-)/.test(e)&&(o=!0,e=e.substr(5),r=!0),/^win(\+|\-)/.test(e)&&(o=!0,e=e.substr(4),r=!0),/^cmd(\+|\-)/.test(e)&&(o=!0,e=e.substr(4),r=!0);while(r);let n;const d=e.indexOf(" ");return d>0?(n=e.substring(0,d),e=e.substring(d)):(n=e,e=""),{remains:e,ctrl:t,shift:i,alt:s,meta:o,key:n}}static parseChord(e){const t=this._readModifiers(e),i=t.key.match(/^\[([^\]]+)\]$/);if(i){const o=i[1],r=Di.lowerCaseToEnum(o);return[new qo(t.ctrl,t.shift,t.alt,t.meta,r),t.remains]}const s=Bt.fromUserSettings(t.key);return[new Jo(t.ctrl,t.shift,t.alt,t.meta,s),t.remains]}static parseKeybinding(e){if(!e)return null;const t=[];let i;for(;e.length>0;)[i,e]=this.parseChord(e),t.push(i);return t.length>0?new fT(t):null}}const fI=[{key:"commandPalette",id:b.CommandPalette,description:c(13586,"The Command Palette"),supportsSubmenus:!1},{key:"touchBar",id:b.TouchBarContext,description:c(13587,"The touch bar (macOS only)"),supportsSubmenus:!1},{key:"editor/title",id:b.EditorTitle,description:c(13588,"The editor title menu")},{key:"editor/title/run",id:b.EditorTitleRun,description:c(13589,"Run submenu inside the editor title menu")},{key:"editor/context",id:b.EditorContext,description:c(13590,"The editor context menu")},{key:"editor/context/copy",id:b.EditorContextCopy,description:c(13591,"'Copy as' submenu in the editor context menu")},{key:"editor/context/share",id:b.EditorContextShare,description:c(13592,"'Share' submenu in the editor context menu"),proposed:"contribShareMenu"},{key:"explorer/context",id:b.ExplorerContext,description:c(13593,"The file explorer context menu")},{key:"explorer/context/share",id:b.ExplorerContextShare,description:c(13594,"'Share' submenu in the file explorer context menu"),proposed:"contribShareMenu"},{key:"editor/title/context",id:b.EditorTitleContext,description:c(13595,"The editor tabs context menu")},{key:"editor/title/context/share",id:b.EditorTitleContextShare,description:c(13596,"'Share' submenu inside the editor title context menu"),proposed:"contribShareMenu"},{key:"debug/callstack/context",id:b.DebugCallStackContext,description:c(13597,"The debug callstack view context menu")},{key:"debug/variables/context",id:b.DebugVariablesContext,description:c(13598,"The debug variables view context menu")},{key:"debug/watch/context",id:b.DebugWatchContext,description:c(13599,"The debug watch view context menu")},{key:"debug/toolBar",id:b.DebugToolBar,description:c(13600,"The debug toolbar menu")},{key:"debug/createConfiguration",id:b.DebugCreateConfiguration,proposed:"contribDebugCreateConfiguration",description:c(13601,"The debug create configuration menu")},{key:"notebook/variables/context",id:b.NotebookVariablesContext,description:c(13602,"The notebook variables view context menu")},{key:"menuBar/home",id:b.MenubarHomeMenu,description:c(13603,"The home indicator context menu (web only)"),proposed:"contribMenuBarHome",supportsSubmenus:!1},{key:"menuBar/edit/copy",id:b.MenubarCopy,description:c(13604,"'Copy as' submenu in the top level Edit menu")},{key:"scm/title",id:b.SCMTitle,description:c(13605,"The Source Control title menu")},{key:"scm/sourceControl",id:b.SCMSourceControl,description:c(13606,"The Source Control menu")},{key:"scm/repositories/title",id:b.SCMSourceControlTitle,description:c(13607,"The Source Control Repositories title menu"),proposed:"contribSourceControlTitleMenu"},{key:"scm/repository",id:b.SCMSourceControlInline,description:c(13608,"The Source Control repository menu")},{key:"scm/resourceState/context",id:b.SCMResourceContext,description:c(13609,"The Source Control resource state context menu")},{key:"scm/resourceFolder/context",id:b.SCMResourceFolderContext,description:c(13610,"The Source Control resource folder context menu")},{key:"scm/resourceGroup/context",id:b.SCMResourceGroupContext,description:c(13611,"The Source Control resource group context menu")},{key:"scm/change/title",id:b.SCMChangeContext,description:c(13612,"The Source Control inline change menu")},{key:"scm/inputBox",id:b.SCMInputBox,description:c(13613,"The Source Control input box menu"),proposed:"contribSourceControlInputBoxMenu"},{key:"scm/history/title",id:b.SCMHistoryTitle,description:c(13614,"The Source Control History title menu"),proposed:"contribSourceControlHistoryTitleMenu"},{key:"scm/historyItem/context",id:b.SCMHistoryItemContext,description:c(13615,"The Source Control history item context menu"),proposed:"contribSourceControlHistoryItemMenu"},{key:"scm/historyItemRef/context",id:b.SCMHistoryItemRefContext,description:c(13616,"The Source Control history item reference context menu"),proposed:"contribSourceControlHistoryItemMenu"},{key:"scm/artifactGroup/context",id:b.SCMArtifactGroupContext,description:c(13617,"The Source Control artifact group context menu"),proposed:"contribSourceControlArtifactGroupMenu"},{key:"scm/artifact/context",id:b.SCMArtifactContext,description:c(13618,"The Source Control artifact context menu"),proposed:"contribSourceControlArtifactMenu"},{key:"statusBar/remoteIndicator",id:b.StatusBarRemoteIndicatorMenu,description:c(13619,"The remote indicator menu in the status bar"),supportsSubmenus:!1},{key:"terminal/context",id:b.TerminalInstanceContext,description:c(13620,"The terminal context menu")},{key:"terminal/title/context",id:b.TerminalTabContext,description:c(13621,"The terminal tabs context menu")},{key:"view/title",id:b.ViewTitle,description:c(13622,"The contributed view title menu")},{key:"viewContainer/title",id:b.ViewContainerTitle,description:c(13623,"The contributed view container title menu"),proposed:"contribViewContainerTitle"},{key:"view/item/context",id:b.ViewItemContext,description:c(13624,"The contributed view item context menu")},{key:"comments/comment/editorActions",id:b.CommentEditorActions,description:c(13625,"The contributed comment editor actions"),proposed:"contribCommentEditorActionsMenu"},{key:"comments/commentThread/title",id:b.CommentThreadTitle,description:c(13626,"The contributed comment thread title menu")},{key:"comments/commentThread/context",id:b.CommentThreadActions,description:c(13627,"The contributed comment thread context menu, rendered as buttons below the comment editor"),supportsSubmenus:!1},{key:"comments/commentThread/additionalActions",id:b.CommentThreadAdditionalActions,description:c(13627,"The contributed comment thread context menu, rendered as buttons below the comment editor"),supportsSubmenus:!0,proposed:"contribCommentThreadAdditionalMenu"},{key:"comments/commentThread/title/context",id:b.CommentThreadTitleContext,description:c(13628,"The contributed comment thread title's peek context menu, rendered as a right click menu on the comment thread's peek title."),proposed:"contribCommentPeekContext"},{key:"comments/comment/title",id:b.CommentTitle,description:c(13629,"The contributed comment title menu")},{key:"comments/comment/context",id:b.CommentActions,description:c(13630,"The contributed comment context menu, rendered as buttons below the comment editor"),supportsSubmenus:!1},{key:"comments/commentThread/comment/context",id:b.CommentThreadCommentContext,description:c(13631,"The contributed comment context menu, rendered as a right click menu on the an individual comment in the comment thread's peek view."),proposed:"contribCommentPeekContext"},{key:"commentsView/commentThread/context",id:b.CommentsViewThreadActions,description:c(13632,"The contributed comment thread context menu in the comments view"),proposed:"contribCommentsViewThreadMenus"},{key:"notebook/toolbar",id:b.NotebookToolbar,description:c(13633,"The contributed notebook toolbar menu")},{key:"notebook/kernelSource",id:b.NotebookKernelSource,description:c(13634,"The contributed notebook kernel sources menu"),proposed:"notebookKernelSource"},{key:"notebook/cell/title",id:b.NotebookCellTitle,description:c(13635,"The contributed notebook cell title menu")},{key:"notebook/cell/execute",id:b.NotebookCellExecute,description:c(13636,"The contributed notebook cell execution menu")},{key:"interactive/toolbar",id:b.InteractiveToolbar,description:c(13637,"The contributed interactive toolbar menu")},{key:"interactive/cell/title",id:b.InteractiveCellTitle,description:c(13638,"The contributed interactive cell title menu")},{key:"issue/reporter",id:b.IssueReporter,description:c(13639,"The contributed issue reporter menu")},{key:"testing/item/context",id:b.TestItem,description:c(13640,"The contributed test item menu")},{key:"testing/item/gutter",id:b.TestItemGutter,description:c(13641,"The menu for a gutter decoration for a test item")},{key:"testing/profiles/context",id:b.TestProfilesContext,description:c(13642,"The menu for configuring testing profiles.")},{key:"testing/item/result",id:b.TestPeekElement,description:c(13643,"The menu for an item in the Test Results view or peek.")},{key:"testing/message/context",id:b.TestMessageContext,description:c(13644,"A prominent button overlaying editor content where the message is displayed")},{key:"testing/message/content",id:b.TestMessageContent,description:c(13645,"Context menu for the message in the results tree")},{key:"extension/context",id:b.ExtensionContext,description:c(13646,"The extension context menu")},{key:"timeline/title",id:b.TimelineTitle,description:c(13647,"The Timeline view title menu")},{key:"timeline/item/context",id:b.TimelineItemContext,description:c(13648,"The Timeline view item context menu")},{key:"ports/item/context",id:b.TunnelContext,description:c(13649,"The Ports view item context menu")},{key:"ports/item/origin/inline",id:b.TunnelOriginInline,description:c(13650,"The Ports view item origin inline menu")},{key:"ports/item/port/inline",id:b.TunnelPortInline,description:c(13651,"The Ports view item port inline menu")},{key:"file/newFile",id:b.NewFile,description:c(13652,"The 'New File...' quick pick, shown on welcome page and File menu."),supportsSubmenus:!1},{key:"webview/context",id:b.WebviewContext,description:c(13653,"The webview context menu")},{key:"file/share",id:b.MenubarShare,description:c(13654,"Share submenu shown in the top level File menu."),proposed:"contribShareMenu"},{key:"editor/inlineCompletions/actions",id:b.InlineCompletionsActions,description:c(13655,"The actions shown when hovering on an inline completion"),supportsSubmenus:!1,proposed:"inlineCompletionsAdditions"},{key:"editor/content",id:b.EditorContent,description:c(13656,"The prominent button in an editor, overlays its content"),proposed:"contribEditorContentMenu"},{key:"editor/lineNumber/context",id:b.EditorLineNumberContext,description:c(13657,"The contributed editor line number context menu")},{key:"mergeEditor/result/title",id:b.MergeInputResultToolbar,description:c(13658,"The result toolbar of the merge editor"),proposed:"contribMergeEditorMenus"},{key:"multiDiffEditor/content",id:b.MultiDiffEditorContent,description:c(13659,"A prominent button overlaying the multi diff editor"),proposed:"contribEditorContentMenu"},{key:"multiDiffEditor/resource/title",id:b.MultiDiffEditorFileToolbar,description:c(13660,"The resource toolbar in the multi diff editor"),proposed:"contribMultiDiffEditorMenus"},{key:"diffEditor/gutter/hunk",id:b.DiffEditorHunkToolbar,description:c(13661,"The gutter toolbar in the diff editor"),proposed:"contribDiffEditorGutterToolBarMenus"},{key:"diffEditor/gutter/selection",id:b.DiffEditorSelectionToolbar,description:c(13661,"The gutter toolbar in the diff editor"),proposed:"contribDiffEditorGutterToolBarMenus"},{key:"searchPanel/aiResults/commands",id:b.SearchActionMenu,description:c(13662,"The commands that will contribute to the menu rendered as buttons next to the AI search title")},{key:"editor/context/chat",id:b.ChatTextEditorMenu,description:c(13663,"The Chat submenu in the text editor context menu."),supportsSubmenus:!1,proposed:"chatParticipantPrivate"},{key:"chat/input/editing/sessionToolbar",id:b.ChatEditingSessionChangesToolbar,description:c(13664,"The Chat Editing widget toolbar menu for session changes."),proposed:"chatSessionsProvider"},{key:"chat/chatSessions",id:b.AgentSessionsContext,description:c(13665,"The Chat Sessions menu."),supportsSubmenus:!1,proposed:"chatSessionsProvider"},{key:"chatSessions/newSession",id:b.AgentSessionsCreateSubMenu,description:c(13666,"Menu for new chat sessions."),supportsSubmenus:!1,proposed:"chatSessionsProvider"},{key:"chat/multiDiff/context",id:b.ChatMultiDiffContext,description:c(13667,"The Chat Multi-Diff context menu."),supportsSubmenus:!1,proposed:"chatSessionsProvider"}];var Do;(function(a){function e(f){return typeof f.command=="string"}a.isMenuItem=e;function t(f,m){return typeof f.command!="string"?(m.error(c(13668,"property `{0}` is mandatory and must be of type `string`","command")),!1):f.alt&&typeof f.alt!="string"?(m.error(c(13669,"property `{0}` can be omitted or must be of type `string`","alt")),!1):f.when&&typeof f.when!="string"?(m.error(c(13669,"property `{0}` can be omitted or must be of type `string`","when")),!1):f.group&&typeof f.group!="string"?(m.error(c(13669,"property `{0}` can be omitted or must be of type `string`","group")),!1):!0}a.isValidMenuItem=t;function i(f,m){return typeof f.submenu!="string"?(m.error(c(13668,"property `{0}` is mandatory and must be of type `string`","submenu")),!1):f.when&&typeof f.when!="string"?(m.error(c(13669,"property `{0}` can be omitted or must be of type `string`","when")),!1):f.group&&typeof f.group!="string"?(m.error(c(13669,"property `{0}` can be omitted or must be of type `string`","group")),!1):!0}a.isValidSubmenuItem=i;function s(f,m){if(!Array.isArray(f))return m.error(c(13670,"submenu items must be an array")),!1;for(const v of f)if(e(v)){if(!t(v,m))return!1}else if(!i(v,m))return!1;return!0}a.isValidItems=s;function o(f,m){return typeof f!="object"?(m.error(c(13671,"submenu items must be an object")),!1):typeof f.id!="string"?(m.error(c(13668,"property `{0}` is mandatory and must be of type `string`","id")),!1):typeof f.label!="string"?(m.error(c(13668,"property `{0}` is mandatory and must be of type `string`","label")),!1):!0}a.isValidSubmenu=o;const r={type:"object",required:["command"],properties:{command:{description:c(13672,"Identifier of the command to execute. The command must be declared in the 'commands'-section"),type:"string"},alt:{description:c(13673,"Identifier of an alternative command to execute. The command must be declared in the 'commands'-section"),type:"string"},when:{description:c(13674,"Condition which must be true to show this item"),type:"string"},group:{description:c(13675,"Group into which this item belongs"),type:"string"}}},n={type:"object",required:["submenu"],properties:{submenu:{description:c(13676,"Identifier of the submenu to display in this item."),type:"string"},when:{description:c(13674,"Condition which must be true to show this item"),type:"string"},group:{description:c(13675,"Group into which this item belongs"),type:"string"}}},d={type:"object",required:["id","label"],properties:{id:{description:c(13677,"Identifier of the menu to display as a submenu."),type:"string"},label:{description:c(13678,"The label of the menu item which leads to this submenu."),type:"string"},icon:{description:c(13679,'(Optional) Icon which is used to represent the submenu in the UI. Either a file path, an object with file paths for dark and light themes, or a theme icon references, like "\\$(zap)"'),anyOf:[{type:"string"},{type:"object",properties:{light:{description:c(13680,"Icon path when a light theme is used"),type:"string"},dark:{description:c(13681,"Icon path when a dark theme is used"),type:"string"}}}]}}};a.menusContribution={description:c(13682,"Contributes menu items to the editor"),type:"object",properties:jg(fI,f=>f.key,f=>({markdownDescription:f.proposed?c(13683,'Proposed API, requires `enabledApiProposal: ["{0}"]` - {1}',f.proposed,f.description):f.description,type:"array",items:f.supportsSubmenus===!1?r:{oneOf:[r,n]}})),additionalProperties:{description:"Submenu",type:"array",items:{oneOf:[r,n]}}},a.submenusContribution={description:c(13684,"Contributes submenu items to the editor"),type:"array",items:d};function l(f,m){return f?Nr(f.command)?(m.error(c(13668,"property `{0}` is mandatory and must be of type `string`","command")),!1):!p(f.title,m,"title")||f.shortTitle&&!p(f.shortTitle,m,"shortTitle")?!1:f.enablement&&typeof f.enablement!="string"?(m.error(c(13669,"property `{0}` can be omitted or must be of type `string`","precondition")),!1):!(f.category&&!p(f.category,m,"category")||!h(f.icon,m)):(m.error(c(13685,"expected non-empty value.")),!1)}a.isValidCommand=l;function h(f,m){return typeof f>"u"||typeof f=="string"||typeof f.dark=="string"&&typeof f.light=="string"?!0:(m.error(c(13686,"property `icon` can be omitted or must be either a string or a literal like `{dark, light}`")),!1)}function p(f,m,v){return typeof f>"u"?(m.error(c(13687,"property `{0}` is mandatory and must be of type `string` or `object`",v)),!1):typeof f=="string"&&Nr(f)?(m.error(c(13668,"property `{0}` is mandatory and must be of type `string`",v)),!1):typeof f!="string"&&(Nr(f.original)||Nr(f.value))?(m.error(c(13688,"properties `{0}` and `{1}` are mandatory and must be of type `string`",`${v}.value`,`${v}.original`)),!1):!0}const g={type:"object",required:["command","title"],properties:{command:{description:c(13689,"Identifier of the command to execute"),type:"string"},title:{description:c(13690,"Title by which the command is represented in the UI"),type:"string"},shortTitle:{markdownDescription:c(13691,"(Optional) Short title by which the command is represented in the UI. Menus pick either `title` or `shortTitle` depending on the context in which they show commands."),type:"string"},category:{description:c(13692,"(Optional) Category string by which the command is grouped in the UI"),type:"string"},enablement:{description:c(13693,"(Optional) Condition which must be true to enable the command in the UI (menu and keybindings). Does not prevent executing the command by other means, like the `executeCommand`-api."),type:"string"},icon:{description:c(13694,'(Optional) Icon which is used to represent the command in the UI. Either a file path, an object with file paths for dark and light themes, or a theme icon references, like "\\$(zap)"'),anyOf:[{type:"string"},{type:"object",properties:{light:{description:c(13695,"Icon path when a light theme is used"),type:"string"},dark:{description:c(13696,"Icon path when a dark theme is used"),type:"string"}}}]}}};a.commandsContribution={description:c(13697,"Contributes commands to the command palette."),oneOf:[g,{type:"array",items:g}]}})(Do||(Do={}));const mC=new B,mI=Un.registerExtensionPoint({extensionPoint:"commands",jsonSchema:Do.commandsContribution,activationEventsGenerator:function*(a){for(const e of a)e.command&&(yield`onCommand:${e.command}`)}});mI.setHandler(a=>{function e(t,i){if(!Do.isValidCommand(t,i.collector))return;const{icon:s,enablement:o,category:r,title:n,shortTitle:d,command:l}=t;let h;s&&(typeof s=="string"?h=Se.fromString(s)??{dark:po(i.description.extensionLocation,s),light:po(i.description.extensionLocation,s)}:h={dark:po(i.description.extensionLocation,s.dark),light:po(i.description.extensionLocation,s.light)});const p=_.getCommand(l);p&&(p.source?i.collector.info(c(13698,"Command `{0}` already registered by {1} ({2})",t.command,p.source.title,p.source.id)):i.collector.info(c(13699,"Command `{0}` already registered",t.command))),mC.add(_.addCommand({id:l,title:n,source:{id:i.description.identifier.value,title:i.description.displayName??i.description.name},shortTitle:d,tooltip:n,category:r,precondition:I.deserialize(o),icon:h}))}mC.clear();for(const t of a){const{value:i}=t;if(Array.isArray(i))for(const s of i)e(s,t);else e(i,t)}});const jd=new Map,wI=Un.registerExtensionPoint({extensionPoint:"submenus",jsonSchema:Do.submenusContribution});wI.setHandler(a=>{jd.clear();for(const e of a){const{value:t,collector:i}=e;for(const[,s]of Object.entries(t)){if(!Do.isValidSubmenu(s,i))continue;if(!s.id){i.warn(c(13700,"`{0}` is not a valid submenu identifier",s.id));continue}if(jd.has(s.id)){i.info(c(13701,"The `{0}` submenu was already previously registered.",s.id));continue}if(!s.label){i.warn(c(13702,"`{0}` is not a valid submenu label",s.label));continue}let o;s.icon&&(typeof s.icon=="string"?o=Se.fromString(s.icon)||{dark:po(e.description.extensionLocation,s.icon)}:o={dark:po(e.description.extensionLocation,s.icon.dark),light:po(e.description.extensionLocation,s.icon.light)});const r={id:b.for(`api:${s.id}`),label:s.label,icon:o};jd.set(s.id,r)}}});const $O=new Map(fI.map(a=>[a.key,a])),wC=new B,Dg=new Map,qO=Un.registerExtensionPoint({extensionPoint:"menus",jsonSchema:Do.menusContribution,deps:[wI]});qO.setHandler(a=>{wC.clear(),Dg.clear();for(const e of a){const{value:t,collector:i}=e;for(const s of Object.entries(t)){if(!Do.isValidItems(s[1],i))continue;let o=$O.get(s[0]);if(!o){const r=jd.get(s[0]);r&&(o={key:s[0],id:r.id,description:""})}if(o){if(o.proposed&&!Il(e.description,o.proposed)){i.error(c(13703,`{0} is a proposed menu identifier. It requires 'package.json#enabledApiProposals: ["{1}"]' and is only available when running out of dev or with the following command line switch: --enable-proposed-api {2}`,s[0],o.proposed,e.description.identifier.value));continue}for(const r of s[1]){let n;if(Do.isMenuItem(r)){const d=_.getCommand(r.command),l=r.alt&&_.getCommand(r.alt)||void 0;if(!d){i.error(c(13704,"Menu item references a command `{0}` which is not defined in the 'commands' section.",r.command));continue}r.alt&&!l&&i.warn(c(13705,"Menu item references an alt-command `{0}` which is not defined in the 'commands' section.",r.alt)),r.command===r.alt&&i.info(c(13706,"Menu item references the same command as default and alt-command")),n={command:d,alt:l,group:void 0,order:void 0,when:void 0}}else{if(o.supportsSubmenus===!1){i.error(c(13707,"Menu item references a submenu for a menu which doesn't have submenu support."));continue}const d=jd.get(r.submenu);if(!d){i.error(c(13708,"Menu item references a submenu `{0}` which is not defined in the 'submenus' section.",r.submenu));continue}let l=Dg.get(o.id.id);if(l||(l=new Set,Dg.set(o.id.id,l)),l.has(d.id.id)){i.warn(c(13709,"The `{0}` submenu was already contributed to the `{1}` menu.",r.submenu,s[0]));continue}l.add(d.id.id),n={submenu:d.id,icon:d.icon,title:d.label,group:void 0,order:void 0,when:void 0}}if(r.group){const d=r.group.lastIndexOf("@");d>0?(n.group=r.group.substr(0,d),n.order=Number(r.group.substr(d+1))||void 0):n.group=r.group}if(o.id===b.ViewContainerTitle&&!r.when?.includes("viewContainer == workbench.view.debug")){i.error(c(13710,"The {0} menu contribution must check {1} in its {2} clause.","`viewContainer/title`","`viewContainer == workbench.view.debug`",'"when"'));continue}n.when=I.deserialize(r.when),wC.add(_.appendMenuItem(o.id,n))}}}}});let am=class extends M{constructor(e){super(),this._keybindingService=e,this.type="table"}shouldRender(e){return!!e.contributes?.commands}render(e){const i=(e.contributes?.commands||[]).map(h=>({id:h.command,title:h.title,keybindings:[],menus:[]})),s=jg(i,h=>h.id),o=e.contributes?.menus||{},r=jg(i,h=>h.id);if(o.commandPalette)for(const h of o.commandPalette)delete r[h.command];if(Object.keys(r).length){o.commandPalette||(o.commandPalette=[]);for(const h in r)o.commandPalette.push({command:h})}for(const h in o)for(const p of o[h])if(p.when!=="false"&&p.command){let g=s[p.command];g?g.menus.includes(h)||g.menus.push(h):(g={id:p.command,title:"",keybindings:[],menus:[h]},s[g.id]=g,i.push(g))}if((e.contributes?.keybindings?Array.isArray(e.contributes.keybindings)?e.contributes.keybindings:[e.contributes.keybindings]:[]).forEach(h=>{const p=this.resolveKeybinding(h);if(!p)return;let g=s[h.command];g?g.keybindings.push(p):(g={id:h.command,title:"",keybindings:[p],menus:[]},s[g.id]=g,i.push(g))}),!i.length)return{data:{headers:[],rows:[]},dispose:()=>{}};const d=[c(13711,"ID"),c(13712,"Title"),c(13713,"Keyboard Shortcuts"),c(13714,"Menu Contexts")],l=i.sort((h,p)=>h.id.localeCompare(p.id)).map(h=>[new Zi().appendMarkdown(`\`${h.id}\``),typeof h.title=="string"?h.title:h.title.value,h.keybindings,new Zi().appendMarkdown(`${h.menus.sort((p,g)=>p.localeCompare(g)).map(p=>`\`${p}\``).join("&nbsp;")}`)]);return{data:{headers:d,rows:l},dispose:()=>{}}}resolveKeybinding(e){let t;switch(mT){case"win32":t=e.win;break;case"linux":t=e.linux;break;case"darwin":t=e.mac;break}return this._keybindingService.resolveUserBinding(t??e.key)[0]}};am=D([u(0,ot)],am);se.as(Ip.ExtensionFeaturesRegistry).registerExtensionFeature({id:"commands",label:c(13715,"Commands"),access:{canToggle:!1},renderer:new he(am)});class bI{static writeKeybindingItem(e,t){if(!t.resolvedKeybinding)return;const i=JSON.stringify(t.resolvedKeybinding.getUserSettingsLabel());e.write(`{ "key": ${jO(i+",",25)} "command": `);const s=t.when?JSON.stringify(t.when.serialize()):"",o=JSON.stringify(t.command);s.length>0?(e.write(`${o},`),e.writeLine(),e.write(`                                     "when": ${s}`)):e.write(`${o}`),t.commandArgs&&(e.write(","),e.writeLine(),e.write(`                                     "args": ${JSON.stringify(t.commandArgs)}`)),e.write(" }")}static readUserKeybindingItem(e){const t="key"in e&&typeof e.key=="string"?Rc.parseKeybinding(e.key):null,i="when"in e&&typeof e.when=="string"?I.deserialize(e.when):void 0,s="command"in e&&typeof e.command=="string"?e.command:null,o="args"in e&&typeof e.args<"u"?e.args:void 0;return{keybinding:t,command:s,commandArgs:o,when:i,_sourceKey:"key"in e&&typeof e.key=="string"?e.key:void 0}}}function jO(a,e){return a.length<e?a+new Array(e-a.length).join(" "):a}class YO{constructor(){this._lines=[],this._currentLine=""}write(e){this._currentLine+=e}writeLine(e=""){this._lines.push(this._currentLine+e),this._currentLine=""}toString(){return this.writeLine(),this._lines.join(`
`)}}var Rd;function XO(a,e){return a?typeof a.command!="string"?(e.push(c(14117,"property `{0}` is mandatory and must be of type `string`","command")),!1):a.key&&typeof a.key!="string"?(e.push(c(14118,"property `{0}` can be omitted or must be of type `string`","key")),!1):a.when&&typeof a.when!="string"?(e.push(c(14118,"property `{0}` can be omitted or must be of type `string`","when")),!1):a.mac&&typeof a.mac!="string"?(e.push(c(14118,"property `{0}` can be omitted or must be of type `string`","mac")),!1):a.linux&&typeof a.linux!="string"?(e.push(c(14118,"property `{0}` can be omitted or must be of type `string`","linux")),!1):a.win&&typeof a.win!="string"?(e.push(c(14118,"property `{0}` can be omitted or must be of type `string`","win")),!1):!0:(e.push(c(14116,"expected non-empty value.")),!1)}const bC={type:"object",default:{command:"",key:""},required:["command","key"],properties:{command:{description:c(14119,"Identifier of the command to run when keybinding is triggered."),type:"string"},args:{description:c(14120,"Arguments to pass to the command to execute.")},key:{description:c(14121,"Key or key sequence (separate keys with plus-sign and sequences with space, e.g. Ctrl+O and Ctrl+L L for a chord)."),type:"string"},mac:{description:c(14122,"Mac specific key or key sequence."),type:"string"},linux:{description:c(14123,"Linux specific key or key sequence."),type:"string"},win:{description:c(14124,"Windows specific key or key sequence."),type:"string"},when:{description:c(14125,"Condition when the key is active."),type:"string"}}},vC=Un.registerExtensionPoint({extensionPoint:"keybindings",deps:[mI],jsonSchema:{description:c(14126,"Contributes keybindings."),oneOf:[bC,{type:"array",items:bC}]}}),JO=[V.NumpadDivide,V.NumpadMultiply,V.NumpadSubtract,V.NumpadAdd,V.Numpad1,V.Numpad2,V.Numpad3,V.Numpad4,V.Numpad5,V.Numpad6,V.Numpad7,V.Numpad8,V.Numpad9,V.Numpad0,V.NumpadDecimal],As=new Map;As.set(V.Numpad1,w.Digit1);As.set(V.Numpad2,w.Digit2);As.set(V.Numpad3,w.Digit3);As.set(V.Numpad4,w.Digit4);As.set(V.Numpad5,w.Digit5);As.set(V.Numpad6,w.Digit6);As.set(V.Numpad7,w.Digit7);As.set(V.Numpad8,w.Digit8);As.set(V.Numpad9,w.Digit9);As.set(V.Numpad0,w.Digit0);let dm=Rd=class extends wT{constructor(e,t,i,s,o,r,n,d,l,h,p){super(e,t,i,s,h),this.hostService=r,this.keyboardLayoutService=p,this._contributions=[],this.isComposingGlobalContextKey=e.createKey("isComposing",!1),this.kbsJsonSchema=new cm,this.updateKeybindingsJsonSchema(),this._keyboardMapper=this.keyboardLayoutService.getKeyboardMapper(),this._register(this.keyboardLayoutService.onDidChangeKeyboardLayout(()=>{this._keyboardMapper=this.keyboardLayoutService.getKeyboardMapper(),this.updateResolver()})),this._keybindingHoldMode=null,this._cachedResolver=null,this.userKeybindings=this._register(new ZO(o,l,d,h)),this.userKeybindings.initialize().then(()=>{this.userKeybindings.keybindings.length&&this.updateResolver()}),this._register(this.userKeybindings.onDidChange(()=>{h.debug("User keybindings changed"),this.updateResolver()})),vC.setHandler(g=>{const f=[];for(const m of g)this._handleKeybindingsExtensionPointUser(m.description.identifier,m.description.isBuiltin,m.value,m.collector,f);Z.setExtensionKeybindings(f),this.updateResolver()}),this.updateKeybindingsJsonSchema(),this._register(n.onDidRegisterExtensions(()=>this.updateKeybindingsJsonSchema())),this._register(K.runAndSubscribe(ZS,({window:g,disposables:f})=>f.add(this._registerKeyListeners(g)),{window:me,disposables:this._store})),this._register(JS(g=>{g===me.vscodeWindowId&&ag.keyboard!==dg.None&&(this.lockKeyCodes(sy(me)?["Escape"]:[]),this._cachedResolver=null,this._onDidUpdateKeybindings.fire())}))}lockKeyCodes(e){const t=me.navigator.keyboard;e.length>0?t?.lock(e):t?.unlock()}dispose(){this._contributions.forEach(e=>e.listener?.dispose()),this._contributions.length=0,super.dispose()}_registerKeyListeners(e){const t=new B;return t.add(X(e,Q.KEY_DOWN,i=>{if(this._keybindingHoldMode)return;this.isComposingGlobalContextKey.set(i.isComposing);const s=new br(i);this._log(`/ Received  keydown event - ${CT(i)}`),this._log(`| Converted keydown event - ${ST(s)}`),this._dispatch(s,s.target)&&s.preventDefault(),this.isComposingGlobalContextKey.set(!1)})),t.add(X(e,Q.KEY_UP,i=>{this._resetKeybindingHoldMode(),this.isComposingGlobalContextKey.set(i.isComposing);const s=new br(i);this._singleModifierDispatch(s,s.target)&&s.preventDefault(),this.isComposingGlobalContextKey.set(!1)})),t}registerSchemaContribution(e){const t=e.onDidChange?.(()=>this.updateKeybindingsJsonSchema()),i={listener:t,contribution:e};return this._contributions.push(i),this.updateKeybindingsJsonSchema(),pe(()=>{t?.dispose(),QS(this._contributions,i),this.updateKeybindingsJsonSchema()})}updateKeybindingsJsonSchema(){this.kbsJsonSchema.updateSchema(this._contributions.flatMap(e=>e.contribution.getSchemaAdditions()))}_printKeybinding(e){return bT.toLabel(pi,e.chords,t=>t instanceof Jo?Bt.toString(t.keyCode):Di.toString(t.scanCode))||"[null]"}_printResolvedKeybinding(e){return e.getDispatchChords().map(t=>t||"[null]").join(" ")}_printResolvedKeybindings(e,t,i){const o=`${t.padStart(35," ")} => `;if(i.length===0){e.push(`${o}${"[NO BINDING]".padStart(35," ")}`);return}for(const r of i)e.push(`${o}${this._printResolvedKeybinding(r).padStart(35," ")}`)}_dumpResolveKeybindingDebugInfo(){const e=new Set,t=[];t.push("Default Resolved Keybindings (unique only):");for(const i of Z.getDefaultKeybindings()){if(!i.keybinding)continue;const s=this._printKeybinding(i.keybinding);if(e.has(s))continue;e.add(s);const o=this._keyboardMapper.resolveKeybinding(i.keybinding);this._printResolvedKeybindings(t,s,o)}t.push("User Resolved Keybindings (unique only):");for(const i of this.userKeybindings.keybindings){if(!i.keybinding)continue;const s=i._sourceKey??"Impossible: missing source key, but has keybinding";if(e.has(s))continue;e.add(s);const o=this._keyboardMapper.resolveKeybinding(i.keybinding);this._printResolvedKeybindings(t,s,o)}return t.join(`
`)}_dumpDebugInfo(){const e=JSON.stringify(this.keyboardLayoutService.getCurrentKeyboardLayout(),null,"	"),t=this._keyboardMapper.dumpDebugInfo(),i=this._dumpResolveKeybindingDebugInfo(),s=JSON.stringify(this.keyboardLayoutService.getRawKeyboardMapping(),null,"	");return`Layout info:
${e}

${i}

${t}

Raw mapping:
${s}`}_dumpDebugInfoJSON(){const e={layout:this.keyboardLayoutService.getCurrentKeyboardLayout(),rawMapping:this.keyboardLayoutService.getRawKeyboardMapping()};return JSON.stringify(e,null,"	")}enableKeybindingHoldMode(e){if(this._currentlyDispatchingCommandId!==e)return;this._keybindingHoldMode=new pr;const t=Eo(He(void 0)),i=t.onDidBlur(()=>this._resetKeybindingHoldMode());return this._keybindingHoldMode.p.finally(()=>{i.dispose(),t.dispose()}),this._log(`+ Enabled hold-mode for ${e}.`),this._keybindingHoldMode.p}_resetKeybindingHoldMode(){this._keybindingHoldMode&&(this._keybindingHoldMode?.complete(),this._keybindingHoldMode=null)}customKeybindingsCount(){return this.userKeybindings.keybindings.length}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}getUserKeybindingItems(){return this._resolveUserKeybindingItems(this.userKeybindings.keybindings,!1)}_getResolver(){if(!this._cachedResolver){const e=this._resolveKeybindingItems(Z.getDefaultKeybindings(),!0),t=this.getUserKeybindingItems();this._cachedResolver=new vT(e,t,i=>this._log(i))}return this._cachedResolver}_documentHasFocus(){return this.hostService.hasFocus}_resolveKeybindingItems(e,t){const i=[];let s=0;for(const o of e){const r=o.when||void 0,n=o.keybinding;if(!n)i[s++]=new fl(void 0,o.command,o.commandArgs,r,t,o.extensionId,o.isBuiltinExtension);else{if(this._assertBrowserConflicts(n))continue;const d=this._keyboardMapper.resolveKeybinding(n);for(let l=d.length-1;l>=0;l--){const h=d[l];i[s++]=new fl(h,o.command,o.commandArgs,r,t,o.extensionId,o.isBuiltinExtension)}}}return i}_resolveUserKeybindingItems(e,t){const i=[];let s=0;for(const o of e){const r=o.when||void 0;if(!o.keybinding)i[s++]=new fl(void 0,o.command,o.commandArgs,r,t,null,!1);else{const n=this._keyboardMapper.resolveKeybinding(o.keybinding);for(const d of n)i[s++]=new fl(d,o.command,o.commandArgs,r,t,null,!1)}}return i}_assertBrowserConflicts(e){if(ag.keyboard===dg.Always||ag.keyboard===dg.FullScreen&&sy(me))return!1;for(const t of e.chords){if(!t.metaKey&&!t.altKey&&!t.ctrlKey&&!t.shiftKey)continue;const i=C.CtrlCmd|C.Alt|C.Shift;let s=0;if(t.metaKey&&(s|=C.CtrlCmd),t.shiftKey&&(s|=C.Shift),t.altKey&&(s|=C.Alt),t.ctrlKey&&pi===bs.Macintosh&&(s|=C.WinCtrl),(s&i)===(C.CtrlCmd|C.Alt)&&(t instanceof qo&&(t.scanCode===V.ArrowLeft||t.scanCode===V.ArrowRight)||t instanceof Jo&&(t.keyCode===w.LeftArrow||t.keyCode===w.RightArrow))||(s&i)===C.CtrlCmd&&(t instanceof qo&&t.scanCode>=V.Digit1&&t.scanCode<=V.Digit0||t instanceof Jo&&t.keyCode>=w.Digit0&&t.keyCode<=w.Digit9))return!0}return!1}resolveKeybinding(e){return this._keyboardMapper.resolveKeybinding(e)}resolveKeyboardEvent(e){return this.keyboardLayoutService.validateCurrentKeyboardMapping(e),this._keyboardMapper.resolveKeyboardEvent(e)}resolveUserBinding(e){const t=Rc.parseKeybinding(e);return t?this._keyboardMapper.resolveKeybinding(t):[]}_handleKeybindingsExtensionPointUser(e,t,i,s,o){if(Array.isArray(i))for(let r=0,n=i.length;r<n;r++)this._handleKeybinding(e,t,r+1,i[r],s,o);else this._handleKeybinding(e,t,1,i,s,o)}_handleKeybinding(e,t,i,s,o,r){const n=[];if(XO(s,n)){const d=this._asCommandRule(e,t,i++,s);d&&r.push(d)}n.length>0&&o.error(c(14127,"Invalid `contributes.{0}`: {1}",vC.name,n.join(`
`)))}static bindToCurrentPlatform(e,t,i,s){if(pi===bs.Windows&&s){if(s)return s}else if(pi===bs.Macintosh){if(t)return t}else if(i)return i;return e}_asCommandRule(e,t,i,s){const{command:o,args:r,when:n,key:d,mac:l,linux:h,win:p}=s,g=Rd.bindToCurrentPlatform(d,l,h,p);if(!g)return;let f;t?f=L.BuiltinExtension+i:f=L.ExternalExtension+i;const m=_.getCommand(o),v=m&&m.precondition;let E;return n&&v?E=I.and(v,I.deserialize(n)):n?E=I.deserialize(n):v&&(E=v),{id:o,args:r,when:E,weight:f,keybinding:Rc.parseKeybinding(g),extensionId:e.value,isBuiltinExtension:t}}getDefaultKeybindingsContent(){const e=this._getResolver(),t=e.getDefaultKeybindings(),i=e.getDefaultBoundCommands();return Rd._getDefaultKeybindings(t)+`

`+Rd._getAllCommandsAsComment(i)}static _getDefaultKeybindings(e){const t=new YO;t.writeLine("[");const i=e.length-1;return e.forEach((s,o)=>{bI.writeKeybindingItem(t,s),o!==i?t.writeLine(","):t.writeLine()}),t.writeLine("]"),t.toString()}static _getAllCommandsAsComment(e){const i=yT(e).sort().join(`
// - `);return"// "+c(14128,"Here are other available commands: ")+`
// - `+i}mightProducePrintableCharacter(e){if(e.ctrlKey||e.metaKey||e.altKey)return!1;const t=Di.toEnum(e.code);if(JO.indexOf(t)!==-1)return!!(e.keyCode===Xi[t]||Ge&&e.keyCode===As.get(t));if(Xi[t]!==-1)return!1;const s=this.keyboardLayoutService.getRawKeyboardMapping();if(!s)return!1;const o=s[e.code];return!(!o||!o.value||/\s/.test(o.value))}};dm=Rd=D([u(0,de),u(1,ke),u(2,nt),u(3,Qe),u(4,Nb),u(5,Rt),u(6,si),u(7,Ve),u(8,Kn),u(9,et),u(10,el)],dm);class ZO extends M{get keybindings(){return this._keybindings}constructor(e,t,i,s){super(),this.userDataProfileService=e,this.uriIdentityService=t,this.fileService=i,this._rawKeybindings=[],this._keybindings=[],this.watchDisposables=this._register(new B),this._onDidChange=this._register(new A),this.onDidChange=this._onDidChange.event,this.watch(),this.reloadConfigurationScheduler=this._register(new pd(()=>this.reload().then(o=>{o&&this._onDidChange.fire()}),50)),this._register(K.filter(this.fileService.onDidFilesChange,o=>o.contains(this.userDataProfileService.currentProfile.keybindingsResource))(()=>{s.debug("Keybindings file changed"),this.reloadConfigurationScheduler.schedule()})),this._register(this.fileService.onDidRunOperation(o=>{o.operation===Gr.WRITE&&o.resource.toString()===this.userDataProfileService.currentProfile.keybindingsResource.toString()&&(s.debug("Keybindings file written"),this.reloadConfigurationScheduler.schedule())})),this._register(e.onDidChangeCurrentProfile(o=>{this.uriIdentityService.extUri.isEqual(o.previous.keybindingsResource,o.profile.keybindingsResource)||o.join(this.whenCurrentProfileChanged())}))}async whenCurrentProfileChanged(){this.watch(),this.reloadConfigurationScheduler.schedule()}watch(){this.watchDisposables.clear(),this.watchDisposables.add(this.fileService.watch(qc(this.userDataProfileService.currentProfile.keybindingsResource))),this.watchDisposables.add(this.fileService.watch(this.userDataProfileService.currentProfile.keybindingsResource))}async initialize(){await this.reload()}async reload(){const e=await this.readUserKeybindings();return Sp(this._rawKeybindings,e)?!1:(this._rawKeybindings=e,this._keybindings=this._rawKeybindings.map(t=>bI.readUserKeybindingItem(t)),!0)}async readUserKeybindings(){try{const e=await this.fileService.readFile(this.userDataProfileService.currentProfile.keybindingsResource),t=eE(e.value.toString());return Array.isArray(t)?t.filter(i=>i&&typeof i=="object"):[]}catch{return[]}}}const pa=class pa{constructor(){this.commandsSchemas=[],this.commandsEnum=[],this.removalCommandsEnum=[],this.commandsEnumDescriptions=[],this.schema={id:pa.schemaId,type:"array",title:c(14129,"Keybindings configuration"),allowTrailingCommas:!0,allowComments:!0,definitions:{editorGroupsSchema:{type:"array",items:{type:"object",properties:{groups:{$ref:"#/definitions/editorGroupsSchema",default:[{},{}]},size:{type:"number",default:.5}}}},commandNames:{type:"string",enum:this.commandsEnum,enumDescriptions:this.commandsEnumDescriptions,description:c(14130,"Name of the command to execute")},commandType:{anyOf:[{$ref:"#/definitions/commandNames"},{type:"string",enum:this.removalCommandsEnum,enumDescriptions:this.commandsEnumDescriptions,description:c(14131,"Name of the command to remove keyboard shortcut for")},{type:"string"}]},commandsSchemas:{allOf:this.commandsSchemas}},items:{required:["key"],type:"object",defaultSnippets:[{body:{key:"$1",command:"$2",when:"$3"}}],properties:{key:{type:"string",description:c(14132,"Key or key sequence (separated by space)")},command:{anyOf:[{if:{type:"array"},then:{not:{type:"array"},errorMessage:c(14133,`Incorrect type. Expected "{0}". The field 'command' does not support running multiple commands. Use command 'runCommands' to pass it multiple commands to run.`,"string")},else:{$ref:"#/definitions/commandType"}},{$ref:"#/definitions/commandType"}]},when:{type:"string",description:c(14134,"Condition when the key is active.")},args:{description:c(14135,"Arguments to pass to the command to execute.")}},$ref:"#/definitions/commandsSchemas"}},this.schemaRegistry=se.as(ET.JSONContribution),this.schemaRegistry.registerSchema(pa.schemaId,this.schema)}updateSchema(e){this.commandsSchemas.length=0,this.commandsEnum.length=0,this.removalCommandsEnum.length=0,this.commandsEnumDescriptions.length=0;const t=new Set,i=(r,n)=>{/^_/.test(r)||t.has(r)||(t.add(r),this.commandsEnum.push(r),this.commandsEnumDescriptions.push(n===void 0?"":_T(n)?n.value:n),this.removalCommandsEnum.push(`-${r}`))},s=re.getCommands();for(const[r,n]of s){const d=n.metadata;if(i(r,d?.description??_.getCommand(r)?.title),!d||!d.args||d.args.length!==1||!d.args[0].schema)continue;const l=d.args[0].schema,h=typeof d.args[0].isOptional<"u"?!d.args[0].isOptional:Array.isArray(l.required)&&l.required.length>0,p={if:{required:["command"],properties:{command:{const:r}}},then:{required:[].concat(h?["args"]:[]),properties:{args:l}}};this.commandsSchemas.push(p)}const o=_.getCommands();for(const r of o.keys())i(r);this.commandsSchemas.push(...e),this.schemaRegistry.notifySchemaChanged(pa.schemaId)}};pa.schemaId="vscode://schemas/keybindings";let cm=pa;function yC(a,e){return!a||!e?!1:!!(a.name&&e.name&&a.name===e.name||a.id&&e.id&&a.id===e.id||a.model&&e.model&&a.model===e.model&&a.layout===e.layout)}function Rh(a){if(!a)return{label:"",description:""};if(a.name)return{label:a.text,description:""};if(a.id){const t=a;return t.localizedName?{label:t.localizedName,description:""}:/^com\.apple\.keylayout\./.test(t.id)?{label:t.id.replace(/^com\.apple\.keylayout\./,"").replace(/-/," "),description:""}:/^.*inputmethod\./.test(t.id)?{label:t.id.replace(/^.*inputmethod\./,"").replace(/[-\.]/," "),description:`Input Method (${t.lang})`}:{label:t.lang,description:""}}return{label:a.layout,description:""}}function Vc(a){return a.name?a.name:a.id?a.id:a.layout}function QO(a){const e=a,t={};for(const i in e){const s=e[i];if(s.length){const o=s[0],r=s[1],n=s[2],d=s[3],l=Number(s[4]),h=s.length===6?s[5]:void 0;t[i]={value:o,vkey:h,withShift:r,withAltGr:n,withShiftAltGr:d,valueIsDeadKey:(l&1)>0,withShiftIsDeadKey:(l&2)>0,withAltGrIsDeadKey:(l&4)>0,withShiftAltGrIsDeadKey:(l&8)>0}}else t[i]={value:"",valueIsDeadKey:!1,withShift:"",withShiftIsDeadKey:!1,withAltGr:"",withAltGrIsDeadKey:!1,withShiftAltGr:"",withShiftAltGrIsDeadKey:!1}}return t}class Xp{constructor(e,t,i,s){this.layout=e,this.secondaryLayouts=t,this.mapping=QO(i),this.isUserKeyboardLayout=!!s,this.layout.isUserKeyboardLayout=!!s}static createKeyboardLayoutFromDebugInfo(e,t,i){const s=new Xp(e,[],{},!0);return s.mapping=t,s}update(e){this.layout=e.layout,this.secondaryLayouts=e.secondaryLayouts,this.mapping=e.mapping,this.isUserKeyboardLayout=e.isUserKeyboardLayout,this.layout.isUserKeyboardLayout=e.isUserKeyboardLayout}getScore(e){let t=0;for(const i in e){if(mi&&(i==="Backslash"||i==="KeyQ")||xn&&(i==="Backspace"||i==="Escape"))continue;const s=this.mapping[i];s===void 0&&(t-=1);const o=e[i];s&&o&&s.value!==o.value&&(t-=1)}return t}equal(e){return this.isUserKeyboardLayout!==e.isUserKeyboardLayout||Vc(this.layout)!==Vc(e.layout)?!1:this.fuzzyEqual(e.mapping)}fuzzyEqual(e){for(const t in e){if(mi&&(t==="Backslash"||t==="KeyQ"))continue;if(this.mapping[t]===void 0)return!1;const i=this.mapping[t],s=e[t];if(i.value!==s.value)return!1}return!0}}var Pc;(function(a){a[a.Code=0]="Code",a[a.KeyCode=1]="KeyCode"})(Pc||(Pc={}));function eM(a){const e=a.getValue("keyboard"),t=e?.dispatch==="keyCode"?Pc.KeyCode:Pc.Code,i=!!e?.mapAltGrToCtrlAlt;return{dispatch:t,mapAltGrToCtrlAlt:i}}const tM=se.as(Lo.Configuration),iM={id:"keyboard",order:15,type:"object",title:c(1952,"Keyboard"),properties:{"keyboard.dispatch":{scope:Me.APPLICATION,type:"string",enum:["code","keyCode"],default:"code",markdownDescription:c(1953,"Controls the dispatching logic for key presses to use either `code` (recommended) or `keyCode`."),included:pi===bs.Macintosh||pi===bs.Linux},"keyboard.mapAltGrToCtrlAlt":{scope:Me.APPLICATION,type:"boolean",default:!1,markdownDescription:c(1954,"Controls if the AltGraph+ modifier should be treated as Ctrl+Alt+."),included:pi===bs.Windows}}};tM.registerConfiguration(iM);class sM{constructor(e){this._actual=e,this._cache=new Map}dumpDebugInfo(){return this._actual.dumpDebugInfo()}resolveKeyboardEvent(e){return this._actual.resolveKeyboardEvent(e)}resolveKeybinding(e){const t=e.getHashCode(),i=this._cache.get(t);if(!i){const s=this._actual.resolveKeybinding(e);return this._cache.set(t,s),s}return i}}class Vd extends tE{constructor(e,t){super(bs.Windows,t),this._mapper=e}_getLabel(e){return e.isDuplicateModifierCase()?"":this._mapper.getUILabelForKeyCode(e.keyCode)}_getUSLabelForKeybinding(e){return e.isDuplicateModifierCase()?"":Bt.toString(e.keyCode)}getUSLabel(){return DT.toLabel(this._os,this._chords,e=>this._getUSLabelForKeybinding(e))}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":this._mapper.getAriaLabelForKeyCode(e.keyCode)}_getElectronAccelerator(e){return this._mapper.getElectronAcceleratorForKeyBinding(e)}_getUserSettingsLabel(e){if(e.isDuplicateModifierCase())return"";const t=this._mapper.getUserSettingsLabelForKeyCode(e.keyCode);return t&&t.toLowerCase()}_isWYSIWYG(e){return this.__isWYSIWYG(e.keyCode)}__isWYSIWYG(e){if(e===w.LeftArrow||e===w.UpArrow||e===w.RightArrow||e===w.DownArrow)return!0;const t=this._mapper.getAriaLabelForKeyCode(e),i=this._mapper.getUserSettingsLabelForKeyCode(e);return t===i}_getChordDispatch(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=Bt.toString(e.keyCode),t}_getSingleModifierChordDispatch(e){return e.keyCode===w.Ctrl&&!e.shiftKey&&!e.altKey&&!e.metaKey?"ctrl":e.keyCode===w.Shift&&!e.ctrlKey&&!e.altKey&&!e.metaKey?"shift":e.keyCode===w.Alt&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey?"alt":e.keyCode===w.Meta&&!e.ctrlKey&&!e.shiftKey&&!e.altKey?"meta":null}static getProducedCharCode(e,t){return t?e.ctrlKey&&e.shiftKey&&e.altKey?t.withShiftAltGr:e.ctrlKey&&e.altKey?t.withAltGr:e.shiftKey?t.withShift:t.value:null}static getProducedChar(e,t){const i=this.getProducedCharCode(e,t);return i===null||i.length===0?" --- ":"  "+i+"  "}}class oM{constructor(e,t,i){this._isUSStandard=e,this._mapAltGrToCtrlAlt=i,this._keyCodeToLabel=[],this._scanCodeToKeyCode=[],this._keyCodeToLabel=[],this._keyCodeExists=[],this._keyCodeToLabel[w.Unknown]=Bt.toString(w.Unknown);for(let n=V.None;n<V.MAX_VALUE;n++){const d=Xi[n];d!==w.DependsOnKbLayout&&(this._scanCodeToKeyCode[n]=d,this._keyCodeToLabel[d]=Bt.toString(d),this._keyCodeExists[d]=!0)}const s=[];let o=!1;this._codeInfo=[];for(const n in t)if(t.hasOwnProperty(n)){const d=Di.toEnum(n);if(d===V.None)continue;const l=t[n],h=Xi[d];if(h!==w.DependsOnKbLayout){const x=oy[l.vkey]||w.Unknown;if(x===w.Unknown||h===x||d!==V.NumpadComma)continue}const p=l.value,g=l.withShift,f=l.withAltGr,m=l.withShiftAltGr,v=oy[l.vkey]||w.Unknown,E={scanCode:d,keyCode:v,value:p,withShift:g,withAltGr:f,withShiftAltGr:m};if(this._codeInfo[d]=E,this._scanCodeToKeyCode[d]=v,v===w.Unknown)continue;if(this._keyCodeExists[v]=!0,p.length===0)this._keyCodeToLabel[v]=null;else if(p.length>1)this._keyCodeToLabel[v]=p;else{const x=p.charCodeAt(0);if(x>=k.a&&x<=k.z){const G=k.A+(x-k.a);s[G]=!0,o=!0,this._keyCodeToLabel[v]=String.fromCharCode(k.A+(x-k.a))}else x>=k.A&&x<=k.Z?(s[x]=!0,o=!0,this._keyCodeToLabel[v]=p):this._keyCodeToLabel[v]=p}}const r=(n,d)=>{s[n]||(this._keyCodeToLabel[d]=String.fromCharCode(n))};if(r(k.A,w.KeyA),r(k.B,w.KeyB),r(k.C,w.KeyC),r(k.D,w.KeyD),r(k.E,w.KeyE),r(k.F,w.KeyF),r(k.G,w.KeyG),r(k.H,w.KeyH),r(k.I,w.KeyI),r(k.J,w.KeyJ),r(k.K,w.KeyK),r(k.L,w.KeyL),r(k.M,w.KeyM),r(k.N,w.KeyN),r(k.O,w.KeyO),r(k.P,w.KeyP),r(k.Q,w.KeyQ),r(k.R,w.KeyR),r(k.S,w.KeyS),r(k.T,w.KeyT),r(k.U,w.KeyU),r(k.V,w.KeyV),r(k.W,w.KeyW),r(k.X,w.KeyX),r(k.Y,w.KeyY),r(k.Z,w.KeyZ),!o){const n=(d,l)=>{this._keyCodeToLabel[d]=String.fromCharCode(l)};n(w.Semicolon,k.Semicolon),n(w.Equal,k.Equals),n(w.Comma,k.Comma),n(w.Minus,k.Dash),n(w.Period,k.Period),n(w.Slash,k.Slash),n(w.Backquote,k.BackTick),n(w.BracketLeft,k.OpenSquareBracket),n(w.Backslash,k.Backslash),n(w.BracketRight,k.CloseSquareBracket),n(w.Quote,k.SingleQuote)}}dumpDebugInfo(){const e=[],t=[V.ArrowUp,V.Numpad0];let i=0;e.push("-----------------------------------------------------------------------------------------------------------------------------------------");for(let s=V.None;s<V.MAX_VALUE;s++){if(Xi[s]!==w.DependsOnKbLayout&&t.indexOf(s)===-1)continue;i%6===0&&(e.push("|       HW Code combination      |  Key  |    KeyCode combination    |          UI label         |        User settings       | WYSIWYG |"),e.push("-----------------------------------------------------------------------------------------------------------------------------------------")),i++;const o=this._codeInfo[s],r=Di.toString(s),n=[0,2,5,7];for(const d of n){const l=!!(d&1),h=!!(d&2),p=!!(d&4),g=new qo(l,h,p,!1,s),f=this._resolveChord(g),m=f?Bt.toString(f.keyCode):null,v=f?new Vd(this,[f]):null,E=`${l?"Ctrl+":""}${h?"Shift+":""}${p?"Alt+":""}${r}`,x=v?v.getAriaLabel():null,G=x?x.replace(/Control\+/,"Ctrl+"):null,W=v?v.getUserSettingsLabel():null,Y=Vd.getProducedChar(g,o),$=m?`${l?"Ctrl+":""}${h?"Shift+":""}${p?"Alt+":""}${m}`:null,ie=(v?v.isWYSIWYG():!1)?"       ":"   NO  ";e.push(`| ${this._leftPad(E,30)} | ${Y} | ${this._leftPad($,25)} | ${this._leftPad(G,25)} |  ${this._leftPad(W,25)} | ${ie} |`)}e.push("-----------------------------------------------------------------------------------------------------------------------------------------")}return e.join(`
`)}_leftPad(e,t){for(e===null&&(e="null");e.length<t;)e=" "+e;return e}getUILabelForKeyCode(e){return this._getLabelForKeyCode(e)}getAriaLabelForKeyCode(e){return this._getLabelForKeyCode(e)}getUserSettingsLabelForKeyCode(e){return this._isUSStandard?Bt.toUserSettingsUS(e):Bt.toUserSettingsGeneral(e)}getElectronAcceleratorForKeyBinding(e){return Bt.toElectronAccelerator(e.keyCode)}_getLabelForKeyCode(e){return this._keyCodeToLabel[e]||Bt.toString(w.Unknown)}resolveKeyboardEvent(e){const t=e.ctrlKey||this._mapAltGrToCtrlAlt&&e.altGraphKey,i=e.altKey||this._mapAltGrToCtrlAlt&&e.altGraphKey,s=new Jo(t,e.shiftKey,i,e.metaKey,e.keyCode);return new Vd(this,[s])}_resolveChord(e){if(!e)return null;if(e instanceof Jo)return this._keyCodeExists[e.keyCode]?e:null;const t=this._scanCodeToKeyCode[e.scanCode]||w.Unknown;return t===w.Unknown||!this._keyCodeExists[t]?null:new Jo(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t)}resolveKeybinding(e){const t=IT(e.chords.map(i=>this._resolveChord(i)));return t.length>0?[new Vd(this,t)]:[]}}const Yd=[];class CC extends tE{constructor(e,t,i){super(t,i),this._mapper=e}_getLabel(e){return this._mapper.getUILabelForScanCodeChord(e)}_getAriaLabel(e){return this._mapper.getAriaLabelForScanCodeChord(e)}_getElectronAccelerator(e){return this._mapper.getElectronAcceleratorLabelForScanCodeChord(e)}_getUserSettingsLabel(e){return this._mapper.getUserSettingsLabelForScanCodeChord(e)}_isWYSIWYG(e){if(!e||Xi[e.scanCode]!==w.DependsOnKbLayout)return!0;const t=this._mapper.getAriaLabelForScanCodeChord(e),i=this._mapper.getUserSettingsLabelForScanCodeChord(e);return!t&&!i?!0:!t||!i?!1:t.toLowerCase()===i.toLowerCase()}_getChordDispatch(e){return this._mapper.getDispatchStrForScanCodeChord(e)}_getSingleModifierChordDispatch(e){return(e.scanCode===V.ControlLeft||e.scanCode===V.ControlRight)&&!e.shiftKey&&!e.altKey&&!e.metaKey?"ctrl":(e.scanCode===V.AltLeft||e.scanCode===V.AltRight)&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey?"alt":(e.scanCode===V.ShiftLeft||e.scanCode===V.ShiftRight)&&!e.ctrlKey&&!e.altKey&&!e.metaKey?"shift":(e.scanCode===V.MetaLeft||e.scanCode===V.MetaRight)&&!e.ctrlKey&&!e.shiftKey&&!e.altKey?"meta":null}}class Xd{constructor(e,t,i,s){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.scanCode=s}toString(){return`${this.ctrlKey?"Ctrl+":""}${this.shiftKey?"Shift+":""}${this.altKey?"Alt+":""}${Di.toString(this.scanCode)}`}equals(e){return this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.scanCode===e.scanCode}getProducedCharCode(e){return e?this.ctrlKey&&this.shiftKey&&this.altKey?e.withShiftAltGr:this.ctrlKey&&this.altKey?e.withAltGr:this.shiftKey?e.withShift:e.value:""}getProducedChar(e){const t=Ui.getCharCode(this.getProducedCharCode(e));return t===0?" --- ":t>=k.U_Combining_Grave_Accent&&t<=k.U_Combining_Latin_Small_Letter_X?"U+"+t.toString(16):"  "+String.fromCharCode(t)+"  "}}class lm{constructor(e,t,i,s){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.keyCode=s}toString(){return`${this.ctrlKey?"Ctrl+":""}${this.shiftKey?"Shift+":""}${this.altKey?"Alt+":""}${Bt.toString(this.keyCode)}`}}class rM{constructor(){this._scanCodeToKeyCode=[],this._keyCodeToScanCode=[],this._scanCodeToKeyCode=[],this._keyCodeToScanCode=[]}registrationComplete(){this._moveToEnd(V.IntlHash),this._moveToEnd(V.IntlBackslash)}_moveToEnd(e){for(let t=0;t<8;t++){const i=this._scanCodeToKeyCode[(e<<3)+t];if(i)for(let s=0,o=i.length;s<o;s++){const r=this._keyCodeToScanCode[i[s]];if(r.length!==1)for(let n=0,d=r.length;n<d;n++){const l=r[n];if(l>>>3===e){for(let p=n+1;p<d;p++)r[p-1]=r[p];r[d-1]=l}}}}}registerIfUnknown(e,t){if(t.keyCode===w.Unknown)return;const i=this._encodeScanCodeCombo(e),s=this._encodeKeyCodeCombo(t),o=t.keyCode>=w.Digit0&&t.keyCode<=w.Digit9,r=t.keyCode>=w.KeyA&&t.keyCode<=w.KeyZ,n=this._scanCodeToKeyCode[i];if(o||r){if(n){for(let d=0,l=n.length;d<l;d++)if(n[d]===s)return}}else if(n&&n.length!==0)return;this._scanCodeToKeyCode[i]=this._scanCodeToKeyCode[i]||[],this._scanCodeToKeyCode[i].unshift(s),this._keyCodeToScanCode[s]=this._keyCodeToScanCode[s]||[],this._keyCodeToScanCode[s].unshift(i)}lookupKeyCodeCombo(e){const t=this._encodeKeyCodeCombo(e),i=this._keyCodeToScanCode[t];if(!i||i.length===0)return[];const s=[];for(let o=0,r=i.length;o<r;o++){const n=i[o],d=!!(n&1),l=!!(n&2),h=!!(n&4),p=n>>>3;s[o]=new Xd(d,l,h,p)}return s}lookupScanCodeCombo(e){const t=this._encodeScanCodeCombo(e),i=this._scanCodeToKeyCode[t];if(!i||i.length===0)return[];const s=[];for(let o=0,r=i.length;o<r;o++){const n=i[o],d=!!(n&1),l=!!(n&2),h=!!(n&4),p=n>>>3;s[o]=new lm(d,l,h,p)}return s}guessStableKeyCode(e){if(e>=V.Digit1&&e<=V.Digit0)switch(e){case V.Digit1:return w.Digit1;case V.Digit2:return w.Digit2;case V.Digit3:return w.Digit3;case V.Digit4:return w.Digit4;case V.Digit5:return w.Digit5;case V.Digit6:return w.Digit6;case V.Digit7:return w.Digit7;case V.Digit8:return w.Digit8;case V.Digit9:return w.Digit9;case V.Digit0:return w.Digit0}const t=this.lookupScanCodeCombo(new Xd(!1,!1,!1,e)),i=this.lookupScanCodeCombo(new Xd(!1,!0,!1,e));if(t.length===1&&i.length===1){const s=t[0].shiftKey,o=t[0].keyCode,r=i[0].shiftKey,n=i[0].keyCode;if(o===n&&s!==r)return o}return w.DependsOnKbLayout}_encodeScanCodeCombo(e){return this._encode(e.ctrlKey,e.shiftKey,e.altKey,e.scanCode)}_encodeKeyCodeCombo(e){return this._encode(e.ctrlKey,e.shiftKey,e.altKey,e.keyCode)}_encode(e,t,i,s){return((e?1:0)<<0|(t?1:0)<<1|(i?1:0)<<2|s<<3)>>>0}}class Ui{constructor(e,t,i,s){this._isUSStandard=e,this._mapAltGrToCtrlAlt=i,this._OS=s,this._scanCodeToLabel=[],this._scanCodeToDispatch=[],this._codeInfo=[],this._scanCodeKeyCodeMapper=new rM,this._scanCodeToLabel=[],this._scanCodeToDispatch=[];const o=(h,p,g,f,m,v,E,x)=>{this._scanCodeKeyCodeMapper.registerIfUnknown(new Xd(!!h,!!p,!!g,f),new lm(!!m,!!v,!!E,x))},r=(h,p,g,f,m)=>{for(let v=h;v<=1;v++)for(let E=p;E<=1;E++)for(let x=g;x<=1;x++)o(v,E,x,f,v,E,x,m)};for(let h=V.None;h<V.MAX_VALUE;h++)this._scanCodeToLabel[h]=null;for(let h=V.None;h<V.MAX_VALUE;h++)this._scanCodeToDispatch[h]=null;for(let h=V.None;h<V.MAX_VALUE;h++){const p=Xi[h];p!==w.DependsOnKbLayout&&(r(0,0,0,h,p),this._scanCodeToLabel[h]=Bt.toString(p),p===w.Unknown||AT(p)?this._scanCodeToDispatch[h]=null:this._scanCodeToDispatch[h]=`[${Di.toString(h)}]`)}const n={};{const h=[];for(const g in t)if(t.hasOwnProperty(g)){const f=Di.toEnum(g);if(f===V.None||Xi[f]!==w.DependsOnKbLayout)continue;const m=t[g],v=Ui.getCharCode(m.value);if(v>=k.a&&v<=k.z){const E=k.A+(v-k.a);h[E]=!0}}const p=(g,f,m,v)=>{h[g]||(n[Di.toString(f)]={value:m,withShift:v,withAltGr:"",withShiftAltGr:""})};p(k.A,V.KeyA,"a","A"),p(k.B,V.KeyB,"b","B"),p(k.C,V.KeyC,"c","C"),p(k.D,V.KeyD,"d","D"),p(k.E,V.KeyE,"e","E"),p(k.F,V.KeyF,"f","F"),p(k.G,V.KeyG,"g","G"),p(k.H,V.KeyH,"h","H"),p(k.I,V.KeyI,"i","I"),p(k.J,V.KeyJ,"j","J"),p(k.K,V.KeyK,"k","K"),p(k.L,V.KeyL,"l","L"),p(k.M,V.KeyM,"m","M"),p(k.N,V.KeyN,"n","N"),p(k.O,V.KeyO,"o","O"),p(k.P,V.KeyP,"p","P"),p(k.Q,V.KeyQ,"q","Q"),p(k.R,V.KeyR,"r","R"),p(k.S,V.KeyS,"s","S"),p(k.T,V.KeyT,"t","T"),p(k.U,V.KeyU,"u","U"),p(k.V,V.KeyV,"v","V"),p(k.W,V.KeyW,"w","W"),p(k.X,V.KeyX,"x","X"),p(k.Y,V.KeyY,"y","Y"),p(k.Z,V.KeyZ,"z","Z")}const d=[];let l=0;for(const h in t)if(t.hasOwnProperty(h)){const p=Di.toEnum(h);if(p===V.None||Xi[p]!==w.DependsOnKbLayout)continue;this._codeInfo[p]=t[h];const g=n[h]||t[h],f=Ui.getCharCode(g.value),m=Ui.getCharCode(g.withShift),v=Ui.getCharCode(g.withAltGr),E=Ui.getCharCode(g.withShiftAltGr),x={scanCode:p,value:f,withShift:m,withAltGr:v,withShiftAltGr:E};if(d[l++]=x,this._scanCodeToDispatch[p]=`[${Di.toString(p)}]`,f>=k.a&&f<=k.z){const G=k.A+(f-k.a);this._scanCodeToLabel[p]=String.fromCharCode(G)}else f>=k.A&&f<=k.Z?this._scanCodeToLabel[p]=String.fromCharCode(f):f?this._scanCodeToLabel[p]=String.fromCharCode(f):this._scanCodeToLabel[p]=null}for(let h=d.length-1;h>=0;h--){const p=d[h],g=p.scanCode,f=p.withShiftAltGr;if(f===p.withAltGr||f===p.withShift||f===p.value)continue;const m=Ui._charCodeToKb(f);if(!m)continue;const v=m.shiftKey,E=m.keyCode;v?o(1,1,1,g,0,1,0,E):o(1,1,1,g,0,0,0,E)}for(let h=d.length-1;h>=0;h--){const p=d[h],g=p.scanCode,f=p.withAltGr;if(f===p.withShift||f===p.value)continue;const m=Ui._charCodeToKb(f);if(!m)continue;const v=m.shiftKey,E=m.keyCode;v?o(1,0,1,g,0,1,0,E):o(1,0,1,g,0,0,0,E)}for(let h=d.length-1;h>=0;h--){const p=d[h],g=p.scanCode,f=p.withShift;if(f===p.value)continue;const m=Ui._charCodeToKb(f);if(!m)continue;const v=m.shiftKey,E=m.keyCode;v?(o(0,1,0,g,0,1,0,E),o(0,1,1,g,0,1,1,E),o(1,1,0,g,1,1,0,E),o(1,1,1,g,1,1,1,E)):(o(0,1,0,g,0,0,0,E),o(0,1,0,g,0,1,0,E),o(0,1,1,g,0,0,1,E),o(0,1,1,g,0,1,1,E),o(1,1,0,g,1,0,0,E),o(1,1,0,g,1,1,0,E),o(1,1,1,g,1,0,1,E),o(1,1,1,g,1,1,1,E))}for(let h=d.length-1;h>=0;h--){const p=d[h],g=p.scanCode,f=Ui._charCodeToKb(p.value);if(!f)continue;const m=f.shiftKey,v=f.keyCode;m?(o(0,0,0,g,0,1,0,v),o(0,0,1,g,0,1,1,v),o(1,0,0,g,1,1,0,v),o(1,0,1,g,1,1,1,v)):(o(0,0,0,g,0,0,0,v),o(0,0,1,g,0,0,1,v),o(0,1,0,g,0,1,0,v),o(0,1,1,g,0,1,1,v),o(1,0,0,g,1,0,0,v),o(1,0,1,g,1,0,1,v),o(1,1,0,g,1,1,0,v),o(1,1,1,g,1,1,1,v))}r(0,0,0,V.Digit1,w.Digit1),r(0,0,0,V.Digit2,w.Digit2),r(0,0,0,V.Digit3,w.Digit3),r(0,0,0,V.Digit4,w.Digit4),r(0,0,0,V.Digit5,w.Digit5),r(0,0,0,V.Digit6,w.Digit6),r(0,0,0,V.Digit7,w.Digit7),r(0,0,0,V.Digit8,w.Digit8),r(0,0,0,V.Digit9,w.Digit9),r(0,0,0,V.Digit0,w.Digit0),this._scanCodeKeyCodeMapper.registrationComplete()}dumpDebugInfo(){const e=[],t=[V.ArrowUp,V.Numpad0];let i=0;e.push(`isUSStandard: ${this._isUSStandard}`),e.push("----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");for(let s=V.None;s<V.MAX_VALUE;s++){if(Xi[s]!==w.DependsOnKbLayout&&t.indexOf(s)===-1)continue;i%4===0&&(e.push("|       HW Code combination      |  Key  |    KeyCode combination    | Pri |          UI label         |         User settings          |    Electron accelerator   |       Dispatching string       | WYSIWYG |"),e.push("----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------")),i++;const o=this._codeInfo[s];for(let r=0;r<8;r++){const n=!!(r&1),d=!!(r&2),l=!!(r&4),h=new Xd(n,d,l,s),p=this.resolveKeyboardEvent({_standardKeyboardEventBrand:!0,ctrlKey:h.ctrlKey,shiftKey:h.shiftKey,altKey:h.altKey,metaKey:!1,altGraphKey:!1,keyCode:w.DependsOnKbLayout,code:Di.toString(s)}),g=h.toString(),f=h.getProducedChar(o),m=p.getAriaLabel(),v=m?m.replace(/Control\+/,"Ctrl+"):null,E=p.getUserSettingsLabel(),x=p.getElectronAccelerator(),G=p.getDispatchChords()[0],Y=(p?p.isWYSIWYG():!1)?"       ":"   NO  ",$=this._scanCodeKeyCodeMapper.lookupScanCodeCombo(h);if($.length===0)e.push(`| ${this._leftPad(g,30)} | ${f} | ${this._leftPad("",25)} | ${this._leftPad("",3)} | ${this._leftPad(v,25)} | ${this._leftPad(E,30)} | ${this._leftPad(x,25)} | ${this._leftPad(G,30)} | ${Y} |`);else for(let H=0,ie=$.length;H<ie;H++){const q=$[H];let ae;const $e=this._scanCodeKeyCodeMapper.lookupKeyCodeCombo(q);if($e.length===1)ae="";else{let Ci=-1;for(let Et=0;Et<$e.length;Et++)if($e[Et].equals(h)){Ci=Et+1;break}ae=String(Ci)}const vt=q.toString();H===0?e.push(`| ${this._leftPad(g,30)} | ${f} | ${this._leftPad(vt,25)} | ${this._leftPad(ae,3)} | ${this._leftPad(v,25)} | ${this._leftPad(E,30)} | ${this._leftPad(x,25)} | ${this._leftPad(G,30)} | ${Y} |`):e.push(`| ${this._leftPad("",30)} |       | ${this._leftPad(vt,25)} | ${this._leftPad(ae,3)} | ${this._leftPad("",25)} | ${this._leftPad("",30)} | ${this._leftPad("",25)} | ${this._leftPad("",30)} |         |`)}}e.push("----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------")}return e.join(`
`)}_leftPad(e,t){for(e===null&&(e="null");e.length<t;)e=" "+e;return e}keyCodeChordToScanCodeChord(e){if(e.keyCode===w.Enter)return[new qo(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,V.Enter)];const t=this._scanCodeKeyCodeMapper.lookupKeyCodeCombo(new lm(e.ctrlKey,e.shiftKey,e.altKey,e.keyCode)),i=[];for(let s=0,o=t.length;s<o;s++){const r=t[s];i[s]=new qo(r.ctrlKey,r.shiftKey,r.altKey,e.metaKey,r.scanCode)}return i}getUILabelForScanCodeChord(e){if(!e)return null;if(e.isDuplicateModifierCase())return"";if(this._OS===bs.Macintosh)switch(e.scanCode){case V.ArrowLeft:return"";case V.ArrowUp:return"";case V.ArrowRight:return"";case V.ArrowDown:return""}return this._scanCodeToLabel[e.scanCode]}getAriaLabelForScanCodeChord(e){return e?e.isDuplicateModifierCase()?"":this._scanCodeToLabel[e.scanCode]:null}getDispatchStrForScanCodeChord(e){const t=this._scanCodeToDispatch[e.scanCode];if(!t)return null;let i="";return e.ctrlKey&&(i+="ctrl+"),e.shiftKey&&(i+="shift+"),e.altKey&&(i+="alt+"),e.metaKey&&(i+="meta+"),i+=t,i}getUserSettingsLabelForScanCodeChord(e){if(!e)return null;if(e.isDuplicateModifierCase())return"";const t=Xi[e.scanCode];if(t!==w.DependsOnKbLayout)return Bt.toUserSettingsUS(t).toLowerCase();const i=this._scanCodeKeyCodeMapper.guessStableKeyCode(e.scanCode);if(i!==w.DependsOnKbLayout){const s=this.keyCodeChordToScanCodeChord(new Jo(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,i));for(let o=0,r=s.length;o<r;o++)if(s[o].scanCode===e.scanCode)return Bt.toUserSettingsUS(i).toLowerCase()}return this._scanCodeToDispatch[e.scanCode]}getElectronAcceleratorLabelForScanCodeChord(e){if(!e)return null;const t=Xi[e.scanCode];if(t!==w.DependsOnKbLayout)return Bt.toElectronAccelerator(t);const i=this._scanCodeKeyCodeMapper.guessStableKeyCode(e.scanCode);return this._OS===bs.Linux&&!this._isUSStandard&&(i===w.Semicolon||i===w.Equal||i===w.Comma||i===w.Minus||i===w.Period||i===w.Slash||i===w.Backquote||i===w.BracketLeft||i===w.Backslash||i===w.BracketRight)?null:i!==w.DependsOnKbLayout?Bt.toElectronAccelerator(i):null}_toResolvedKeybinding(e){if(e.length===0)return[];const t=[];return this._generateResolvedKeybindings(e,0,[],t),t}_generateResolvedKeybindings(e,t,i,s){const o=e[t],r=t===e.length-1;for(let n=0,d=o.length;n<d;n++){const l=[...i,o[n]];r?s.push(new CC(this,this._OS,l)):this._generateResolvedKeybindings(e,t+1,l,s)}}resolveKeyboardEvent(e){let t=Di.toEnum(e.code);t===V.NumpadEnter&&(t=V.Enter);const i=e.keyCode;if(i===w.LeftArrow||i===w.UpArrow||i===w.RightArrow||i===w.DownArrow||i===w.Delete||i===w.Insert||i===w.Home||i===w.End||i===w.PageDown||i===w.PageUp||i===w.Backspace){const n=ry[i];n!==V.DependsOnKbLayout&&(t=n)}else if((t===V.Numpad1||t===V.Numpad2||t===V.Numpad3||t===V.Numpad4||t===V.Numpad5||t===V.Numpad6||t===V.Numpad7||t===V.Numpad8||t===V.Numpad9||t===V.Numpad0||t===V.NumpadDecimal)&&i>=0){const n=ry[i];n!==V.DependsOnKbLayout&&(t=n)}const s=e.ctrlKey||this._mapAltGrToCtrlAlt&&e.altGraphKey,o=e.altKey||this._mapAltGrToCtrlAlt&&e.altGraphKey,r=new qo(s,e.shiftKey,o,e.metaKey,t);return new CC(this,this._OS,[r])}_resolveChord(e){return e?e instanceof qo?[e]:this.keyCodeChordToScanCodeChord(e):[]}resolveKeybinding(e){const t=e.chords.map(i=>this._resolveChord(i));return this._toResolvedKeybinding(t)}static _redirectCharCode(e){switch(e){case k.U_IDEOGRAPHIC_FULL_STOP:return k.Period;case k.U_LEFT_CORNER_BRACKET:return k.OpenSquareBracket;case k.U_RIGHT_CORNER_BRACKET:return k.CloseSquareBracket;case k.U_LEFT_BLACK_LENTICULAR_BRACKET:return k.OpenSquareBracket;case k.U_RIGHT_BLACK_LENTICULAR_BRACKET:return k.CloseSquareBracket;case k.U_FULLWIDTH_SEMICOLON:return k.Semicolon;case k.U_FULLWIDTH_COMMA:return k.Comma}return e}static _charCodeToKb(e){return e=this._redirectCharCode(e),e<Yd.length?Yd[e]:null}static getCharCode(e){if(e.length===0)return 0;const t=e.charCodeAt(0);switch(t){case k.U_Combining_Grave_Accent:return k.U_GRAVE_ACCENT;case k.U_Combining_Acute_Accent:return k.U_ACUTE_ACCENT;case k.U_Combining_Circumflex_Accent:return k.U_CIRCUMFLEX;case k.U_Combining_Tilde:return k.U_SMALL_TILDE;case k.U_Combining_Macron:return k.U_MACRON;case k.U_Combining_Overline:return k.U_OVERLINE;case k.U_Combining_Breve:return k.U_BREVE;case k.U_Combining_Dot_Above:return k.U_DOT_ABOVE;case k.U_Combining_Diaeresis:return k.U_DIAERESIS;case k.U_Combining_Ring_Above:return k.U_RING_ABOVE;case k.U_Combining_Double_Acute_Accent:return k.U_DOUBLE_ACUTE_ACCENT}return t}}(function(){function a(e,t,i){for(let s=Yd.length;s<e;s++)Yd[s]=null;Yd[e]={keyCode:t,shiftKey:i}}for(let e=k.A;e<=k.Z;e++)a(e,w.KeyA+(e-k.A),!0);for(let e=k.a;e<=k.z;e++)a(e,w.KeyA+(e-k.a),!1);a(k.Semicolon,w.Semicolon,!1),a(k.Colon,w.Semicolon,!0),a(k.Equals,w.Equal,!1),a(k.Plus,w.Equal,!0),a(k.Comma,w.Comma,!1),a(k.LessThan,w.Comma,!0),a(k.Dash,w.Minus,!1),a(k.Underline,w.Minus,!0),a(k.Period,w.Period,!1),a(k.GreaterThan,w.Period,!0),a(k.Slash,w.Slash,!1),a(k.QuestionMark,w.Slash,!0),a(k.BackTick,w.Backquote,!1),a(k.Tilde,w.Backquote,!0),a(k.OpenSquareBracket,w.BracketLeft,!1),a(k.OpenCurlyBrace,w.BracketLeft,!0),a(k.Backslash,w.Backslash,!1),a(k.Pipe,w.Backslash,!0),a(k.CloseSquareBracket,w.BracketRight,!1),a(k.CloseCurlyBrace,w.BracketRight,!0),a(k.SingleQuote,w.Quote,!1),a(k.DoubleQuote,w.Quote,!0)})();function nM(a){switch(a){case"./keyboardLayouts/layout.contribution.darwin.js":return _g(()=>import("./layout.contribution.darwin.6yM9hauj.js"),__vite__mapDeps([0,1]));case"./keyboardLayouts/layout.contribution.linux.js":return _g(()=>import("./layout.contribution.linux.C3x3-VMB.js"),__vite__mapDeps([2,1]));case"./keyboardLayouts/layout.contribution.win.js":return _g(()=>import("./layout.contribution.win.B2r8FwHz.js"),__vite__mapDeps([3,1]));default:return new Promise(function(e,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+a)))})}}class aM extends M{get activeKeymap(){return this._activeKeymapInfo}get keymapInfos(){return this._keymapInfos}get activeKeyboardLayout(){return this._initialized?this._activeKeymapInfo?.layout??null:null}get activeKeyMapping(){return this._initialized?this._activeKeymapInfo?.mapping??null:null}get keyboardLayouts(){return this._keymapInfos.map(e=>e.layout)}constructor(e){super(),this._configurationService=e,this._onDidChangeKeyboardMapper=new A,this.onDidChangeKeyboardMapper=this._onDidChangeKeyboardMapper.event,this.keyboardLayoutMapAllowed=navigator.keyboard!==void 0,this._keyboardMapper=null,this._initialized=!1,this._keymapInfos=[],this._mru=[],this._activeKeymapInfo=null,navigator.keyboard&&navigator.keyboard.addEventListener&&navigator.keyboard.addEventListener("layoutchange",()=>{this._getBrowserKeyMapping().then(t=>{this.isKeyMappingActive(t)||this.setLayoutFromBrowserAPI()})}),this._register(this._configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration("keyboard")&&(this._keyboardMapper=null,this._onDidChangeKeyboardMapper.fire())}))}registerKeyboardLayout(e){this._keymapInfos.push(e),this._mru=this._keymapInfos}removeKeyboardLayout(e){let t=this._mru.indexOf(e);this._mru.splice(t,1),t=this._keymapInfos.indexOf(e),this._keymapInfos.splice(t,1)}getMatchedKeymapInfo(e){if(!e)return null;const t=this.getUSStandardLayout();if(t){let i=t.getScore(e);if(i===0)return{result:t,score:0};let s=t;for(let o=0;o<this._mru.length;o++){const r=this._mru[o].getScore(e);if(r>i){if(r===0)return{result:this._mru[o],score:0};i=r,s=this._mru[o]}}return{result:s,score:i}}for(let i=0;i<this._mru.length;i++)if(this._mru[i].fuzzyEqual(e))return{result:this._mru[i],score:0};return null}getUSStandardLayout(){const e=this._mru.filter(t=>t.layout.isUSStandard);return e.length?e[0]:null}isKeyMappingActive(e){return this._activeKeymapInfo&&e&&this._activeKeymapInfo.fuzzyEqual(e)}setUSKeyboardLayout(){this._activeKeymapInfo=this.getUSStandardLayout()}setActiveKeyMapping(e){let t=!1;const i=this.getMatchedKeymapInfo(e);if(i&&(this._activeKeymapInfo?e&&i.result.getScore(e)>this._activeKeymapInfo.getScore(e)&&(this._activeKeymapInfo=i.result,t=!0):(this._activeKeymapInfo=i.result,t=!0)),this._activeKeymapInfo||(this._activeKeymapInfo=this.getUSStandardLayout(),t=!0),!this._activeKeymapInfo||!t)return;const s=this._mru.indexOf(this._activeKeymapInfo);this._mru.splice(s,1),this._mru.unshift(this._activeKeymapInfo),this._setKeyboardData(this._activeKeymapInfo)}setActiveKeymapInfo(e){this._activeKeymapInfo=e;const t=this._mru.indexOf(this._activeKeymapInfo);t!==0&&(this._mru.splice(t,1),this._mru.unshift(this._activeKeymapInfo),this._setKeyboardData(this._activeKeymapInfo))}setLayoutFromBrowserAPI(){this._updateKeyboardLayoutAsync(this._initialized)}_updateKeyboardLayoutAsync(e,t){e&&this._getBrowserKeyMapping(t).then(i=>{this.isKeyMappingActive(i)||this.setActiveKeyMapping(i)})}getKeyboardMapper(){const e=eM(this._configurationService);return e.dispatch===Pc.KeyCode||!this._initialized||!this._activeKeymapInfo?new ny(e.mapAltGrToCtrlAlt,pi):(this._keyboardMapper||(this._keyboardMapper=new sM(vI._createKeyboardMapper(this._activeKeymapInfo,e.mapAltGrToCtrlAlt))),this._keyboardMapper)}validateCurrentKeyboardMapping(e){!this._initialized||this._validateCurrentKeyboardMapping(e)||this._updateKeyboardLayoutAsync(!0,e)}setKeyboardLayout(e){const t=this.keymapInfos.filter(i=>Vc(i.layout)===e);t.length>0&&this.setActiveKeymapInfo(t[0])}_setKeyboardData(e){this._initialized=!0,this._keyboardMapper=null,this._onDidChangeKeyboardMapper.fire()}static _createKeyboardMapper(e,t){const i=e.mapping,s=!!e.layout.isUSStandard;return pi===bs.Windows?new oM(s,i,t):Object.keys(i).length===0?new ny(t,pi):new Ui(s,i,t,pi)}_validateCurrentKeyboardMapping(e){if(!this._initialized)return!0;const t=e,i=this._activeKeymapInfo;if(!i||t.browserEvent.key==="Dead"||t.browserEvent.isComposing)return!0;const s=i.mapping[t.code];if(!s)return!1;if(s.value==="")return(e.ctrlKey||e.metaKey)&&setTimeout(()=>{this._getBrowserKeyMapping().then(n=>{this.isKeyMappingActive(n)||this.setLayoutFromBrowserAPI()})},350),!0;const o=t.altKey&&t.shiftKey?s.withShiftAltGr:t.altKey?s.withAltGr:t.shiftKey?s.withShift:s.value,r=t.altKey&&t.shiftKey&&s.withShiftAltGrIsDeadKey||t.altKey&&s.withAltGrIsDeadKey||t.shiftKey&&s.withShiftIsDeadKey||s.valueIsDeadKey;return!(r&&t.browserEvent.key!=="Dead"||!r&&t.browserEvent.key!==o)}async _getBrowserKeyMapping(e){if(this.keyboardLayoutMapAllowed)try{return await navigator.keyboard.getLayoutMap().then(t=>{const i={};for(const s of t)i[s[0]]={value:s[1],withShift:"",withAltGr:"",withShiftAltGr:""};return i})}catch{this.keyboardLayoutMapAllowed=!1}if(e&&!e.shiftKey&&!e.altKey&&!e.metaKey&&!e.metaKey){const t={},i=e;return t[i.browserEvent.code]={value:i.browserEvent.key,withShift:"",withAltGr:"",withShiftAltGr:""},this.getMatchedKeymapInfo(t)?t:null}return null}}class vI extends aM{constructor(e,t,i,s){super(e),nM(`./keyboardLayouts/layout.contribution.${mi?"win":Ge?"darwin":"linux"}.js`).then(r=>{const n=r.KeyboardLayoutContribution.INSTANCE.layoutInfos;this._keymapInfos.push(...n.map(d=>new Xp(d.layout,d.secondaryLayouts,d.mapping,d.isUserKeyboardLayout))),this._mru=this._keymapInfos,this._initialized=!0,this.setLayoutFromBrowserAPI()})}}class dM extends M{get keyboardLayout(){return this._keyboardLayout}constructor(e,t){super(),this.keyboardLayoutResource=e,this.fileService=t,this._onDidChange=this._register(new A),this.onDidChange=this._onDidChange.event,this._keyboardLayout=null,this.reloadConfigurationScheduler=this._register(new pd(()=>this.reload().then(i=>{i&&this._onDidChange.fire()}),50)),this._register(K.filter(this.fileService.onDidFilesChange,i=>i.contains(this.keyboardLayoutResource))(()=>this.reloadConfigurationScheduler.schedule()))}async initialize(){await this.reload()}async reload(){const e=this._keyboardLayout;try{const t=await this.fileService.readFile(this.keyboardLayoutResource),i=eE(t.value.toString());if(TT(i)==="object"){const s=i.layout,o=i.rawMapping;this._keyboardLayout=Xp.createKeyboardLayoutFromDebugInfo(s,o,!0)}else this._keyboardLayout=null}catch{this._keyboardLayout=null}return e?!Sp(e,this._keyboardLayout):!0}}let hm=class extends M{constructor(e,t,i,s,o,r){super(),this.configurationService=r,this._onDidChangeKeyboardLayout=new A,this.onDidChangeKeyboardLayout=this._onDidChangeKeyboardLayout.event;const d=r.getValue("keyboard").layout;this._keyboardLayoutMode=d??"autodetect",this._factory=new vI(r,i,s,o),this._register(this._factory.onDidChangeKeyboardMapper(()=>{this._onDidChangeKeyboardLayout.fire()})),d&&d!=="autodetect"&&this._factory.setKeyboardLayout(d),this._register(r.onDidChangeConfiguration(l=>{if(l.affectsConfiguration("keyboard.layout")){const p=r.getValue("keyboard").layout;this._keyboardLayoutMode=p,p==="autodetect"?this._factory.setLayoutFromBrowserAPI():this._factory.setKeyboardLayout(p)}})),this._userKeyboardLayout=new dM(e.keyboardLayoutResource,t),this._userKeyboardLayout.initialize().then(()=>{this._userKeyboardLayout.keyboardLayout&&(this._factory.registerKeyboardLayout(this._userKeyboardLayout.keyboardLayout),this.setUserKeyboardLayoutIfMatched())}),this._register(this._userKeyboardLayout.onDidChange(()=>{const l=this._factory.keymapInfos.filter(h=>h.isUserKeyboardLayout);l.length?this._userKeyboardLayout.keyboardLayout?l[0].update(this._userKeyboardLayout.keyboardLayout):this._factory.removeKeyboardLayout(l[0]):this._userKeyboardLayout.keyboardLayout&&this._factory.registerKeyboardLayout(this._userKeyboardLayout.keyboardLayout),this.setUserKeyboardLayoutIfMatched()}))}setUserKeyboardLayoutIfMatched(){const t=this.configurationService.getValue("keyboard").layout;t&&this._userKeyboardLayout.keyboardLayout&&Vc(this._userKeyboardLayout.keyboardLayout.layout)===t&&this._factory.activeKeymap&&(this._userKeyboardLayout.keyboardLayout.equal(this._factory.activeKeymap)||this._factory.setActiveKeymapInfo(this._userKeyboardLayout.keyboardLayout))}getKeyboardMapper(){return this._factory.getKeyboardMapper()}getCurrentKeyboardLayout(){return this._factory.activeKeyboardLayout}getAllKeyboardLayouts(){return this._factory.keyboardLayouts}getRawKeyboardMapping(){return this._factory.activeKeyMapping}validateCurrentKeyboardMapping(e){this._keyboardLayoutMode==="autodetect"&&this._factory.validateCurrentKeyboardMapping(e)}};hm=D([u(0,Fb),u(1,Ve),u(2,Qe),u(3,ge),u(4,ke),u(5,te)],hm);const cM=se.as(Lo.Configuration),lM={id:"keyboard",order:15,type:"object",title:c(14136,"Keyboard"),properties:{"keyboard.layout":{type:"string",default:"autodetect",description:c(14137,"Control the keyboard layout used in web.")}}};cM.registerConfiguration(lM);let um=class extends M{constructor(e,t,i){super(),this._instantiationService=e,this._extensionService=t,this._logService=i,this._extensionHostIsReady=!1,this._onWillExecuteCommand=this._register(new A),this.onWillExecuteCommand=this._onWillExecuteCommand.event,this._onDidExecuteCommand=new A,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._extensionService.whenInstalledExtensionsRegistered().then(s=>this._extensionHostIsReady=s),this._starActivation=null}_activateStar(){return this._starActivation||(this._starActivation=ay([this._extensionService.activateByEvent("*"),fr(3e4)])),kT(this._starActivation)}async executeCommand(e,...t){this._logService.trace("CommandService#executeCommand",e);const i=`onCommand:${e}`;return re.getCommand(e)?this._extensionService.activationEventIsDone(i)?this._tryExecuteCommand(e,t):this._extensionHostIsReady?(await this._extensionService.activateByEvent(i),this._tryExecuteCommand(e,t)):(this._extensionService.activateByEvent(i),this._tryExecuteCommand(e,t)):(await Promise.all([this._extensionService.activateByEvent(i),ay([this._activateStar(),K.toPromise(K.filter(re.onDidRegisterCommand,o=>o===e))])]),this._tryExecuteCommand(e,t))}_tryExecuteCommand(e,t){const i=re.getCommand(e);if(!i)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const s=this._instantiationService.invokeFunction(i.handler,...t);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(s)}catch(s){return Promise.reject(s)}}dispose(){super.dispose(),this._starActivation?.cancel()}};um=D([u(0,z),u(1,si),u(2,et)],um);class la extends R{constructor(){super({id:"workbench.action.toggleKeybindingsLog",title:y(8502,"Toggle Keyboard Shortcuts Troubleshooting"),category:T.Developer,f1:!0})}run(e){if(e.get(ot).toggleLogging()&&e.get(ke).executeCommand(hS),la.disposable){la.disposable.dispose(),la.disposable=void 0;return}const i=e.get(iE),s=new B,o=i.activeContainer,r=ye(o,N(".focus-troubleshooting-marker"));s.add(pe(()=>r.remove()));const n=wp(void 0,void 0,s);xT(".focus-troubleshooting-marker",`
			position: fixed;
			pointer-events: none;
			z-index: 100000;
			background-color: rgba(255, 0, 0, 0.2);
			border: 2px solid rgba(255, 0, 0, 0.8);
			border-radius: 2px;
			display: none;
		`,n);const d=s.add(new A);function l(h,p){p.add(X(h,"keydown",g=>d.fire(g),!0))}for(const{window:h,disposables:p}of Yg())l(h,p);s.add(ZS(({window:h,disposables:p})=>l(h,p))),s.add(i.onDidChangeActiveContainer(()=>{i.activeContainer.appendChild(r)})),s.add(d.event(h=>{const p=h.target;if(p){const g=CS(p);r.style.top=`${g.top}px`,r.style.left=`${g.left}px`,r.style.width=`${g.width}px`,r.style.height=`${g.height}px`,r.style.display="block",setTimeout(()=>{r.style.display="none"},800)}})),la.disposable=s}}S(la);class hM{static hasOpenBrace(e){for(;e.scan()!==ks.EOF;)if(e.getToken()===ks.OpenBraceToken)return!0;return!1}static offsetToPosition(e,t){let i=0;const s=e.getEOL().length,o=e.getLineCount();for(let r=1;r<=o;r++){const n=e.getLineLength(r)+s,d=i+n;if(d>t)return new Dl(r,t-i+1);i=d}return new Dl(o,e.getLineMaxColumn(o))}static insertSnippet(e,t){const i=e.getValueLengthInRange(new ze(1,1,t.lineNumber,t.column));let s;(function(f){f[f.INVALID=0]="INVALID",f[f.AFTER_OBJECT=1]="AFTER_OBJECT",f[f.BEFORE_OBJECT=2]="BEFORE_OBJECT"})(s||(s={}));let o=s.INVALID,r=-1,n=s.INVALID;const d=LT(e.getValue());let l=0,h=0;const p=(f,m)=>{m!==s.INVALID&&l===1&&h===0?(o=m,r=f,n=m):o!==s.INVALID&&(o=s.INVALID,r=d.getTokenOffset())};for(;d.scan()!==ks.EOF;){const f=d.getPosition(),m=d.getToken();let v=!1;switch(m){case ks.OpenBracketToken:v=!0,l++,p(f,s.BEFORE_OBJECT);break;case ks.CloseBracketToken:v=!0,l--,p(f,s.INVALID);break;case ks.CommaToken:v=!0,p(f,s.BEFORE_OBJECT);break;case ks.OpenBraceToken:v=!0,h++,p(f,s.INVALID);break;case ks.CloseBraceToken:v=!0,h--,p(f,s.AFTER_OBJECT);break;case ks.Trivia:case ks.LineBreakTrivia:v=!0}if(f>=i&&(o!==s.INVALID||r!==-1)){let E,x;return o!==s.INVALID?(E=v?f:d.getTokenOffset(),x=o):(E=r,x=n),x===s.AFTER_OBJECT?{position:this.offsetToPosition(e,E),prepend:",",append:""}:(d.setPosition(E),{position:this.offsetToPosition(e,E),prepend:"",append:this.hasOpenBrace(d)?",":""})}}const g=e.getLineCount();return{position:new Dl(g,e.getLineMaxColumn(g)),prepend:`
[`,append:"]"}}}const uM=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),pM=Ee("settings-folder-dropdown",P.chevronDown,c(9932,"Icon for the folder dropdown button in the split JSON Settings editor."));Ee("settings-more-action",P.gear,c(9933,"Icon for the 'more actions' action in the Settings UI."));Ee("keybindings-record-keys",P.recordKeys,c(9934,"Icon for the 'record keys' action in the keybinding UI."));Ee("keybindings-sort",P.sortPrecedence,c(9935,"Icon for the 'sort by precedence' toggle in the keybinding UI."));Ee("keybindings-edit",P.edit,c(9936,"Icon for the edit action in the keybinding UI."));Ee("keybindings-add",P.add,c(9937,"Icon for the add action in the keybinding UI."));Ee("settings-edit",P.edit,c(9938,"Icon for the edit action in the Settings UI."));Ee("settings-remove",P.close,c(9939,"Icon for the remove action in the Settings UI."));Ee("settings-discard",P.discard,c(9940,"Icon for the discard action in the Settings UI."));Ee("preferences-clear-input",P.clearAll,c(9941,"Icon for clear input in the Settings and keybinding UI."));Ee("preferences-ai-results",P.sparkle,c(9942,"Icon for showing AI results in the Settings UI."));Ee("preferences-filter",P.filter,c(9943,"Icon for the button that suggests filters for the Settings UI."));Ee("preferences-open-settings",P.goToFile,c(9944,"Icon for open settings commands."));let pm=class extends RT{constructor(e,t,i,s){super(null,e),this.contextService=t,this.contextMenuService=i,this.hoverService=s,this._folderSettingCounts=new Map;const o=this.contextService.getWorkspace();this._folder=o.folders.length===1?o.folders[0]:null,this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.onWorkspaceFoldersChanged()))}get folder(){return this._folder}set folder(e){this._folder=e,this.update()}setCount(e,t){const i=this.contextService.getWorkspaceFolder(e);if(!i)throw new Error("unknown folder");const s=i.uri;this._folderSettingCounts.set(s.toString(),t),this.update()}render(e){this.element=e,this.container=e,this.labelElement=N(".action-title"),this.detailsElement=N(".action-details"),this.dropDownElement=N(".dropdown-icon.hide"+Se.asCSSSelector(pM)),this.anchorElement=N("a.action-label.folder-settings",{role:"button","aria-haspopup":"true",tabindex:"0"},this.labelElement,this.detailsElement,this.dropDownElement),this.anchorElementHover=this._register(this.hoverService.setupManagedHover(zc("mouse"),this.anchorElement,"")),this._register(X(this.anchorElement,Q.MOUSE_DOWN,t=>be.stop(t))),this._register(X(this.anchorElement,Q.CLICK,t=>this.onClick(t))),this._register(X(this.container,Q.KEY_UP,t=>this.onKeyUp(t))),ye(this.container,this.anchorElement),this.update()}onKeyUp(e){switch(new br(e).keyCode){case w.Enter:case w.Space:this.onClick(e);return}}onClick(e){be.stop(e,!0),!this.folder||this._action.checked?this.showMenu():this._action.run(this._folder)}updateEnabled(){this.update()}updateChecked(){this.update()}onWorkspaceFoldersChanged(){const e=this._folder,t=this.contextService.getWorkspace();e&&(this._folder=t.folders.filter(i=>qe(i.uri,e.uri))[0]||t.folders[0]),this._folder=this._folder?this._folder:t.folders.length===1?t.folders[0]:null,this.update(),this._action.checked&&this._action.run(this._folder)}update(){let e=0;this._folderSettingCounts.forEach(i=>e+=i);const t=this.contextService.getWorkspace();if(this._folder){this.labelElement.textContent=this._folder.name,this.anchorElementHover.update(this._folder.name);const i=this.labelWithCount(this._action.label,e);this.detailsElement.textContent=i,this.dropDownElement.classList.toggle("hide",t.folders.length===1||!this._action.checked)}else{const i=this.labelWithCount(this._action.label,e);this.labelElement.textContent=i,this.detailsElement.textContent="",this.anchorElementHover.update(this._action.label),this.dropDownElement.classList.remove("hide")}this.anchorElement.classList.toggle("checked",this._action.checked),this.container.classList.toggle("disabled",!this._action.enabled)}showMenu(){this.contextMenuService.showContextMenu({getAnchor:()=>this.container,getActions:()=>this.getDropdownMenuActions(),getActionViewItem:()=>{},onHide:()=>{this.anchorElement.blur()}})}getDropdownMenuActions(){const e=[],t=this.contextService.getWorkspace().folders;return this.contextService.getWorkbenchState()===Ns.WORKSPACE&&t.length>0&&e.push(...t.map((i,s)=>{const o=this._folderSettingCounts.get(i.uri.toString());return{id:"folderSettingsTarget"+s,label:this.labelWithCount(i.name,o),tooltip:this.labelWithCount(i.name,o),checked:!!this.folder&&qe(this.folder.uri,i.uri),enabled:!0,class:void 0,run:()=>this._action.run(i)}})),e}labelWithCount(e,t){return t&&(e+=` (${t})`),e}};pm=D([u(1,xt),u(2,st),u(3,oi)],pm);let SC=class extends Dp{constructor(e,t,i,s,o,r,n){super(),this.contextService=i,this.instantiationService=s,this.environmentService=o,this.labelService=r,this.languageService=n,this._settingsTarget=null,this._onDidTargetChange=this._register(new A),this.onDidTargetChange=this._onDidTargetChange.event,this.options=t??{},this.create(e),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.onWorkbenchStateChanged())),this._register(this.contextService.onDidChangeWorkspaceFolders(()=>this.update()))}resetLabels(){const e=this.environmentService.remoteAuthority,t=e&&this.labelService.getHostLabel(ue.vscodeRemote,e);this.userLocalSettings.label=c(9964,"User"),this.userRemoteSettings.label=c(9965,"Remote")+(t?` [${t}]`:""),this.workspaceSettings.label=c(9966,"Workspace"),this.folderSettingsAction.label=c(9967,"Folder")}create(e){const t=ye(e,N(".settings-tabs-widget"));this.settingsSwitcherBar=this._register(new Sr(t,{orientation:Fn.HORIZONTAL,focusOnlyEnabledItems:!0,ariaLabel:c(9968,"Settings Switcher"),ariaRole:"tablist",actionViewItemProvider:(o,r)=>o.id==="folderSettings"?this.folderSettings:void 0})),this.userLocalSettings=this._register(new Je("userSettings","",".settings-tab",!0,()=>this.updateTarget(Ot.USER_LOCAL))),this.userLocalSettings.tooltip=c(9964,"User"),this.userRemoteSettings=this._register(new Je("userSettingsRemote","",".settings-tab",!0,()=>this.updateTarget(Ot.USER_REMOTE)));const i=this.environmentService.remoteAuthority,s=i&&this.labelService.getHostLabel(ue.vscodeRemote,i);this.userRemoteSettings.tooltip=c(9965,"Remote")+(s?` [${s}]`:""),this.workspaceSettings=this._register(new Je("workspaceSettings","",".settings-tab",!1,()=>this.updateTarget(Ot.WORKSPACE))),this.folderSettingsAction=this._register(new Je("folderSettings","",".settings-tab",!1,async o=>{this.updateTarget(zs(o)?o.uri:Ot.USER_LOCAL)})),this.folderSettings=this._register(this.instantiationService.createInstance(pm,this.folderSettingsAction)),this.resetLabels(),this.update(),this.settingsSwitcherBar.push([this.userLocalSettings,this.userRemoteSettings,this.workspaceSettings,this.folderSettingsAction])}get settingsTarget(){return this._settingsTarget}set settingsTarget(e){this._settingsTarget=e,this.userLocalSettings.checked=Ot.USER_LOCAL===this.settingsTarget,this.userRemoteSettings.checked=Ot.USER_REMOTE===this.settingsTarget,this.workspaceSettings.checked=Ot.WORKSPACE===this.settingsTarget,this.settingsTarget instanceof F?(this.folderSettings.action.checked=!0,this.folderSettings.folder=this.contextService.getWorkspaceFolder(this.settingsTarget)):this.folderSettings.action.checked=!1}setResultCount(e,t){if(e===Ot.WORKSPACE){let i=c(9966,"Workspace");t&&(i+=` (${t})`),this.workspaceSettings.label=i}else if(e===Ot.USER_LOCAL){let i=c(9964,"User");t&&(i+=` (${t})`),this.userLocalSettings.label=i}else e instanceof F&&this.folderSettings.setCount(e,t)}updateLanguageFilterIndicators(e){if(this.resetLabels(),e){const t=this.languageService.getLanguageName(e);if(t){const i=` [${t}]`;this.userLocalSettings.label+=i,this.userRemoteSettings.label+=i,this.workspaceSettings.label+=i,this.folderSettingsAction.label+=i}}}onWorkbenchStateChanged(){this.folderSettings.folder=null,this.update(),this.settingsTarget===Ot.WORKSPACE&&this.contextService.getWorkbenchState()===Ns.WORKSPACE&&this.updateTarget(Ot.USER_LOCAL)}updateTarget(e){return this.settingsTarget===e||e instanceof F&&this.settingsTarget instanceof F&&qe(this.settingsTarget,e)||(this.settingsTarget=e,this._onDidTargetChange.fire(this.settingsTarget)),Promise.resolve(void 0)}async update(){this.settingsSwitcherBar.domNode.classList.toggle("empty-workbench",this.contextService.getWorkbenchState()===Ns.EMPTY),this.userRemoteSettings.enabled=!!(this.options.enableRemoteSettings&&this.environmentService.remoteAuthority),this.workspaceSettings.enabled=this.contextService.getWorkbenchState()!==Ns.EMPTY,this.folderSettings.action.enabled=this.contextService.getWorkbenchState()===Ns.WORKSPACE&&this.contextService.getWorkspace().folders.length>0,this.workspaceSettings.tooltip=c(9966,"Workspace")}};SC=D([u(2,xt),u(3,z),u(4,wi),u(5,rs),u(6,Es)],SC);let gm=class extends Dp{get onDidChange(){return this._onDidChange.event}get onFocus(){return this._onFocus.event}constructor(e,t,i,s,o,r){super(),this.options=t,this.contextViewService=i,this.instantiationService=s,this.contextKeyService=o,this.keybindingService=r,this._onDidChange=this._register(new A),this._onFocus=this._register(new A),this.create(e)}create(e){this.domNode=ye(e,N("div.settings-header-widget")),this.createSearchContainer(ye(this.domNode,N("div.settings-search-container"))),this.controlsDiv=ye(this.domNode,N("div.settings-search-controls")),this.options.showResultCount&&(this.countElement=ye(this.controlsDiv,N(".settings-count-widget")),this.countElement.style.backgroundColor=Ea(VT),this.countElement.style.color=Ea(PT),this.countElement.style.border=`1px solid ${Ea(es)}`),this.inputBox.inputElement.setAttribute("aria-live",this.options.ariaLive||"off"),this.options.ariaLabelledBy&&this.inputBox.inputElement.setAttribute("aria-labelledBy",this.options.ariaLabelledBy);const t=this._register(Eo(this.inputBox.inputElement));this._register(t.onDidFocus(()=>this._onFocus.fire()));const i=this.options.focusKey;i&&(this._register(t.onDidFocus(()=>i.set(!0))),this._register(t.onDidBlur(()=>i.set(!1))))}createSearchContainer(e){this.searchContainer=e;const t=ye(this.searchContainer,N("div.settings-search-input"));this.inputBox=this._register(this.createInputBox(t)),this._register(this.inputBox.onDidChange(i=>this._onDidChange.fire(i)))}createInputBox(e){const t=()=>sE(this.keybindingService);return new OT(e,this.contextViewService,{...this.options,showHistoryHint:t},this.contextKeyService)}showMessage(e){this.countElement&&e!==this.countElement.textContent&&(this.countElement.textContent=e,this.inputBox.inputElement.setAttribute("aria-label",e),this.inputBox.inputElement.style.paddingRight=this.getControlsWidth()+"px")}layout(e){e.width<400?(this.countElement?.classList.add("hide"),this.inputBox.inputElement.style.paddingRight="0px"):(this.countElement?.classList.remove("hide"),this.inputBox.inputElement.style.paddingRight=this.getControlsWidth()+"px")}getControlsWidth(){return(this.countElement?MT(this.countElement):0)+20}focus(){this.inputBox.focus(),this.getValue()&&this.inputBox.select()}hasFocus(){return this.inputBox.hasFocus()}clear(){this.inputBox.value=""}getValue(){return this.inputBox.value}setValue(e){return this.inputBox.value=e}dispose(){this.options.focusKey?.set(!1),super.dispose()}};gm=D([u(2,Bn),u(3,z),u(4,de),u(5,ot)],gm);var ia,fm;xe(uM);let mm=class extends gm{constructor(e,t,i,s,o,r){super(e,t,i,s,o,r),this.recordDisposables=this._register(new B),this._onKeybinding=this._register(new A),this.onKeybinding=this._onKeybinding.event,this._onEnter=this._register(new A),this.onEnter=this._onEnter.event,this._onEscape=this._register(new A),this.onEscape=this._onEscape.event,this._onBlur=this._register(new A),this.onBlur=this._onBlur.event,this._register(pe(()=>this.stopRecordingKeys())),this._chords=null,this._inputValue=""}clear(){this._chords=null,super.clear()}startRecordingKeys(){this.recordDisposables.add(X(this.inputBox.inputElement,Q.KEY_DOWN,e=>this._onKeyDown(new br(e)))),this.recordDisposables.add(X(this.inputBox.inputElement,Q.BLUR,()=>this._onBlur.fire())),this.recordDisposables.add(X(this.inputBox.inputElement,Q.INPUT,()=>{this.setInputValue(this._inputValue)}))}stopRecordingKeys(){this._chords=null,this.recordDisposables.clear()}setInputValue(e){this._inputValue=e,this.inputBox.value=this._inputValue}_onKeyDown(e){if(e.preventDefault(),e.stopPropagation(),!this.options.recordEnter&&e.equals(w.Enter)){this._onEnter.fire();return}if(e.equals(w.Escape)){this._onEscape.fire();return}this.printKeybinding(e)}printKeybinding(e){const t=this.keybindingService.resolveKeyboardEvent(e),i=`code: ${e.browserEvent.code}, keyCode: ${e.browserEvent.keyCode}, key: ${e.browserEvent.key} => UI: ${t.getAriaLabel()}, user settings: ${t.getUserSettingsLabel()}, dispatch: ${t.getDispatchChords()[0]}`,s=this.options;this._chords||(this._chords=[]),this._chords.length>0&&this._chords[this._chords.length-1].getDispatchChords()[0]===null?this._chords[this._chords.length-1]=t:(this._chords.length===2&&(this._chords=[]),this._chords.push(t));const r=this._chords.map(n=>n.getUserSettingsLabel()||"").join(" ");this.setInputValue(s.quoteRecordedKeys?`"${r}"`:r),this.inputBox.inputElement.title=i,this._onKeybinding.fire(this._chords)}};mm=D([u(2,Bn),u(3,z),u(4,de),u(5,ot)],mm);var sr;let wm=(sr=class extends Dp{constructor(e,t){super(),this.instantiationService=t,this._keybindingDisposables=this._register(new B),this._chords=null,this._isVisible=!1,this._onHide=this._register(new A),this._onDidChange=this._register(new A),this.onDidChange=this._onDidChange.event,this._onShowExistingKeybindings=this._register(new A),this.onShowExistingKeybidings=this._onShowExistingKeybindings.event,this._domNode=NT(ve("div")),this._domNode.setDisplay("none"),this._domNode.setClassName("defineKeybindingWidget"),this._domNode.setWidth(ia.WIDTH),this._domNode.setHeight(ia.HEIGHT);const i=c(9834,"Press desired key combination and then press ENTER.");ye(this._domNode.domNode,N(".message",void 0,i)),this._domNode.domNode.style.backgroundColor=Ea(FT),this._domNode.domNode.style.color=Ea(BT),this._domNode.domNode.style.boxShadow=`0 2px 8px ${Ea(bS)}`,this._keybindingInputWidget=this._register(this.instantiationService.createInstance(mm,this._domNode.domNode,{ariaLabel:i,history:new Set([]),inputBoxStyles:Ap})),this._keybindingInputWidget.startRecordingKeys(),this._register(this._keybindingInputWidget.onKeybinding(s=>this.onKeybinding(s))),this._register(this._keybindingInputWidget.onEnter(()=>this.hide())),this._register(this._keybindingInputWidget.onEscape(()=>this.clearOrHide())),this._register(this._keybindingInputWidget.onBlur(()=>this.onCancel())),this._outputNode=ye(this._domNode.domNode,N(".output")),this._showExistingKeybindingsNode=ye(this._domNode.domNode,N(".existing")),e&&ye(e,this._domNode.domNode)}get domNode(){return this._domNode.domNode}define(){return this._keybindingInputWidget.clear(),_p.withAsyncBody(async e=>{this._isVisible||(this._isVisible=!0,this._domNode.setDisplay("block"),this._chords=null,this._keybindingInputWidget.setInputValue(""),Ut(this._outputNode),Ut(this._showExistingKeybindingsNode),await fr(0),this._keybindingInputWidget.focus());const t=this._onHide.event(()=>{e(this.getUserSettingsLabel()),t.dispose()})})}layout(e){const t=Math.round((e.height-ia.HEIGHT)/2);this._domNode.setTop(t);const i=Math.round((e.width-ia.WIDTH)/2);this._domNode.setLeft(i)}printExisting(e){if(e>0){const t=N("span.existingText"),i=e===1?c(9835,"1 existing command has this keybinding",e):c(9836,"{0} existing commands have this keybinding",e);ye(t,Xg(i)),GT(i),this._showExistingKeybindingsNode.appendChild(t),t.onmousedown=s=>{s.preventDefault()},t.onmouseup=s=>{s.preventDefault()},t.onclick=()=>{this._onShowExistingKeybindings.fire(this.getUserSettingsLabel())}}}onKeybinding(e){if(this._keybindingDisposables.clear(),this._chords=e,Ut(this._outputNode),Ut(this._showExistingKeybindingsNode),this._keybindingDisposables.add(new Fg(this._outputNode,pi,Bg)).set(this._chords?.[0]??void 0),this._chords)for(let s=1;s<this._chords.length;s++)this._outputNode.appendChild(Xg(c(9837,"chord to"))),this._keybindingDisposables.add(new Fg(this._outputNode,pi,Bg)).set(this._chords[s]);const i=this.getUserSettingsLabel();i&&this._onDidChange.fire(i)}getUserSettingsLabel(){let e=null;return this._chords&&(e=this._chords.map(t=>t.getUserSettingsLabel()).join(" ")),e}onCancel(){this._chords=null,this.hide()}clearOrHide(){this._chords===null?this.hide():(this._chords=null,this._keybindingInputWidget.clear(),Ut(this._outputNode),Ut(this._showExistingKeybindingsNode))}hide(){this._domNode.setDisplay("none"),this._isVisible=!1,this._onHide.fire()}},ia=sr,sr.WIDTH=400,sr.HEIGHT=110,sr);wm=ia=D([u(1,z)],wm);var cn;let bm=(cn=class extends M{constructor(e,t){super(),this._editor=e,this._widget=this._register(t.createInstance(wm,null)),this._editor.addOverlayWidget(this)}getId(){return fm.ID}getDomNode(){return this._widget.domNode}getPosition(){return{preference:null}}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}start(){this._editor.hasModel()&&this._editor.revealPositionInCenterIfOutsideViewport(this._editor.getPosition(),Nt.Smooth);const e=this._editor.getLayoutInfo();return this._widget.layout(new Be(e.width,e.height)),this._widget.define()}},fm=cn,cn.ID="editor.contrib.defineKeybindingWidget",cn);bm=fm=D([u(1,z)],bm);var EC;(function(a){a.Null="null",a.Enum="enum",a.String="string",a.MultilineString="multiline-string",a.Integer="integer",a.Number="number",a.Boolean="boolean",a.Array="array",a.Exclude="exclude",a.Include="include",a.Complex="complex",a.NullableInteger="nullable-integer",a.NullableNumber="nullable-number",a.Object="object",a.BooleanObject="boolean-object",a.LanguageTag="language-tag",a.ExtensionToggle="extension-toggle",a.ComplexObject="complex-object"})(EC||(EC={}));var Pr;(function(a){a[a.None=0]="None",a[a.LanguageTagSettingMatch=1]="LanguageTagSettingMatch",a[a.RemoteMatch=2]="RemoteMatch",a[a.NonContiguousQueryInSettingId=4]="NonContiguousQueryInSettingId",a[a.DescriptionOrValueMatch=8]="DescriptionOrValueMatch",a[a.NonContiguousWordsInSettingsLabel=16]="NonContiguousWordsInSettingsLabel",a[a.ContiguousWordsInSettingsLabel=32]="ContiguousWordsInSettingsLabel",a[a.ContiguousQueryInSettingId=64]="ContiguousQueryInSettingId",a[a.AllWordsInSettingsLabel=128]="AllWordsInSettingsLabel",a[a.ExactMatch=256]="ExactMatch"})(Pr||(Pr={}));Pr.AllWordsInSettingsLabel|Pr.ContiguousWordsInSettingsLabel|Pr.NonContiguousWordsInSettingsLabel|Pr.NonContiguousQueryInSettingId|Pr.ContiguousQueryInSettingId;const gM="editor.contrib.defineKeybinding";var vm;const fM=c(9871,"You won't be able to produce this key combination under your current keyboard layout.");let ym=class extends M{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._userDataProfileService=i,this._keybindingDecorationRenderer=this._register(new Ae),this._defineWidget=this._register(this._instantiationService.createInstance(bm,this._editor)),this._register(this._editor.onDidChangeModel(s=>this._update())),this._update()}_update(){this._keybindingDecorationRenderer.value=_C(this._editor,this._userDataProfileService)?this._instantiationService.createInstance(Cm,this._editor):void 0}showDefineKeybindingWidget(){_C(this._editor,this._userDataProfileService)&&this._defineWidget.start().then(e=>this._onAccepted(e))}_onAccepted(e){if(this._editor.focus(),e&&this._editor.hasModel()){new RegExp(/\\/g).test(e)&&(e=e.slice(0,-1)+"\\\\");let s=["{",'	"key": '+JSON.stringify(e)+",",'	"command": "${1:commandId}",','	"when": "${2:editorTextFocus}"',"}$0"].join(`
`);const o=hM.insertSnippet(this._editor.getModel(),this._editor.getPosition());s=o.prepend+s+o.append,this._editor.setPosition(o.position),oE.get(this._editor)?.insert(s,{overwriteBefore:0,overwriteAfter:0})}}};ym=D([u(1,z),u(2,Nb)],ym);let Cm=vm=class extends M{constructor(e,t){super(),this._editor=e,this._keybindingService=t,this._dec=this._editor.createDecorationsCollection(),this._updateDecorations=this._register(new pd(()=>this._updateDecorationsNow(),500));const i=fe(this._editor.getModel());this._register(i.onDidChangeContent(()=>this._updateDecorations.schedule())),this._register(this._keybindingService.onDidUpdateKeybindings(()=>this._updateDecorations.schedule())),this._register({dispose:()=>{this._dec.clear(),this._updateDecorations.cancel()}}),this._updateDecorations.schedule()}_updateDecorationsNow(){const e=fe(this._editor.getModel()),t=[],i=WT(e.getValue());if(i&&Array.isArray(i.children))for(let s=0,o=i.children.length;s<o;s++){const r=i.children[s],n=this._getDecorationForEntry(e,r);n!==null&&t.push(n)}this._dec.set(t)}_getDecorationForEntry(e,t){if(!Array.isArray(t.children))return null;for(let i=0,s=t.children.length;i<s;i++){const o=t.children[i];if(o.type!=="property"||!Array.isArray(o.children)||o.children.length!==2||o.children[0].value!=="key")continue;const n=o.children[1];if(n.type!=="string")continue;const d=this._keybindingService.resolveUserBinding(n.value);if(d.length===0)return this._createDecoration(!0,null,null,e,n);const l=d[0];let h=null;if(l instanceof Vd&&(h=l.getUSLabel()),!l.isWYSIWYG()){const g=l.getLabel();return typeof g=="string"&&n.value.toLowerCase()===g.toLowerCase()?null:this._createDecoration(!1,l.getLabel(),h,e,n)}if(/abnt_|oem_/.test(n.value))return this._createDecoration(!1,l.getLabel(),h,e,n);const p=l.getUserSettingsLabel();return typeof p=="string"&&!vm._userSettingsFuzzyEquals(n.value,p)?this._createDecoration(!1,l.getLabel(),h,e,n):null}return null}static _userSettingsFuzzyEquals(e,t){if(e=e.trim().toLowerCase(),t=t.trim().toLowerCase(),e===t)return!0;const i=Rc.parseKeybinding(e),s=Rc.parseKeybinding(t);return i===null&&s===null?!0:!i||!s?!1:i.equals(s)}_createDecoration(e,t,i,s,o){let r,n,d;e?(r=new Zi().appendText(fM),n="keybindingError",d=Ql(KT)):(i&&t!==i?r=new Zi(c(9872,"**{0}** for your current keyboard layout (**{1}** for US standard).",t,i)):r=new Zi(c(9873,"**{0}** for your current keyboard layout.",t)),n="keybindingInfo",d=Ql(UT));const l=s.getPositionAt(o.offset),h=s.getPositionAt(o.offset+o.length);return{range:new ze(l.lineNumber,l.column,h.lineNumber,h.column),options:{description:"keybindings-widget",stickiness:Wb.NeverGrowsWhenTypingAtEdges,className:n,hoverMessage:r,overviewRuler:{color:d,position:md.Right}}}}};Cm=vm=D([u(1,ot)],Cm);function _C(a,e){const t=a.getModel();return t?qe(t.uri,e.currentProfile.keybindingsResource):!1}Bb(gM,ym,Gb.AfterFirstRender);class mM extends R{constructor(){super({id:"runCommands",title:y(6279,"Run Commands"),f1:!1,metadata:{description:c(6280,"Run several commands"),args:[{name:"args",schema:{type:"object",required:["commands"],properties:{commands:{type:"array",description:c(6281,"Commands to run"),items:{anyOf:[{$ref:"vscode://schemas/keybindings#/definitions/commandNames"},{type:"string"},{type:"object",required:["command"],properties:{command:{anyOf:[{$ref:"vscode://schemas/keybindings#/definitions/commandNames"},{type:"string"}]}},$ref:"vscode://schemas/keybindings#/definitions/commandsSchemas"}]}}}}}]}})}async run(e,t){const i=e.get(Qe);if(!this._isCommandArgs(t)){i.error(c(6282,"'runCommands' has received an argument with incorrect type. Please, review the argument passed to the command."));return}if(t.commands.length===0){i.warn(c(6283,"'runCommands' has not received commands to run. Did you forget to pass commands in the 'runCommands' argument?"));return}const s=e.get(ke),o=e.get(et);let r=0;try{for(;r<t.commands.length;++r){const n=t.commands[r];o.debug(`runCommands: executing ${r}-th command: ${dy(n)}`),await this._runCommand(s,n),o.debug(`runCommands: executed ${r}-th command`)}}catch(n){o.debug(`runCommands: executing ${r}-th command resulted in an error: ${n instanceof Error?n.message:dy(n)}`),i.error(n)}}_isCommandArgs(e){if(!e||typeof e!="object"||!("commands"in e)||!Array.isArray(e.commands))return!1;for(const t of e.commands)if(typeof t!="string"&&!(typeof t=="object"&&typeof t.command=="string"))return!1;return!0}_runCommand(e,t){let i,s;return typeof t=="string"?i=t:(i=t.command,s=t.args),s===void 0?e.executeCommand(i):Array.isArray(s)?e.executeCommand(i,...s):e.executeCommand(i,s)}}S(mM);F.from({scheme:ue.vscodeUserData,path:"/User/keybindings.json"});let Sm=class extends dm{constructor(e,t,i,s,o,r,n,d,l,h,p,g,f){super(i,s,o,r,n,d,l,h,p,g,f),this.shouldUseGlobalKeybindings=e,this._lockKeyCodesOverride=t,this.keybindingProviders=[],this.authorizedContainers=[]}registerKeybindingProvider(e){this.keybindingProviders.push(e),this.updateResolver();const t=new B;return t.add(e.onDidChangeKeybindings(()=>{this.updateResolver()})),t.add(pe(()=>{const i=this.keybindingProviders.indexOf(e);i>=0&&(this.keybindingProviders.splice(i,1),this.updateResolver())})),t}_getResolver(){return super._getResolver()}registerContainer(e){const t=new B;return t.add(super.registerContainer(e)),this.authorizedContainers.push(e),t.add(pe(()=>{this.authorizedContainers=this.authorizedContainers.filter(i=>i!=e)})),t}_dispatch(e,t){return!this.shouldUseGlobalKeybindings()&&this.authorizedContainers.every(i=>!i.contains(e.target))?!1:super._dispatch(e,t)}getUserKeybindingItems(){return[...super.getUserKeybindingItems(),...this.keybindingProviders.flatMap(e=>e.provideKeybindings())]}lockKeyCodes(e){this._lockKeyCodesOverride(e,t=>super.lockKeyCodes(t))}};Sm=D([u(2,de),u(3,ke),u(4,nt),u(5,Qe),u(6,Nb),u(7,Rt),u(8,si),u(9,Ve),u(10,Kn),u(11,et),u(12,el)],Sm);function MF({shouldUseGlobalKeybindings:a=()=>!1,lockKeyCodesOverride:e=(t,i)=>{i(t)}}={}){return{...HT(),[ot.toString()]:new he(Sm,[a,e],!1),[el.toString()]:new he(hm,[],!0),[ke.toString()]:new he(um,[],!0)}}function yI(a){return`${a}.hidden`}let Em=class extends M{constructor(e,t,i,s){super(),this.viewContainerName=t,this.storageService=i,this._onDidChangeStoredState=this._register(new A),this.onDidChangeStoredState=this._onDidChangeStoredState.event,this.logger=new Tp(()=>s.createLogger(Kb,{name:Hb,group:Ub})),this.globalViewsStateStorageId=yI(e),this.workspaceViewsStateStorageId=e,this._register(this.storageService.onDidChangeValue(ee.PROFILE,this.globalViewsStateStorageId,this._store)(()=>this.onDidStorageChange())),this.state=this.initialize()}set(e,t){this.state.set(e,t)}get(e){return this.state.get(e)}updateState(e){this.updateWorkspaceState(e),this.updateGlobalState(e)}updateWorkspaceState(e){const t=this.getStoredWorkspaceState();for(const i of e){const s=this.get(i.id);s&&(t[i.id]={collapsed:!!s.collapsed,isHidden:!s.visibleWorkspace,size:s.size,order:i.workspace&&s?s.order:void 0})}Object.keys(t).length>0?this.storageService.store(this.workspaceViewsStateStorageId,JSON.stringify(t),ee.WORKSPACE,Ze.MACHINE):this.storageService.remove(this.workspaceViewsStateStorageId,ee.WORKSPACE)}updateGlobalState(e){const t=this.getStoredGlobalState();for(const i of e){const s=this.get(i.id);t.set(i.id,{id:i.id,isHidden:s&&i.canToggleVisibility?!s.visibleGlobal:!1,order:!i.workspace&&s?s.order:void 0})}this.setStoredGlobalState(t)}onDidStorageChange(){if(this.globalViewsStatesValue!==this.getStoredGlobalViewsStatesValue()){this._globalViewsStatesValue=void 0;const e=this.getStoredGlobalState(),t=this.getStoredWorkspaceState(),i=[];for(const[s,o]of e){const r=this.get(s);if(r)r.visibleGlobal!==!o.isHidden&&(o.isHidden||this.logger.value.trace(`View visibility state changed: ${s} is now visible`,this.viewContainerName),i.push({id:s,visible:!o.isHidden}));else{const n=t[s];this.set(s,{active:!1,visibleGlobal:!o.isHidden,visibleWorkspace:Mr(n?.isHidden)?void 0:!n?.isHidden,collapsed:n?.collapsed,order:n?.order,size:n?.size})}}if(i.length){this._onDidChangeStoredState.fire(i);for(const s of i){const o=this.get(s.id);o&&(o.visibleGlobal=s.visible)}}}}initialize(){const e=new Map,t=this.getStoredWorkspaceState();for(const n of Object.keys(t)){const d=t[n];e.set(n,{active:!1,visibleGlobal:void 0,visibleWorkspace:Mr(d.isHidden)?void 0:!d.isHidden,collapsed:d.collapsed,order:d.order,size:d.size})}const i=this.storageService.get(this.globalViewsStateStorageId,ee.WORKSPACE,"[]"),{state:s}=this.parseStoredGlobalState(i);if(s.size>0){for(const{id:n,isHidden:d}of s.values()){const l=e.get(n);l?Mr(l.visibleWorkspace)&&(l.visibleWorkspace=!d):e.set(n,{active:!1,collapsed:void 0,visibleGlobal:void 0,visibleWorkspace:!d})}this.storageService.remove(this.globalViewsStateStorageId,ee.WORKSPACE)}const{state:o,hasDuplicates:r}=this.parseStoredGlobalState(this.globalViewsStatesValue);r&&this.setStoredGlobalState(o);for(const{id:n,isHidden:d,order:l}of o.values()){const h=e.get(n);h?(h.visibleGlobal=!d,Mr(l)||(h.order=l)):e.set(n,{active:!1,visibleGlobal:!d,order:l,collapsed:void 0,visibleWorkspace:void 0})}return e}getStoredWorkspaceState(){return JSON.parse(this.storageService.get(this.workspaceViewsStateStorageId,ee.WORKSPACE,"{}"))}getStoredGlobalState(){return this.parseStoredGlobalState(this.globalViewsStatesValue).state}setStoredGlobalState(e){this.globalViewsStatesValue=JSON.stringify([...e.values()])}parseStoredGlobalState(e){const t=JSON.parse(e);let i=!1;return{state:t.reduce((o,r)=>(typeof r=="string"?(i=i||o.has(r),o.set(r,{id:r,isHidden:!0})):(i=i||o.has(r.id),o.set(r.id,r)),o),new Map),hasDuplicates:i}}get globalViewsStatesValue(){return this._globalViewsStatesValue||(this._globalViewsStatesValue=this.getStoredGlobalViewsStatesValue()),this._globalViewsStatesValue}set globalViewsStatesValue(e){this.globalViewsStatesValue!==e&&(this._globalViewsStatesValue=e,this.setStoredGlobalViewsStatesValue(e))}getStoredGlobalViewsStatesValue(){return this.storageService.get(this.globalViewsStateStorageId,ee.PROFILE,"[]")}setStoredGlobalViewsStatesValue(e){this.storageService.store(this.globalViewsStateStorageId,e,ee.PROFILE,Ze.USER)}};Em=D([u(2,ge),u(3,zb)],Em);let _m=class extends M{get title(){return this._title}get icon(){return this._icon}get keybindingId(){return this._keybindingId}get allViewDescriptors(){return this.viewDescriptorItems.map(e=>e.viewDescriptor)}get activeViewDescriptors(){return this.viewDescriptorItems.filter(e=>e.state.active).map(e=>e.viewDescriptor)}get visibleViewDescriptors(){return this.viewDescriptorItems.filter(e=>this.isViewDescriptorVisible(e)).map(e=>e.viewDescriptor)}constructor(e,t,i,s){if(super(),this.viewContainer=e,this.contextKeyService=i,this.contextKeys=new cy,this.viewDescriptorItems=[],this._onDidChangeContainerInfo=this._register(new A),this.onDidChangeContainerInfo=this._onDidChangeContainerInfo.event,this._onDidChangeAllViewDescriptors=this._register(new A),this.onDidChangeAllViewDescriptors=this._onDidChangeAllViewDescriptors.event,this._onDidChangeActiveViewDescriptors=this._register(new A),this.onDidChangeActiveViewDescriptors=this._onDidChangeActiveViewDescriptors.event,this._onDidAddVisibleViewDescriptors=this._register(new A),this.onDidAddVisibleViewDescriptors=this._onDidAddVisibleViewDescriptors.event,this._onDidRemoveVisibleViewDescriptors=this._register(new A),this.onDidRemoveVisibleViewDescriptors=this._onDidRemoveVisibleViewDescriptors.event,this._onDidMoveVisibleViewDescriptors=this._register(new A),this.onDidMoveVisibleViewDescriptors=this._onDidMoveVisibleViewDescriptors.event,this._onDidChangeEnablement=this._register(new A),this.onDidChangeEnablement=this._onDidChangeEnablement.event,e.when){const o=new cy;for(const r of e.when.keys())o.add(r);this._register(K.filter(i.onDidChangeContext,r=>r.affectsSome(o))(()=>this._onDidChangeEnablement.fire()))}this.logger=new Tp(()=>s.createLogger(Kb,{name:Hb,group:Ub})),this._register(K.filter(i.onDidChangeContext,o=>o.affectsSome(this.contextKeys))(()=>this.onDidChangeContext())),this.viewDescriptorsState=this._register(t.createInstance(Em,e.storageId||`${e.id}.state`,typeof e.title=="string"?e.title:e.title.original)),this._register(this.viewDescriptorsState.onDidChangeStoredState(o=>this.updateVisibility(o))),this.updateContainerInfo()}updateContainerInfo(){const e=this.viewContainer.alwaysUseContainerInfo||this.visibleViewDescriptors.length===0||this.visibleViewDescriptors.some(d=>se.as(qt.ViewsRegistry).getViewContainer(d.id)===this.viewContainer),t=e?typeof this.viewContainer.title=="string"?this.viewContainer.title:this.viewContainer.title.value:this.visibleViewDescriptors[0]?.containerTitle||this.visibleViewDescriptors[0]?.name?.value||"";let i=!1;this._title!==t&&(this._title=t,i=!0);const s=e?this.viewContainer.icon:this.visibleViewDescriptors[0]?.containerIcon||rE;let o=!1;this.isEqualIcon(s)||(this._icon=s,o=!0);const r=this.viewContainer.openCommandActionDescriptor?.id??this.activeViewDescriptors.find(d=>d.openCommandActionDescriptor)?.openCommandActionDescriptor?.id;let n=!1;this._keybindingId!==r&&(this._keybindingId=r,n=!0),(i||o||n)&&this._onDidChangeContainerInfo.fire({title:i,icon:o,keybindingId:n})}isEqualIcon(e){return F.isUri(e)?F.isUri(this._icon)&&qe(e,this._icon):Se.isThemeIcon(e)?Se.isThemeIcon(this._icon)&&Se.isEqual(e,this._icon):e===this._icon}isVisible(e){const t=this.viewDescriptorItems.find(i=>i.viewDescriptor.id===e);if(!t)throw new Error(`Unknown view ${e}`);return this.isViewDescriptorVisible(t)}setVisible(e,t){this.updateVisibility([{id:e,visible:t}])}updateVisibility(e){const t=Mi(e.filter(({visible:o})=>!o).map(({id:o})=>this.findAndIgnoreIfNotFound(o))),i=[];for(const{viewDescriptorItem:o,visibleIndex:r}of t)this.updateViewDescriptorItemVisibility(o,!1)&&i.push({viewDescriptor:o.viewDescriptor,index:r});i.length&&this.broadCastRemovedVisibleViewDescriptors(i);const s=[];for(const{id:o,visible:r}of e){if(!r)continue;const n=this.findAndIgnoreIfNotFound(o);if(!n)continue;const{viewDescriptorItem:d,visibleIndex:l}=n;this.updateViewDescriptorItemVisibility(d,!0)&&s.push({index:l,viewDescriptor:d.viewDescriptor,size:d.state.size,collapsed:!!d.state.collapsed})}s.length&&this.broadCastAddedVisibleViewDescriptors(s)}updateViewDescriptorItemVisibility(e,t){return!e.viewDescriptor.canToggleVisibility||this.isViewDescriptorVisibleWhenActive(e)===t?!1:(e.viewDescriptor.workspace?e.state.visibleWorkspace=t:(e.state.visibleGlobal=t,t&&this.logger.value.trace(`Showing view ${e.viewDescriptor.id} in the container ${this.viewContainer.id}`)),this.isViewDescriptorVisible(e)===t)}isCollapsed(e){return!!this.find(e).viewDescriptorItem.state.collapsed}setCollapsed(e,t){const{viewDescriptorItem:i}=this.find(e);i.state.collapsed!==t&&(i.state.collapsed=t),this.viewDescriptorsState.updateState(this.allViewDescriptors)}getSize(e){return this.find(e).viewDescriptorItem.state.size}setSizes(e){for(const{id:t,size:i}of e){const{viewDescriptorItem:s}=this.find(t);s.state.size!==i&&(s.state.size=i)}this.viewDescriptorsState.updateState(this.allViewDescriptors)}move(e,t){const i=this.viewDescriptorItems.findIndex(n=>n.viewDescriptor.id===e),s=this.viewDescriptorItems.findIndex(n=>n.viewDescriptor.id===t),o=this.viewDescriptorItems[i],r=this.viewDescriptorItems[s];zT(this.viewDescriptorItems,i,s);for(let n=0;n<this.viewDescriptorItems.length;n++)this.viewDescriptorItems[n].state.order=n;this.broadCastMovedViewDescriptors({index:i,viewDescriptor:o.viewDescriptor},{index:s,viewDescriptor:r.viewDescriptor})}add(e){const t=[];for(const o of e){const r=o.viewDescriptor;if(r.when)for(const d of r.when.keys())this.contextKeys.add(d);let n=this.viewDescriptorsState.get(r.id);if(n){if(r.workspace)n.visibleWorkspace=io(o.visible)?io(n.visibleWorkspace)?!r.hideByDefault:n.visibleWorkspace:o.visible;else{const d=n.visibleGlobal;n.visibleGlobal=io(o.visible)?io(n.visibleGlobal)?!r.hideByDefault:n.visibleGlobal:o.visible,n.visibleGlobal&&!d&&this.logger.value.trace(`Added view ${r.id} in the container ${this.viewContainer.id} and showing it.`,`${d}`,`${r.hideByDefault}`,`${o.visible}`)}n.collapsed=io(o.collapsed)?io(n.collapsed)?!!r.collapsed:n.collapsed:o.collapsed}else n={active:!1,visibleGlobal:io(o.visible)?!r.hideByDefault:o.visible,visibleWorkspace:io(o.visible)?!r.hideByDefault:o.visible,collapsed:io(o.collapsed)?!!r.collapsed:o.collapsed};this.viewDescriptorsState.set(r.id,n),n.active=this.contextKeyService.contextMatchesRules(r.when),t.push({viewDescriptor:r,state:n})}this.viewDescriptorItems.push(...t),this.viewDescriptorItems.sort(this.compareViewDescriptors.bind(this)),this._onDidChangeAllViewDescriptors.fire({added:t.map(({viewDescriptor:o})=>o),removed:[]});const i=[];for(const o of t)o.state.active&&i.push({viewDescriptorItem:o,visible:this.isViewDescriptorVisible(o)});i.length&&this._onDidChangeActiveViewDescriptors.fire({added:i.map(({viewDescriptorItem:o})=>o.viewDescriptor),removed:[]});const s=[];for(const{viewDescriptorItem:o,visible:r}of i)if(r&&this.isViewDescriptorVisible(o)){const{visibleIndex:n}=this.find(o.viewDescriptor.id);s.push({index:n,viewDescriptor:o.viewDescriptor,size:o.state.size,collapsed:!!o.state.collapsed})}this.broadCastAddedVisibleViewDescriptors(s)}remove(e){const t=[],i=[],s=[],o=[];for(const r of e){if(r.when)for(const d of r.when.keys())this.contextKeys.delete(d);const n=this.viewDescriptorItems.findIndex(d=>d.viewDescriptor.id===r.id);if(n!==-1){t.push(r);const d=this.viewDescriptorItems[n];if(d.state.active&&s.push(d.viewDescriptor),this.isViewDescriptorVisible(d)){const{visibleIndex:l}=this.find(d.viewDescriptor.id);o.push({index:l,viewDescriptor:d.viewDescriptor})}i.push(d)}}i.forEach(r=>this.viewDescriptorItems.splice(this.viewDescriptorItems.indexOf(r),1)),this.broadCastRemovedVisibleViewDescriptors(o),s.length&&this._onDidChangeActiveViewDescriptors.fire({added:[],removed:s}),t.length&&this._onDidChangeAllViewDescriptors.fire({added:[],removed:t})}onDidChangeContext(){const e=[],t=[];for(const o of this.viewDescriptorItems){const r=o.state.active,n=this.contextKeyService.contextMatchesRules(o.viewDescriptor.when);r!==n&&(n?e.push({item:o,visibleWhenActive:this.isViewDescriptorVisibleWhenActive(o)}):t.push(o))}const i=[];for(const o of t)if(this.isViewDescriptorVisible(o)){const{visibleIndex:r}=this.find(o.viewDescriptor.id);i.push({index:r,viewDescriptor:o.viewDescriptor})}t.forEach(o=>o.state.active=!1),e.forEach(({item:o})=>o.state.active=!0),this.broadCastRemovedVisibleViewDescriptors(i),(e.length||t.length)&&this._onDidChangeActiveViewDescriptors.fire({added:e.map(({item:o})=>o.viewDescriptor),removed:t.map(o=>o.viewDescriptor)});const s=[];for(const{item:o,visibleWhenActive:r}of e)if(r&&this.isViewDescriptorVisible(o)){const{visibleIndex:n}=this.find(o.viewDescriptor.id);s.push({index:n,viewDescriptor:o.viewDescriptor,size:o.state.size,collapsed:!!o.state.collapsed})}this.broadCastAddedVisibleViewDescriptors(s)}broadCastAddedVisibleViewDescriptors(e){e.length&&(this._onDidAddVisibleViewDescriptors.fire(e.sort((t,i)=>t.index-i.index)),this.updateState(`Added views:${e.map(t=>t.viewDescriptor.id).join(",")} in ${this.viewContainer.id}`))}broadCastRemovedVisibleViewDescriptors(e){e.length&&(this._onDidRemoveVisibleViewDescriptors.fire(e.sort((t,i)=>i.index-t.index)),this.updateState(`Removed views:${e.map(t=>t.viewDescriptor.id).join(",")} from ${this.viewContainer.id}`))}broadCastMovedViewDescriptors(e,t){this._onDidMoveVisibleViewDescriptors.fire({from:e,to:t}),this.updateState(`Moved view ${e.viewDescriptor.id} to ${t.viewDescriptor.id} in ${this.viewContainer.id}`)}updateState(e){this.logger.value.trace(e),this.viewDescriptorsState.updateState(this.allViewDescriptors),this.updateContainerInfo()}isViewDescriptorVisible(e){return e.state.active?this.isViewDescriptorVisibleWhenActive(e):!1}isViewDescriptorVisibleWhenActive(e){return e.viewDescriptor.workspace?!!e.state.visibleWorkspace:!!e.state.visibleGlobal}find(e){const t=this.findAndIgnoreIfNotFound(e);if(t)return t;throw new Error(`view descriptor ${e} not found`)}findAndIgnoreIfNotFound(e){for(let t=0,i=0;t<this.viewDescriptorItems.length;t++){const s=this.viewDescriptorItems[t];if(s.viewDescriptor.id===e)return{index:t,visibleIndex:i,viewDescriptorItem:s};this.isViewDescriptorVisible(s)&&i++}}compareViewDescriptors(e,t){return e.viewDescriptor.id===t.viewDescriptor.id?0:this.getViewOrder(e)-this.getViewOrder(t)||this.getGroupOrderResult(e.viewDescriptor,t.viewDescriptor)}getViewOrder(e){const t=typeof e.state.order=="number"?e.state.order:e.viewDescriptor.order;return typeof t=="number"?t:Number.MAX_VALUE}getGroupOrderResult(e,t){return!e.group||!t.group||e.group===t.group?0:e.group<t.group?-1:1}};_m=D([u(1,z),u(2,de),u(3,zb)],_m);var xs;function IC(a){return`${a}.state`}var or;let Im=(or=class extends M{get viewContainers(){return this.viewContainersRegistry.all}constructor(e,t,i,s,o,r){super(),this.instantiationService=e,this.contextKeyService=t,this.storageService=i,this.extensionService=s,this.telemetryService=o,this._onDidChangeContainer=this._register(new A),this.onDidChangeContainer=this._onDidChangeContainer.event,this._onDidChangeLocation=this._register(new A),this.onDidChangeLocation=this._onDidChangeLocation.event,this._onDidChangeContainerLocation=this._register(new A),this.onDidChangeContainerLocation=this._onDidChangeContainerLocation.event,this.viewContainerModels=this._register(new Rn),this.viewsVisibilityActionDisposables=this._register(new Rn),this.canRegisterViewsVisibilityActions=!1,this._onDidChangeViewContainers=this._register(new A),this.onDidChangeViewContainers=this._onDidChangeViewContainers.event,this.logger=new Tp(()=>r.createLogger(Kb,{name:Hb,group:Ub})),this.activeViewContextKeys=new Map,this.movableViewContextKeys=new Map,this.defaultViewLocationContextKeys=new Map,this.defaultViewContainerLocationContextKeys=new Map,this.viewContainersRegistry=se.as(qt.ViewContainersRegistry),this.viewsRegistry=se.as(qt.ViewsRegistry),this.migrateToViewsCustomizationsStorage(),this.viewContainersCustomLocations=new Map(Object.entries(this.viewCustomizations.viewContainerLocations)),this.viewDescriptorsCustomLocations=new Map(Object.entries(this.viewCustomizations.viewLocations)),this.viewContainerBadgeEnablementStates=new Map(Object.entries(this.viewCustomizations.viewContainerBadgeEnablementStates)),this.viewContainers.forEach(n=>this.onDidRegisterViewContainer(n)),this._register(this.viewsRegistry.onViewsRegistered(n=>this.onDidRegisterViews(n))),this._register(this.viewsRegistry.onViewsDeregistered(({views:n,viewContainer:d})=>this.onDidDeregisterViews(n,d))),this._register(this.viewsRegistry.onDidChangeContainer(({views:n,from:d,to:l})=>this.onDidChangeDefaultContainer(n,d,l))),this._register(this.viewContainersRegistry.onDidRegister(({viewContainer:n})=>{this.onDidRegisterViewContainer(n),this._onDidChangeViewContainers.fire({added:[{container:n,location:this.getViewContainerLocation(n)}],removed:[]})})),this._register(this.viewContainersRegistry.onDidDeregister(({viewContainer:n,viewContainerLocation:d})=>{this.onDidDeregisterViewContainer(n),this._onDidChangeViewContainers.fire({removed:[{container:n,location:d}],added:[]})})),this._register(this.storageService.onDidChangeValue(ee.PROFILE,xs.VIEWS_CUSTOMIZATIONS,this._store)(()=>this.onDidStorageChange())),this.extensionService.whenInstalledExtensionsRegistered().then(()=>this.whenExtensionsRegistered())}migrateToViewsCustomizationsStorage(){if(this.storageService.get(xs.VIEWS_CUSTOMIZATIONS,ee.PROFILE))return;const e=this.storageService.get("views.cachedViewContainerLocations",ee.PROFILE),t=this.storageService.get("views.cachedViewPositions",ee.PROFILE);if(!e&&!t)return;const i=e?JSON.parse(e):[],s=t?JSON.parse(t):[],o={viewContainerLocations:i.reduce((r,[n,d])=>(r[n]=d,r),{}),viewLocations:s.reduce((r,[n,{containerId:d}])=>(r[n]=d,r),{}),viewContainerBadgeEnablementStates:{}};this.storageService.store(xs.VIEWS_CUSTOMIZATIONS,JSON.stringify(o),ee.PROFILE,Ze.USER),this.storageService.remove("views.cachedViewContainerLocations",ee.PROFILE),this.storageService.remove("views.cachedViewPositions",ee.PROFILE)}registerGroupedViews(e){for(const[t,i]of e.entries()){const s=this.viewContainersRegistry.get(t);if(!s||!this.viewContainerModels.has(s)){if(this.isGeneratedContainerId(t)){const r=this.viewContainersCustomLocations.get(t);r!==void 0&&this.registerGeneratedViewContainer(r,t)}continue}const o=i.filter(r=>this.getViewContainerModel(s).allViewDescriptors.filter(n=>n.id===r.id).length===0);this.addViews(s,o)}}deregisterGroupedViews(e){for(const[t,i]of e.entries()){const s=this.viewContainersRegistry.get(t);!s||!this.viewContainerModels.has(s)||this.removeViews(s,i)}}moveOrphanViewsToDefaultLocation(){for(const[e,t]of this.viewDescriptorsCustomLocations.entries()){if(this.viewContainersRegistry.get(t))continue;const i=this.viewsRegistry.getViewContainer(e),s=this.getViewDescriptorById(e);i&&s&&this.addViews(i,[s])}}whenExtensionsRegistered(){this.moveOrphanViewsToDefaultLocation();for(const e of[...this.viewContainersCustomLocations.keys()])this.cleanUpGeneratedViewContainer(e);this.saveViewCustomizations();for(const[e,t]of this.viewContainerModels)this.registerViewsVisibilityActions(e,t);this.canRegisterViewsVisibilityActions=!0}onDidRegisterViews(e){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(({views:t,viewContainer:i})=>{const s=this.regroupViews(i.id,t);this.registerGroupedViews(s),t.forEach(o=>this.getOrCreateMovableViewContextKey(o).set(!!o.canMoveView))})})}isGeneratedContainerId(e){return e.startsWith(xs.COMMON_CONTAINER_ID_PREFIX)}onDidDeregisterViews(e,t){const i=this.regroupViews(t.id,e);this.deregisterGroupedViews(i),this.contextKeyService.bufferChangeEvents(()=>{e.forEach(s=>this.getOrCreateMovableViewContextKey(s).set(!1))})}regroupViews(e,t){const i=new Map;for(const s of t){const o=this.viewDescriptorsCustomLocations.get(s.id)??e;let r=i.get(o);r||i.set(o,r=[]),r.push(s)}return i}getViewDescriptorById(e){return this.viewsRegistry.getView(e)}getViewLocationById(e){const t=this.getViewContainerByViewId(e);return t===null?null:this.getViewContainerLocation(t)}getViewContainerByViewId(e){const t=this.viewDescriptorsCustomLocations.get(e);return t?this.viewContainersRegistry.get(t)??null:this.getDefaultContainerById(e)}getViewContainerLocation(e){return this.viewContainersCustomLocations.get(e.id)??this.getDefaultViewContainerLocation(e)}getDefaultViewContainerLocation(e){return this.viewContainersRegistry.getViewContainerLocation(e)}getDefaultContainerById(e){return this.viewsRegistry.getViewContainer(e)??null}getViewContainerModel(e){return this.getOrRegisterViewContainerModel(e)}getViewContainerById(e){return this.viewContainersRegistry.get(e)||null}getViewContainersByLocation(e){return this.viewContainers.filter(t=>this.getViewContainerLocation(t)===e)}getDefaultViewContainer(e){return this.viewContainersRegistry.getDefaultViewContainer(e)}moveViewContainerToLocation(e,t,i,s){this.logger.value.trace(`moveViewContainerToLocation: viewContainer:${e.id} location:${t} reason:${s}`),this.moveViewContainerToLocationWithoutSaving(e,t,i),this.saveViewCustomizations()}getViewContainerBadgeEnablementState(e){return this.viewContainerBadgeEnablementStates.get(e)??!0}setViewContainerBadgeEnablementState(e,t){this.viewContainerBadgeEnablementStates.set(e,t),this.saveViewCustomizations()}moveViewToLocation(e,t,i){this.logger.value.trace(`moveViewToLocation: view:${e.id} location:${t} reason:${i}`);const s=this.registerGeneratedViewContainer(t);this.moveViewsToContainer([e],s)}moveViewsToContainer(e,t,i,s){if(!e.length)return;this.logger.value.trace(`moveViewsToContainer: views:${e.map(n=>n.id).join(",")} viewContainer:${t.id} reason:${s}`);const o=this.getViewContainerByViewId(e[0].id),r=t;o&&r&&o!==r&&(this.moveViewsWithoutSaving(e,o,r,i),this.cleanUpGeneratedViewContainer(o.id),this.saveViewCustomizations(),this.reportMovedViews(e,o,r))}reset(){for(const e of this.viewContainers){const t=this.getViewContainerModel(e);for(const o of t.allViewDescriptors){const r=this.getDefaultContainerById(o.id),n=this.getViewContainerByViewId(o.id);n&&r&&n!==r&&this.moveViewsWithoutSaving([o],n,r)}const i=this.getDefaultViewContainerLocation(e),s=this.getViewContainerLocation(e);i!==null&&s!==i&&this.moveViewContainerToLocationWithoutSaving(e,i),this.cleanUpGeneratedViewContainer(e.id)}this.viewContainersCustomLocations.clear(),this.viewDescriptorsCustomLocations.clear(),this.saveViewCustomizations()}isViewContainerRemovedPermanently(e){return this.isGeneratedContainerId(e)&&!this.viewContainersCustomLocations.has(e)}onDidChangeDefaultContainer(e,t,i){const s=e.filter(o=>!this.viewDescriptorsCustomLocations.has(o.id)||!this.viewContainers.includes(t)&&this.viewDescriptorsCustomLocations.get(o.id)===t.id);s.length&&this.moveViewsWithoutSaving(s,t,i)}reportMovedViews(e,t,i){const s=g=>g.id.startsWith(xs.COMMON_CONTAINER_ID_PREFIX)?"custom":g.extensionId?"extension":g.id,o=this.getViewContainerLocation(t),r=this.getViewContainerLocation(i),n=e.length,d=s(t),l=s(i),h=o===ce.Panel?"panel":"sidebar",p=r===ce.Panel?"panel":"sidebar";this.telemetryService.publicLog2("viewDescriptorService.moveViews",{viewCount:n,fromContainer:d,toContainer:l,fromLocation:h,toLocation:p})}moveViewsWithoutSaving(e,t,i,s=Dd.Expand){this.removeViews(t,e),this.addViews(i,e,s);const o=this.getViewContainerLocation(t),r=this.getViewContainerLocation(i);o!==r&&this._onDidChangeLocation.fire({views:e,from:o,to:r}),this._onDidChangeContainer.fire({views:e,from:t,to:i})}moveViewContainerToLocationWithoutSaving(e,t,i){const s=this.getViewContainerLocation(e),o=t;if(s!==o){const r=this.isGeneratedContainerId(e.id),n=o===this.getDefaultViewContainerLocation(e);r||!n?this.viewContainersCustomLocations.set(e.id,o):this.viewContainersCustomLocations.delete(e.id),this.getOrCreateDefaultViewContainerLocationContextKey(e).set(r||n),e.requestedIndex=i,this._onDidChangeContainerLocation.fire({viewContainer:e,from:s,to:o});const d=this.getViewsByContainer(e);this._onDidChangeLocation.fire({views:d,from:s,to:o})}}cleanUpGeneratedViewContainer(e){if(!this.isGeneratedContainerId(e))return;const t=this.getViewContainerById(e);t&&this.getViewContainerModel(t)?.allViewDescriptors.length||[...this.viewDescriptorsCustomLocations.values()].includes(e)||(t&&this.viewContainersRegistry.deregisterViewContainer(t),this.viewContainersCustomLocations.delete(e),this.viewContainerBadgeEnablementStates.delete(e),this.storageService.remove(yI(t?.storageId||IC(e)),ee.PROFILE))}registerGeneratedViewContainer(e,t){const i=t||this.generateContainerId(e),s=this.viewContainersRegistry.registerViewContainer({id:i,ctorDescriptor:new he(tl,[i,{mergeViewWithContainerWhenSingleView:!0}]),title:{value:c(14611,"User View Container"),original:"User View Container"},icon:e===ce.Sidebar?rE:void 0,storageId:IC(i),hideIfEmpty:!0},e,{doNotRegisterOpenCommand:!0});return this.viewContainersCustomLocations.get(s.id)!==e&&this.viewContainersCustomLocations.set(s.id,e),this.getOrCreateDefaultViewContainerLocationContextKey(s).set(!0),s}onDidStorageChange(){JSON.stringify(this.viewCustomizations)!==this.getStoredViewCustomizationsValue()&&this.onDidViewCustomizationsStorageChange()}onDidViewCustomizationsStorageChange(){this._viewCustomizations=void 0;const e=new Map(Object.entries(this.viewCustomizations.viewContainerLocations)),t=new Map(Object.entries(this.viewCustomizations.viewLocations)),i=[],s=[];for(const[o,r]of e.entries()){const n=this.getViewContainerById(o);n?r!==this.getViewContainerLocation(n)&&i.push([n,r]):this.isGeneratedContainerId(o)&&this.registerGeneratedViewContainer(r,o)}for(const o of this.viewContainers)if(!e.has(o.id)){const r=this.getViewContainerLocation(o),n=this.getDefaultViewContainerLocation(o);r!==n&&i.push([o,n])}for(const[o,r]of t.entries()){const n=this.getViewDescriptorById(o);if(n){const d=this.getViewContainerByViewId(o),l=this.viewContainersRegistry.get(r);d&&l&&l!==d&&s.push({views:[n],from:d,to:l})}}for(const o of this.viewContainers){const r=this.getViewContainerModel(o);for(const n of r.allViewDescriptors)if(!t.has(n.id)){const d=this.getViewContainerByViewId(n.id),l=this.getDefaultContainerById(n.id);d&&l&&d!==l&&s.push({views:[n],from:d,to:l})}}for(const[o,r]of i)this.moveViewContainerToLocationWithoutSaving(o,r);for(const{views:o,from:r,to:n}of s)this.moveViewsWithoutSaving(o,r,n,Dd.Default);this.viewContainersCustomLocations=e,this.viewDescriptorsCustomLocations=t}generateContainerId(e){return`${xs.COMMON_CONTAINER_ID_PREFIX}.${$T(e)}.${fd()}`}saveViewCustomizations(){const e={viewContainerLocations:{},viewLocations:{},viewContainerBadgeEnablementStates:{}};for(const[t,i]of this.viewContainersCustomLocations){const s=this.getViewContainerById(t);s&&!this.isGeneratedContainerId(t)&&i===this.getDefaultViewContainerLocation(s)||(e.viewContainerLocations[t]=i)}for(const[t,i]of this.viewDescriptorsCustomLocations){const s=this.getViewContainerById(i);s&&this.getDefaultContainerById(t)?.id===s.id||(e.viewLocations[t]=i)}for(const[t,i]of this.viewContainerBadgeEnablementStates)i===!1&&(e.viewContainerBadgeEnablementStates[t]=i);this.viewCustomizations=e}get viewCustomizations(){return this._viewCustomizations||(this._viewCustomizations=JSON.parse(this.getStoredViewCustomizationsValue()),this._viewCustomizations.viewContainerLocations=this._viewCustomizations.viewContainerLocations??{},this._viewCustomizations.viewLocations=this._viewCustomizations.viewLocations??{},this._viewCustomizations.viewContainerBadgeEnablementStates=this._viewCustomizations.viewContainerBadgeEnablementStates??{}),this._viewCustomizations}set viewCustomizations(e){const t=JSON.stringify(e);JSON.stringify(this.viewCustomizations)!==t&&(this._viewCustomizations=e,this.setStoredViewCustomizationsValue(t))}getStoredViewCustomizationsValue(){return this.storageService.get(xs.VIEWS_CUSTOMIZATIONS,ee.PROFILE,"{}")}setStoredViewCustomizationsValue(e){this.storageService.store(xs.VIEWS_CUSTOMIZATIONS,e,ee.PROFILE,Ze.USER)}getViewsByContainer(e){const t=this.viewsRegistry.getViews(e).filter(i=>(this.viewDescriptorsCustomLocations.get(i.id)??e.id)===e.id);for(const[i,s]of this.viewDescriptorsCustomLocations.entries()){if(s!==e.id||this.viewsRegistry.getViewContainer(i)===e)continue;const o=this.getViewDescriptorById(i);o&&t.push(o)}return t}onDidRegisterViewContainer(e){const t=this.isGeneratedContainerId(e.id)?!0:this.getViewContainerLocation(e)===this.getDefaultViewContainerLocation(e);this.getOrCreateDefaultViewContainerLocationContextKey(e).set(t),this.getOrRegisterViewContainerModel(e)}getOrRegisterViewContainerModel(e){let t=this.viewContainerModels.get(e)?.viewContainerModel;if(!t){const i=new B;t=i.add(this.instantiationService.createInstance(_m,e)),this.onDidChangeActiveViews({added:t.activeViewDescriptors,removed:[]}),t.onDidChangeActiveViewDescriptors(r=>this.onDidChangeActiveViews(r),this,i),this.onDidChangeVisibleViews({added:[...t.visibleViewDescriptors],removed:[]}),t.onDidAddVisibleViewDescriptors(r=>this.onDidChangeVisibleViews({added:r.map(({viewDescriptor:n})=>n),removed:[]}),this,i),t.onDidRemoveVisibleViewDescriptors(r=>this.onDidChangeVisibleViews({added:[],removed:r.map(({viewDescriptor:n})=>n)}),this,i),i.add(pe(()=>this.viewsVisibilityActionDisposables.deleteAndDispose(e))),i.add(this.registerResetViewContainerAction(e));const s={viewContainerModel:t,disposables:i,dispose:()=>i.dispose()};this.viewContainerModels.set(e,s),this.onDidRegisterViews([{views:this.viewsRegistry.getViews(e),viewContainer:e}]);const o=this.getViewsByContainer(e).filter(r=>this.getDefaultContainerById(r.id)!==e);o.length&&(this.addViews(e,o),this.contextKeyService.bufferChangeEvents(()=>{o.forEach(r=>this.getOrCreateMovableViewContextKey(r).set(!!r.canMoveView))})),this.canRegisterViewsVisibilityActions&&this.registerViewsVisibilityActions(e,s)}return t}onDidDeregisterViewContainer(e){this.viewContainerModels.deleteAndDispose(e),this.viewsVisibilityActionDisposables.deleteAndDispose(e)}onDidChangeActiveViews({added:e,removed:t}){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(i=>this.getOrCreateActiveViewContextKey(i).set(!0)),t.forEach(i=>this.getOrCreateActiveViewContextKey(i).set(!1))})}onDidChangeVisibleViews({added:e,removed:t}){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(i=>this.getOrCreateVisibleViewContextKey(i).set(!0)),t.forEach(i=>this.getOrCreateVisibleViewContextKey(i).set(!1))})}registerViewsVisibilityActions(e,{viewContainerModel:t,disposables:i}){this.viewsVisibilityActionDisposables.deleteAndDispose(e),this.viewsVisibilityActionDisposables.set(e,this.registerViewsVisibilityActionsForContainer(t)),i.add(K.any(t.onDidChangeActiveViewDescriptors,t.onDidAddVisibleViewDescriptors,t.onDidRemoveVisibleViewDescriptors,t.onDidMoveVisibleViewDescriptors)(s=>{this.viewsVisibilityActionDisposables.deleteAndDispose(e),this.viewsVisibilityActionDisposables.set(e,this.registerViewsVisibilityActionsForContainer(t))}))}registerViewsVisibilityActionsForContainer(e){const t=new B;return e.activeViewDescriptors.forEach((i,s)=>{i.remoteAuthority||(t.add(S(class extends ly{constructor(){super({id:`${i.id}.toggleVisibility`,viewPaneContainerId:e.viewContainer.id,precondition:i.canToggleVisibility&&(!e.isVisible(i.id)||e.visibleViewDescriptors.length>1)?I.true():I.false(),toggled:I.has(`${i.id}.visible`),title:i.name,metadata:{description:y(14612,"Toggles the visibility of the {0} view if the view container it is located in is visible",i.name.value)},menu:[{id:hb,when:I.equals("viewContainer",e.viewContainer.id),order:s},{id:b.ViewContainerTitleContext,when:I.equals("viewContainer",e.viewContainer.id),order:s,group:"1_toggleVisibility"},{id:b.ViewTitleContext,when:I.or(...e.visibleViewDescriptors.map(o=>I.equals("view",o.id))),order:s,group:"2_toggleVisibility"}]})}async runInViewPaneContainer(o,r){r.toggleViewVisibility(i.id)}})),t.add(S(class extends ly{constructor(){super({id:`${i.id}.removeView`,viewPaneContainerId:e.viewContainer.id,title:c(14613,"Hide '{0}'",i.name.value),metadata:{description:y(14614,"Hides the {0} view if it is visible and the view container it is located in is visible",i.name.value)},precondition:i.canToggleVisibility&&(!e.isVisible(i.id)||e.visibleViewDescriptors.length>1)?I.true():I.false(),menu:[{id:b.ViewTitleContext,when:I.and(I.equals("view",i.id),I.has(`${i.id}.visible`)),group:"1_hide",order:1}]})}async runInViewPaneContainer(o,r){r.getView(i.id)?.isVisible()&&r.toggleViewVisibility(i.id)}})))}),t}registerResetViewContainerAction(e){const t=this;return S(class extends R{constructor(){super({id:`${e.id}.resetViewContainerLocation`,title:y(14615,"Reset Location"),menu:[{id:b.ViewContainerTitleContext,group:"1_viewActions",when:I.or(I.and(I.equals("viewContainer",e.id),I.equals(`${e.id}.defaultViewContainerLocation`,!1)))}]})}run(s){t.moveViewContainerToLocation(e,t.getDefaultViewContainerLocation(e),void 0,this.desc.id),s.get(jt).openViewContainer(e.id,!0)}})}addViews(e,t,i=Dd.Default){this.contextKeyService.bufferChangeEvents(()=>{t.forEach(s=>{const o=this.getDefaultContainerById(s.id)===e;this.getOrCreateDefaultViewLocationContextKey(s).set(o),o?this.viewDescriptorsCustomLocations.delete(s.id):this.viewDescriptorsCustomLocations.set(s.id,e.id)})}),this.getViewContainerModel(e).add(t.map(s=>({viewDescriptor:s,collapsed:i===Dd.Default?void 0:!1,visible:i===Dd.Default?void 0:!0})))}removeViews(e,t){this.contextKeyService.bufferChangeEvents(()=>{t.forEach(i=>{this.viewDescriptorsCustomLocations.get(i.id)===e.id&&this.viewDescriptorsCustomLocations.delete(i.id),this.getOrCreateDefaultViewLocationContextKey(i).set(!1)})}),this.getViewContainerModel(e).remove(t)}getOrCreateActiveViewContextKey(e){const t=`${e.id}.active`;let i=this.activeViewContextKeys.get(t);return i||(i=new oe(t,!1).bindTo(this.contextKeyService),this.activeViewContextKeys.set(t,i)),i}getOrCreateVisibleViewContextKey(e){const t=`${e.id}.visible`;let i=this.activeViewContextKeys.get(t);return i||(i=new oe(t,!1).bindTo(this.contextKeyService),this.activeViewContextKeys.set(t,i)),i}getOrCreateMovableViewContextKey(e){const t=`${e.id}.canMove`;let i=this.movableViewContextKeys.get(t);return i||(i=new oe(t,!1).bindTo(this.contextKeyService),this.movableViewContextKeys.set(t,i)),i}getOrCreateDefaultViewLocationContextKey(e){const t=`${e.id}.defaultViewLocation`;let i=this.defaultViewLocationContextKeys.get(t);return i||(i=new oe(t,!1).bindTo(this.contextKeyService),this.defaultViewLocationContextKeys.set(t,i)),i}getOrCreateDefaultViewContainerLocationContextKey(e){const t=`${e.id}.defaultViewContainerLocation`;let i=this.defaultViewContainerLocationContextKeys.get(t);return i||(i=new oe(t,!1).bindTo(this.contextKeyService),this.defaultViewContainerLocationContextKeys.set(t,i)),i}},xs=or,or.VIEWS_CUSTOMIZATIONS="views.customizations",or.COMMON_CONTAINER_ID_PREFIX="workbench.views.service",or);Im=xs=D([u(0,z),u(1,de),u(2,ge),u(3,si),u(4,nt),u(5,zb)],Im);var lo,vo;let Dm=(vo=class extends M{constructor(e,t,i,s,o,r,n,d){super(),this.editorGroupService=e,this.instantiationService=t,this.configurationService=i,this.quickInputService=s,this.notificationService=o,this.storageService=r,this.extensionService=n,this.logService=d,this._onDidChangeEditorRegistrations=this._register(new qg),this.onDidChangeEditorRegistrations=this._onDidChangeEditorRegistrations.event,this._editors=new Map,this._flattenedEditors=new Map,this._shouldReFlattenEditors=!0,this.cache=new Set(JSON.parse(this.storageService.get(lo.cacheStorageID,ee.PROFILE,JSON.stringify([])))),this.storageService.remove(lo.cacheStorageID,ee.PROFILE),this._register(this.storageService.onWillSaveState(()=>{this.cacheEditors()})),this._register(this.extensionService.onDidRegisterExtensions(()=>{this.cache=void 0}))}resolveUntypedInputAndGroup(e,t){const i=e,s=this.instantiationService.invokeFunction(D_,i,t);if(s instanceof Promise)return s.then(([o,r])=>[i,o,r]);{const[o,r]=s;return[i,o,r]}}async resolveEditor(e,t){if(this._flattenedEditors=this._flattenEditorsMap(),hy(e))return this.doResolveSideBySideEditor(e,t);let i;const s=this.resolveUntypedInputAndGroup(e,t);if(s instanceof Promise?i=await s:i=s,!i)return ai.NONE;const[o,r,n]=i;n&&(o.options={...o.options,activation:n});let d=Ue.getCanonicalUri(o,{supportSideBySide:Le.PRIMARY});if(this.cache&&d&&this.resourceMatchesCache(d)&&await this.extensionService.whenInstalledExtensionsRegistered(),d===void 0)d=F.from({scheme:ue.untitled});else if(d.scheme===void 0||d===null)return ai.NONE;if(o.options?.override===Ca.PICK){const g=await this.doPickEditor(o);if(!g)return ai.ABORT;o.options=g}let{editor:l,conflictingDefault:h}=this.getEditor(d,o.options?.override);if(!l&&(o.options?.override||nE(e)))return ai.NONE;if(!l){const g=this.getEditor(d,Mt.id);if(l=g?.editor,h=g?.conflictingDefault,!l)return ai.NONE}if(cg(o)&&o.options?.override===void 0){let g=Ue.getCanonicalUri(o,{supportSideBySide:Le.SECONDARY});g||(g=F.from({scheme:ue.untitled}));const{editor:f}=this.getEditor(g,void 0);if(!f||l.editorInfo.id!==f.editorInfo.id){const{editor:m,conflictingDefault:v}=this.getEditor(d,Mt.id);l=m,h=v}if(!l)return ai.NONE}if(o.options={override:l.editorInfo.id,...o.options},l.editorFactoryObject.createDiffEditorInput===void 0&&cg(o))return ai.NONE;const p=await this.doResolveEditor(o,r,l);return h&&p&&await this.doHandleConflictingDefaults(d,l.editorInfo.label,o,p.editor,r),p?(p.editor.editorId!==l.editorInfo.id&&this.logService.warn(`Editor ID Mismatch: ${p.editor.editorId} !== ${l.editorInfo.id}. This will cause bugs. Please ensure editorInput.editorId matches the registered id`),{...p,group:r}):ai.ABORT}async doResolveSideBySideEditor(e,t){const i=await this.resolveEditor(e.primary,t);if(!Hg(i))return ai.NONE;const s=await this.resolveEditor(e.secondary,i.group??t);return Hg(s)?{group:i.group??s.group,editor:this.instantiationService.createInstance(Zt,e.label,e.description,s.editor,i.editor),options:e.options}:ai.NONE}bufferChangeEvents(e){this._onDidChangeEditorRegistrations.pause();try{e()}finally{this._onDidChangeEditorRegistrations.resume()}}registerEditor(e,t,i,s){let o=this._editors.get(e);o===void 0&&(o=new Map,this._editors.set(e,o));let r=o.get(t.id);r===void 0&&(r=[]);const n=FS(r,{globPattern:e,editorInfo:t,options:i,editorFactoryObject:s});return o.set(t.id,r),this._shouldReFlattenEditors=!0,this._onDidChangeEditorRegistrations.fire(),pe(()=>{n(),r&&r.length===0&&o?.delete(t.id),this._shouldReFlattenEditors=!0,this._onDidChangeEditorRegistrations.fire()})}getAssociationsForResource(e){let i=this.getAllUserAssociations().filter(o=>o.filenamePattern&&Al(o.filenamePattern,e));i=i.sort((o,r)=>(r.filenamePattern?.length??0)-(o.filenamePattern?.length??0));const s=this._registeredEditors;return i.filter(o=>s.find(r=>r.editorInfo.id===o.viewType))}getAllUserAssociations(){const e=this.configurationService.inspect(uy)||{},t=e.defaultValue??{},i=e.workspaceValue??{},s=e.userValue??{},o={...i};for(const[n,d]of Object.entries({...t,...s}))o[n]===void 0&&(o[n]=d);const r=[];for(const[n,d]of Object.entries(o)){const l={filenamePattern:n,viewType:d};r.push(l)}return r}_flattenEditorsMap(){if(!this._shouldReFlattenEditors)return this._flattenedEditors;this._shouldReFlattenEditors=!1;const e=new Map;for(const[t,i]of this._editors){const s=[];for(const o of i.values()){let r;for(const n of o)r||(r={editorInfo:n.editorInfo,globPattern:n.globPattern,options:{},editorFactoryObject:{}}),r.options={...r.options,...n.options},r.editorFactoryObject={...r.editorFactoryObject,...n.editorFactoryObject};r&&s.push(r)}e.set(t,s)}return e}get _registeredEditors(){return Array.from(this._flattenedEditors.values()).flat()}updateUserAssociations(e,t){const i={viewType:t,filenamePattern:e},s=this.getAllUserAssociations(),o=Object.create(null);for(const r of[...s,i])r.filenamePattern&&(o[r.filenamePattern]=r.viewType);this.configurationService.updateValue(uy,o)}findMatchingEditors(e){const t=this.getAssociationsForResource(e),i=[];for(const[s,o]of this._flattenedEditors)for(const r of o)(t.find(d=>d.viewType===r.editorInfo.id)&&r.editorInfo.priority!==rt.exclusive||Al(s,e))&&i.push(r);return i.sort((s,o)=>zi(o.editorInfo.priority)===zi(s.editorInfo.priority)&&typeof o.globPattern=="string"&&typeof s.globPattern=="string"?o.globPattern.length-s.globPattern.length:zi(o.editorInfo.priority)-zi(s.editorInfo.priority))}getEditors(e){if(this._flattenedEditors=this._flattenEditorsMap(),F.isUri(e)){const t=this.findMatchingEditors(e);return t.find(i=>i.editorInfo.priority===rt.exclusive)?[]:t.map(i=>i.editorInfo)}return Xo(this._registeredEditors.map(t=>t.editorInfo),t=>t.id)}getEditor(e,t){const i=(h,p)=>h.find(g=>g.options?.canSupportResource!==void 0?g.editorInfo.id===p&&g.options.canSupportResource(e):g.editorInfo.id===p);if(t&&t!==Ca.EXCLUSIVE_ONLY){const h=this._registeredEditors;return{editor:i(h,t),conflictingDefault:!1}}const s=this.findMatchingEditors(e),o=this.getAssociationsForResource(e),r=t===Ca.EXCLUSIVE_ONLY?rt.exclusive:rt.builtin;let n=s.filter(h=>zi(h.editorInfo.priority)>=zi(r)&&h.editorInfo.id!==Mt.id);if(n.length===0)return{editor:o[0]&&r!==rt.exclusive?i(s,o[0].viewType):void 0,conflictingDefault:!1};const d=n[0].editorInfo.priority===rt.exclusive?n[0].editorInfo.id:o[0]?.viewType||n.find(h=>!h.options?.canSupportResource||h.options.canSupportResource(e))?.editorInfo.id||n[0].editorInfo.id;let l=!1;return n=n.filter(h=>h.editorInfo.priority!==rt.exclusive).filter(h=>!h.options?.canSupportResource||h.options.canSupportResource(e)),o.length===0&&n.length>1&&(l=!0),{editor:i(s,d),conflictingDefault:l}}async doResolveEditor(e,t,i){let s=e.options;const o=Ue.getCanonicalUri(e,{supportSideBySide:Le.PRIMARY});if(s&&typeof s.activation>"u"&&(s={...s,activation:s.preserveFocus?ho.RESTORE:void 0}),qT(e)){if(!i.editorFactoryObject.createMergeEditorInput)return;const l=await i.editorFactoryObject.createMergeEditorInput(e,t);return{editor:l.editor,options:l.options??s}}if(cg(e)){if(!i.editorFactoryObject.createDiffEditorInput)return;const l=await i.editorFactoryObject.createDiffEditorInput(e,t);return{editor:l.editor,options:l.options??s}}if(jT(e)){if(!i.editorFactoryObject.createMultiDiffEditorInput)return;const l=await i.editorFactoryObject.createMultiDiffEditorInput(e,t);return{editor:l.editor,options:l.options??s}}if(hy(e))throw new Error("Untyped side by side editor input not supported here.");if(YT(e)){if(!i.editorFactoryObject.createUntitledEditorInput)return;const l=await i.editorFactoryObject.createUntitledEditorInput(e,t);return{editor:l.editor,options:l.options??s}}if(o===void 0)throw new Error("Undefined resource on non untitled editor input.");if(typeof i.options?.singlePerResource=="function"?i.options.singlePerResource():i.options?.singlePerResource){const l=this.findExistingEditorsForResource(o,i.editorInfo.id);if(l.length){const h=await this.moveExistingEditorForResource(l,t);return h?{editor:h,options:s}:void 0}}if(!i.editorFactoryObject.createEditorInput)return;const n=await i.editorFactoryObject.createEditorInput(e,t);return s=n.options??s,{editor:n.editor,options:s}}async moveExistingEditorForResource(e,t){const i=e[0];for(const{editor:s,group:o}of e)if(s!==i.editor&&!await o.closeEditor(s))return;if(!(t.id!==i.group.id&&!i.group.moveEditor(i.editor,t)))return i.editor}findExistingEditorsForResource(e,t){const i=[],s=Xo([...this.editorGroupService.groups]);for(const o of s)for(const r of o.editors)qe(r.resource,e)&&r.editorId===t&&i.push({editor:r,group:o});return i}async doHandleConflictingDefaults(e,t,i,s,o){const r=this.findMatchingEditors(e),n=JSON.parse(this.storageService.get(lo.conflictingDefaultsStorageID,ee.PROFILE,"{}")),d=`*${Yi(e)}`,l=()=>{n[d]=[],r.forEach(g=>n[d].push(g.editorInfo.id)),this.storageService.store(lo.conflictingDefaultsStorageID,JSON.stringify(n),ee.PROFILE,Ze.MACHINE)};if(n[d]?.find(g=>g===s.editorId))return;const p=this.notificationService.prompt(Te.Warning,c(13883,"There are multiple default editors available for the resource."),[{label:c(13884,"Configure Default"),run:async()=>{const g=await this.doPickEditor(i,!0);if(!g)return;i.options=g;const f=await this.resolveEditor(i,o);f===ai.ABORT||f===ai.NONE||o.replaceEditors([{editor:s,replacement:f.editor,options:f.options??g}])}},{label:c(13885,"Keep {0}",t),run:l}]).onDidClose(()=>{l(),p.dispose()})}mapEditorsToQuickPickEntry(e,t){const i=this.editorGroupService.activeGroup.findEditors(e).at(0);let s=e.scheme===ue.untitled?this._registeredEditors.filter(p=>p.editorInfo.priority!==rt.exclusive):this.findMatchingEditors(e);s=Xo(s,p=>p.editorInfo.id);const o=this.getAssociationsForResource(e)[0]?.viewType;s=s.sort((p,g)=>p.editorInfo.id===Mt.id?-1:g.editorInfo.id===Mt.id?1:zi(g.editorInfo.priority)-zi(p.editorInfo.priority));const r=[],n=c(13886,"Active"),d=c(13887,"Default"),l=c(13888,"Active and Default");let h=o;if(!h&&s.length>2&&s[1]?.editorInfo.priority!==rt.option&&(h=s[1]?.editorInfo.id),h||(h=Mt.id),s.forEach(p=>{const g=i?.editorId??Mt.id,f=i?p.editorInfo.id===g:!1,m=p.editorInfo.id===h,v={id:p.editorInfo.id,label:p.editorInfo.label,description:f&&m?l:f?n:m?d:void 0,detail:p.editorInfo.detail??p.editorInfo.priority};r.push(v)}),!t&&Yi(e)!==""){const p={type:"separator"};r.push(p);const g={id:lo.configureDefaultID,label:c(13889,"Configure default editor for '{0}'...",`*${Yi(e)}`)};r.push(g)}return r}async doPickEditor(e,t){let i=Ue.getOriginalUri(e,{supportSideBySide:Le.PRIMARY});i===void 0&&(i=F.from({scheme:ue.untitled}));const s=this.mapEditorsToQuickPickEntry(i,t),o=new B,r=o.add(this.quickInputService.createQuickPick({useSeparators:!0})),n=t?c(13890,"Select new default editor for '{0}'",`*${Yi(i)}`):c(13891,"Select editor for '{0}'",Dt(i));r.placeholder=n,r.canAcceptInBackground=!0,r.items=s;const d=r.items.find(h=>h.type==="item");d&&(r.selectedItems=[d]);const l=await new Promise(h=>{o.add(r.onDidAccept(p=>{let g;r.selectedItems.length===1&&(g={item:r.selectedItems[0],keyMods:r.keyMods,openInBackground:p.inBackground}),i&&t&&g?.item.id&&this.updateUserAssociations(`*${Yi(i)}`,g.item.id),h(g)})),o.add(r.onDidHide(()=>{o.dispose(),h(void 0)})),o.add(r.onDidTriggerItemButton(p=>{h({item:p.item,openInBackground:!1}),i&&p.item?.id&&this.updateUserAssociations(`*${Yi(i)}`,p.item.id)})),r.show()});if(r.dispose(),l)return l.item.id===lo.configureDefaultID?this.doPickEditor(e,!0):{...e.options,override:l.item.id,preserveFocus:l.openInBackground||e.options?.preserveFocus}}cacheEditors(){const e=new Set;for(const[i,s]of this._flattenedEditors)s.find(r=>r.editorInfo.priority!==rt.option&&r.editorInfo.id!==Mt.id)&&(XT(i)?e.add(`${i.pattern}`):e.add(i));const t=this.getAllUserAssociations();for(const i of t)i.filenamePattern&&e.add(i.filenamePattern);this.storageService.store(lo.cacheStorageID,JSON.stringify(Array.from(e)),ee.PROFILE,Ze.MACHINE)}resourceMatchesCache(e){if(!this.cache)return!1;for(const t of this.cache)if(Al(t,e))return!0;return!1}},lo=vo,vo.configureDefaultID="promptOpenWith.configureDefault",vo.cacheStorageID="editorOverrideService.cache",vo.conflictingDefaultsStorageID="editorOverrideService.conflictingDefaults",vo);Dm=lo=D([u(0,U),u(1,z),u(2,te),u(3,lt),u(4,Qe),u(5,ge),u(6,si),u(7,et)],Dm);var Am,ln;let Tm=(ln=class extends M{constructor(e,t){super(),this.instantiationService=e,this.configurationService=t,this._onDidSave=this._register(new A),this.onDidSave=this._onDidSave.event,this._onDidChangeDirty=this._register(new A),this.onDidChangeDirty=this._onDidChangeDirty.event,this._onDidChangeEncoding=this._register(new A),this.onDidChangeEncoding=this._onDidChangeEncoding.event,this._onDidCreate=this._register(new A),this.onDidCreate=this._onDidCreate.event,this._onWillDispose=this._register(new A),this.onWillDispose=this._onWillDispose.event,this._onDidChangeLabel=this._register(new A),this.onDidChangeLabel=this._onDidChangeLabel.event,this.mapResourceToModel=new js}get(e){return this.mapResourceToModel.get(e)}getValue(e){return this.get(e)?.textEditorModel?.getValue()}async resolve(e){const t=this.doCreateOrGet(e);return await t.resolve(),t}create(e){return this.doCreateOrGet(e)}doCreateOrGet(e=Object.create(null)){const t=this.massageOptions(e);return t.untitledResource&&this.mapResourceToModel.has(t.untitledResource)?this.mapResourceToModel.get(t.untitledResource):this.doCreate(t)}massageOptions(e){const t=Object.create(null);if(e.associatedResource?(t.untitledResource=F.from({scheme:ue.untitled,authority:e.associatedResource.authority,fragment:e.associatedResource.fragment,path:e.associatedResource.path,query:e.associatedResource.query}),t.associatedResource=e.associatedResource):e.untitledResource?.scheme===ue.untitled&&(t.untitledResource=e.untitledResource),e.languageId)t.languageId=e.languageId;else if(!t.associatedResource){const i=this.configurationService.getValue();i.files?.defaultLanguage&&(t.languageId=i.files.defaultLanguage)}return t.encoding=e.encoding,t.initialValue=e.initialValue,t}doCreate(e){let t=e.untitledResource;if(!t){let s=1;do t=F.from({scheme:ue.untitled,path:`Untitled-${s}`}),s++;while(this.mapResourceToModel.has(t))}const i=this._register(this.instantiationService.createInstance(JT,t,!!e.associatedResource,e.initialValue,e.languageId,e.encoding));return this.registerModel(i),i}registerModel(e){const t=new B;t.add(e.onDidChangeDirty(()=>this._onDidChangeDirty.fire(e))),t.add(e.onDidChangeName(()=>this._onDidChangeLabel.fire(e))),t.add(e.onDidChangeEncoding(()=>this._onDidChangeEncoding.fire(e))),t.add(e.onWillDispose(()=>this._onWillDispose.fire(e))),K.once(e.onWillDispose)(()=>{this.mapResourceToModel.delete(e.resource),t.dispose()}),this.mapResourceToModel.set(e.resource,e),this._onDidCreate.fire(e),e.isDirty()&&this._onDidChangeDirty.fire(e)}isUntitledWithAssociatedResource(e){return e.scheme===ue.untitled&&e.path.length>1&&!Am.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX.test(e.path)}canDispose(e){return e.isDisposed()?!0:this.doCanDispose(e)}async doCanDispose(e){return e.isDirty()?(await K.toPromise(e.onDidChangeDirty),this.canDispose(e)):!0}notifyDidSave(e,t){this._onDidSave.fire({source:e,target:t})}},Am=ln,ln.UNTITLED_WITHOUT_ASSOCIATED_RESOURCE_REGEX=/Untitled-\d+/,ln);Tm=Am=D([u(0,z),u(1,te)],Tm);var Ls,km,ps;let Vh=(ps=class extends M{constructor(e,t,i,s,o,r,n,d,l,h,p){super(),this.editorService=e,this.editorGroupService=t,this.contextService=i,this.storageService=s,this.configurationService=o,this.fileService=r,this.workspacesService=n,this.instantiationService=d,this.layoutService=l,this.contextKeyService=h,this.logService=p,this.activeEditorListeners=this._register(new B),this.lastActiveEditor=void 0,this._onDidChangeEditorNavigationStack=this._register(new A),this.onDidChangeEditorNavigationStack=this._onDidChangeEditorNavigationStack.event,this.defaultScopedEditorNavigationStack=void 0,this.editorGroupScopedNavigationStacks=new Map,this.editorScopedNavigationStacks=new Map,this.editorNavigationScope=di.DEFAULT,this.recentlyUsedEditorsStack=void 0,this.recentlyUsedEditorsStackIndex=0,this.recentlyUsedEditorsInGroupStack=void 0,this.recentlyUsedEditorsInGroupStackIndex=0,this.navigatingInRecentlyUsedEditorsStack=!1,this.navigatingInRecentlyUsedEditorsInGroupStack=!1,this.recentlyClosedEditors=[],this.ignoreEditorCloseEvent=!1,this.history=void 0,this.editorHistoryListeners=this._register(new Rn),this.resourceExcludeMatcher=this._register(new ZT(me,()=>{const g=this._register(this.instantiationService.createInstance(QT,f=>ek(f?this.configurationService.getValue({resource:f}):this.configurationService.getValue())||Object.create(null),f=>f.affectsConfiguration(tk)||f.affectsConfiguration(ik)));return this._register(g.onExpressionChange(()=>this.removeExcludedFromHistory())),g})),this.editorHelper=this.instantiationService.createInstance(Ph),this.canNavigateBackContextKey=new oe("canNavigateBack",!1,c(14103,"Whether it is possible to navigate back in editor history")).bindTo(this.contextKeyService),this.canNavigateForwardContextKey=new oe("canNavigateForward",!1,c(14104,"Whether it is possible to navigate forward in editor history")).bindTo(this.contextKeyService),this.canNavigateBackInNavigationsContextKey=new oe("canNavigateBackInNavigationLocations",!1,c(14105,"Whether it is possible to navigate back in editor navigation locations history")).bindTo(this.contextKeyService),this.canNavigateForwardInNavigationsContextKey=new oe("canNavigateForwardInNavigationLocations",!1,c(14106,"Whether it is possible to navigate forward in editor navigation locations history")).bindTo(this.contextKeyService),this.canNavigateToLastNavigationLocationContextKey=new oe("canNavigateToLastNavigationLocation",!1,c(14107,"Whether it is possible to navigate to the last editor navigation location")).bindTo(this.contextKeyService),this.canNavigateBackInEditsContextKey=new oe("canNavigateBackInEditLocations",!1,c(14108,"Whether it is possible to navigate back in editor edit locations history")).bindTo(this.contextKeyService),this.canNavigateForwardInEditsContextKey=new oe("canNavigateForwardInEditLocations",!1,c(14109,"Whether it is possible to navigate forward in editor edit locations history")).bindTo(this.contextKeyService),this.canNavigateToLastEditLocationContextKey=new oe("canNavigateToLastEditLocation",!1,c(14110,"Whether it is possible to navigate to the last editor edit location")).bindTo(this.contextKeyService),this.canReopenClosedEditorContextKey=new oe("canReopenClosedEditor",!1,c(14111,"Whether it is possible to reopen the last closed editor")).bindTo(this.contextKeyService),this.registerListeners(),this.editorService.activeEditorPane&&this.onDidActiveEditorChange()}registerListeners(){this.registerMouseNavigationListener(),this._register(this.editorService.onDidActiveEditorChange(()=>this.onDidActiveEditorChange())),this._register(this.editorService.onDidOpenEditorFail(e=>this.remove(e.editor))),this._register(this.editorService.onDidCloseEditor(e=>this.onDidCloseEditor(e))),this._register(this.editorService.onDidMostRecentlyActiveEditorsChange(()=>this.handleEditorEventInRecentEditorsStack())),this._register(this.editorGroupService.onDidRemoveGroup(e=>this.onDidRemoveGroup(e))),this._register(this.fileService.onDidFilesChange(e=>this.onDidFilesChange(e))),this._register(this.fileService.onDidRunOperation(e=>this.onDidFilesChange(e))),this._register(this.storageService.onWillSaveState(()=>this.saveState())),this.registerEditorNavigationScopeChangeListener(),this._register(this.onDidChangeEditorNavigationStack(()=>this.updateContextKeys())),this._register(this.editorGroupService.onDidChangeActiveGroup(()=>this.updateContextKeys()))}onDidCloseEditor(e){this.handleEditorCloseEventInHistory(e),this.handleEditorCloseEventInReopen(e)}registerMouseNavigationListener(){const e=this._register(new B),t=()=>{e.clear(),this.configurationService.getValue(Ls.MOUSE_NAVIGATION_SETTING)&&this._register(K.runAndSubscribe(this.layoutService.onDidAddContainer,({container:i,disposables:s})=>{const o=s.add(new B);o.add(X(i,Q.MOUSE_DOWN,r=>this.onMouseDownOrUp(r,!0))),o.add(X(i,Q.MOUSE_UP,r=>this.onMouseDownOrUp(r,!1))),e.add(o)},{container:this.layoutService.mainContainer,disposables:this._store}))};this._register(this.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(Ls.MOUSE_NAVIGATION_SETTING)&&t()})),t()}onMouseDownOrUp(e,t){switch(e.button){case 3:be.stop(e),t&&this.goBack();break;case 4:be.stop(e),t&&this.goForward();break}}onDidRemoveGroup(e){this.handleEditorGroupRemoveInNavigationStacks(e)}onDidActiveEditorChange(){const e=this.editorGroupService.activeGroup,t=e.activeEditorPane;if(!(this.lastActiveEditor&&this.editorHelper.matchesEditorIdentifier(this.lastActiveEditor,t))){if(this.lastActiveEditor=t?.input?{editor:t.input,groupId:t.group.id}:void 0,this.activeEditorListeners.clear(),!t?.group.isTransient(t.input))this.handleActiveEditorChange(e,t);else{this.logService.trace(`[History]: ignoring transient editor change until becoming non-transient (editor: ${t.input?.resource?.toString()}})`);const i=e.onDidModelChange(s=>{s.kind===ut.EDITOR_TRANSIENT&&s.editor===t.input&&!t.group.isTransient(t.input)&&(i.dispose(),this.handleActiveEditorChange(e,t))});this.activeEditorListeners.add(i)}Jg(t)&&this.activeEditorListeners.add(t.onDidChangeSelection(i=>{t.group.isTransient(t.input)?this.logService.trace(`[History]: ignoring transient editor selection change (editor: ${t.input?.resource?.toString()}})`):this.handleActiveEditorSelectionChangeEvent(e,t,i)})),this.updateContextKeys()}}onDidFilesChange(e){e instanceof Nd?e.gotDeleted()&&this.remove(e):e.isOperation(Gr.DELETE)?this.remove(e):e.isOperation(Gr.MOVE)&&e.target.isFile&&this.move(e)}handleActiveEditorChange(e,t){this.handleActiveEditorChangeInHistory(t),this.handleActiveEditorChangeInNavigationStacks(e,t)}handleActiveEditorSelectionChangeEvent(e,t,i){this.handleActiveEditorSelectionChangeInNavigationStacks(e,t,i)}move(e){this.moveInHistory(e),this.moveInEditorNavigationStacks(e)}remove(e){this.removeFromHistory(e),this.removeFromEditorNavigationStacks(e),this.removeFromRecentlyClosedEditors(e),this.removeFromRecentlyOpened(e)}removeFromRecentlyOpened(e){let t;It(e)?t=Ue.getOriginalUri(e):e instanceof Nd||(t=e.resource),t&&this.workspacesService.removeRecentlyOpened([t])}clear(){this.clearRecentlyOpened(),this.clearEditorNavigationStacks(),this.recentlyClosedEditors=[],this.updateContextKeys()}updateContextKeys(){this.contextKeyService.bufferChangeEvents(()=>{const e=this.getStack();this.canNavigateBackContextKey.set(e.canGoBack(Fe.NONE)),this.canNavigateForwardContextKey.set(e.canGoForward(Fe.NONE)),this.canNavigateBackInNavigationsContextKey.set(e.canGoBack(Fe.NAVIGATION)),this.canNavigateForwardInNavigationsContextKey.set(e.canGoForward(Fe.NAVIGATION)),this.canNavigateToLastNavigationLocationContextKey.set(e.canGoLast(Fe.NAVIGATION)),this.canNavigateBackInEditsContextKey.set(e.canGoBack(Fe.EDITS)),this.canNavigateForwardInEditsContextKey.set(e.canGoForward(Fe.EDITS)),this.canNavigateToLastEditLocationContextKey.set(e.canGoLast(Fe.EDITS)),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0)})}registerEditorNavigationScopeChangeListener(){const e=()=>{this.disposeEditorNavigationStacks();const t=this.configurationService.getValue(Ls.NAVIGATION_SCOPE_SETTING);t==="editorGroup"?this.editorNavigationScope=di.EDITOR_GROUP:t==="editor"?this.editorNavigationScope=di.EDITOR:this.editorNavigationScope=di.DEFAULT};this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration(Ls.NAVIGATION_SCOPE_SETTING)&&e()})),e()}getStack(e=this.editorGroupService.activeGroup,t=e.activeEditor){switch(this.editorNavigationScope){case di.EDITOR:{if(!t)return new wM;let i=this.editorScopedNavigationStacks.get(e.id);i||(i=new Map,this.editorScopedNavigationStacks.set(e.id,i));let s=i.get(t)?.stack;if(!s){const o=new B;s=o.add(this.instantiationService.createInstance(Jd,di.EDITOR)),o.add(s.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire())),i.set(t,{stack:s,disposable:o})}return s}case di.EDITOR_GROUP:{let i=this.editorGroupScopedNavigationStacks.get(e.id)?.stack;if(!i){const s=new B;i=s.add(this.instantiationService.createInstance(Jd,di.EDITOR_GROUP)),s.add(i.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire())),this.editorGroupScopedNavigationStacks.set(e.id,{stack:i,disposable:s})}return i}case di.DEFAULT:return this.defaultScopedEditorNavigationStack||(this.defaultScopedEditorNavigationStack=this._register(this.instantiationService.createInstance(Jd,di.DEFAULT)),this._register(this.defaultScopedEditorNavigationStack.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire()))),this.defaultScopedEditorNavigationStack}}goForward(e){return this.getStack().goForward(e)}goBack(e){return this.getStack().goBack(e)}goPrevious(e){return this.getStack().goPrevious(e)}goLast(e){return this.getStack().goLast(e)}handleActiveEditorChangeInNavigationStacks(e,t){this.getStack(e,t?.input).handleActiveEditorChange(t)}handleActiveEditorSelectionChangeInNavigationStacks(e,t,i){this.getStack(e,t.input).handleActiveEditorSelectionChange(t,i)}handleEditorCloseEventInHistory(e){const t=this.editorScopedNavigationStacks.get(e.groupId);if(t){const i=t.get(e.editor);i&&(i.disposable.dispose(),t.delete(e.editor)),t.size===0&&this.editorScopedNavigationStacks.delete(e.groupId)}}handleEditorGroupRemoveInNavigationStacks(e){this.defaultScopedEditorNavigationStack?.remove(e.id);const t=this.editorGroupScopedNavigationStacks.get(e.id);t&&(t.disposable.dispose(),this.editorGroupScopedNavigationStacks.delete(e.id))}clearEditorNavigationStacks(){this.withEachEditorNavigationStack(e=>e.clear())}removeFromEditorNavigationStacks(e){this.withEachEditorNavigationStack(t=>t.remove(e))}moveInEditorNavigationStacks(e){this.withEachEditorNavigationStack(t=>t.move(e))}withEachEditorNavigationStack(e){this.defaultScopedEditorNavigationStack&&e(this.defaultScopedEditorNavigationStack);for(const[,t]of this.editorGroupScopedNavigationStacks)e(t.stack);for(const[,t]of this.editorScopedNavigationStacks)for(const[,i]of t)e(i.stack)}disposeEditorNavigationStacks(){this.defaultScopedEditorNavigationStack?.dispose(),this.defaultScopedEditorNavigationStack=void 0;for(const[,e]of this.editorGroupScopedNavigationStacks)e.disposable.dispose();this.editorGroupScopedNavigationStacks.clear();for(const[,e]of this.editorScopedNavigationStacks)for(const[,t]of e)t.disposable.dispose();this.editorScopedNavigationStacks.clear()}openNextRecentlyUsedEditor(e){const[t,i]=this.ensureRecentlyUsedStack(s=>s-1,e);return this.doNavigateInRecentlyUsedEditorsStack(t[i],e)}openPreviouslyUsedEditor(e){const[t,i]=this.ensureRecentlyUsedStack(s=>s+1,e);return this.doNavigateInRecentlyUsedEditorsStack(t[i],e)}async doNavigateInRecentlyUsedEditorsStack(e,t){if(e){const i=typeof t!="number"||!this.editorGroupService.getGroup(t);i?this.navigatingInRecentlyUsedEditorsStack=!0:this.navigatingInRecentlyUsedEditorsInGroupStack=!0;const s=this.editorGroupService.getGroup(e.groupId)??this.editorGroupService.activeGroup;try{await s.openEditor(e.editor)}finally{i?this.navigatingInRecentlyUsedEditorsStack=!1:this.navigatingInRecentlyUsedEditorsInGroupStack=!1}}}ensureRecentlyUsedStack(e,t){let i,s;const o=typeof t=="number"?this.editorGroupService.getGroup(t):void 0;o?(i=this.recentlyUsedEditorsInGroupStack||o.getEditors(Ie.MOST_RECENTLY_ACTIVE).map(n=>({groupId:o.id,editor:n})),s=this.recentlyUsedEditorsInGroupStackIndex):(i=this.recentlyUsedEditorsStack||this.editorService.getEditors(Ie.MOST_RECENTLY_ACTIVE),s=this.recentlyUsedEditorsStackIndex);let r=e(s);return r<0?r=0:r>i.length-1&&(r=i.length-1),o?(this.recentlyUsedEditorsInGroupStack=i,this.recentlyUsedEditorsInGroupStackIndex=r):(this.recentlyUsedEditorsStack=i,this.recentlyUsedEditorsStackIndex=r),[i,r]}handleEditorEventInRecentEditorsStack(){this.navigatingInRecentlyUsedEditorsStack||(this.recentlyUsedEditorsStack=void 0,this.recentlyUsedEditorsStackIndex=0),this.navigatingInRecentlyUsedEditorsInGroupStack||(this.recentlyUsedEditorsInGroupStack=void 0,this.recentlyUsedEditorsInGroupStackIndex=0)}handleEditorCloseEventInReopen(e){if(this.ignoreEditorCloseEvent)return;const{editor:t,context:i}=e;if(i===Vr.REPLACE||i===Vr.MOVE||!t.canReopen())return;const s=t.toUntyped();if(!s)return;const o=[],r=Ue.getOriginalUri(t,{supportSideBySide:Le.BOTH});F.isUri(r)?o.push(r):r&&o.push(...Mi([r.primary,r.secondary])),this.removeFromRecentlyClosedEditors(t),this.recentlyClosedEditors.push({editorId:t.editorId,editor:s,resource:Ue.getOriginalUri(t),associatedResources:o,index:e.index,sticky:e.sticky}),this.recentlyClosedEditors.length>Ls.MAX_RECENTLY_CLOSED_EDITORS&&this.recentlyClosedEditors.shift(),this.canReopenClosedEditorContextKey.set(!0)}async reopenLastClosedEditor(){const e=this.recentlyClosedEditors.pop();let t;return e&&(t=this.doReopenLastClosedEditor(e)),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0),t}async doReopenLastClosedEditor(e){const t={pinned:!0,sticky:e.sticky,index:e.index,ignoreError:!0};(e.sticky&&!this.editorGroupService.activeGroup.isSticky(e.index)||!e.sticky&&this.editorGroupService.activeGroup.isSticky(e.index))&&(t.index=void 0);let i;if(!this.editorGroupService.activeGroup.contains(e.editor)){this.ignoreEditorCloseEvent=!0;try{i=await this.editorService.openEditor({...e.editor,options:{...e.editor.options,...t}})}finally{this.ignoreEditorCloseEvent=!1}}i||(QS(this.recentlyClosedEditors,e),this.reopenLastClosedEditor())}removeFromRecentlyClosedEditors(e){this.recentlyClosedEditors=this.recentlyClosedEditors.filter(t=>It(e)&&t.editorId!==e.editorId?!0:!(t.resource&&this.editorHelper.matchesFile(t.resource,e)||t.associatedResources.some(i=>this.editorHelper.matchesFile(i,e)))),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0)}handleActiveEditorChangeInHistory(e){const t=e?.input;!t||t.isDisposed()||!this.includeInHistory(t)||(this.removeFromHistory(t),this.addToHistory(t))}addToHistory(e,t=!0){this.ensureHistoryLoaded(this.history);const i=this.editorHelper.preferResourceEditorInput(e);i&&(t?this.history.unshift(i):this.history.push(i),this.history.length>Ls.MAX_HISTORY_ITEMS&&this.editorHelper.clearOnEditorDispose(this.history.pop(),this.editorHistoryListeners),It(e)&&this.editorHelper.onEditorDispose(e,()=>this.updateHistoryOnEditorDispose(i),this.editorHistoryListeners))}updateHistoryOnEditorDispose(e){if(It(e))if(!sk(e))this.removeFromHistory(e);else{const t=[],i=e.primary.matches(e.secondary)?[e.primary]:[e.primary,e.secondary];for(const s of i){const o=this.editorHelper.preferResourceEditorInput(s);Zg(o)&&this.includeInHistory(o)&&t.push(o)}this.replaceInHistory(e,...t)}else this.includeInHistory(e)||this.removeFromHistory(e)}includeInHistory(e){return It(e)?!0:!this.resourceExcludeMatcher.value.matches(e.resource)}removeExcludedFromHistory(){this.ensureHistoryLoaded(this.history),this.history=this.history.filter(e=>{const t=this.includeInHistory(e);return t||this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t})}moveInHistory(e){e.isOperation(Gr.MOVE)&&this.removeFromHistory(e)&&this.addToHistory({resource:e.target.resource})}removeFromHistory(e){let t=!1;return this.ensureHistoryLoaded(this.history),this.history=this.history.filter(i=>{const s=this.editorHelper.matchesEditor(e,i);return s&&(this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t=!0),!s}),t}replaceInHistory(e,...t){this.ensureHistoryLoaded(this.history);let i=!1;const s=[];for(const o of this.history)this.editorHelper.matchesEditor(e,o)?(this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),i||(s.push(...t),i=!0)):t.some(r=>this.editorHelper.matchesEditor(r,o))||s.push(o);i||s.push(...t),this.history=s}clearRecentlyOpened(){this.history=[],this.editorHistoryListeners.clearAndDisposeAll()}getHistory(){return this.ensureHistoryLoaded(this.history),this.history}ensureHistoryLoaded(e){this.history||(this.history=[],this.editorGroupService.isReady?this.loadHistory():(async()=>(await this.editorGroupService.whenReady,this.loadHistory()))())}loadHistory(){this.history=[];const e=this.loadHistoryFromStorage(),t=[...this.editorService.getEditors(Ie.MOST_RECENTLY_ACTIVE)].reverse(),i=new Set;for(const{editor:s}of t)if(this.includeInHistory(s)){if(s.resource){const o=`${s.resource.toString()}/${s.editorId}`;if(i.has(o))continue;i.add(o)}this.addToHistory(s)}for(const s of e){const o=`${s.resource.toString()}/${s.options?.override}`;!i.has(o)&&this.includeInHistory(s)&&(i.add(o),this.addToHistory(s,!1))}}loadHistoryFromStorage(){const e=[],t=this.storageService.get(Ls.HISTORY_STORAGE_KEY,ee.WORKSPACE);if(t)try{const i=JSON.parse(t);for(const s of i)if(!(!s.editor||!s.editor.resource))try{e.push({...s.editor,resource:typeof s.editor.resource=="string"?F.parse(s.editor.resource):F.from(s.editor.resource)})}catch(o){gr(o)}}catch(i){gr(i)}return e}saveState(){if(!this.history)return;const e=[];for(const t of this.history)It(t)||!Zg(t)||e.push({editor:{...t,resource:t.resource.toString()}});this.storageService.store(Ls.HISTORY_STORAGE_KEY,JSON.stringify(e),ee.WORKSPACE,Ze.MACHINE)}getLastActiveWorkspaceRoot(e,t){const i=this.contextService.getWorkspace().folders;if(i.length!==0){if(i.length===1){const s=i[0].uri;return(!e||s.scheme===e)&&(!t||s.authority===t)?s:void 0}for(const s of this.getHistory()){if(It(s)||e&&s.resource.scheme!==e||t&&s.resource.authority!==t)continue;const o=this.contextService.getWorkspaceFolder(s.resource);if(o)return o.uri}for(const s of i){const o=s.uri;if((!e||o.scheme===e)&&(!t||o.authority===t))return o}}}getLastActiveFile(e,t){for(const i of this.getHistory()){let s;if(It(i)?s=Ue.getOriginalUri(i,{filterByScheme:e}):s=i.resource,s&&s.scheme===e&&(!t||s.authority===t))return s}}dispose(){super.dispose();for(const[,e]of this.editorGroupScopedNavigationStacks)e.disposable.dispose();for(const[,e]of this.editorScopedNavigationStacks)for(const[,t]of e)t.disposable.dispose();for(const[,e]of this.editorHistoryListeners)e.dispose()}},Ls=ps,ps.MOUSE_NAVIGATION_SETTING="workbench.editor.mouseBackForwardToNavigate",ps.NAVIGATION_SCOPE_SETTING="workbench.editor.navigationScope",ps.MAX_RECENTLY_CLOSED_EDITORS=20,ps.MAX_HISTORY_ITEMS=200,ps.HISTORY_STORAGE_KEY="history.entries",ps);Vh=Ls=D([u(0,O),u(1,U),u(2,xt),u(3,ge),u(4,te),u(5,Ve),u(6,Wn),u(7,z),u(8,je),u(9,de),u(10,et)],Vh);ok(mt,Vh,rk.Eager);class DC{constructor(e,t,i){this.editorIdentifier=e,this.selection=t,this.reason=i}justifiesNewNavigationEntry(e){if(this.editorIdentifier.groupId!==e.editorIdentifier.groupId||!this.editorIdentifier.editor.matches(e.editorIdentifier.editor)||!this.selection||!e.selection)return!0;const t=this.selection.compare(e.selection);return t===zo.SIMILAR&&(e.reason===zt.NAVIGATION||e.reason===zt.JUMP)?!0:t===zo.DIFFERENT}}let Jd=class extends M{constructor(e,t){super(),this.scope=e,this.instantiationService=t,this.selectionsStack=this._register(this.instantiationService.createInstance(Zd,Fe.NONE,this.scope)),this.editsStack=this._register(this.instantiationService.createInstance(Zd,Fe.EDITS,this.scope)),this.navigationsStack=this._register(this.instantiationService.createInstance(Zd,Fe.NAVIGATION,this.scope)),this.stacks=[this.selectionsStack,this.editsStack,this.navigationsStack],this.onDidChange=K.any(this.selectionsStack.onDidChange,this.editsStack.onDidChange,this.navigationsStack.onDidChange)}canGoForward(e){return this.getStack(e).canGoForward()}goForward(e){return this.getStack(e).goForward()}canGoBack(e){return this.getStack(e).canGoBack()}goBack(e){return this.getStack(e).goBack()}goPrevious(e){return this.getStack(e).goPrevious()}canGoLast(e){return this.getStack(e).canGoLast()}goLast(e){return this.getStack(e).goLast()}getStack(e=Fe.NONE){switch(e){case Fe.NONE:return this.selectionsStack;case Fe.EDITS:return this.editsStack;case Fe.NAVIGATION:return this.navigationsStack}}handleActiveEditorChange(e){this.selectionsStack.notifyNavigation(e)}handleActiveEditorSelectionChange(e,t){const i=this.selectionsStack.current;this.selectionsStack.notifyNavigation(e,t),t.reason===zt.EDIT?this.editsStack.notifyNavigation(e,t):(t.reason===zt.NAVIGATION||t.reason===zt.JUMP)&&!this.selectionsStack.isNavigating()&&(t.reason===zt.JUMP&&!this.navigationsStack.isNavigating()&&i&&this.navigationsStack.addOrReplace(i.groupId,i.editor,i.selection),this.navigationsStack.notifyNavigation(e,t))}clear(){for(const e of this.stacks)e.clear()}remove(e){for(const t of this.stacks)t.remove(e)}move(e){for(const t of this.stacks)t.move(e)}};Jd=D([u(1,z)],Jd);class wM{constructor(){this.onDidChange=K.None}canGoForward(){return!1}async goForward(){}canGoBack(){return!1}async goBack(){}async goPrevious(){}canGoLast(){return!1}async goLast(){}handleActiveEditorChange(){}handleActiveEditorSelectionChange(){}clear(){}remove(){}move(){}dispose(){}}var hn;let Zd=(hn=class extends M{get current(){return this.stack[this.index]}set current(e){e&&(this.stack[this.index]=e)}constructor(e,t,i,s,o,r){super(),this.filter=e,this.scope=t,this.editorService=s,this.editorGroupService=o,this.logService=r,this._onDidChange=this._register(new A),this.onDidChange=this._onDidChange.event,this.mapEditorToDisposable=this._register(new Rn),this.mapGroupToDisposable=this._register(new Rn),this.stack=[],this.index=-1,this.previousIndex=-1,this.navigating=!1,this.currentSelectionState=void 0,this.editorHelper=i.createInstance(Ph),this.registerListeners()}registerListeners(){this._register(this.onDidChange(()=>this.traceStack())),this._register(this.logService.onDidChangeLogLevel(()=>this.traceStack())),this._register(this.editorGroupService.onDidRemoveGroup(e=>{this.mapGroupToDisposable.deleteAndDispose(e.id)}))}traceStack(){if(this.logService.getLevel()!==gy.Trace)return;const e=[];for(const t of this.stack)typeof t.selection?.log=="function"?e.push(`- group: ${t.groupId}, editor: ${t.editor.resource?.toString()}, selection: ${t.selection.log()}`):e.push(`- group: ${t.groupId}, editor: ${t.editor.resource?.toString()}, selection: <none>`);e.length===0?this.trace(`index: ${this.index}, navigating: ${this.isNavigating()}: <empty>`):this.trace(`index: ${this.index}, navigating: ${this.isNavigating()}
${e.join(`
`)}
			`)}trace(e,t=null,i){if(this.logService.getLevel()!==gy.Trace)return;let s;switch(this.filter){case Fe.NONE:s="global";break;case Fe.EDITS:s="edits";break;case Fe.NAVIGATION:s="navigation";break}let o;switch(this.scope){case di.DEFAULT:o="default";break;case di.EDITOR_GROUP:o="editorGroup";break;case di.EDITOR:o="editor";break}t!==null?this.logService.trace(`[History stack ${s}-${o}]: ${e} (editor: ${t?.resource?.toString()}, event: ${this.traceEvent(i)})`):this.logService.trace(`[History stack ${s}-${o}]: ${e}`)}traceEvent(e){if(!e)return"<none>";switch(e.reason){case zt.EDIT:return"edit";case zt.NAVIGATION:return"navigation";case zt.JUMP:return"jump";case zt.PROGRAMMATIC:return"programmatic";case zt.USER:return"user"}}registerGroupListeners(e){if(!this.mapGroupToDisposable.has(e)){const t=this.editorGroupService.getGroup(e);t&&this.mapGroupToDisposable.set(e,t.onWillMoveEditor(i=>this.onWillMoveEditor(i)))}}onWillMoveEditor(e){if(this.trace("onWillMoveEditor()",e.editor),this.scope!==di.EDITOR_GROUP)for(const t of this.stack)t.groupId===e.groupId&&this.editorHelper.matchesEditor(e.editor,t.editor)&&(t.groupId=e.target)}notifyNavigation(e,t){this.trace("notifyNavigation()",e?.input,t);const i=Jg(e),s=e?.input&&!e.input.isDisposed();this.navigating?(this.trace("notifyNavigation() ignoring (navigating)",e?.input,t),i&&s?(this.trace("notifyNavigation() updating current selection state",e?.input,t),this.currentSelectionState=new DC({groupId:e.group.id,editor:e.input},e.getSelection(),t?.reason)):(this.trace("notifyNavigation() dropping current selection state",e?.input,t),this.currentSelectionState=void 0)):(this.trace("notifyNavigation() not ignoring",e?.input,t),i&&s?this.onSelectionAwareEditorNavigation(e.group.id,e.input,e.getSelection(),t):(this.currentSelectionState=void 0,s&&this.onNonSelectionAwareEditorNavigation(e.group.id,e.input)))}onSelectionAwareEditorNavigation(e,t,i,s){if(this.current?.groupId===e&&!i&&this.editorHelper.matchesEditor(this.current.editor,t))return;this.trace("onSelectionAwareEditorNavigation()",t,s);const o=new DC({groupId:e,editor:t},i,s?.reason);!this.currentSelectionState||this.currentSelectionState.justifiesNewNavigationEntry(o)?this.doAdd(e,t,o.selection):this.doReplace(e,t,o.selection),this.currentSelectionState=o}onNonSelectionAwareEditorNavigation(e,t){this.current?.groupId===e&&this.editorHelper.matchesEditor(this.current.editor,t)||(this.trace("onNonSelectionAwareEditorNavigation()",t),this.doAdd(e,t))}doAdd(e,t,i){this.navigating||this.addOrReplace(e,t,i)}doReplace(e,t,i){this.navigating||this.addOrReplace(e,t,i,!0)}addOrReplace(e,t,i,s){this.registerGroupListeners(e);let o=!1;this.current&&(s||this.shouldReplaceStackEntry(this.current,{groupId:e,editor:t,selection:i}))&&(o=!0);const r=this.editorHelper.preferResourceEditorInput(t);if(!r)return;o?this.trace("replace()",r):this.trace("add()",r);const n={groupId:e,editor:r,selection:i},d=[];if(o)this.current&&d.push(this.current),this.current=n;else{if(this.stack.length>this.index+1){for(let l=this.index+1;l<this.stack.length;l++)d.push(this.stack[l]);this.stack=this.stack.slice(0,this.index+1)}this.stack.splice(this.index+1,0,n),this.stack.length>km.MAX_STACK_SIZE?(d.push(this.stack.shift()),this.previousIndex>=0&&this.previousIndex--):this.setIndex(this.index+1,!0)}for(const l of d)this.editorHelper.clearOnEditorDispose(l.editor,this.mapEditorToDisposable);It(r)&&this.editorHelper.onEditorDispose(r,()=>this.remove(r),this.mapEditorToDisposable),this._onDidChange.fire()}shouldReplaceStackEntry(e,t){return e.groupId!==t.groupId||!this.editorHelper.matchesEditor(e.editor,t.editor)?!1:e.selection?t.selection?e.selection.compare(t.selection)===zo.IDENTICAL:!1:!0}move(e){if(e.isOperation(Gr.MOVE))for(const t of this.stack)this.editorHelper.matchesEditor(e,t.editor)&&(t.editor={resource:e.target.resource})}remove(e){const t=this.stack.length;this.stack=this.stack.filter(i=>{const s=typeof e=="number"?i.groupId===e:this.editorHelper.matchesEditor(e,i.editor);return s&&this.editorHelper.clearOnEditorDispose(i.editor,this.mapEditorToDisposable),!s}),t!==this.stack.length&&(this.flatten(),this.index=this.stack.length-1,this.previousIndex=-1,typeof e=="number"&&this.mapGroupToDisposable.deleteAndDispose(e),this._onDidChange.fire())}flatten(){const e=[];let t;for(const i of this.stack)t&&this.shouldReplaceStackEntry(i,t)||(t=i,e.push(i));this.stack=e}clear(){this.index=-1,this.previousIndex=-1,this.stack.splice(0),this.mapEditorToDisposable.clearAndDisposeAll(),this.mapGroupToDisposable.clearAndDisposeAll()}dispose(){this.clear(),super.dispose()}canGoForward(){return this.stack.length>this.index+1}async goForward(){if(!await this.maybeGoCurrent()&&this.canGoForward())return this.setIndex(this.index+1),this.navigate()}canGoBack(){return this.index>0}async goBack(){if(!await this.maybeGoCurrent()&&this.canGoBack())return this.setIndex(this.index-1),this.navigate()}async goPrevious(){if(!await this.maybeGoCurrent())return this.previousIndex===-1?this.goBack():(this.setIndex(this.previousIndex),this.navigate())}canGoLast(){return this.stack.length>0}async goLast(){if(this.canGoLast())return this.setIndex(this.stack.length-1),this.navigate()}async maybeGoCurrent(){return this.filter===Fe.NONE||this.isCurrentSelectionActive()?!1:(await this.navigate(),!0)}isCurrentSelectionActive(){if(!this.current?.selection)return!1;const e=this.editorService.activeEditorPane;if(!Jg(e)||e.group.id!==this.current.groupId||!e.input||!this.editorHelper.matchesEditor(e.input,this.current.editor))return!1;const t=e.getSelection();return t?t.compare(this.current.selection)===zo.IDENTICAL:!1}setIndex(e,t){this.previousIndex=this.index,this.index=e,t||this._onDidChange.fire()}async navigate(){this.navigating=!0;try{this.current&&await this.doNavigate(this.current)}finally{this.navigating=!1}}doNavigate(e){let t=Object.create(null);return e.selection&&(t=e.selection.restore(t)),It(e.editor)?this.editorService.openEditor(e.editor,t,e.groupId):this.editorService.openEditor({...e.editor,options:{...e.editor.options,...t}},e.groupId)}isNavigating(){return this.navigating}},km=hn,hn.MAX_STACK_SIZE=50,hn);Zd=km=D([u(2,z),u(3,O),u(4,U),u(5,et)],Zd);let Ph=class{constructor(e,t,i,s){this.uriIdentityService=e,this.lifecycleService=t,this.fileService=i,this.pathService=s}preferResourceEditorInput(e){const t=Ue.getOriginalUri(e);if(t?.scheme===ue.file||t?.scheme===ue.vscodeRemote||t?.scheme===ue.vscodeUserData||t?.scheme===this.pathService.defaultUriScheme){if(It(e)){const s=e.toUntyped();if(Zg(s))return s}return e}else return It(e)?e:void 0}matchesEditor(e,t){return e instanceof Nd||e instanceof py?It(t)?!1:e instanceof Nd?e.contains(t.resource,zl.DELETED):this.matchesFile(t.resource,e):It(e)?It(t)?e.matches(t):this.matchesFile(t.resource,e):It(t)?this.matchesFile(e.resource,t):e&&t&&this.uriIdentityService.extUri.isEqual(e.resource,t.resource)}matchesFile(e,t){if(t instanceof Nd)return t.contains(e,zl.DELETED);if(t instanceof py)return this.uriIdentityService.extUri.isEqualOrParent(e,t.resource);if(It(t)){const i=t.resource;return!i||this.lifecycleService.phase>=kp.Restored&&!this.fileService.hasProvider(i)?!1:this.uriIdentityService.extUri.isEqual(i,e)}return this.uriIdentityService.extUri.isEqual(t?.resource,e)}matchesEditorIdentifier(e,t){return!t?.group||e.groupId!==t.group.id?!1:t.input?e.editor.matches(t.input):!1}onEditorDispose(e,t,i){const s=K.once(e.onWillDispose)(()=>t());let o=i.get(e);o||(o=new B,i.set(e,o)),o.add(s)}clearOnEditorDispose(e,t){It(e)&&t.deleteAndDispose(e)}};Ph=D([u(0,Kn),u(1,gd),u(2,Ve),u(3,Gn)],Ph);const bM=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),vM=new oe("activeCustomEditorId","",{type:"string",description:c(6430,"The viewType of the currently active custom editor.")}),yM=new oe("focusedCustomEditorIsEditable",!1);var er;(function(a){a.default="default",a.builtin="builtin",a.option="option"})(er||(er={}));class AC{constructor(e){this.id=e.id,this.displayName=e.displayName,this.providerDisplayName=e.providerDisplayName,this.priority=e.priority,this.selector=e.selector}matches(e){return this.selector.some(t=>t.filenamePattern&&Al(t.filenamePattern,e))}}class Ag{constructor(e){this.allEditors=Xo(e,t=>t.id)}get length(){return this.allEditors.length}get defaultEditor(){return this.allEditors.find(e=>{switch(e.priority){case rt.default:case rt.builtin:return this.allEditors.every(t=>t===e||CM(t,e));default:return!1}})}get bestAvailableEditor(){return Array.from(this.allEditors).sort((t,i)=>zi(t.priority)-zi(i.priority))[0]}}function CM(a,e){return zi(a.priority)<zi(e.priority)}class SM{constructor(){this._references=new Map}async getAllModels(e){const t=`${e.toString()}@@@`,i=[];for(const[s,o]of this._references)s.startsWith(t)&&o.model&&i.push(await o.model);return i}async get(e,t){const i=this.key(e,t);return this._references.get(i)?.model}tryRetain(e,t){const i=this.key(e,t),s=this._references.get(i);if(s)return s.counter++,s.model.then(o=>({object:o,dispose:$b(()=>{--s.counter<=0&&(s.model.then(r=>r.dispose()),this._references.delete(i))})}))}add(e,t,i){const s=this.key(e,t);if(this._references.get(s))throw new Error("Model already exists");return this._references.set(s,{viewType:t,model:i,counter:0}),this.tryRetain(e,t)}disposeAllModelsForView(e){for(const[t,i]of this._references)i.viewType===e&&(i.model.then(s=>s.dispose()),this._references.delete(t))}key(e,t){return`${e.toString()}@@@${t}`}}const ls=Object.freeze({viewType:"viewType",displayName:"displayName",selector:"selector",priority:"priority"}),EM={type:"object",required:[ls.viewType,ls.displayName,ls.selector],additionalProperties:!1,properties:{[ls.viewType]:{type:"string",markdownDescription:c(6432,"Identifier for the custom editor. This must be unique across all custom editors, so we recommend including your extension id as part of `viewType`. The `viewType` is used when registering custom editors with `vscode.registerCustomEditorProvider` and in the `onCustomEditor:${id}` [activation event](https://code.visualstudio.com/api/references/activation-events).")},[ls.displayName]:{type:"string",description:c(6433,"Human readable name of the custom editor. This is displayed to users when selecting which editor to use.")},[ls.selector]:{type:"array",description:c(6434,"Set of globs that the custom editor is enabled for."),items:{type:"object",defaultSnippets:[{body:{filenamePattern:"$1"}}],additionalProperties:!1,properties:{filenamePattern:{type:"string",description:c(6435,"Glob that the custom editor is enabled for.")}}}},[ls.priority]:{type:"string",markdownDeprecationMessage:c(6436,"Controls if the custom editor is enabled automatically when the user opens a file. This may be overridden by users using the `workbench.editorAssociations` setting."),enum:[er.default,er.option],markdownEnumDescriptions:[c(6437,"The editor is automatically used when the user opens a resource, provided that no other default custom editors are registered for that resource."),c(6438,"The editor is not automatically used when the user opens a resource, but a user can switch to the editor using the `Reopen With` command.")],default:er.default}}},_M=Un.registerExtensionPoint({extensionPoint:"customEditors",deps:[nk],jsonSchema:{description:c(6439,"Contributed custom editors."),type:"array",defaultSnippets:[{body:[{[ls.viewType]:"$1",[ls.displayName]:"$2",[ls.selector]:[{filenamePattern:"$3"}]}]}],items:EM},activationEventsGenerator:function*(a){for(const e of a){const t=e[ls.viewType];t&&(yield`onCustomEditor:${t}`)}}});class IM extends M{constructor(){super(...arguments),this.type="table"}shouldRender(e){return!!e.contributes?.customEditors}render(e){const t=e.contributes?.customEditors||[];if(!t.length)return{data:{headers:[],rows:[]},dispose:()=>{}};const i=[c(6440,"View Type"),c(6441,"Priority"),c(6442,"Filename Pattern")],s=t.map(o=>[o.viewType,o.priority??"",Mi(o.selector.map(r=>r.filenamePattern)).join(", ")]);return{data:{headers:i,rows:s},dispose:()=>{}}}}se.as(Ip.ExtensionFeaturesRegistry).registerExtensionFeature({id:"customEditors",label:c(6443,"Custom Editors"),access:{canToggle:!1},renderer:new he(IM)});const Or=class Or extends M{constructor(e){super(),this._editors=new Map,this._onChange=this._register(new A),this.onChange=this._onChange.event,this._memento=new aE(Or.CUSTOM_EDITORS_STORAGE_ID,e);const t=this._memento.getMemento(ee.PROFILE,Ze.MACHINE);for(const i of t[Or.CUSTOM_EDITORS_ENTRY_ID]||[])this.add(new AC(i));this._register(_M.setHandler(i=>{this.update(i)}))}update(e){this._editors.clear();for(const i of e)for(const s of i.value)this.add(new AC({id:s.viewType,displayName:s.displayName,providerDisplayName:i.description.isBuiltin?c(6429,"Built-in"):i.description.displayName||i.description.identifier.value,selector:s.selector||[],priority:DM(s,i.description)}));const t=this._memento.getMemento(ee.PROFILE,Ze.MACHINE);t[Or.CUSTOM_EDITORS_ENTRY_ID]=Array.from(this._editors.values()),this._memento.saveMemento(),this._onChange.fire()}[Symbol.iterator](){return this._editors.values()}get(e){return this._editors.get(e)}getContributedEditors(e){return Array.from(this._editors.values()).filter(t=>t.matches(e))}add(e){if(this._editors.has(e.id)){console.error(`Custom editor with id '${e.id}' already registered`);return}this._editors.set(e.id,e)}};Or.CUSTOM_EDITORS_STORAGE_ID="customEditors",Or.CUSTOM_EDITORS_ENTRY_ID="editors";let xm=Or;function DM(a,e){switch(a.priority){case er.default:return rt.default;case er.option:return rt.option;case er.builtin:return e.isBuiltin?rt.builtin:rt.default;default:return rt.default}}xe(bM);let Lm=class extends M{constructor(e,t,i,s,o,r,n){super(),this.editorService=i,this.editorGroupService=s,this.instantiationService=o,this.uriIdentityService=r,this.editorResolverService=n,this._untitledCounter=0,this._editorResolverDisposables=this._register(new B),this._editorCapabilities=new Map,this._onDidChangeEditorTypes=this._register(new A),this.onDidChangeEditorTypes=this._onDidChangeEditorTypes.event,this._fileEditorFactory=se.as(Lt.EditorFactory).getFileEditorFactory(),this._models=new SM,this._contributedEditors=this._register(new xm(t)),this.editorResolverService.bufferChangeEvents(this.registerContributionPoints.bind(this)),this._register(this._contributedEditors.onChange(()=>{this.editorResolverService.bufferChangeEvents(this.registerContributionPoints.bind(this)),this._onDidChangeEditorTypes.fire()}));const d={contextKey:vM,getGroupContextKeyValue:p=>this.getActiveCustomEditorId(p),onDidChange:this.onDidChangeEditorTypes},l={contextKey:yM,getGroupContextKeyValue:p=>this.getCustomEditorIsEditable(p),onDidChange:this.onDidChangeEditorTypes};this._register(this.editorGroupService.registerContextKeyProvider(d)),this._register(this.editorGroupService.registerContextKeyProvider(l)),this._register(e.onDidRunOperation(p=>{p.isOperation(Gr.MOVE)&&this.handleMovedFileInOpenedFileEditors(p.resource,this.uriIdentityService.asCanonicalUri(p.target.resource))}));const h=105;this._register(dE.addImplementation(h,"custom-editor",()=>this.withActiveCustomEditor(p=>p.undo()))),this._register(cE.addImplementation(h,"custom-editor",()=>this.withActiveCustomEditor(p=>p.redo())))}getEditorTypes(){return[...this._contributedEditors]}withActiveCustomEditor(e){const t=this.editorService.activeEditor;if(t instanceof ci){const i=e(t);return i||!0}return!1}registerContributionPoints(){this._editorResolverDisposables.clear();for(const e of this._contributedEditors)for(const t of e.selector)t.filenamePattern&&this._editorResolverDisposables.add(this.editorResolverService.registerEditor(t.filenamePattern,{id:e.id,label:e.displayName,detail:e.providerDisplayName,priority:e.priority},{singlePerResource:()=>!(this.getCustomEditorCapabilities(e.id)?.supportsMultipleEditorsPerDocument??!1)},{createEditorInput:({resource:i},s)=>({editor:ci.create(this.instantiationService,{resource:i,viewType:e.id,webviewTitle:void 0,iconPath:void 0},s.id)}),createUntitledEditorInput:({resource:i},s)=>({editor:ci.create(this.instantiationService,{resource:i??F.from({scheme:ue.untitled,authority:`Untitled-${this._untitledCounter++}`}),viewType:e.id,webviewTitle:void 0,iconPath:void 0},s.id)}),createDiffEditorInput:(i,s)=>({editor:this.createDiffEditorInput(i,e.id,s)})}))}createDiffEditorInput(e,t,i){const s=ci.create(this.instantiationService,{resource:fe(e.modified.resource),viewType:t,webviewTitle:void 0,iconPath:void 0},i.id,{customClasses:"modified"}),o=ci.create(this.instantiationService,{resource:fe(e.original.resource),viewType:t,webviewTitle:void 0,iconPath:void 0},i.id,{customClasses:"original"});return this.instantiationService.createInstance(Jt,e.label,e.description,o,s,!0)}get models(){return this._models}getCustomEditor(e){return this._contributedEditors.get(e)}getContributedCustomEditors(e){return new Ag(this._contributedEditors.getContributedEditors(e))}getUserConfiguredCustomEditors(e){const t=this.editorResolverService.getAssociationsForResource(e);return new Ag(Mi(t.map(i=>this._contributedEditors.get(i.viewType))))}getAllCustomEditors(e){return new Ag([...this.getUserConfiguredCustomEditors(e).allEditors,...this.getContributedCustomEditors(e).allEditors])}registerCustomEditorCapabilities(e,t){if(this._editorCapabilities.has(e))throw new Error(`Capabilities for ${e} already set`);return this._editorCapabilities.set(e,t),pe(()=>{this._editorCapabilities.delete(e)})}getCustomEditorCapabilities(e){return this._editorCapabilities.get(e)}getActiveCustomEditorId(e){const t=e.activeEditorPane;return t?.input?.resource&&t?.input instanceof ci?t.input.viewType:""}getCustomEditorIsEditable(e){const t=e.activeEditorPane;return t?.input?.resource?t?.input instanceof ci:!1}async handleMovedFileInOpenedFileEditors(e,t){if(Yi(e).toLowerCase()===Yi(t).toLowerCase())return;const i=this.getAllCustomEditors(t);if(!i.allEditors.some(o=>o.priority!==rt.option))return;const s=new Map;for(const o of this.editorGroupService.groups)for(const r of o.editors)if(this._fileEditorFactory.isFileEditor(r)&&!(r instanceof ci)&&qe(r.resource,t)){let n=s.get(o.id);n||(n=[],s.set(o.id,n)),n.push(r)}if(s.size)for(const[o,r]of s)this.editorService.replaceEditors(r.map(n=>{let d;if(i.defaultEditor){const l=i.defaultEditor.id;d=ci.create(this.instantiationService,{resource:t,viewType:l,webviewTitle:void 0,iconPath:void 0},o)}else d={resource:t,options:{override:Mt.id}};return{editor:n,replacement:d,options:{preserveFocus:!0}}}),o)}};Lm=D([u(0,Ve),u(1,ge),u(2,O),u(3,U),u(4,z),u(5,Kn),u(6,Qs)],Lm);let Rm=class extends M{constructor(e,t){super(),this._themeService=e,this._configurationService=t,this._cachedWebViewThemeData=void 0,this._onThemeDataChanged=this._register(new A),this.onThemeDataChanged=this._onThemeDataChanged.event,this._register(this._themeService.onDidColorThemeChange(()=>{this._reset()}));const i=["editor.fontFamily","editor.fontWeight","editor.fontSize","editor.fontLigatures","accessibility.underlineLinks"];this._register(this._configurationService.onDidChangeConfiguration(s=>{i.some(o=>s.affectsConfiguration(o))&&this._reset()}))}getTheme(){return this._themeService.getColorTheme()}getWebviewThemeData(){if(!this._cachedWebViewThemeData){const e=this._configurationService.getValue("editor"),t=e.fontFamily||Tl.fontFamily,i=e.fontWeight||Tl.fontWeight,s=e.fontSize||Tl.fontSize,o=new ak().validate(e.fontLigatures),r=this._configurationService.getValue("accessibility.underlineLinks"),n=this._themeService.getColorTheme(),d=dk().getColors().reduce((p,g)=>{const f=n.getColor(g.id);return f&&(p["vscode-"+g.id.replace(".","-")]=f.toString()),p},{}),l={"vscode-font-family":ck,"vscode-font-weight":"normal","vscode-font-size":"13px","vscode-editor-font-family":t,"vscode-editor-font-weight":i,"vscode-editor-font-size":s+"px","text-link-decoration":r?"underline":"none",...d,"vscode-editor-font-feature-settings":o},h=Oc.fromTheme(n);this._cachedWebViewThemeData={styles:l,activeTheme:h,themeLabel:n.label,themeId:n.settingsId}}return this._cachedWebViewThemeData}_reset(){this._cachedWebViewThemeData=void 0,this._onThemeDataChanged.fire()}};Rm=D([u(0,zR),u(1,te)],Rm);var Oc;(function(a){a.light="vscode-light",a.dark="vscode-dark",a.highContrast="vscode-high-contrast",a.highContrastLight="vscode-high-contrast-light"})(Oc||(Oc={}));(function(a){function e(t){switch(t.type){case ml.LIGHT:return a.light;case ml.DARK:return a.dark;case ml.HIGH_CONTRAST_DARK:return a.highContrast;case ml.HIGH_CONTRAST_LIGHT:return a.highContrastLight}}a.fromTheme=e})(Oc||(Oc={}));class AM{constructor(e,t,i){this._getExtensionLocation=e,this._getMappings=t,this.tunnelService=i,this._tunnels=new Map}async getRedirect(e,t){const i=F.parse(t),s=lk(i);if(s){for(const o of this._getMappings())if(o.webviewPort===s.port){const r=this._getExtensionLocation();if(r&&r.scheme===ue.vscodeRemote){const n=e&&await this.getOrCreateTunnel(e,o.extensionHostPort);if(n)return n.tunnelLocalPort===o.webviewPort?void 0:encodeURI(i.with({authority:`127.0.0.1:${n.tunnelLocalPort}`}).toString(!0))}if(o.webviewPort!==o.extensionHostPort)return encodeURI(i.with({authority:`${s.address}:${o.extensionHostPort}`}).toString(!0))}}}async dispose(){for(const e of this._tunnels.values())await e.dispose();this._tunnels.clear()}async getOrCreateTunnel(e,t){const i=this._tunnels.get(t);if(i)return i;const s=await this.tunnelService.openTunnel({getAddress:async()=>e},void 0,t);let o;return typeof s=="string"&&(o=void 0),o&&this._tunnels.set(t,o),o}}const TM=new Map([[".svg","image/svg+xml"],[".txt",Fd.text],[".css","text/css"],[".js","application/javascript"],[".cjs","application/javascript"],[".mjs","application/javascript"],[".json","application/json"],[".html","text/html"],[".htm","text/html"],[".xhtml","application/xhtml+xml"],[".oft","font/otf"],[".xml","application/xml"],[".wasm","application/wasm"]]);function kM(a){const e=hk(a.fsPath).toLowerCase();return TM.get(e)||uk(a.fsPath)||Fd.unknown}var mo;(function(a){let e;(function(s){s[s.Success=0]="Success",s[s.Failed=1]="Failed",s[s.AccessDenied=2]="AccessDenied",s[s.NotModified=3]="NotModified"})(e=a.Type||(a.Type={}));class t{constructor(o,r,n,d){this.stream=o,this.etag=r,this.mtime=n,this.mimeType=d,this.type=e.Success}}a.StreamSuccess=t,a.Failed={type:e.Failed},a.AccessDenied={type:e.AccessDenied};class i{constructor(o,r){this.mimeType=o,this.mtime=r,this.type=e.NotModified}}a.NotModified=i})(mo||(mo={}));async function xM(a,e,t,i,s){const o=LM(a,e.roots);if(i.trace(`Webview.loadLocalResource - trying to load resource. requestUri=${a}, resourceToLoad=${o}`),!o)return i.trace(`Webview.loadLocalResource - access denied. requestUri=${a}, resourceToLoad=${o}`),mo.AccessDenied;const r=kM(a);try{const n=await t.readFileStream(o,{etag:e.ifNoneMatch},s);return i.trace(`Webview.loadLocalResource - Loaded. requestUri=${a}, resourceToLoad=${o}`),new mo.StreamSuccess(n.value,n.etag,n.mtime,r)}catch(n){return n instanceof lE&&n.fileOperationResult===Ms.FILE_NOT_MODIFIED_SINCE?(i.trace(`Webview.loadLocalResource - not modified. requestUri=${a}, resourceToLoad=${o}`),new mo.NotModified(r,n.options?.mtime)):(i.error(`Webview.loadLocalResource - Error using fileReader. requestUri=${a}, resourceToLoad=${o}`),mo.Failed)}}function LM(a,e){for(const t of e)if(RM(t,a))return VM(a)}function RM(a,e){if(a.scheme!==e.scheme)return!1;let t=fy(e.fsPath),i=fy(a.fsPath+(a.fsPath.endsWith(Bd)?"":Bd));return my(a.fsPath)&&my(e.fsPath)&&(i=i.toLowerCase(),t=t.toLowerCase()),t.startsWith(i)}function VM(a){return a.scheme===ue.vscodeRemote?F.from({scheme:ue.vscodeRemote,authority:a.authority,path:"/vscode-resource",query:JSON.stringify({requestResourcePath:a.path})}):a}const PM=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));xe(PM);const OM=c(6165,"Find"),MM=c(6166,"Find"),NM=c(6167,"Previous Match"),FM=c(6168,"Next Match"),BM=c(6169,"Close"),El=310,GM=73;class WM extends Dp{constructor(e,t,i,s,o){super(),this._keybindingService=o,this._isVisible=!1,this._foundMatch=!1,this._width=0,this.state=this._register(new pk),this._matchesLimit=e.matchesLimit??Number.MAX_SAFE_INTEGER,this._findInput=this._register(new gk(null,t,{label:OM,placeholder:MM,validation:l=>{if(l.length===0||!this._findInput.getRegex())return null;try{return new RegExp(l),null}catch(h){return this._foundMatch=!1,this.updateButtons(this._foundMatch),{content:h.message}}},showCommonFindToggles:e.showCommonFindToggles,appendCaseSensitiveLabel:e.appendCaseSensitiveActionId?this._getKeybinding(e.appendCaseSensitiveActionId):void 0,appendRegexLabel:e.appendRegexActionId?this._getKeybinding(e.appendRegexActionId):void 0,appendWholeWordsLabel:e.appendWholeWordsActionId?this._getKeybinding(e.appendWholeWordsActionId):void 0,showHistoryHint:()=>sE(o),inputBoxStyles:Ap,toggleStyles:hE},i)),this._updateHistoryDelayer=this._register(new fk(500)),this._register(this._findInput.onInput(async l=>{(!e.checkImeCompletionState||!this._findInput.isImeSessionInProgress)&&(this._foundMatch=this._onInputChanged(),e.showResultCount&&await this.updateResultCount(),this.updateButtons(this._foundMatch),this.focusFindBox(),this._delayedUpdateHistory())})),this._findInput.setRegex(!!this.state.isRegex),this._findInput.setCaseSensitive(!!this.state.matchCase),this._findInput.setWholeWords(!!this.state.wholeWord),this._register(this._findInput.onDidOptionChange(()=>{this.state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this.state.onFindReplaceStateChange(()=>{this._findInput.setRegex(this.state.isRegex),this._findInput.setWholeWords(this.state.wholeWord),this._findInput.setCaseSensitive(this.state.matchCase),this.findFirst()}));const r={groupId:"simple-find-widget"};this.prevBtn=this._register(new lg({label:NM+(e.previousMatchActionId?this._getKeybinding(e.previousMatchActionId):""),icon:mk,hoverLifecycleOptions:r,onTrigger:()=>{this.find(!0)}},s)),this.nextBtn=this._register(new lg({label:FM+(e.nextMatchActionId?this._getKeybinding(e.nextMatchActionId):""),icon:wk,hoverLifecycleOptions:r,onTrigger:()=>{this.find(!1)}},s));const n=this._register(new lg({label:BM+(e.closeWidgetActionId?this._getKeybinding(e.closeWidgetActionId):""),icon:bk,hoverLifecycleOptions:r,onTrigger:()=>{this.hide()}},s));this._innerDomNode=ve("div"),this._innerDomNode.classList.add("simple-find-part"),this._innerDomNode.appendChild(this._findInput.domNode),this._innerDomNode.appendChild(this.prevBtn.domNode),this._innerDomNode.appendChild(this.nextBtn.domNode),this._innerDomNode.appendChild(n.domNode),this._domNode=ve("div"),this._domNode.classList.add("simple-find-part-wrapper"),this._domNode.appendChild(this._innerDomNode),this.onkeyup(this._innerDomNode,l=>{if(l.equals(w.Escape)){this.hide(),l.preventDefault();return}}),this._focusTracker=this._register(Eo(this._innerDomNode)),this._register(this._focusTracker.onDidFocus(this._onFocusTrackerFocus.bind(this))),this._register(this._focusTracker.onDidBlur(this._onFocusTrackerBlur.bind(this))),this._findInputFocusTracker=this._register(Eo(this._findInput.domNode)),this._register(this._findInputFocusTracker.onDidFocus(this._onFindInputFocusTrackerFocus.bind(this))),this._register(this._findInputFocusTracker.onDidBlur(this._onFindInputFocusTrackerBlur.bind(this))),this._register(X(this._innerDomNode,"click",l=>{l.stopPropagation()})),e?.showResultCount&&(this._domNode.classList.add("result-count"),this._matchesCount=ve("div"),this._matchesCount.className="matchesCount",this._findInput.domNode.insertAdjacentElement("afterend",this._matchesCount),this._register(this._findInput.onDidChange(async()=>{await this.updateResultCount()})),this._register(this._findInput.onDidOptionChange(async()=>{this._foundMatch=this._onInputChanged(),await this.updateResultCount(),this.focusFindBox(),this._delayedUpdateHistory()})));let d=e?.initialWidth;if(d&&(d=d<El?El:d,this._domNode.style.width=`${d}px`),e?.enableSash){const l=d??El;let h=l;const p=this._register(new vk(this._innerDomNode,this,{orientation:le.VERTICAL,size:1}));this._register(p.onDidStart(()=>{h=parseFloat(wy(this._domNode).width)})),this._register(p.onDidChange(g=>{const f=h+g.startX-g.currentX;f<l||(this._domNode.style.width=`${f}px`)})),this._register(p.onDidReset(g=>{parseFloat(wy(this._domNode).width)===l?this._domNode.style.width="100%":this._domNode.style.width=`${l}px`}))}}getVerticalSashLeft(e){return 0}get inputValue(){return this._findInput.getValue()}get focusTracker(){return this._focusTracker}_getKeybinding(e){const t=this._keybindingService?.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){super.dispose(),this._domNode?.remove()}isVisible(){return this._isVisible}getDomNode(){return this._domNode}getFindInputDomNode(){return this._findInput.domNode}reveal(e,t=!0){if(e&&this._findInput.setValue(e),this._isVisible){this._findInput.select();return}this._isVisible=!0,this.updateResultCount(),this.layout(),setTimeout(()=>{this._innerDomNode.classList.toggle("suppress-transition",!t),this._innerDomNode.classList.add("visible","visible-transition"),this._innerDomNode.setAttribute("aria-hidden","false"),this._findInput.select(),t||setTimeout(()=>{this._innerDomNode.classList.remove("suppress-transition")},0)},0)}show(e){e&&!this._isVisible&&this._findInput.setValue(e),this._isVisible=!0,this.layout(),setTimeout(()=>{this._innerDomNode.classList.add("visible","visible-transition"),this._innerDomNode.setAttribute("aria-hidden","false")},0)}hide(e=!0){this._isVisible&&(this._innerDomNode.classList.toggle("suppress-transition",!e),this._innerDomNode.classList.remove("visible-transition"),this._innerDomNode.setAttribute("aria-hidden","true"),setTimeout(()=>{this._isVisible=!1,this.updateButtons(this._foundMatch),this._innerDomNode.classList.remove("visible","suppress-transition")},e?200:0))}layout(e=this._width){if(this._width=e,!!this._isVisible&&this._matchesCount){let t=!1;El+GM+28>=e&&(t=!0),this._innerDomNode.classList.toggle("reduced-find-widget",t)}}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this))}_updateHistory(){this._findInput.inputBox.addToHistory()}_getRegexValue(){return this._findInput.getRegex()}_getWholeWordValue(){return this._findInput.getWholeWords()}_getCaseSensitiveValue(){return this._findInput.getCaseSensitive()}updateButtons(e){const t=this.inputValue.length>0;this.prevBtn.setEnabled(this._isVisible&&t&&e),this.nextBtn.setEnabled(this._isVisible&&t&&e)}focusFindBox(){this.nextBtn.focus(),this._findInput.inputBox.focus()}async updateResultCount(){if(!this._matchesCount){this.updateButtons(this._foundMatch);return}const e=await this._getResultCount();this._matchesCount.textContent="";const t=this.inputValue.length>0&&e?.resultCount===0;this._matchesCount.classList.toggle("no-results",t);let i="";if(e?.resultCount){let s=String(e.resultCount);e.resultCount>=this._matchesLimit&&(s+="+");let o=String(e.resultIndex+1);o==="0"&&(o="?"),i=xd(Ck,o,s)}else i=by;yk(this._announceSearchResults(i,this.inputValue)),this._matchesCount.appendChild(Xg(i)),this._foundMatch=!!e&&e.resultCount>0,this.updateButtons(this._foundMatch)}changeState(e){this.state.change(e,!1)}_announceSearchResults(e,t){return t?e===by?t===""?c(6171,"{0} found",e):c(6172,"{0} found for '{1}'",e,t):c(6173,"{0} found for '{1}'",e,t):c(6170,"Enter search input")}}const KM=De("simpleFindWidget.sashBorder",{dark:"#454545",light:"#C8C8C8",hcDark:"#6FC3DF",hcLight:"#0F4A85"},c(6174,"Border color of the sash border."));Vb((a,e)=>{const t=a.getColor(KM);e.addRule(`.monaco-workbench .simple-find-part .monaco-sash { background-color: ${t}; border-color: ${t} }`)});let Vm=class extends WM{async _getResultCount(e){}constructor(e,t,i,s,o){super({showCommonFindToggles:!1,checkImeCompletionState:e.checkImeCompletionState,enableSash:!0},t,i,s,o),this._delegate=e,this._findWidgetFocused=qb.bindTo(i),this._register(e.hasFindResult(r=>{this.updateButtons(r),this.focusFindBox()})),this._register(e.onDidStopFind(()=>{this.updateButtons(!1)}))}find(e){const t=this.inputValue;t&&this._delegate.find(t,e)}hide(e=!0){super.hide(e),this._delegate.stopFind(!0),this._delegate.focus()}_onInputChanged(){const e=this.inputValue;return e?this._delegate.updateFind(e):this._delegate.stopFind(!1),!1}_onFocusTrackerFocus(){this._findWidgetFocused.set(!0)}_onFocusTrackerBlur(){this._findWidgetFocused.reset()}_onFindInputFocusTrackerFocus(){}_onFindInputFocusTrackerBlur(){}findFirst(){}};Vm=D([u(1,Bn),u(2,de),u(3,oi),u(4,ot)],Vm);var Ko;(function(a){let e;(function(i){i[i.Initializing=0]="Initializing",i[i.Ready=1]="Ready"})(e=a.Type||(a.Type={}));class t{constructor(s){this.pendingMessages=s,this.type=e.Initializing}}a.Initializing=t,a.Ready={type:e.Ready}})(Ko||(Ko={}));const UM="webviewId";let Pm=class extends M{get window(){return typeof this._windowId=="number"?$c(this._windowId)?.window:void 0}get platform(){return"browser"}get element(){return this._element}get isFocused(){if(!this._focused||!this.window)return!1;const e=Hs(this.window.document);return!(e&&e!==this.element)}constructor(e,t,i,s,o,r,n,d,l,h,p,g){super(),this.webviewThemeDataProvider=t,this._environmentService=r,this._fileService=n,this._logService=d,this._remoteAuthorityResolverService=l,this._tunnelService=h,this._accessibilityService=g,this.id=fd(),this._windowId=void 0,this._expectedServiceWorkerVersion=4,this._state=new Ko.Initializing([]),this._resourceLoadingCts=this._register(new _o),this._focusDelayer=this._register(new Sk(50)),this._onDidHtmlChange=this._register(new A),this.onDidHtmlChange=this._onDidHtmlChange.event,this._messageHandlers=new Map,this.checkImeCompletionState=!0,this.intrinsicContentSize=hs("WebviewIntrinsicContentSize",void 0),this._disposed=!1,this._onMissingCsp=this._register(new A),this.onMissingCsp=this._onMissingCsp.event,this._onDidClickLink=this._register(new A),this.onDidClickLink=this._onDidClickLink.event,this._onMessage=this._register(new A),this.onMessage=this._onMessage.event,this._onDidScroll=this._register(new A),this.onDidScroll=this._onDidScroll.event,this._onDidWheel=this._register(new A),this.onDidWheel=this._onDidWheel.event,this._onDidUpdateState=this._register(new A),this.onDidUpdateState=this._onDidUpdateState.event,this._onDidFocus=this._register(new A),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new A),this.onDidBlur=this._onDidBlur.event,this._onFatalError=this._register(new A),this.onFatalError=this._onFatalError.event,this._onDidDispose=this._register(new A),this.onDidDispose=this._onDidDispose.event,this._hasAlertedAboutMissingCsp=!1,this._hasFindResult=this._register(new A),this.hasFindResult=this._hasFindResult.event,this._onDidStopFind=this._register(new A),this.onDidStopFind=this._onDidStopFind.event,this.providedViewType=e.providedViewType,this.origin=e.origin??this.id,this._options=e.options,this.extension=e.extension,this._content={html:"",title:e.title,options:e.contentOptions,state:void 0},this._portMappingManager=this._register(new AM(()=>this.extension?.location,()=>this._content.options.portMapping||[],this._tunnelService)),this._element=this._createElement(e.options,e.contentOptions),this._register(this.on("no-csp-found",()=>{this.handleNoCspFound()})),this._register(this.on("did-click-link",({uri:f})=>{this._onDidClickLink.fire(f)})),this._register(this.on("onmessage",({message:f,transfer:m})=>{this._onMessage.fire({message:f,transfer:m})})),this._register(this.on("did-scroll",({scrollYPercentage:f})=>{this._onDidScroll.fire({scrollYPercentage:f})})),this._register(this.on("do-reload",()=>{this.reload()})),this._register(this.on("do-update-state",f=>{this.state=f,this._onDidUpdateState.fire(f)})),this._register(this.on("did-focus",()=>{this.handleFocusChange(!0)})),this._register(this.on("did-blur",()=>{this.handleFocusChange(!1)})),this._register(this.on("did-scroll-wheel",f=>{this._onDidWheel.fire(f)})),this._register(this.on("did-find",({didFind:f})=>{this._hasFindResult.fire(f)})),this._register(this.on("fatal-error",f=>{o.error(c(13158,"Error loading webview: {0}",f.message)),this._onFatalError.fire({message:f.message})})),this._register(this.on("did-keydown",f=>{this.handleKeyEvent("keydown",f)})),this._register(this.on("did-keyup",f=>{this.handleKeyEvent("keyup",f)})),this._register(this.on("did-context-menu",f=>{if(!this.element||!this._contextKeyService)return;const m=this.element.getBoundingClientRect(),v=this._contextKeyService.createOverlay([...Object.entries(f.context),[UM,this.providedViewType]]);s.showContextMenu({menuId:b.WebviewContext,menuActionOptions:{shouldForwardArgs:!0},contextKeyService:v,getActionsContext:()=>({...f.context,webview:this.providedViewType}),getAnchor:()=>({x:m.x+f.clientX,y:m.y+f.clientY})}),this._send("set-context-menu-visible",{visible:!0})})),this._register(this.on("load-resource",async f=>{try{const m=Ek(f.authority),v=F.from({scheme:f.scheme,authority:m,path:decodeURIComponent(f.path),query:f.query?decodeURIComponent(f.query):f.query});this.loadResource(f.id,v,f.ifNoneMatch)}catch{this._send("did-load-resource",{id:f.id,status:404,path:f.path})}})),this._register(this.on("load-localhost",f=>{this.localLocalhost(f.id,f.origin)})),this._register(K.runAndSubscribe(t.onThemeDataChanged,()=>this.style())),this._register(g.onDidChangeReducedMotion(()=>this.style())),this._register(g.onDidChangeScreenReaderOptimized(()=>this.style())),this._register(s.onDidHideContextMenu(()=>this._send("set-context-menu-visible",{visible:!1}))),this._confirmBeforeClose=i.getValue("window.confirmBeforeClose"),this._register(i.onDidChangeConfiguration(f=>{f.affectsConfiguration("window.confirmBeforeClose")&&(this._confirmBeforeClose=i.getValue("window.confirmBeforeClose"),this._send("set-confirm-before-close",this._confirmBeforeClose))})),this._register(this.on("drag-start",()=>{this._startBlockingIframeDragEvents()})),this._register(this.on("drag",f=>{this.handleDragEvent("drag",f)})),this._register(this.on("updated-intrinsic-content-size",f=>{this.intrinsicContentSize.set({width:f.width,height:f.height},void 0,void 0)})),e.options.enableFindWidget&&(this._webviewFindWidget=this._register(p.createInstance(Vm,this)))}dispose(){if(this._disposed=!0,this.element?.remove(),this._element=void 0,this._messagePort=void 0,this._state.type===Ko.Type.Initializing){for(const e of this._state.pendingMessages)e.resolve(!1);this._state.pendingMessages=[]}this._onDidDispose.fire(),this._resourceLoadingCts.dispose(!0),super.dispose()}setContextKeyService(e){this._contextKeyService=e}postMessage(e,t){return this._send("message",{message:e,transfer:t})}async _send(e,t,i=[]){if(this._state.type===Ko.Type.Initializing){const{promise:s,resolve:o}=uE();return this._state.pendingMessages.push({channel:e,data:t,transferable:i,resolve:o}),s}else return this.doPostMessage(e,t,i)}_createElement(e,t){const i=ve("iframe");i.name=this.id,i.className=`webview ${e.customClasses||""}`,i.sandbox.add("allow-scripts","allow-same-origin","allow-forms","allow-pointer-lock","allow-downloads");const s=["cross-origin-isolated","autoplay","local-network-access"];return LS||s.push("clipboard-read","clipboard-write"),i.setAttribute("allow",s.join("; ")),i.style.border="none",i.style.width="100%",i.style.height="100%",i.focus=()=>{this._doFocus()},i}_initElement(e,t,i,s){const o={id:this.id,parentId:s.vscodeWindowId.toString(),origin:this.origin,swVersion:String(this._expectedServiceWorkerVersion),extensionId:t?.id.value??"",platform:this.platform,"vscode-resource-base-authority":Ik,parentOrigin:s.origin};this._options.disableServiceWorker&&(o.disableServiceWorker="true"),this._environmentService.remoteAuthority&&(o.remoteAuthority=this._environmentService.remoteAuthority),i.purpose&&(o.purpose=i.purpose),o.serviceWorkerUri=Gd.asBrowserUri("vs/workbench/contrib/webview/browser/pre/service-worker.js").toString(!0),o.fakeHtmlUri=Gd.asBrowserUri("vs/workbench/contrib/webview/browser/pre/fake.html").toString(!0),_k.addSearchParam(o,!0,!0);const r=new URLSearchParams(o).toString();this.perfMark("init/set-src");const n=Gd.asBrowserUri("vs/workbench/contrib/webview/browser/pre/index.html");this.element.setAttribute("src",`${n.toString(!0)}?${r}`)}mountTo(e,t){if(this.element){this._windowId=t.vscodeWindowId,this._encodedWebviewOriginPromise=Dk(t.origin,this.origin).then(i=>this._encodedWebviewOrigin=i),this._encodedWebviewOriginPromise.then(i=>{this._disposed||this._initElement(i,this.extension,this._options,t)}),this._registerMessageHandler(t),this._webviewFindWidget&&e.appendChild(this._webviewFindWidget.getDomNode());for(const i of[Q.MOUSE_DOWN,Q.MOUSE_MOVE,Q.DROP])this._register(X(e,i,()=>{this._stopBlockingIframeDragEvents()}));for(const i of[e,t])this._register(X(i,Q.DRAG_END,()=>{this._stopBlockingIframeDragEvents()}));e.id=this.id,this.perfMark("mounted"),e.appendChild(this.element)}}_registerMessageHandler(e){const t=this._register(X(e,"message",i=>{if(!(!this._encodedWebviewOrigin||i?.data?.target!==this.id)&&i.data.channel==="webview-ready"){if(this._messagePort)return;this.perfMark("webview-ready"),this._logService.trace(`Webview(${this.id}): webview ready`),this._messagePort=i.ports[0],this._messagePort.onmessage=s=>{const o=this._messageHandlers.get(s.data.channel);if(!o){console.log(`No handlers found for '${s.data.channel}'`);return}o?.forEach(r=>r(s.data.data,s))},this.element?.classList.add("ready"),this._state.type===Ko.Type.Initializing&&this._state.pendingMessages.forEach(({channel:s,data:o,resolve:r})=>r(this.doPostMessage(s,o))),this._state=Ko.Ready,t.dispose()}}))}perfMark(e){performance.mark(`webview/webviewElement/${e}`,{detail:{id:this.id}})}_startBlockingIframeDragEvents(){this.element&&(this.element.style.pointerEvents="none")}_stopBlockingIframeDragEvents(){this.element&&(this.element.style.pointerEvents="auto")}webviewContentEndpoint(e){const t=this._environmentService.webviewExternalEndpoint;if(!t)throw new Error("'webviewExternalEndpoint' has not been configured. Webviews will not work!");const i=t.replace("{{uuid}}",e);return i[i.length-1]==="/"?i.slice(0,i.length-1):i}doPostMessage(e,t,i=[]){return this.element&&this._messagePort?(this._messagePort.postMessage({channel:e,args:t},i),!0):!1}on(e,t){let i=this._messageHandlers.get(e);return i||(i=new Set,this._messageHandlers.set(e,i)),i.add(t),pe(()=>{this._messageHandlers.get(e)?.delete(t)})}handleNoCspFound(){this._hasAlertedAboutMissingCsp||(this._hasAlertedAboutMissingCsp=!0,this.extension?.id&&this._environmentService.isExtensionDevelopment&&this._onMissingCsp.fire(this.extension.id))}reload(){this.doUpdateContent(this._content)}reinitializeAfterDismount(){this._state=new Ko.Initializing([]),this._messagePort=void 0,this.mountTo(this.element.parentElement,He(this.element)),this.reload()}setHtml(e){this.doUpdateContent({...this._content,html:e}),this._onDidHtmlChange.fire(e)}setTitle(e){this._content={...this._content,title:e},this._send("set-title",e)}set contentOptions(e){if(this._logService.debug(`Webview(${this.id}): will update content options`),Ak(e,this._content.options)){this._logService.debug(`Webview(${this.id}): skipping content options update`);return}this.doUpdateContent({...this._content,options:e})}set localResourcesRoot(e){this._content={...this._content,options:{...this._content.options,localResourceRoots:e}}}set state(e){this._content={...this._content,state:e}}set initialScrollProgress(e){this._send("initial-scroll-position",e)}doUpdateContent(e){this._logService.debug(`Webview(${this.id}): will update content`),this._content=e;const t=!!this._content.options.allowScripts;this.perfMark("set-content"),this._send("content",{contents:this._content.html,title:this._content.title,options:{allowMultipleAPIAcquire:!!this._content.options.allowMultipleAPIAcquire,allowScripts:t,allowForms:this._content.options.allowForms??t},state:this._content.state,cspSource:Tk,confirmBeforeClose:this._confirmBeforeClose})}style(){let{styles:e,activeTheme:t,themeLabel:i,themeId:s}=this.webviewThemeDataProvider.getWebviewThemeData();this._options.transformCssVariables&&(e=this._options.transformCssVariables(e));const o=this._accessibilityService.isMotionReduced(),r=this._accessibilityService.isScreenReaderOptimized();this._send("styles",{styles:e,activeTheme:t,themeId:s,themeLabel:i,reduceMotion:o,screenReader:r})}handleFocusChange(e){this._focused=e,e?this._onDidFocus.fire():this._onDidBlur.fire()}handleKeyEvent(e,t){const i=new KeyboardEvent(e,t);Object.defineProperty(i,"target",{get:()=>this.element}),this.window?.dispatchEvent(i)}handleDragEvent(e,t){const i=new DragEvent(e,t);Object.defineProperty(i,"target",{get:()=>this.element}),this.window?.dispatchEvent(i)}windowDidDragStart(){this._startBlockingIframeDragEvents()}windowDidDragEnd(){this._stopBlockingIframeDragEvents()}selectAll(){this.execCommand("selectAll")}copy(){this.execCommand("copy")}paste(){this.execCommand("paste")}cut(){this.execCommand("cut")}undo(){this.execCommand("undo")}redo(){this.execCommand("redo")}execCommand(e){this.element&&this._send("execCommand",e)}async loadResource(e,t,i){try{const s=await xM(t,{ifNoneMatch:i,roots:this._content.options.localResourceRoots||[]},this._fileService,this._logService,this._resourceLoadingCts.token);switch(s.type){case mo.Type.Success:{const o=await this.streamToBuffer(s.stream);return this._send("did-load-resource",{id:e,status:200,path:t.path,mime:s.mimeType,data:o,etag:s.etag,mtime:s.mtime},[o])}case mo.Type.NotModified:return this._send("did-load-resource",{id:e,status:304,path:t.path,mime:s.mimeType,mtime:s.mtime});case mo.Type.AccessDenied:return this._send("did-load-resource",{id:e,status:401,path:t.path})}}catch{}return this._send("did-load-resource",{id:e,status:404,path:t.path})}async streamToBuffer(e){return(await kk(e)).buffer.buffer}async localLocalhost(e,t){const i=this._environmentService.remoteAuthority,s=i?await this._remoteAuthorityResolverService.resolveAuthority(i):void 0,o=s?await this._portMappingManager.getRedirect(s.authority,t):void 0;return this._send("did-load-localhost",{id:e,origin:t,location:o})}focus(){this._doFocus(),this.handleFocusChange(!0)}_doFocus(){if(this.element){try{this.element.contentWindow?.focus()}catch{}this._focusDelayer.trigger(async()=>{if(!(!this.isFocused||!this.element)){if(this.window){const e=Hs(this.window?.document);if(e&&e!==this.element&&e?.tagName!=="BODY")return}this.window?.document.body?.focus(),this._send("focus",void 0)}})}}find(e,t){this.element&&this._send("find",{value:e,previous:t})}updateFind(e){!e||!this.element||this._send("find",{value:e})}stopFind(e){this.element&&(this._send("find-stop",{clearSelection:!e}),this._onDidStopFind.fire())}showFind(e=!0){this._webviewFindWidget?.reveal(void 0,e)}hideFind(e=!0){this._webviewFindWidget?.hide(e)}runFindAction(e){this._webviewFindWidget?.find(e)}};Pm=D([u(2,te),u(3,st),u(4,Qe),u(5,wi),u(6,Ve),u(7,et),u(8,xk),u(9,Fi),u(10,z),u(11,Lk)],Pm);let Om=class extends M{get window(){return $c(this._windowId,!0).window}constructor(e,t,i,s){super(),this._layoutService=t,this._webviewService=i,this._baseContextKeyService=s,this._isFirstLoad=!0,this._firstLoadPendingMessages=new Set,this._webview=this._register(new Ae),this._webviewEvents=this._register(new B),this._html="",this._initialScrollProgress=0,this._state=void 0,this._owner=void 0,this._windowId=void 0,this._scopedContextKeyService=this._register(new Ae),this._shouldShowFindWidgetOnRestore=!1,this._isDisposed=!1,this._onDidDispose=this._register(new A),this.onDidDispose=this._onDidDispose.event,this._onDidFocus=this._register(new A),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new A),this.onDidBlur=this._onDidBlur.event,this._onDidClickLink=this._register(new A),this.onDidClickLink=this._onDidClickLink.event,this._onDidScroll=this._register(new A),this.onDidScroll=this._onDidScroll.event,this._onDidUpdateState=this._register(new A),this.onDidUpdateState=this._onDidUpdateState.event,this._onMessage=this._register(new A),this.onMessage=this._onMessage.event,this._onMissingCsp=this._register(new A),this.onMissingCsp=this._onMissingCsp.event,this._onDidWheel=this._register(new A),this.onDidWheel=this._onDidWheel.event,this._onFatalError=this._register(new A),this.onFatalError=this._onFatalError.event,this.intrinsicContentSize=hs("WebviewIntrinsicContentSize",void 0),this.providedViewType=e.providedViewType,this.origin=e.origin??fd(),this._title=e.title,this._extension=e.extension,this._options=e.options,this._contentOptions=e.contentOptions}get isFocused(){return!!this._webview.value?.isFocused}dispose(){this._isDisposed=!0,this._container?.domNode.remove(),this._container=void 0;for(const e of this._firstLoadPendingMessages)e.resolve(!1);this._firstLoadPendingMessages.clear(),this._onDidDispose.fire(),super.dispose()}get container(){if(this._isDisposed)throw new Error("OverlayWebview has been disposed");if(!this._container){const e=ve("div");e.style.position="absolute",e.style.overflow="hidden",this._container=new Rk(e),this._container.setVisibility("hidden"),this._layoutService.getContainer(this.window).appendChild(e)}return this._container.domNode}claim(e,t,i){if(this._isDisposed)return;const s=this._owner;if(this._windowId!==t.vscodeWindowId&&(this.release(s),this._webview.clear(),this._webviewEvents.clear(),this._container?.domNode.remove(),this._container=void 0),this._owner=e,this._windowId=t.vscodeWindowId,this._show(t),s!==e){const o=i||this._baseContextKeyService;this._scopedContextKeyService.clear(),this._scopedContextKeyService.value=o.createScoped(this.container);const r=this._findWidgetVisible?.get();this._findWidgetVisible?.reset(),this._findWidgetVisible=pE.bindTo(o),this._findWidgetVisible.set(!!r),this._findWidgetEnabled?.reset(),this._findWidgetEnabled=gE.bindTo(o),this._findWidgetEnabled.set(!!this.options.enableFindWidget),this._webview.value?.setContextKeyService(this._scopedContextKeyService.value)}}release(e){this._owner===e&&(this._scopedContextKeyService.clear(),this._owner=void 0,this._container&&this._container.setVisibility("hidden"),this._options.retainContextWhenHidden?(this._shouldShowFindWidgetOnRestore=!!this._findWidgetVisible?.get(),this.hideFind(!1)):(this._webview.clear(),this._webviewEvents.clear()))}layoutWebviewOverElement(e,t,i){if(!this._container||!this._container.domNode.parentElement)return;const s=this._layoutService.whenContainerStylesLoaded(this.window);s?s.then(()=>this.doLayoutWebviewOverElement(e,t,i)):this.doLayoutWebviewOverElement(e,t,i)}doLayoutWebviewOverElement(e,t,i){if(!this._container||!this._container.domNode.parentElement)return;const s=e.getBoundingClientRect(),o=this._container.domNode.parentElement.getBoundingClientRect(),r=(o.height-this._container.domNode.parentElement.clientHeight)/2,n=(o.width-this._container.domNode.parentElement.clientWidth)/2;if(this._container.setTop(s.top-o.top-r),this._container.setLeft(s.left-o.left-n),this._container.setWidth(t?t.width:s.width),this._container.setHeight(t?t.height:s.height),i){const{top:d,left:l,right:h,bottom:p}=HM(s,i);this._container.domNode.style.clipPath=`polygon(${l}px ${d}px, ${h}px ${d}px, ${h}px ${p}px, ${l}px ${p}px)`}}_show(e){if(this._isDisposed)throw new Error("OverlayWebview is disposed");if(!this._webview.value){const t=this._webviewService.createWebviewElement({providedViewType:this.providedViewType,origin:this.origin,title:this._title,options:this._options,contentOptions:this._contentOptions,extension:this.extension});this._webview.value=t,t.state=this._state,this._scopedContextKeyService.value&&this._webview.value.setContextKeyService(this._scopedContextKeyService.value),this._html&&t.setHtml(this._html),this._options.tryRestoreScrollPosition&&(t.initialScrollProgress=this._initialScrollProgress),this._findWidgetEnabled?.set(!!this.options.enableFindWidget),t.mountTo(this.container,e),this._webviewEvents.clear(),this._webviewEvents.add(t.onDidFocus(()=>{this._onDidFocus.fire()})),this._webviewEvents.add(t.onDidBlur(()=>{this._onDidBlur.fire()})),this._webviewEvents.add(t.onDidClickLink(i=>{this._onDidClickLink.fire(i)})),this._webviewEvents.add(t.onMessage(i=>{this._onMessage.fire(i)})),this._webviewEvents.add(t.onMissingCsp(i=>{this._onMissingCsp.fire(i)})),this._webviewEvents.add(t.onDidWheel(i=>{this._onDidWheel.fire(i)})),this._webviewEvents.add(t.onFatalError(i=>{this._onFatalError.fire(i)})),this._webviewEvents.add(ts(i=>{this.intrinsicContentSize.set(i.readObservable(t.intrinsicContentSize),void 0,void 0)})),this._webviewEvents.add(t.onDidScroll(i=>{this._initialScrollProgress=i.scrollYPercentage,this._onDidScroll.fire(i)})),this._webviewEvents.add(t.onDidUpdateState(i=>{this._state=i,this._onDidUpdateState.fire(i)})),this._isFirstLoad&&this._firstLoadPendingMessages.forEach(async i=>{i.resolve(await t.postMessage(i.message,i.transfer))}),this._isFirstLoad=!1,this._firstLoadPendingMessages.clear()}this.options.retainContextWhenHidden&&this._shouldShowFindWidgetOnRestore&&(this.showFind(!1),this._shouldShowFindWidgetOnRestore=!1),this._container?.setVisibility("visible")}setHtml(e){this._html=e,this._withWebview(t=>t.setHtml(e))}setTitle(e){this._title=e,this._withWebview(t=>t.setTitle(e))}get initialScrollProgress(){return this._initialScrollProgress}set initialScrollProgress(e){this._initialScrollProgress=e,this._withWebview(t=>t.initialScrollProgress=e)}get state(){return this._state}set state(e){this._state=e,this._withWebview(t=>t.state=e)}get extension(){return this._extension}set extension(e){this._extension=e,this._withWebview(t=>t.extension=e)}get options(){return this._options}set options(e){this._options={customClasses:this._options.customClasses,...e}}get contentOptions(){return this._contentOptions}set contentOptions(e){this._contentOptions=e,this._withWebview(t=>t.contentOptions=e)}set localResourcesRoot(e){this._withWebview(t=>t.localResourcesRoot=e)}async postMessage(e,t){if(this._webview.value)return this._webview.value.postMessage(e,t);if(this._isFirstLoad){let i;const s=new Promise(o=>i=o);return this._firstLoadPendingMessages.add({message:e,transfer:t,resolve:i}),s}return!1}focus(){this._webview.value?.focus()}reload(){this._webview.value?.reload()}selectAll(){this._webview.value?.selectAll()}copy(){this._webview.value?.copy()}paste(){this._webview.value?.paste()}cut(){this._webview.value?.cut()}undo(){this._webview.value?.undo()}redo(){this._webview.value?.redo()}showFind(e=!0){this._webview.value&&(this._webview.value.showFind(e),this._findWidgetVisible?.set(!0))}hideFind(e=!0){this._findWidgetVisible?.reset(),this._webview.value?.hideFind(e)}runFindAction(e){this._webview.value?.runFindAction(e)}_withWebview(e){this._webview.value&&e(this._webview.value)}windowDidDragStart(){this._webview.value?.windowDidDragStart()}windowDidDragEnd(){this._webview.value?.windowDidDragEnd()}setContextKeyService(e){this._webview.value?.setContextKeyService(e)}};Om=D([u(1,je),u(2,Hn),u(3,de)],Om);function HM(a,e){const t=e.getBoundingClientRect(),i=Math.max(t.top-a.top,0),s=Math.max(a.width-(a.right-t.right),0),o=Math.max(a.height-(a.bottom-t.bottom),0),r=Math.max(t.left-a.left,0);return{top:i,right:s,bottom:o,left:r}}let Mm=class extends M{constructor(e){super(),this._instantiationService=e,this._webviews=new Set,this._onDidChangeActiveWebview=this._register(new A),this.onDidChangeActiveWebview=this._onDidChangeActiveWebview.event,this._webviewThemeDataProvider=this._instantiationService.createInstance(Rm)}get activeWebview(){return this._activeWebview}_updateActiveWebview(e){e!==this._activeWebview&&(this._activeWebview=e,this._onDidChangeActiveWebview.fire(e))}get webviews(){return this._webviews.values()}createWebviewElement(e){const t=this._instantiationService.createInstance(Pm,e,this._webviewThemeDataProvider);return this.registerNewWebview(t),t}createWebviewOverlay(e){const t=this._instantiationService.createInstance(Om,e);return this.registerNewWebview(t),t}registerNewWebview(e){this._webviews.add(e);const t=new B;t.add(e.onDidFocus(()=>{this._updateActiveWebview(e)}));const i=()=>{this._activeWebview===e&&this._updateActiveWebview(void 0)};t.add(e.onDidBlur(i)),t.add(e.onDidDispose(()=>{i(),t.dispose(),this._webviews.delete(e)}))}};Mm=D([u(0,z)],Mm);class zM extends M{constructor(){super(...arguments),this._resolvers=new Map,this._awaitingRevival=new Map,this._onNewResolverRegistered=this._register(new A),this.onNewResolverRegistered=this._onNewResolverRegistered.event}register(e,t){if(this._resolvers.has(e))throw new Error(`View resolver already registered for ${e}`);this._resolvers.set(e,t),this._onNewResolverRegistered.fire({viewType:e});const i=this._awaitingRevival.get(e);return i&&t.resolve(i.webview,Ni.None).then(()=>{this._awaitingRevival.delete(e),i.resolve()}),pe(()=>{this._resolvers.delete(e)})}resolve(e,t,i){const s=this._resolvers.get(e);if(!s){if(this._awaitingRevival.has(e))throw new Error("View already awaiting revival");const{promise:o,resolve:r}=uE();return this._awaitingRevival.set(e,{webview:t,resolve:r}),o}return s.resolve(t,i)}}const $M=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),qM=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));xe(qM);var Qd;(function(a){a[a.Horizontal=0]="Horizontal",a[a.Vertical=1]="Vertical"})(Qd||(Qd={}));class jM extends M{constructor(e,t,i,s){if(super(),this.container=e,this.message=t,this.options=s,this.modalElement=this.container.appendChild(N(".monaco-dialog-modal-block.dimmed")),this._register(wb(this.modalElement,Q.CLICK,d=>{d.target===this.modalElement&&this.element.focus()})),this.shadowElement=this.modalElement.appendChild(N(".dialog-shadow")),this.element=this.shadowElement.appendChild(N(".monaco-dialog-box")),s.alignment===Qd.Vertical&&this.element.classList.add("align-vertical"),s.extraClasses&&this.element.classList.add(...s.extraClasses),this.element.setAttribute("role","dialog"),this.element.tabIndex=-1,ur(this.element),this.options.renderFooter){this.footerContainer=this.element.appendChild(N(".dialog-footer-row"));const d=this.footerContainer.appendChild(N("#monaco-dialog-footer.dialog-footer"));this.options.renderFooter(d);for(const l of this.footerContainer.querySelectorAll("a"))l.tabIndex=0}this.buttonStyles=s.buttonStyles,Array.isArray(i)&&i.length>0?this.buttons=i:this.options.disableDefaultAction?this.buttons=[]:this.buttons=[c(3,"OK")];const o=this.element.appendChild(N(".dialog-buttons-row"));this.buttonsContainer=o.appendChild(N(".dialog-buttons"));const r=this.element.appendChild(N(".dialog-message-row"));if(this.iconElement=r.appendChild(N("#monaco-dialog-icon.dialog-icon")),this.iconElement.setAttribute("aria-label",this.getIconAriaLabel()),this.messageContainer=r.appendChild(N(".dialog-message-container")),this.options.detail||this.options.renderBody){const l=this.messageContainer.appendChild(N(".dialog-message")).appendChild(N("#monaco-dialog-message-text.dialog-message-text"));l.innerText=this.message}if(this.messageDetailElement=this.messageContainer.appendChild(N("#monaco-dialog-message-detail.dialog-message-detail")),this.options.detail||!this.options.renderBody?this.messageDetailElement.innerText=this.options.detail?this.options.detail:t:this.messageDetailElement.style.display="none",this.options.renderBody){const d=this.messageContainer.appendChild(N("#monaco-dialog-message-body.dialog-message-body"));this.options.renderBody(d);for(const l of this.messageContainer.querySelectorAll("a"))l.tabIndex=0}if(this.options.inputs?this.inputs=this.options.inputs.map(d=>{const l=this.messageContainer.appendChild(N(".dialog-message-input")),h=this._register(new fE(l,void 0,{placeholder:d.placeholder,type:d.type??"text",inputBoxStyles:s.inputBoxStyles}));return d.value&&(h.value=d.value),h}):this.inputs=[],this.options.checkboxLabel){const d=this.messageContainer.appendChild(N(".dialog-checkbox-row")),l=this.checkbox=this._register(new mE(this.options.checkboxLabel,!!this.options.checkboxChecked,s.checkboxStyles));d.appendChild(l.domNode);const h=d.appendChild(N(".dialog-checkbox-message"));h.innerText=this.options.checkboxLabel,this._register(X(h,Q.CLICK,()=>l.checked=!l.checked))}const n=this.element.appendChild(N(".dialog-toolbar-row"));this.toolbarContainer=n.appendChild(N(".dialog-toolbar")),this.applyStyles()}getIconAriaLabel(){let e=c(4,"Info");switch(this.options.type){case"error":e=c(5,"Error");break;case"warning":e=c(6,"Warning");break;case"pending":e=c(7,"In Progress");break}return e}updateMessage(e){this.messageDetailElement.innerText=e}async show(){return this.focusToReturn=Hs(this.container.ownerDocument),new Promise(e=>{Ut(this.buttonsContainer);const t=()=>{e({button:this.options.cancelId||0,checkboxChecked:this.checkbox?this.checkbox.checked:void 0})};this._register(pe(t));const i=this.buttonBar=this._register(new mb(this.buttonsContainer,{alignment:this.options?.alignment===Qd.Vertical?vy.Vertical:vy.Horizontal})),s=this.rearrangeButtons(this.buttons,this.options.cancelId),o=d=>{e({button:s[d].index,checkboxChecked:this.checkbox?this.checkbox.checked:void 0,values:this.inputs.length>0?this.inputs.map(l=>l.value):void 0})};s.forEach((d,l)=>{const h=s[l].index===0;let p;const g=this.options.buttonOptions?.[s[l]?.index];if(h&&this.options?.primaryButtonDropdown){const f=Vk(this.options.primaryButtonDropdown.actions)?this.options.primaryButtonDropdown.actions.getActions():this.options.primaryButtonDropdown.actions;p=this._register(i.addButtonWithDropdown({...this.options.primaryButtonDropdown,...this.buttonStyles,dropdownLayer:2600,actions:f.map(m=>Gt({...m,run:async()=>{await m.run(),o(l)}}))}))}else g?.sublabel?p=this._register(i.addButtonWithDescription({secondary:!h,...this.buttonStyles})):p=this._register(i.addButton({secondary:!h,...this.buttonStyles}));g?.styleButton&&g.styleButton(p),p.label=wE(s[l].label,!0),p instanceof Pk&&g?.sublabel&&(p.description=g?.sublabel),this._register(p.onDidClick(f=>{f&&be.stop(f),o(l)}))});const r=He(this.container);this._register(X(r,"keydown",d=>{const l=new br(d);if(l.equals(C.Alt)&&l.preventDefault(),l.equals(w.Enter)){this.inputs.some(p=>p.hasFocus())&&(be.stop(d),e({button:s.find(p=>p.index!==this.options.cancelId)?.index??0,checkboxChecked:this.checkbox?this.checkbox.checked:void 0,values:this.inputs.length>0?this.inputs.map(p=>p.value):void 0}));return}if(Ge&&l.equals(C.CtrlCmd|w.KeyD)){be.stop(d);const p=s.find(g=>g.index===1&&g.index!==this.options.cancelId);p&&e({button:p.index,checkboxChecked:this.checkbox?this.checkbox.checked:void 0,values:this.inputs.length>0?this.inputs.map(g=>g.value):void 0});return}if(l.equals(w.Space))return;let h=!1;if(l.equals(w.Tab)||l.equals(w.RightArrow)||l.equals(C.Shift|w.Tab)||l.equals(w.LeftArrow)){const p=[];let g=-1;if(this.messageContainer){const f=this.messageContainer.querySelectorAll("a");for(const m of f)p.push(m),Jl(m)&&(g=p.length-1)}for(const f of this.inputs)p.push(f),f.hasFocus()&&(g=p.length-1);if(this.checkbox&&(p.push(this.checkbox),this.checkbox.hasFocus()&&(g=p.length-1)),this.buttonBar)for(const f of this.buttonBar.buttons)f instanceof Ok?(p.push(f.primaryButton),f.primaryButton.hasFocus()&&(g=p.length-1),p.push(f.dropdownButton),f.dropdownButton.hasFocus()&&(g=p.length-1)):(p.push(f),f.hasFocus()&&(g=p.length-1));if(this.footerContainer){const f=this.footerContainer.querySelectorAll("a");for(const m of f)p.push(m),Jl(m)&&(g=p.length-1)}if(l.equals(w.Tab)||l.equals(w.RightArrow)){const f=(g+1)%p.length;p[f].focus()}else{g===-1&&(g=p.length);let f=g-1;f===-1&&(f=p.length-1),p[f].focus()}h=!0}h?be.stop(d,!0):this.options.keyEventProcessor&&this.options.keyEventProcessor(l)},!0)),this._register(X(r,"keyup",d=>{be.stop(d,!0);const l=new br(d);!this.options.disableCloseAction&&l.equals(w.Escape)&&t()},!0)),this._register(X(this.element,"focusout",d=>{d.relatedTarget&&this.element&&(Ja(d.relatedTarget,this.element)||(this.focusToReturn=d.relatedTarget,d.target&&(d.target.focus(),be.stop(d,!0))))},!1));const n="codicon-modifier-spin";if(this.iconElement.classList.remove(...Se.asClassNameArray(P.dialogError),...Se.asClassNameArray(P.dialogWarning),...Se.asClassNameArray(P.dialogInfo),...Se.asClassNameArray(P.loading),n),this.options.icon)this.iconElement.classList.add(...Se.asClassNameArray(this.options.icon));else switch(this.options.type){case"error":this.iconElement.classList.add(...Se.asClassNameArray(P.dialogError));break;case"warning":this.iconElement.classList.add(...Se.asClassNameArray(P.dialogWarning));break;case"pending":this.iconElement.classList.add(...Se.asClassNameArray(P.loading),n);break;case"none":this.iconElement.classList.add("no-codicon");break;default:this.iconElement.classList.add(...Se.asClassNameArray(P.dialogInfo));break}if(!this.options.disableCloseAction&&!this.options.disableCloseButton){const d=this._register(new Sr(this.toolbarContainer,{})),l=this._register(new Je("dialog.close",c(8,"Close Dialog"),Se.asClassName(P.dialogClose),!0,async()=>{e({button:this.options.cancelId||0,checkboxChecked:this.checkbox?this.checkbox.checked:void 0})}));d.push(l,{icon:!0,label:!1})}this.applyStyles(),this.element.setAttribute("aria-modal","true"),this.element.setAttribute("aria-labelledby","monaco-dialog-icon monaco-dialog-message-text"),this.element.setAttribute("aria-describedby","monaco-dialog-icon monaco-dialog-message-text monaco-dialog-message-detail monaco-dialog-message-body monaco-dialog-footer"),ja(this.element),this.inputs.length>0?(this.inputs[0].focus(),this.inputs[0].select()):s.forEach((d,l)=>{d.index===0&&i.buttons[l].focus()})})}applyStyles(){const e=this.options.dialogStyles,t=e.dialogForeground,i=e.dialogBackground,s=e.dialogShadow?`0 0px 8px ${e.dialogShadow}`:"",o=e.dialogBorder?`1px solid ${e.dialogBorder}`:"",r=e.textLinkForeground;if(this.shadowElement.style.boxShadow=s,this.element.style.color=t??"",this.element.style.backgroundColor=i??"",this.element.style.border=o,r)for(const d of[...this.messageContainer.getElementsByTagName("a"),...this.footerContainer?.getElementsByTagName("a")??[]])d.style.color=r;let n;switch(this.options.type){case"none":break;case"error":n=e.errorIconForeground;break;case"warning":n=e.warningIconForeground;break;default:n=e.infoIconForeground;break}n&&(this.iconElement.style.color=n)}dispose(){super.dispose(),this.modalElement&&(this.modalElement.remove(),this.modalElement=void 0),this.focusToReturn&&Ja(this.focusToReturn,this.container.getRootNode())&&(this.focusToReturn.focus(),this.focusToReturn=void 0)}rearrangeButtons(e,t){const i=e.map((s,o)=>({label:s,index:o}));if(e.length<2||this.options.alignment===Qd.Vertical)return i;if(Ge||xn){if(typeof t=="number"&&i[t]){const s=i.splice(t,1)[0];i.splice(1,0,s)}i.reverse()}else if(mi&&typeof t=="number"&&i[t]){const s=i.splice(t,1)[0];i.push(s)}return i}}const YM=["workbench.action.quit","workbench.action.reloadWindow","copy","cut","editor.action.selectAll","editor.action.clipboardCopyAction","editor.action.clipboardCutAction","editor.action.clipboardPasteAction"];function XM(a,e,t,i=YM){return{keyEventProcessor:s=>{const o=e.softDispatch(s,t.activeContainer);o.kind===Nk.KbFound&&o.commandId&&(i.includes(o.commandId)||be.stop(s,!0))},buttonStyles:Xa,checkboxStyles:bE,inputBoxStyles:Ap,dialogStyles:Mk,...a}}xe($M);let Nm=class extends M{constructor(e,t,i,s,o,r,n,d,l){super(),this.activityService=e,this.paneCompositeService=t,this.viewDescriptorService=i,this.viewsService=s,this.notificationService=o,this.statusbarService=r,this.layoutService=n,this.keybindingService=d,this.userActivityService=l,this.windowProgressStack=[],this.windowProgressStatusEntry=void 0}async withProgress(e,t,i){const{location:s}=e,o=async n=>{const d=this.userActivityService.markActive({extendOnly:!0,whenHeldFor:15e3});try{return await t(n)}finally{d.dispose()}},r=n=>{const d=this.viewDescriptorService.getViewContainerById(n);if(d){const l=this.viewDescriptorService.getViewContainerLocation(d);if(l!==null)return this.withPaneCompositeProgress(n,l,o,{...e,location:n})}if(this.viewDescriptorService.getViewDescriptorById(n)!==null)return this.withViewProgress(n,o,{...e,location:n});throw new Error(`Bad progress location: ${n}`)};if(typeof s=="string")return r(s);switch(s){case oo.Notification:{let n=e.priority;return n!==Qn.URGENT&&(this.notificationService.getFilter()===yy.ERROR?n=Qn.SILENT:Fk(e.source)&&this.notificationService.getFilter(e.source)===yy.ERROR&&(n=Qn.SILENT)),this.withNotificationProgress({...e,location:s,priority:n},o,i)}case oo.Window:{const n=e.type;return e.command?this.withWindowProgress({...e,location:s,type:n},o):this.withNotificationProgress({delay:150,...e,priority:Qn.SILENT,location:oo.Notification,type:n},o,i)}case oo.Explorer:return this.withPaneCompositeProgress("workbench.view.explorer",ce.Sidebar,o,{...e,location:s});case oo.Scm:return r("workbench.scm");case oo.Extensions:return this.withPaneCompositeProgress("workbench.view.extensions",ce.Sidebar,o,{...e,location:s});case oo.Dialog:return this.withDialogProgress(e,o,i);default:throw new Error(`Bad progress location: ${s}`)}}withWindowProgress(e,t){const i=[e,new vE(()=>this.updateWindowProgress())],s=t(i[1]);let o=setTimeout(()=>{o=void 0,this.windowProgressStack.unshift(i),this.updateWindowProgress(),Promise.all([fr(150),s]).finally(()=>{const r=this.windowProgressStack.indexOf(i);this.windowProgressStack.splice(r,1),this.updateWindowProgress()})},150);return s.finally(()=>clearTimeout(o))}updateWindowProgress(e=0){if(e<this.windowProgressStack.length){const[t,i]=this.windowProgressStack[e],s=t.title,o=i.value?.message,r=t.command;let n,d;const l=t.source&&typeof t.source!="string"?t.source.label:t.source;if(s&&o)n=c(14238,"{0}: {1}",s,o),d=l?c(14239,"[{0}] {1}: {2}",l,s,o):n;else if(s)n=s,d=l?c(14240,"[{0}]: {1}",l,s):n;else if(o)n=o,d=l?c(14240,"[{0}]: {1}",l,o):n;else{this.updateWindowProgress(e+1);return}const h={name:c(14241,"Progress Message"),text:n,showProgress:t.type||!0,ariaLabel:n,tooltip:Cy(d).trim(),command:r};this.windowProgressStatusEntry?this.windowProgressStatusEntry.update(h):this.windowProgressStatusEntry=this.statusbarService.addEntry(h,"status.progress",_t.LEFT,-Number.MAX_VALUE)}else this.windowProgressStatusEntry?.dispose(),this.windowProgressStatusEntry=void 0}withNotificationProgress(e,t,i){const s=new class extends M{get step(){return this._step}get done(){return this._done}constructor(){super(),this._onDidReport=this._register(new A),this.onDidReport=this._onDidReport.event,this._onWillDispose=this._register(new A),this.onWillDispose=this._onWillDispose.event,this._step=void 0,this._done=!1,this.promise=t(this),this.promise.finally(()=>{this.dispose()})}report(f){this._step=f,this._onDidReport.fire(f)}cancel(f){i?.(f),this.dispose()}dispose(){this._done=!0,this._onWillDispose.fire(),super.dispose()}},o=()=>{const f=new pr;return this.withWindowProgress({location:oo.Window,title:e.title?eh(e.title).toString():void 0,command:"notifications.showList",type:e.type},m=>{function v(x){x.message&&m.report({message:eh(x.message).toString()})}s.step&&v(s.step);const E=s.onDidReport(x=>v(x));return f.p.finally(()=>E.dispose()),K.once(s.onWillDispose)(()=>f.complete()),f.p}),pe(()=>f.complete())},r=(f,m,v)=>{const E=new B,x=e.primaryActions?Array.from(e.primaryActions):[],G=e.secondaryActions?Array.from(e.secondaryActions):[];if(e.buttons&&e.buttons.forEach((H,ie)=>{const q=new class extends Je{constructor(){super(`progress.button.${H}`,H,void 0,!0)}async run(){s.cancel(ie)}};E.add(q),x.push(q)}),e.cancellable){const H=new class extends Je{constructor(){super("progress.cancel",typeof e.cancellable=="string"?e.cancellable:c(14242,"Cancel"),void 0,!0)}async run(){s.cancel()}};E.add(H),x.push(H)}const W=this.notificationService.notify({severity:Te.Info,message:Cy(f),source:e.source,actions:{primary:x,secondary:G},progress:typeof v=="number"&&v>=0?{total:100,worked:v}:{infinite:!0},priority:m});let Y;const $=H=>{dt(Y),!H&&!s.done&&(Y=o())};return E.add(W.onDidChangeVisibility($)),m===Qn.SILENT&&$(!1),K.once(W.onDidClose)(()=>{E.dispose(),dt(Y)}),W},n=(f,m)=>{typeof m=="number"&&m>=0?(f.progress.total(100),f.progress.worked(m)):f.progress.infinite()};let d,l,h;const p=f=>{f?.message&&e.title?h=`${e.title}: ${f.message}`:h=e.title||f?.message,!d&&h&&(typeof e.delay=="number"&&e.delay>0?l===void 0&&(l=setTimeout(()=>d=r(h,e.priority,f?.increment),e.delay)):d=r(h,e.priority,f?.increment)),d&&(h&&d.updateMessage(h),typeof f?.increment=="number"&&n(d,f.increment))};p(s.step);const g=s.onDidReport(f=>p(f));return K.once(s.onWillDispose)(()=>g.dispose()),(async()=>{try{typeof e.delay=="number"&&e.delay>0?await s.promise:await Promise.all([fr(800),s.promise])}finally{clearTimeout(l),d?.close()}})(),s.promise}withPaneCompositeProgress(e,t,i,s){const o=this.paneCompositeService.getProgressIndicator(e,t),r=o?this.withCompositeProgress(o,i,s):i({report:()=>{}});return t===ce.Sidebar&&this.showOnActivityBar(e,s,r),r}withViewProgress(e,t,i){const s=this.viewsService.getViewProgressIndicator(e),o=s?this.withCompositeProgress(s,t,i):t({report:()=>{}}),r=this.viewDescriptorService.getViewContainerByViewId(e)?.id;return r===void 0||this.showOnActivityBar(r,i,o),o}showOnActivityBar(e,t,i){let s,o=setTimeout(()=>{o=void 0;const r=this.activityService.showViewContainerActivity(e,{badge:new Bk(()=>"")}),n=Date.now(),d=300;s={dispose(){const l=Date.now()-n;l<d?setTimeout(()=>r.dispose(),d-l):r.dispose()}}},t.delay||300);i.finally(()=>{clearTimeout(o),dt(s)})}withCompositeProgress(e,t,i){let s;function o(n){let d,l;return typeof n<"u"&&(typeof n=="number"?d=n:typeof n.increment=="number"&&(d=n.total??100,l=n.increment)),typeof d=="number"?(s||(s=e.show(d,i.delay),r.catch(()=>{}).finally(()=>s?.done())),typeof l=="number"&&s.worked(l)):(s?.done(),e.showWhile(r,i.delay)),s}const r=t({report:n=>{o(n)}});return o(i.total),r}withDialogProgress(e,t,i){const s=new B;let o,r=!1;const n=f=>{const m=e.buttons||[];return e.sticky||m.push(e.cancellable?typeof e.cancellable=="boolean"?c(14242,"Cancel"):e.cancellable:c(14243,"Dismiss")),o=new jM(this.layoutService.activeContainer,f,m,XM({type:"pending",detail:e.detail,cancelId:m.length-1,disableCloseAction:e.sticky,disableDefaultAction:e.sticky},this.keybindingService,this.layoutService)),s.add(o),o.show().then(v=>{r||i?.(v.button),dt(o)}),o};let d=e.delay??0,l;const h=s.add(new pd(()=>{d=0,l&&!o?o=n(l):l&&o.updateMessage(l)},0)),p=function(f){l=f,h.isScheduled()||h.schedule(d)},g=t({report:f=>{p(f.message)}});return g.finally(()=>{r=!0,dt(s)}),e.title&&p(e.title),g}};Nm=D([u(0,Ir),u(1,_r),u(2,At),u(3,jt),u(4,Qe),u(5,Ss),u(6,iE),u(7,ot),u(8,Gk)],Nm);let Fm=class extends M{constructor(e){super(),this.paneCompositeParts=new Map;const t=e.createInstance(im),i=e.createInstance(om),s=e.createInstance(hf);this.paneCompositeParts.set(ce.Panel,t),this.paneCompositeParts.set(ce.Sidebar,i),this.paneCompositeParts.set(ce.AuxiliaryBar,s);const o=this._register(new B);this.onDidPaneCompositeOpen=K.any(...Sy.map(r=>K.map(this.paneCompositeParts.get(r).onDidPaneCompositeOpen,n=>({composite:n,viewContainerLocation:r}),o))),this.onDidPaneCompositeClose=K.any(...Sy.map(r=>K.map(this.paneCompositeParts.get(r).onDidPaneCompositeClose,n=>({composite:n,viewContainerLocation:r}),o)))}openPaneComposite(e,t,i){return this.getPartByLocation(t).openPaneComposite(e,i)}getActivePaneComposite(e){return this.getPartByLocation(e).getActivePaneComposite()}getPaneComposite(e,t){return this.getPartByLocation(t).getPaneComposite(e)}getPaneComposites(e){return this.getPartByLocation(e).getPaneComposites()}getPinnedPaneCompositeIds(e){return this.getPartByLocation(e).getPinnedPaneCompositeIds()}getVisiblePaneCompositeIds(e){return this.getPartByLocation(e).getVisiblePaneCompositeIds()}getPaneCompositeIds(e){return this.getPartByLocation(e).getPaneCompositeIds()}getProgressIndicator(e,t){return this.getPartByLocation(t).getProgressIndicator(e)}hideActivePaneComposite(e){this.getPartByLocation(e).hideActivePaneComposite()}getLastActivePaneCompositeId(e){return this.getPartByLocation(e).getLastActivePaneCompositeId()}getPartByLocation(e){return fe(this.paneCompositeParts.get(e))}};Fm=D([u(0,z)],Fm);async function JM(a){const e=navigator.usb;if(!e)return;const t=await e.requestDevice({filters:a?.filters??[]});if(t)return{deviceClass:t.deviceClass,deviceProtocol:t.deviceProtocol,deviceSubclass:t.deviceSubclass,deviceVersionMajor:t.deviceVersionMajor,deviceVersionMinor:t.deviceVersionMinor,deviceVersionSubminor:t.deviceVersionSubminor,manufacturerName:t.manufacturerName,productId:t.productId,productName:t.productName,serialNumber:t.serialNumber,usbVersionMajor:t.usbVersionMajor,usbVersionMinor:t.usbVersionMinor,usbVersionSubminor:t.usbVersionSubminor,vendorId:t.vendorId}}async function ZM(a){const e=navigator.serial;if(!e)return;const t=await e.requestPort({filters:a?.filters??[]});if(!t)return;const i=t.getInfo();return{usbVendorId:i.usbVendorId,usbProductId:i.usbProductId}}async function QM(a){const e=navigator.hid;if(!e)return;const t=await e.requestDevice({filters:a?.filters??[]});if(!t.length)return;const i=t[0];return{opened:i.opened,vendorId:i.vendorId,productId:i.productId,productName:i.productName,collections:i.collections}}const e1=c(1956,"open"),t1=c(1957,"close"),i1=c(1958,"find");var Tg={open:e1,close:t1,find:i1};let Bm=class{constructor(e,t,i,s){this.fileService=e,this.environmentService=t,this.lifecycleService=i,this.logService=s}async getLogs(){return Wk(this.fileService,this.environmentService)}async whenWorkbenchRestored(){this.logService.info("[driver] Waiting for restored lifecycle phase..."),await this.lifecycleService.when(kp.Restored),this.logService.info("[driver] Restored lifecycle phase reached. Waiting for contributions..."),await se.as(jb.Workbench).whenRestored,this.logService.info("[driver] Workbench contributions created.")}async setValue(e,t){const i=me.document.querySelector(e);if(!i)return Promise.reject(new Error(`Element not found: ${e}`));const s=i;s.value=t;const o=new Event("input",{bubbles:!0,cancelable:!0});s.dispatchEvent(o)}async isActiveElement(e){if(me.document.querySelector(e)!==me.document.activeElement){const i=[];let s=me.document.activeElement;for(;s;){const o=s.tagName,r=s.id?`#${s.id}`:"",n=Mi(s.className.split(/\s+/g).map(d=>d.trim())).map(d=>`.${d}`).join("");i.unshift(`${o}${r}${n}`),s=s.parentElement}throw new Error(`Active element not found. Current active element is '${i.join(" > ")}'. Looking for ${e}`)}return!0}async getElements(e,t){const i=me.document.querySelectorAll(e),s=[];for(let o=0;o<i.length;o++){const r=i.item(o);s.push(this.serializeElement(r,t))}return s}serializeElement(e,t){const i=Object.create(null);for(let n=0;n<e.attributes.length;n++){const d=e.attributes.item(n);d&&(i[d.name]=d.value)}const s=[];if(t)for(let n=0;n<e.children.length;n++){const d=e.children.item(n);d&&s.push(this.serializeElement(d,!0))}const{left:o,top:r}=Ey(e);return{tagName:e.tagName,className:e.className,textContent:e.textContent||"",attributes:i,children:s,left:o,top:r}}async getElementXY(e,t,i){const s=typeof t=="number"&&typeof i=="number"?{x:t,y:i}:void 0;return this._getElementXY(e,s)}async typeInEditor(e,t){const i=me.document.querySelector(e);if(!i)throw new Error(`Editor not found: ${e}`);if(_y(i)){const s=i.editContext;if(!s)throw new Error(`Edit context not found: ${e}`);const o=s.selectionStart,r=s.selectionEnd,n=new TextUpdateEvent("textupdate",{updateRangeStart:o,updateRangeEnd:r,text:t,selectionStart:o+t.length,selectionEnd:o+t.length,compositionStart:0,compositionEnd:0});s.dispatchEvent(n)}else if(th(i)){const s=i.selectionStart,o=s+t.length,r=i.value,n=r.substr(0,s)+t+r.substr(s);i.value=n,i.setSelectionRange(o,o);const d=new Event("input",{bubbles:!0,cancelable:!0});i.dispatchEvent(d)}}async getEditorSelection(e){const t=me.document.querySelector(e);if(!t)throw new Error(`Editor not found: ${e}`);if(_y(t)){const i=t.editContext;if(!i)throw new Error(`Edit context not found: ${e}`);return{selectionStart:i.selectionStart,selectionEnd:i.selectionEnd}}else{if(th(t))return{selectionStart:t.selectionStart,selectionEnd:t.selectionEnd};throw new Error(`Unknown type of element: ${e}`)}}async getTerminalBuffer(e){const t=me.document.querySelector(e);if(!t)throw new Error(`Terminal not found: ${e}`);const i=t.xterm;if(!i)throw new Error(`Xterm not found: ${e}`);const s=[];for(let o=0;o<i.buffer.active.length;o++)s.push(i.buffer.active.getLine(o).translateToString(!0));return s}async writeInTerminal(e,t){const i=me.document.querySelector(e);if(!i)throw new Error(`Element not found: ${e}`);const s=i.xterm;if(!s)throw new Error(`Xterm not found: ${e}`);s.input(t)}getLocaleInfo(){return Promise.resolve({language:Qg,locale:Kk})}getLocalizedStrings(){return Promise.resolve({open:Tg.open,close:Tg.close,find:Tg.find})}async _getElementXY(e,t){const i=me.document.querySelector(e);if(!i)return Promise.reject(new Error(`Element not found: ${e}`));const{left:s,top:o}=Ey(i),{width:r,height:n}=yE(i);let d,l;return t?(d=s+t.x,l=o+t.y):(d=s+r/2,l=o+n/2),d=Math.round(d),l=Math.round(l),{x:d,y:l}}};Bm=D([u(0,Ve),u(1,Fb),u(2,gd),u(3,et)],Bm);function s1(a){Object.assign(me,{driver:a.createInstance(Bm)})}var Rr,rr;let Oh=(rr=class extends M{constructor(e,t={getWindowsCount:Iy,getWindows:Yg},i,s,o,r){super(),this.hostService=i,this.environmentService=s,this.contextMenuService=o,this.layoutService=r,this.enableWindowFocusOnElementFocus(e),this.enableMultiWindowAwareTimeout(e,t),this.registerFullScreenListeners(e.vscodeWindowId),this.registerContextMenuListeners(e)}enableWindowFocusOnElementFocus(e){const t=e.HTMLElement.prototype.focus,i=this;e.HTMLElement.prototype.focus=function(s){i.onElementFocus(He(this)),t.apply(this,[s])}}onElementFocus(e){const t=wr();t!==e&&t.document.hasFocus()&&(e.focus(),!this.environmentService.extensionTestsLocationURI&&!e.document.hasFocus()&&this.hostService.focus(e))}enableMultiWindowAwareTimeout(e,t={getWindowsCount:Iy,getWindows:Yg}){function i(r){return r===me?window:r}const s=i(e).setTimeout;Object.defineProperty(i(e),"vscodeOriginalSetTimeout",{get:()=>s});const o=i(e).clearTimeout;Object.defineProperty(i(e),"vscodeOriginalClearTimeout",{get:()=>o}),i(e).setTimeout=function(r,n=0,...d){if(t.getWindowsCount()===1||typeof r=="string"||n===0)return s.apply(this,[r,n,...d]);const l=new Set,h=Rr.TIMEOUT_HANDLES++;Rr.TIMEOUT_DISPOSABLES.set(h,l);const p=$b(r,()=>{dt(l),Rr.TIMEOUT_DISPOSABLES.delete(h)});for(const{window:g,disposables:f}of t.getWindows()){if(CE(g)&&g.document.visibilityState==="hidden")continue;let m=!1;const v=i(e).vscodeOriginalSetTimeout?.apply(this,[(...x)=>{m||p(...x)},n,...d]),E=pe(()=>{m=!0,i(e).vscodeOriginalClearTimeout?.apply(this,[v]),l.delete(E)});f.add(E),l.add(E)}return h},i(e).clearTimeout=function(r){const n=typeof r=="number"?Rr.TIMEOUT_DISPOSABLES.get(r):void 0;n?(dt(n),Rr.TIMEOUT_DISPOSABLES.delete(r)):o.apply(this,[r])}}static async confirmOnShutdown(e,t){const i=e.get(Bi),s=e.get(te),o=t===Wd.QUIT?Ge?c(3709,"Are you sure you want to quit?"):c(3710,"Are you sure you want to exit?"):c(3711,"Are you sure you want to close the window?"),r=t===Wd.QUIT?Ge?c(3712,"&&Quit"):c(3713,"&&Exit"):c(3714,"&&Close Window"),n=await i.confirm({message:o,primaryButton:r,checkbox:{label:c(3715,"Do not ask me again")}});return n.confirmed&&n.checkboxChecked&&await s.updateValue("window.confirmBeforeClose","never"),n.confirmed}registerFullScreenListeners(e){this._register(this.hostService.onDidChangeFullScreen(({windowId:t,fullscreen:i})=>{if(t===e){const s=$c(e);s&&Uk(i,s.window)}}))}registerContextMenuListeners(e){if(e!==me)return;const t=i=>this.layoutService.activeContainer.classList.toggle("context-menu-visible",i);this._register(this.contextMenuService.onDidShowContextMenu(()=>t(!0))),this._register(this.contextMenuService.onDidHideContextMenu(()=>t(!1)))}},Rr=rr,rr.TIMEOUT_HANDLES=Number.MIN_SAFE_INTEGER,rr.TIMEOUT_DISPOSABLES=new Map,rr);Oh=Rr=D([u(2,Rt),u(3,wi),u(4,st),u(5,je)],Oh);let TC=class extends Oh{constructor(e,t,i,s,o,r,n,d,l,h){super(me,void 0,l,r,h,n),this.openerService=e,this.lifecycleService=t,this.dialogService=i,this.labelService=s,this.productService=o,this.browserEnvironmentService=r,this.instantiationService=d,this.registerListeners(),this.create()}registerListeners(){this._register(this.lifecycleService.onWillShutdown(()=>this.onWillShutdown()));const e=ih&&me.visualViewport?me.visualViewport:me;this._register(X(e,Q.RESIZE,()=>{this.layoutService.layout(),ih&&me.scrollTo(0,0)})),this._register(X(this.layoutService.mainContainer,Q.WHEEL,t=>t.preventDefault(),{passive:!1})),this._register(X(this.layoutService.mainContainer,Q.CONTEXT_MENU,t=>be.stop(t,!0))),this._register(X(this.layoutService.mainContainer,Q.DROP,t=>be.stop(t,!0)))}onWillShutdown(){K.toPromise(K.any(K.once(new Dy(me.document.body,Q.KEY_DOWN,!0).event),K.once(new Dy(me.document.body,Q.MOUSE_DOWN,!0).event))).then(async()=>{await fr(3e3),await this.dialogService.prompt({type:Te.Error,message:c(3716,"An unexpected error occurred that requires a reload of this page."),detail:c(3717,"The workbench was unexpectedly disposed while running."),buttons:[{label:c(3718,"&&Reload"),run:()=>me.location.reload()}]})})}create(){this.setupOpenHandlers(),this.registerLabelFormatters(),this.registerCommands(),this.setupDriver()}setupDriver(){this.environmentService.enableSmokeTestDriver&&s1(this.instantiationService)}setupOpenHandlers(){this.openerService.setDefaultExternalOpener({openExternal:async e=>{let t=!1;if(this.browserEnvironmentService.options?.openerAllowedExternalUrlPrefixes){for(const i of this.browserEnvironmentService.options.openerAllowedExternalUrlPrefixes)if(e.startsWith(i)){t=!0;break}}if(Md(e,ue.http)||Md(e,ue.https))Pb?zk(e,!t)||await this.dialogService.prompt({type:Te.Warning,message:c(3719,"The browser blocked opening a new tab or window. Press 'Retry' to try again."),custom:{markdownDetails:[{markdown:new Zi(c(3720,"Please allow pop-ups for this website in your [browser settings]({0}).","https://aka.ms/allow-vscode-popup"),!0)}]},buttons:[{label:c(3721,"&&Retry"),run:()=>t?Ay(e):Ty(e)}],cancelButton:!0}):t?Ay(e):Ty(e);else{const i=()=>{this.lifecycleService.withExpectedShutdown({disableShutdownHandling:!0},()=>me.location.href=e)};i();const s=async()=>{const{downloadUrl:o}=this.productService;let r;const n=[{label:c(3722,"&&Try Again"),run:()=>i()}];o!==void 0?(r=c(3723,`We launched {0} on your computer.

If {1} did not launch, try again or install it below.`,this.productService.nameLong,this.productService.nameLong),n.push({label:c(3724,"&&Install"),run:async()=>{await this.openerService.open(F.parse(o)),s()}})):r=c(3725,`We launched {0} on your computer.

If {1} did not launch, try again below.`,this.productService.nameLong,this.productService.nameLong),await this.hostService.withExpectedShutdown(()=>this.dialogService.prompt({type:Te.Info,message:c(3726,"All done. You can close this tab now."),detail:r,buttons:n,cancelButton:!0}))};Md(e,this.productService.urlProtocol)&&await s()}return!0}})}registerLabelFormatters(){this._register(this.labelService.registerFormatter({scheme:ue.vscodeUserData,priority:!0,formatting:{label:"(Settings) ${path}",separator:"/"}}))}registerCommands(){re.registerCommand("workbench.experimental.requestUsbDevice",async(e,t)=>JM(t)),re.registerCommand("workbench.experimental.requestSerialPort",async(e,t)=>ZM(t)),re.registerCommand("workbench.experimental.requestHidDevice",async(e,t)=>QM(t))}};TC=D([u(0,tt),u(1,gd),u(2,Bi),u(3,rs),u(4,_s),u(5,Hk),u(6,je),u(7,z),u(8,Rt),u(9,st)],TC);var Gm,Mh;(function(a){a[a.Maximized=0]="Maximized",a[a.Normal=1]="Normal",a[a.Fullscreen=2]="Fullscreen"})(Mh||(Mh={}));const o1=new Be(ef.width,ef.height);let Wm=class extends Oh{constructor(e,t,i,s,o,r,n,d){super(e,void 0,o,r,n,d),this.window=e,this.container=t,this.configurationService=s,this._onWillLayout=this._register(new A),this.onWillLayout=this._onWillLayout.event,this._onDidLayout=this._register(new A),this.onDidLayout=this._onDidLayout.event,this._onBeforeUnload=this._register(new A),this.onBeforeUnload=this._onBeforeUnload.event,this._onUnload=this._register(new A),this.onUnload=this._onUnload.event,this._onWillDispose=this._register(new A),this.onWillDispose=this._onWillDispose.event,this.compact=!1,this.whenStylesHaveLoaded=i.wait().then(()=>{}),this.registerListeners()}updateOptions(e){this.compact=e.compact}registerListeners(){this._register(X(this.window,Q.BEFORE_UNLOAD,e=>this.handleBeforeUnload(e))),this._register(X(this.window,Q.UNLOAD,()=>this.handleUnload())),this._register(X(this.window,"unhandledrejection",e=>{gr(e.reason),e.preventDefault()})),this._register(X(this.window,Q.RESIZE,()=>this.layout())),this._register(X(this.container,Q.SCROLL,()=>this.container.scrollTop=0)),ei?(this._register(X(this.container,Q.DROP,e=>be.stop(e,!0))),this._register(X(this.container,Q.WHEEL,e=>e.preventDefault(),{passive:!1})),this._register(X(this.container,Q.CONTEXT_MENU,e=>be.stop(e,!0)))):(this._register(X(this.window.document.body,Q.DRAG_OVER,e=>be.stop(e))),this._register(X(this.window.document.body,Q.DROP,e=>be.stop(e)))),this._register(X(window,Q.UNLOAD,()=>{this.window?.close()}))}handleBeforeUnload(e){let t;if(this._onBeforeUnload.fire({veto(o){o&&(t=o)}}),t){this.handleVetoBeforeClose(e,t);return}const i=this.configurationService.getValue("window.confirmBeforeClose");(i==="always"||i==="keyboardOnly"&&tx.getInstance().isModifierPressed)&&this.confirmBeforeClose(e)}handleVetoBeforeClose(e,t){this.preventUnload(e)}preventUnload(e){e.preventDefault(),e.returnValue=c(13742,"Changes that you made may not be saved. Please check press 'Cancel' and try again.")}confirmBeforeClose(e){this.preventUnload(e)}handleUnload(){this._onUnload.fire()}layout(){const e=yE(this.window.document.body,o1,this.container);this._onWillLayout.fire(e),this._onDidLayout.fire(e)}createState(){return{bounds:{x:this.window.screenX,y:this.window.screenY,width:this.window.outerWidth,height:this.window.outerHeight},zoomLevel:ix(this.window),compact:this.compact}}dispose(){this._store.isDisposed||(this._onWillDispose.fire(),super.dispose())}};Wm=D([u(3,te),u(4,Rt),u(5,wi),u(6,st),u(7,je)],Wm);var un;let Km=(un=class extends M{constructor(e,t,i,s,o,r,n){super(),this.layoutService=e,this.dialogService=t,this.configurationService=i,this.telemetryService=s,this.hostService=o,this.environmentService=r,this.contextMenuService=n,this._onDidOpenAuxiliaryWindow=this._register(new A),this.onDidOpenAuxiliaryWindow=this._onDidOpenAuxiliaryWindow.event,this.windows=new Map}async open(e){cs("code/auxiliaryWindow/willOpen");const t=await this.openWindow(e);if(!t)throw new Error(c(13743,"Unable to open a new window."));const i=await this.resolveWindowId(t);qk(t,i);const s=new B,{container:o,stylesLoaded:r}=this.createContainer(t,s,e),n=this.createAuxiliaryWindow(t,o,r);n.updateOptions({compact:e?.compact??!1});const d=new B;this.windows.set(t.vscodeWindowId,n),d.add(pe(()=>this.windows.delete(t.vscodeWindowId)));const l=new B;return K.once(n.onWillDispose)(()=>{t.close(),s.dispose(),d.dispose(),l.dispose()}),d.add(jk(t)),this._onDidOpenAuxiliaryWindow.fire({window:n,disposables:l}),cs("code/auxiliaryWindow/didOpen"),this.telemetryService.publicLog2("auxiliaryWindowOpen",{bounds:!!e?.bounds}),n}createAuxiliaryWindow(e,t,i){return new Wm(e,t,i,this.configurationService,this.hostService,this.environmentService,this.contextMenuService,this.layoutService)}async openWindow(e){const t=wr(),i={x:t.screenX,y:t.screenY,width:t.outerWidth,height:t.outerHeight},s=ef,o=Math.max(e?.bounds?.width??s.width,ky.WIDTH),r=Math.max(e?.bounds?.height??s.height,ky.HEIGHT);let n={x:e?.bounds?.x??Math.max(i.x+i.width/2-o/2,0),y:e?.bounds?.y??Math.max(i.y+i.height/2-r/2,0),width:o,height:r};!e?.bounds&&n.x===i.x&&n.y===i.y&&(n={...n,x:n.x+30,y:n.y+30});const d=Mi(["popup=yes",`left=${n.x}`,`top=${n.y}`,`width=${n.width}`,`height=${n.height}`,e?.nativeTitlebar?"window-native-titlebar=yes":void 0,e?.disableFullscreen?"window-disable-fullscreen=yes":void 0,e?.alwaysOnTop?"window-always-on-top=yes":void 0,e?.mode===Mh.Maximized?"window-maximized=yes":void 0,e?.mode===Mh.Fullscreen?"window-fullscreen=yes":void 0]),l=me.open(ox?"":"about:blank",void 0,d.join(","));return!l&&ei?(await this.dialogService.prompt({type:Te.Warning,message:c(13744,"The browser blocked opening a new window. Press 'Retry' to try again."),custom:{markdownDetails:[{markdown:new Zi(c(13745,"Please allow pop-ups for this website in your [browser settings]({0}).","https://aka.ms/allow-vscode-popup"),!0)}]},buttons:[{label:c(13746,"&&Retry"),run:()=>this.openWindow(e)}],cancelButton:!0})).result:l?.window}async resolveWindowId(e){return Gm.WINDOW_IDS++}createContainer(e,t,i){this.applyMeta(e);const{stylesLoaded:s}=this.applyCSS(e,t),o=this.applyHTML(e,t);return{stylesLoaded:s,container:o}}applyMeta(e){for(const i of['meta[charset="utf-8"]','meta[http-equiv="Content-Security-Policy"]','meta[name="viewport"]','meta[name="theme-color"]']){const s=me.document.querySelector(i);if(s){const o=SE(e.document.head);if(xy(s,o),i==='meta[http-equiv="Content-Security-Policy"]'){const r=o.getAttribute("content");r&&o.setAttribute("content",r.replace(/(script-src[^\;]*)/,"script-src 'none'"))}}}const t=me.document.querySelector('link[rel="icon"]');if(t){const i=Yk(e.document.head);xy(t,i)}}applyCSS(e,t){cs("code/auxiliaryWindow/willApplyCSS");const i=new e.CSSStyleSheet;i.insertRule(`body {
	height: 100%;
	width: 100%;
	margin: 0;
	padding: 0;
	overflow: hidden;
	font-size: 11px;
	user-select: none;
	-webkit-user-select: none;
}`),e.document.adoptedStyleSheets=[...e.document.adoptedStyleSheets,i,...(sx??me.document).adoptedStyleSheets.map(h=>{const p=new e.CSSStyleSheet;for(const g of h.cssRules)p.insertRule(g.cssText);return p})];const s=new Map,o=new Xk;o.wait().then(()=>cs("code/auxiliaryWindow/didLoadCSSStyles"));const r=t.add(new B);let n=0;function d(){--n===0&&(r.dispose(),o.open())}function l(h){if(ex(h))return;const p=e.document.head.appendChild(h.cloneNode(!0));h.tagName.toLowerCase()==="link"&&(n++,r.add(X(p,"load",d)),r.add(X(p,"error",d))),s.set(h,p)}n++;try{for(const h of me.document.head.querySelectorAll('link[rel="stylesheet"], style'))l(h)}finally{d()}return t.add(Jk(e)),t.add(Zk.observe(me.document.head,t,{childList:!0,subtree:!0})(h=>{for(const p of h)if(!(p.type!=="childList"||p.target.nodeName.toLowerCase()==="title"||p.target.nodeName.toLowerCase()==="script"||p.target.nodeName.toLowerCase()==="meta")){for(const g of p.addedNodes)if(Ln(g)&&(g.tagName.toLowerCase()==="style"||g.tagName.toLowerCase()==="link"))l(g);else if(g.nodeType===Node.TEXT_NODE&&g.parentNode){const f=s.get(g.parentNode);f&&(f.textContent=g.textContent)}for(const g of p.removedNodes){const f=s.get(g);f&&(f.parentNode?.removeChild(f),s.delete(g))}}})),cs("code/auxiliaryWindow/didApplyCSS"),{stylesLoaded:o}}applyHTML(e,t){cs("code/auxiliaryWindow/willApplyHTML");const i=N("div",{role:"application"});return Qk(i,0,0,0,0,"relative"),i.style.display="flex",i.style.height="100%",i.style.flexDirection="column",e.document.body.append(i),t.add(hg(me.document.documentElement,e.document.documentElement)),t.add(hg(me.document.body,e.document.body)),t.add(hg(this.layoutService.mainContainer,i,["class"])),cs("code/auxiliaryWindow/didApplyHTML"),i}getWindow(e){return this.windows.get(e)}},Gm=un,un.WINDOW_IDS=$k(me)+1,un);Km=Gm=D([u(0,je),u(1,Bi),u(2,te),u(3,nt),u(4,Rt),u(5,wi),u(6,st)],Km);let Um=class extends tl{constructor(e,t,i,s,o,r,n,d,l,h,p,g,f){super(e,{mergeViewWithContainerWhenSingleView:!1},n,i,s,l,o,h,d,r,p,g,f),this.constantViewDescriptors=new Map,this.allViews=new Map,this._register(t(m=>{this.filterValue=m,this.onFilterChanged(m)})),this._register(this.viewContainerModel.onDidChangeActiveViewDescriptors(()=>{this.updateAllViews(this.viewContainerModel.activeViewDescriptors)}))}updateAllViews(e){e.forEach(t=>{const i=this.getFilterOn(t);i&&(this.allViews.has(i)||this.allViews.set(i,new Map),this.allViews.get(i).set(t.id,t),this.filterValue&&!this.filterValue.includes(i)&&this.panes.find(s=>s.id===t.id)&&this.viewContainerModel.setVisible(t.id,!1))})}addConstantViewDescriptors(e){e.forEach(t=>this.constantViewDescriptors.set(t.id,t))}onFilterChanged(e){this.allViews.size===0&&this.updateAllViews(this.viewContainerModel.activeViewDescriptors),this.getViewsNotForTarget(e).forEach(t=>this.viewContainerModel.setVisible(t.id,!1)),this.getViewsForTarget(e).forEach(t=>this.viewContainerModel.setVisible(t.id,!0))}getViewsForTarget(e){const t=[];for(let i=0;i<e.length;i++)this.allViews.has(e[i])&&t.push(...Array.from(this.allViews.get(e[i]).values()));return t}getViewsNotForTarget(e){const t=this.allViews.keys();let i=t.next(),s=[];for(;!i.done;){let o=!1;e.forEach(r=>{i.value===r&&(o=!0)}),o||(s=s.concat(this.getViewsForTarget([i.value]))),i=t.next()}return s}onDidAddViewDescriptors(e){const t=super.onDidAddViewDescriptors(e);for(let i=0;i<e.length;i++)this.constantViewDescriptors.has(e[i].viewDescriptor.id)&&t[i].setExpanded(!1);return this.allViews.size===0&&this.updateAllViews(this.viewContainerModel.activeViewDescriptors),t}openView(e,t){const i=super.openView(e,t);if(i){const s=Array.from(this.allViews.entries()).find(o=>o[1].has(e));s&&!this.filterValue?.includes(s[0])&&this.setFilter(s[1].get(e))}return i}};Um=D([u(2,te),u(3,je),u(4,nt),u(5,ge),u(6,z),u(7,we),u(8,st),u(9,si),u(10,xt),u(11,At),u(12,et)],Um);let Hm=class extends M{constructor(e,t,i,s,o){super(),this.viewDescriptorService=e,this.paneCompositeService=t,this.contextKeyService=i,this.layoutService=s,this.editorService=o,this._onDidChangeViewVisibility=this._register(new A),this.onDidChangeViewVisibility=this._onDidChangeViewVisibility.event,this._onDidChangeViewContainerVisibility=this._register(new A),this.onDidChangeViewContainerVisibility=this._onDidChangeViewContainerVisibility.event,this._onDidChangeFocusedView=this._register(new A),this.onDidChangeFocusedView=this._onDidChangeFocusedView.event,this.viewContainerDisposables=this._register(new Rn),this.viewDisposable=new Map,this.enabledViewContainersContextKeys=new Map,this.visibleViewContextKeys=new Map,this.viewPaneContainers=new Map,this._register(pe(()=>{this.viewDisposable.forEach(r=>r.dispose()),this.viewDisposable.clear()})),this.viewDescriptorService.viewContainers.forEach(r=>this.onDidRegisterViewContainer(r,this.viewDescriptorService.getViewContainerLocation(r))),this._register(this.viewDescriptorService.onDidChangeViewContainers(({added:r,removed:n})=>this.onDidChangeContainers(r,n))),this._register(this.viewDescriptorService.onDidChangeContainerLocation(({viewContainer:r,from:n,to:d})=>this.onDidChangeContainerLocation(r,n,d))),this._register(this.paneCompositeService.onDidPaneCompositeOpen(r=>this._onDidChangeViewContainerVisibility.fire({id:r.composite.getId(),visible:!0,location:r.viewContainerLocation}))),this._register(this.paneCompositeService.onDidPaneCompositeClose(r=>this._onDidChangeViewContainerVisibility.fire({id:r.composite.getId(),visible:!1,location:r.viewContainerLocation}))),this.focusedViewContextKey=kl.bindTo(i)}onViewsAdded(e){for(const t of e)this.onViewsVisibilityChanged(t,t.isBodyVisible())}onViewsVisibilityChanged(e,t){this.getOrCreateActiveViewContextKey(e).set(t),this._onDidChangeViewVisibility.fire({id:e.id,visible:t})}onViewsRemoved(e){for(const t of e)this.onViewsVisibilityChanged(t,!1)}getOrCreateActiveViewContextKey(e){const t=rx(e.id);let i=this.visibleViewContextKeys.get(t);return i||(i=new oe(t,!1).bindTo(this.contextKeyService),this.visibleViewContextKeys.set(t,i)),i}onDidChangeContainers(e,t){for(const{container:i,location:s}of t)this.onDidDeregisterViewContainer(i,s);for(const{container:i,location:s}of e)this.onDidRegisterViewContainer(i,s)}onDidRegisterViewContainer(e,t){this.registerPaneComposite(e,t);const i=new B,s=this.viewDescriptorService.getViewContainerModel(e);this.onViewDescriptorsAdded(s.allViewDescriptors,e),i.add(s.onDidChangeAllViewDescriptors(({added:o,removed:r})=>{this.onViewDescriptorsAdded(o,e),this.onViewDescriptorsRemoved(r)})),this.updateViewContainerEnablementContextKey(e),i.add(s.onDidChangeActiveViewDescriptors(()=>this.updateViewContainerEnablementContextKey(e))),i.add(this.registerOpenViewContainerAction(e)),this.viewContainerDisposables.set(e.id,i)}onDidDeregisterViewContainer(e,t){this.deregisterPaneComposite(e,t),this.viewContainerDisposables.deleteAndDispose(e.id)}onDidChangeContainerLocation(e,t,i){this.deregisterPaneComposite(e,t),this.registerPaneComposite(e,i),this.layoutService.isVisible(xg(i))&&this.viewDescriptorService.getViewContainersByLocation(i).filter(s=>this.isViewContainerActive(s.id)).length===1&&this.openViewContainer(e.id)}onViewDescriptorsAdded(e,t){if(this.viewDescriptorService.getViewContainerLocation(t)!==null)for(const s of e){const o=new B;o.add(this.registerOpenViewAction(s)),o.add(this.registerFocusViewAction(s,t.title)),o.add(this.registerResetViewLocationAction(s)),this.viewDisposable.set(s,o)}}onViewDescriptorsRemoved(e){for(const t of e){const i=this.viewDisposable.get(t);i&&(i.dispose(),this.viewDisposable.delete(t))}}updateViewContainerEnablementContextKey(e){let t=this.enabledViewContainersContextKeys.get(e.id);t||(t=this.contextKeyService.createKey(kg(e.id),!1),this.enabledViewContainersContextKeys.set(e.id,t)),t.set(!(e.hideIfEmpty&&this.viewDescriptorService.getViewContainerModel(e).activeViewDescriptors.length===0))}async openComposite(e,t,i){return this.paneCompositeService.openPaneComposite(e,t,i)}getComposite(e,t){return this.paneCompositeService.getPaneComposite(e,t)}isViewContainerVisible(e){const t=this.viewDescriptorService.getViewContainerById(e);if(!t)return!1;const i=this.viewDescriptorService.getViewContainerLocation(t);return i===null?!1:this.paneCompositeService.getActivePaneComposite(i)?.getId()===e}isViewContainerActive(e){const t=this.viewDescriptorService.getViewContainerById(e);return!t||!this.contextKeyService.contextMatchesRules(t.when)?!1:t.hideIfEmpty?this.viewDescriptorService.getViewContainerModel(t).activeViewDescriptors.length>0:!0}getVisibleViewContainer(e){const t=this.paneCompositeService.getActivePaneComposite(e)?.getId();return t?this.viewDescriptorService.getViewContainerById(t):null}getActiveViewPaneContainerWithId(e){const t=this.viewDescriptorService.getViewContainerById(e);return t?this.getActiveViewPaneContainer(t):null}async openViewContainer(e,t){const i=this.viewDescriptorService.getViewContainerById(e);if(i){const s=this.viewDescriptorService.getViewContainerLocation(i);if(s!==null)return await this.paneCompositeService.openPaneComposite(e,s,t)||null}return null}async closeViewContainer(e){const t=this.viewDescriptorService.getViewContainerById(e);if(t){const i=this.viewDescriptorService.getViewContainerLocation(t),s=i!==null&&this.paneCompositeService.getActivePaneComposite(i);if(i!==null)return s?this.layoutService.setPartHidden(!0,xg(i)):void 0}}isViewVisible(e){return this.getActiveViewWithId(e)?.isBodyVisible()||!1}getActiveViewWithId(e){const t=this.viewDescriptorService.getViewContainerByViewId(e);if(t){const i=this.getActiveViewPaneContainer(t);if(i)return i.getView(e)}return null}getViewWithId(e){const t=this.viewDescriptorService.getViewContainerByViewId(e);if(t){const i=this.viewPaneContainers.get(t.id);if(i)return i.getView(e)}return null}getFocusedView(){const e=this.contextKeyService.getContextKeyValue(kl.key)??"";return this.viewDescriptorService.getViewDescriptorById(e.toString())}getFocusedViewName(){const e=this.editorService.activeTextEditorControl?.hasTextFocus()?c(14616,"Text Editor"):void 0;return this.getFocusedView()?.name?.value??e??""}async openView(e,t){const i=this.viewDescriptorService.getViewContainerByViewId(e);if(!i||!this.viewDescriptorService.getViewContainerModel(i).activeViewDescriptors.some(r=>r.id===e))return null;const s=this.viewDescriptorService.getViewContainerLocation(i),o=this.getComposite(i.id,s);if(o){const r=await this.openComposite(o.id,s);if(r?.openView)return r.openView(e,t)||null;t&&r?.focus()}return null}closeView(e){const t=this.viewDescriptorService.getViewContainerByViewId(e);if(t){const i=this.getActiveViewPaneContainer(t);if(i){const s=i.getView(e);if(s)if(i.views.length===1){const o=this.viewDescriptorService.getViewContainerLocation(t);o===ce.Sidebar?this.layoutService.setPartHidden(!0,j.SIDEBAR_PART):(o===ce.Panel||o===ce.AuxiliaryBar)&&this.paneCompositeService.hideActivePaneComposite(o),this.focusedViewContextKey.get()===e&&this.focusedViewContextKey.reset()}else s.setExpanded(!1)}}}getActiveViewPaneContainer(e){const t=this.viewDescriptorService.getViewContainerLocation(e);if(t===null)return null;const i=this.paneCompositeService.getActivePaneComposite(t);return i?.getId()===e.id&&i.getViewPaneContainer()||null}getViewProgressIndicator(e){const t=this.viewDescriptorService.getViewContainerByViewId(e);if(!t)return;const i=this.viewPaneContainers.get(t.id);if(!i)return;const s=i.getView(e);if(s)return i.isViewMergedWithContainer()?this.getViewContainerProgressIndicator(t):s.getProgressIndicator()}getViewContainerProgressIndicator(e){const t=this.viewDescriptorService.getViewContainerLocation(e);if(t!==null)return this.paneCompositeService.getProgressIndicator(e.id,t)}registerOpenViewContainerAction(e){const t=new B;if(e.openCommandActionDescriptor){const{id:i,mnemonicTitle:s,keybindings:o,order:r}=e.openCommandActionDescriptor??{id:e.id},n=e.openCommandActionDescriptor.title??e.title,d=this;if(t.add(S(class extends R{constructor(){super({id:i,get title(){const h=d.viewDescriptorService.getViewContainerLocation(e),p=typeof n=="string"?n:n.value,g=typeof n=="string"?n:n.original;return h===ce.Sidebar?{value:c(14617,"Show {0}",p),original:`Show ${g}`}:{value:c(14618,"Toggle {0}",p),original:`Toggle ${g}`}},category:T.View,precondition:I.has(kg(e.id)),keybinding:o?{...o,weight:L.WorkbenchContrib}:void 0,f1:!0})}async run(h){const p=h.get(U),g=h.get(At),f=h.get(je),m=h.get(jt),v=g.getViewContainerLocation(e);switch(v){case ce.AuxiliaryBar:case ce.Sidebar:{const E=v===ce.Sidebar?j.SIDEBAR_PART:j.AUXILIARYBAR_PART;!m.isViewContainerVisible(e.id)||!f.hasFocus(E)?await m.openViewContainer(e.id,!0):p.activeGroup.focus();break}case ce.Panel:!m.isViewContainerVisible(e.id)||!f.hasFocus(j.PANEL_PART)?await m.openViewContainer(e.id,!0):m.closeViewContainer(e.id);break}}})),s){const l=this.viewDescriptorService.getDefaultViewContainerLocation(e);t.add(_.appendMenuItem(b.MenubarViewMenu,{command:{id:i,title:s},group:l===ce.Sidebar?"3_sidebar":l===ce.AuxiliaryBar?"4_auxbar":"5_panel",when:I.has(kg(e.id)),order:r??Number.MAX_VALUE}))}}return t}registerOpenViewAction(e){const t=new B,i=e.openCommandActionDescriptor?.title??e.name,s=e.openCommandActionDescriptor?.id??`${e.id}.open`,o=this;if(t.add(S(class extends R{constructor(){super({id:s,get title(){const n=o.viewDescriptorService.getViewLocationById(e.id),d=typeof i=="string"?i:i.value,l=typeof i=="string"?i:i.original;return n===ce.Sidebar?{value:c(14617,"Show {0}",d),original:`Show ${l}`}:{value:c(14618,"Toggle {0}",d),original:`Toggle ${l}`}},category:T.View,precondition:I.has(`${e.id}.active`),keybinding:e.openCommandActionDescriptor?.keybindings?{...e.openCommandActionDescriptor.keybindings,weight:L.WorkbenchContrib}:void 0,f1:e.openCommandActionDescriptor?!0:void 0,metadata:{description:c(14619,"Opens view {0}",e.name.value),args:[{name:"options",schema:{type:"object",properties:{preserveFocus:{type:"boolean",default:!1,description:c(14620,"Whether to preserve the existing focus when opening the view.")}}}}]}})}async run(n,d){const l=n.get(U),h=n.get(At),p=n.get(je),g=n.get(jt),f=n.get(de);if(kl.getValue(f)===e.id&&!d?.preserveFocus){const v=h.getViewLocationById(e.id);h.getViewLocationById(e.id)===ce.Sidebar?l.activeGroup.focus():v!==null&&p.setPartHidden(!0,xg(v))}else await g.openView(e.id,!d?.preserveFocus)}})),e.openCommandActionDescriptor?.mnemonicTitle){const r=this.viewDescriptorService.getDefaultContainerById(e.id);if(r){const n=this.viewDescriptorService.getDefaultViewContainerLocation(r);t.add(_.appendMenuItem(b.MenubarViewMenu,{command:{id:s,title:e.openCommandActionDescriptor.mnemonicTitle},group:n===ce.Sidebar?"3_sidebar":n===ce.AuxiliaryBar?"4_auxbar":"5_panel",when:I.has(`${e.id}.active`),order:e.openCommandActionDescriptor.order??Number.MAX_VALUE}))}}return t}registerFocusViewAction(e,t){return S(class extends R{constructor(){const s=y(14621,"Focus on {0} View",e.name.value);super({id:e.focusCommand?e.focusCommand.id:`${e.id}.focus`,title:s,category:t,menu:[{id:b.CommandPalette,when:e.when}],keybinding:{when:I.has(`${e.id}.active`),weight:L.WorkbenchContrib,primary:e.focusCommand?.keybindings?.primary,secondary:e.focusCommand?.keybindings?.secondary,linux:e.focusCommand?.keybindings?.linux,mac:e.focusCommand?.keybindings?.mac,win:e.focusCommand?.keybindings?.win},metadata:{description:s.value,args:[{name:"focusOptions",description:"Focus Options",schema:{type:"object",properties:{preserveFocus:{type:"boolean",default:!1}}}}]}})}run(s,o){s.get(jt).openView(e.id,!o?.preserveFocus)}})}registerResetViewLocationAction(e){return S(class extends R{constructor(){super({id:`${e.id}.resetViewLocation`,title:y(14622,"Reset Location"),menu:[{id:b.ViewTitleContext,when:I.or(I.and(I.equals("view",e.id),I.equals(`${e.id}.defaultViewLocation`,!1))),group:"1_hide",order:2}]})}run(i){const s=i.get(At),o=s.getDefaultContainerById(e.id),r=s.getViewContainerModel(o);if(o.hideIfEmpty&&r.visibleViewDescriptors.length===0){const n=s.getDefaultViewContainerLocation(o);s.moveViewContainerToLocation(o,n,void 0,this.desc.id)}s.moveViewsToContainer([e],o,void 0,this.desc.id),i.get(jt).openView(e.id,!0)}})}registerPaneComposite(e,t){const i=this;let s=class extends cf{constructor(r,n,d,l,h,p,g){super(e.id,r,d,l,h,p,g,n)}createViewPaneContainer(r){const n=this._register(new B),d=i.createViewPaneContainer(r,e,t,n,this.instantiationService);return d instanceof Um||n.add(K.any(d.onDidAddViews,d.onDidRemoveViews,d.onTitleAreaUpdate)(()=>{this.updateTitleArea()})),d}};s=D([u(0,nt),u(1,xt),u(2,ge),u(3,z),u(4,we),u(5,st),u(6,si)],s),se.as(kC(t)).registerPaneComposite(av.create(s,e.id,typeof e.title=="string"?e.title:e.title.value,Za(e.icon)?e.icon:void 0,e.order,e.requestedIndex,e.icon instanceof F?e.icon:void 0))}deregisterPaneComposite(e,t){se.as(kC(t)).deregisterPaneComposite(e.id)}createViewPaneContainer(e,t,i,s,o){const r=o.createInstance(t.ctorDescriptor.ctor,...t.ctorDescriptor.staticArguments||[]);return this.viewPaneContainers.set(r.getId(),r),s.add(pe(()=>this.viewPaneContainers.delete(r.getId()))),s.add(r.onDidAddViews(n=>this.onViewsAdded(n))),s.add(r.onDidChangeViewVisibility(n=>this.onViewsVisibilityChanged(n,n.isBodyVisible()))),s.add(r.onDidRemoveViews(n=>this.onViewsRemoved(n))),s.add(r.onDidFocusView(n=>{this.focusedViewContextKey.get()!==n.id&&(this.focusedViewContextKey.set(n.id),this._onDidChangeFocusedView.fire())})),s.add(r.onDidBlurView(n=>{this.focusedViewContextKey.get()===n.id&&(this.focusedViewContextKey.reset(),this._onDidChangeFocusedView.fire())})),r}};Hm=D([u(0,At),u(1,_r),u(2,de),u(3,je),u(4,O)],Hm);function kg(a){return`viewContainer.${a}.enabled`}function kC(a){switch(a){case ce.AuxiliaryBar:return Us.Auxiliary;case ce.Panel:return Us.Panels;case ce.Sidebar:default:return Us.Viewlets}}function xg(a){switch(a){case ce.AuxiliaryBar:return j.AUXILIARYBAR_PART;case ce.Panel:return j.PANEL_PART;case ce.Sidebar:default:return j.SIDEBAR_PART}}class r1{constructor(){this.onWillInstantiateEditorPane=Oi.onWillInstantiateEditorPane}didInstantiateEditorPane(e){return Oi.didInstantiateEditorPane(e)}}class n1{constructor(){this._providers=new Map,this._onDidChange=new A,this.onDidChange=this._onDidChange.event}dispose(){this._onDidChange.dispose()}register(e,t,i,s){const o=this._makeKey(e,t);if(this._providers.has(o))throw new Error(`A provider for the command ${t} and menu ${e} is already registered.`);this._providers.set(o,i);const r=s?.(()=>{this._onDidChange.fire(e)});return pe(()=>{r?.dispose(),this._providers.delete(o)})}lookUp(e,t){return this._providers.get(this._makeKey(e,t))}_makeKey(e,t){return`${e.id}/${t instanceof b?t.id:t}`}}var zm;class Mc{constructor(){this.uris=[]}async perform(){return this}toString(){return"(noop)"}}class CI{constructor(e,t,i){this.newUri=e,this.oldUri=t,this.options=i,this.type="rename"}}let $m=zm=class{constructor(e,t,i,s){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=s}get uris(){return this._edits.flatMap(e=>[e.newUri,e.oldUri])}async perform(e){const t=[],i=[];for(const s of this._edits)s.options.overwrite===void 0&&s.options.ignoreIfExists&&await this._fileService.exists(s.newUri)||(t.push({file:{source:s.oldUri,target:s.newUri},overwrite:s.options.overwrite}),i.push(new CI(s.oldUri,s.newUri,s.options)));return t.length===0?new Mc:(await this._workingCopyFileService.move(t,e,this._undoRedoInfo),new zm(i,{isUndoing:!0},this._workingCopyFileService,this._fileService))}toString(){return`(rename ${this._edits.map(e=>`${e.oldUri} to ${e.newUri}`).join(", ")})`}};$m=zm=D([u(2,xp),u(3,Ve)],$m);class a1{constructor(e,t,i){this.newUri=e,this.oldUri=t,this.options=i,this.type="copy"}}let qm=class{constructor(e,t,i,s,o){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=s,this._instaService=o}get uris(){return this._edits.flatMap(e=>[e.newUri,e.oldUri])}async perform(e){const t=[];for(const o of this._edits)o.options.overwrite===void 0&&o.options.ignoreIfExists&&await this._fileService.exists(o.newUri)||t.push({file:{source:o.oldUri,target:o.newUri},overwrite:o.options.overwrite});if(t.length===0)return new Mc;const i=await this._workingCopyFileService.copy(t,e,this._undoRedoInfo),s=[];for(let o=0;o<i.length;o++){const r=i[o],n=this._edits[o];s.push(new _v(r.resource,{recursive:!0,folder:this._edits[o].options.folder||r.isDirectory,...n.options},!1))}return this._instaService.createInstance(Nc,s,{isUndoing:!0})}toString(){return`(copy ${this._edits.map(e=>`${e.oldUri} to ${e.newUri}`).join(", ")})`}};qm=D([u(2,xp),u(3,Ve),u(4,z)],qm);class SI{constructor(e,t,i){this.newUri=e,this.options=t,this.contents=i,this.type="create"}}let Nh=class{constructor(e,t,i,s,o,r){this._edits=e,this._undoRedoInfo=t,this._fileService=i,this._workingCopyFileService=s,this._instaService=o,this._textFileService=r}get uris(){return this._edits.map(e=>e.newUri)}async perform(e){const t=[],i=[],s=[];for(const o of this._edits)if(o.newUri.scheme!==ue.untitled&&!(o.options.overwrite===void 0&&o.options.ignoreIfExists&&await this._fileService.exists(o.newUri))){if(o.options.folder)t.push({resource:o.newUri});else{const r=typeof o.contents<"u"?o.contents:await this._textFileService.getEncodedReadable(o.newUri);i.push({resource:o.newUri,contents:r,overwrite:o.options.overwrite})}s.push(new _v(o.newUri,o.options,!o.options.folder&&!o.contents))}return t.length===0&&i.length===0?new Mc:(await this._workingCopyFileService.createFolder(t,e,this._undoRedoInfo),await this._workingCopyFileService.create(i,e,this._undoRedoInfo),this._instaService.createInstance(Nc,s,{isUndoing:!0}))}toString(){return`(create ${this._edits.map(e=>e.options.folder?`folder ${e.newUri}`:`file ${e.newUri} with ${e.contents?.byteLength||0} bytes`).join(", ")})`}};Nh=D([u(2,Ve),u(3,xp),u(4,z),u(5,zn)],Nh);class _v{constructor(e,t,i){this.oldUri=e,this.options=t,this.undoesCreate=i,this.type="delete"}}let Nc=class{constructor(e,t,i,s,o,r,n){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=s,this._configurationService=o,this._instaService=r,this._logService=n}get uris(){return this._edits.map(e=>e.oldUri)}async perform(e){const t=[],i=[];for(const s of this._edits){let o;try{o=await this._fileService.resolve(s.oldUri,{resolveMetadata:!0})}catch{if(!s.options.ignoreIfNotExists)throw new Error(`${s.oldUri} does not exist and can not be deleted`);continue}t.push({resource:s.oldUri,recursive:s.options.recursive,useTrash:!s.options.skipTrashBin&&this._fileService.hasCapability(s.oldUri,vb.Trash)&&this._configurationService.getValue("files.enableTrash")});let r,n=!1;if(!s.undoesCreate&&!s.options.folder&&(n=typeof s.options.maxSize=="number"&&o.size>s.options.maxSize,!n))try{r=await this._fileService.readFile(s.oldUri)}catch(d){this._logService.error(d)}n||i.push(new SI(s.oldUri,s.options,r?.value))}return t.length===0?new Mc:(await this._workingCopyFileService.delete(t,e,this._undoRedoInfo),i.length===0?new Mc:this._instaService.createInstance(Nh,i,{isUndoing:!0}))}toString(){return`(delete ${this._edits.map(e=>e.oldUri).join(", ")})`}};Nc=D([u(2,xp),u(3,Ve),u(4,te),u(5,z),u(6,et)],Nc);class d1{constructor(e,t,i,s){this.label=e,this.code=t,this.operations=i,this.confirmBeforeUndo=s,this.type=EE.Workspace,this.resources=i.flatMap(o=>o.uris)}async undo(){await this._reverse()}async redo(){await this._reverse()}async _reverse(){for(let e=0;e<this.operations.length;e++){const i=await this.operations[e].perform(Ni.None);this.operations[e]=i}}toString(){return this.operations.map(e=>String(e)).join(", ")}}let jm=class{constructor(e,t,i,s,o,r,n,d,l,h){this._label=e,this._code=t,this._undoRedoGroup=i,this._undoRedoSource=s,this._confirmBeforeUndo=o,this._progress=r,this._token=n,this._edits=d,this._instaService=l,this._undoRedoService=h}async apply(){const e=[],t={undoRedoGroupId:this._undoRedoGroup.id},i=[];for(const r of this._edits)r.newResource&&r.oldResource&&!r.options?.copy?i.push(new CI(r.newResource,r.oldResource,r.options??{})):r.newResource&&r.oldResource&&r.options?.copy?i.push(new a1(r.newResource,r.oldResource,r.options??{})):!r.newResource&&r.oldResource?i.push(new _v(r.oldResource,r.options??{},!1)):r.newResource&&!r.oldResource&&i.push(new SI(r.newResource,r.options??{},await r.options.contents));if(i.length===0)return[];const s=[];s[0]=[i[0]];for(let r=1;r<i.length;r++){const n=i[r],d=s.at(-1);d?.[0].type===n.type?d.push(n):s.push([n])}for(const r of s){if(this._token.isCancellationRequested)break;let n;switch(r[0].type){case"rename":n=this._instaService.createInstance($m,r,t);break;case"copy":n=this._instaService.createInstance(qm,r,t);break;case"delete":n=this._instaService.createInstance(Nc,r,t);break;case"create":n=this._instaService.createInstance(Nh,r,t);break}if(n){const d=await n.perform(this._token);e.push(d)}this._progress.report(void 0)}const o=new d1(this._label,this._code,e,this._confirmBeforeUndo);return this._undoRedoService.pushElement(o,this._undoRedoGroup,this._undoRedoSource),o.resources}};jm=D([u(8,z),u(9,Yb)],jm);class EI{constructor(e){this._modelReference=e,this.model=this._modelReference.object.textEditorModel,this._edits=[]}dispose(){this._modelReference.dispose()}isNoOp(){return!(this._edits.length>0||this._newEol!==void 0&&this._newEol!==this.model.getEndOfLineSequence())}addEdit(e){this._expectedModelVersionId=e.versionId;const{textEdit:t}=e;if(typeof t.eol=="number"&&(this._newEol=t.eol),!t.range&&!t.text||ze.isEmpty(t.range)&&!t.text)return;let i;t.range?i=ze.lift(t.range):i=this.model.getFullModelRange(),this._edits.push({...tf.replaceMove(i,t.text),insertAsSnippet:t.insertAsSnippet,keepWhitespace:t.keepWhitespace})}validate(){return typeof this._expectedModelVersionId>"u"||this.model.getVersionId()===this._expectedModelVersionId?{canApply:!0}:{canApply:!1,reason:this.model.uri}}getBeforeCursorState(){return null}apply(e){this._edits.length>0&&(this._edits=this._edits.map(this._transformSnippetStringToInsertText,this).sort((t,i)=>ze.compareRangesUsingStarts(t.range,i.range)),this.model.pushEditOperations(null,this._edits,()=>null,void 0,e)),this._newEol!==void 0&&this.model.pushEOL(this._newEol)}_transformSnippetStringToInsertText(e){if(!e.insertAsSnippet||!e.text)return e;const t=Lp.asInsertText(e.text);return{...e,insertAsSnippet:!1,text:t}}}class c1 extends EI{constructor(e,t){super(e),this._editor=t}getBeforeCursorState(){return this._canUseEditor()?this._editor.getSelections():null}apply(e){if(!this._canUseEditor()){super.apply();return}if(this._edits.length>0){const t=oE.get(this._editor);if(t&&this._edits.some(i=>i.insertAsSnippet)){const i=[];for(const s of this._edits)s.range&&s.text!==null&&i.push({range:ze.lift(s.range),template:s.insertAsSnippet?s.text:Lp.escape(s.text),keepWhitespace:s.keepWhitespace});t.apply(i,{undoStopBefore:!1,undoStopAfter:!1})}else this._edits=this._edits.map(this._transformSnippetStringToInsertText,this).sort((i,s)=>ze.compareRangesUsingStarts(i.range,s.range)),this._editor.executeEdits(e,this._edits)}this._newEol!==void 0&&this._editor.hasModel()&&this._editor.getModel().pushEOL(this._newEol)}_canUseEditor(){return this._editor?.getModel()?.uri.toString()===this.model.uri.toString()}}let Ym=class{constructor(e,t,i,s,o,r,n,d,l,h,p,g){this._label=e,this._code=t,this._editor=i,this._undoRedoGroup=s,this._undoRedoSource=o,this._progress=r,this._token=n,this._editorWorker=l,this._modelService=h,this._textModelResolverService=p,this._undoRedoService=g,this._edits=new js;for(const f of d){let m=this._edits.get(f.resource);m||(m=[],this._edits.set(f.resource,m)),m.push(f)}}_validateBeforePrepare(){for(const e of this._edits.values())for(const t of e)if(typeof t.versionId=="number"){const i=this._modelService.getModel(t.resource);if(i&&i.getVersionId()!==t.versionId)throw new Error(`${i.uri.toString()} has changed in the meantime`)}}async _createEditsTasks(){const e=[],t=[];for(const[i,s]of this._edits){const o=this._textModelResolverService.createModelReference(i).then(async r=>{let n,d=!1;if(this._editor?.getModel()?.uri.toString()===r.object.textEditorModel.uri.toString()?(n=new c1(r,this._editor),d=!0):n=new EI(r),e.push(n),!d){s.forEach(n.addEdit,n);return}const l=async(g,f)=>{const m=s.slice(g,f),v=await this._editorWorker.computeMoreMinimalEdits(r.object.textEditorModel.uri,m.map(E=>E.textEdit),!1);v?v.forEach(E=>n.addEdit(new Io(r.object.textEditorModel.uri,E,void 0,void 0))):m.forEach(n.addEdit,n)};let h=0,p=0;for(;p<s.length;p++)(s[p].textEdit.insertAsSnippet||s[p].metadata)&&(await l(h,p),n.addEdit(s[p]),h=p+1);await l(h,p)});t.push(o)}return await Promise.all(t),e}_validateTasks(e){for(const t of e){const i=t.validate();if(!i.canApply)return i}return{canApply:!0}}async apply(e){this._validateBeforePrepare();const t=await this._createEditsTasks();try{if(this._token.isCancellationRequested)return[];const i=[],s=this._validateTasks(t);if(!s.canApply)throw new Error(`${s.reason.toString()} has changed in the meantime`);if(t.length===1){const o=t[0];if(!o.isNoOp()){const r=new Ly(this._label,this._code,o.model,o.getBeforeCursorState());this._undoRedoService.pushElement(r,this._undoRedoGroup,this._undoRedoSource),o.apply(e),r.close(),i.push(o.model.uri)}this._progress.report(void 0)}else{const o=new nx(this._label,this._code,t.map(r=>new Ly(this._label,this._code,r.model,r.getBeforeCursorState())));this._undoRedoService.pushElement(o,this._undoRedoGroup,this._undoRedoSource);for(const r of t)r.apply(),this._progress.report(void 0),i.push(r.model.uri);o.close()}return i}finally{dt(t)}}};Ym=D([u(8,ax),u(9,Ro),u(10,$n),u(11,Yb)],Ym);class Ur extends dx{static is(e){return e instanceof Ur?!0:bp(e)&&!!(e.undo&&e.redo)}static lift(e){return e instanceof Ur?e:new Ur(e.resource,e.undo,e.redo,e.metadata)}constructor(e,t,i,s){super(s),this.resource=e,this.undo=t,this.redo=i}}let Xm=class{constructor(e,t,i,s,o,r){this._undoRedoGroup=e,this._undoRedoSource=t,this._progress=i,this._token=s,this._edits=o,this._undoRedoService=r}async apply(){const e=[];for(const t of this._edits){if(this._token.isCancellationRequested)break;await t.redo(),this._undoRedoService.pushElement({type:EE.Resource,resource:t.resource,label:t.metadata?.label||"Custom Edit",code:"paste",undo:t.undo,redo:t.redo},this._undoRedoGroup,this._undoRedoSource),this._progress.report(void 0),e.push(t.resource)}return e}};Xm=D([u(5,Yb)],Xm);function l1(a){return a.map(e=>{if(Io.is(e))return Io.lift(e);if(Qi.is(e))return Qi.lift(e);if(sh.is(e))return sh.lift(e);if(Ur.is(e))return Ur.lift(e);throw new Error("Unsupported edit")})}let Jm=class{constructor(e,t,i,s,o,r,n,d,l,h,p){this._label=e,this._code=t,this._editor=i,this._progress=s,this._token=o,this._edits=r,this._undoRedoGroup=n,this._undoRedoSource=d,this._confirmBeforeUndo=l,this._instaService=h,this._logService=p}ariaMessage(){const e=new js,t=new js;let i=0;for(const s of this._edits)s instanceof Io?(i+=1,t.set(s.resource,!0)):s instanceof Qi&&e.set(s.oldResource??s.newResource,!0);return this._edits.length===0?c(4506,"Made no edits"):e.size===0?i>1&&t.size>1?c(4507,"Made {0} text edits in {1} files",i,t.size):c(4508,"Made {0} text edits in one file",i):c(4509,"Made {0} text edits in {1} files, also created or deleted {2} files",i,t.size,e.size)}async perform(e){if(this._edits.length===0)return[];const t=[1];for(let n=1;n<this._edits.length;n++)Object.getPrototypeOf(this._edits[n-1])===Object.getPrototypeOf(this._edits[n])?t[t.length-1]++:t.push(1);const i=this._edits.length>1?0:void 0;this._progress.report({increment:i,total:100});const s={report:n=>this._progress.report({increment:100/this._edits.length})},o=[];let r=0;for(const n of t){if(this._token.isCancellationRequested)break;const d=this._edits.slice(r,r+n);d[0]instanceof Qi?o.push(await this._performFileEdits(d,this._undoRedoGroup,this._undoRedoSource,this._confirmBeforeUndo,s)):d[0]instanceof Io?o.push(await this._performTextEdits(d,this._undoRedoGroup,this._undoRedoSource,s,e)):d[0]instanceof sh?o.push(await this._performCellEdits(d,this._undoRedoGroup,this._undoRedoSource,s)):d[0]instanceof Ur?o.push(await this._performOpaqueEdits(d,this._undoRedoGroup,this._undoRedoSource,s)):console.log("UNKNOWN EDIT"),r=r+n}return o.flat()}async _performFileEdits(e,t,i,s,o){return this._logService.debug("_performFileEdits",JSON.stringify(e)),await this._instaService.createInstance(jm,this._label||c(4510,"Workspace Edit"),this._code||"undoredo.workspaceEdit",t,i,s,o,this._token,e).apply()}async _performTextEdits(e,t,i,s,o){return this._logService.debug("_performTextEdits",JSON.stringify(e)),await this._instaService.createInstance(Ym,this._label||c(4510,"Workspace Edit"),this._code||"undoredo.workspaceEdit",this._editor,t,i,s,this._token,e).apply(o)}async _performCellEdits(e,t,i,s){return this._logService.debug("_performCellEdits",JSON.stringify(e)),await this._instaService.createInstance(ux,t,i,s,this._token,e).apply()}async _performOpaqueEdits(e,t,i,s){return this._logService.debug("_performOpaqueEdits",JSON.stringify(e)),await this._instaService.createInstance(Xm,t,i,s,this._token,e).apply()}};Jm=D([u(9,z),u(10,et)],Jm);let Zm=class{constructor(e,t,i,s,o,r,n){this._instaService=e,this._logService=t,this._editorService=i,this._lifecycleService=s,this._dialogService=o,this._workingCopyService=r,this._configService=n,this._activeUndoRedoGroups=new _E}setPreviewHandler(e){return this._previewHandler=e,pe(()=>{this._previewHandler===e&&(this._previewHandler=void 0)})}hasPreviewHandler(){return!!this._previewHandler}async apply(e,t){let i=l1(Array.isArray(e)?e:e.edits);if(i.length===0)return{ariaSummary:c(4511,"Made no edits"),isApplied:!1};this._previewHandler&&(t?.showPreview||i.some(h=>h.metadata?.needsConfirmation))&&(i=await this._previewHandler(i,t));let s=t?.editor;if(!s){const h=this._editorService.activeTextEditorControl;cx(h)?s=h:TS(h)&&(s=h.getModifiedEditor())}s&&s.getOption(li.readOnly)&&(s=void 0);let o,r=()=>{};if(typeof t?.undoRedoGroupId=="number"){for(const h of this._activeUndoRedoGroups)if(h.id===t.undoRedoGroupId){o=h;break}}o||(o=new lx,r=this._activeUndoRedoGroups.push(o));const n=t?.quotableLabel||t?.label,d=this._instaService.createInstance(Jm,n,t?.code,s,t?.progress??vE.None,t?.token??Ni.None,i,o,t?.undoRedoSource,!!t?.confirmBeforeUndo);let l;try{l=this._lifecycleService.onBeforeShutdown(p=>p.veto(this._shouldVeto(n,p.reason),"veto.blukEditService"));const h=await d.perform(t?.reason);return t?.respectAutoSaveConfig&&this._configService.getValue(_I)===!0&&h.length>1&&await this._saveAll(h),{ariaSummary:d.ariaMessage(),isApplied:i.length>0}}catch(h){throw this._logService.error(h),h}finally{l?.dispose(),r()}}async _saveAll(e){const t=new hx(e),i=this._workingCopyService.dirtyWorkingCopies.map(async o=>{t.has(o.resource)&&await o.save()}),s=await Promise.allSettled(i);for(const o of s)o.status==="rejected"&&this._logService.warn(o.reason)}async _shouldVeto(e,t){let i;switch(t){case Wd.CLOSE:i=c(4512,"Are you sure you want to close the window?");break;case Wd.LOAD:i=c(4513,"Are you sure you want to change the workspace?");break;case Wd.RELOAD:i=c(4514,"Are you sure you want to reload the window?");break;default:i=Ge?c(4515,"Are you sure you want to quit?"):c(4516,"Are you sure you want to exit?");break}return!(await this._dialogService.confirm({message:i,detail:c(4517,"'{0}' is in progress.",e||c(4518,"File operation"))})).confirmed}};Zm=D([u(0,z),u(1,et),u(2,O),u(3,gd),u(4,Bi),u(5,IE),u(6,te)],Zm);const _I="files.refactoring.autoSave";se.as(Lo.Configuration).registerConfiguration({id:"files",properties:{[_I]:{description:c(4519,"Controls if files that were part of a refactoring are saved automatically"),default:!0,type:"boolean"}}});const h1=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));let Qm=class{constructor(e,t,i,s){this._conflicts=new js,this._disposables=new B,this._onDidConflict=new A,this.onDidConflict=this._onDidConflict.event;const o=new js;for(const n of e)if(n instanceof Io){if(o.set(n.resource,!0),typeof n.versionId=="number"){const d=i.getModel(n.resource);d&&d.getVersionId()!==n.versionId&&(this._conflicts.set(n.resource,!0),this._onDidConflict.fire(this))}}else n instanceof Qi?n.newResource?o.set(n.newResource,!0):n.oldResource&&o.set(n.oldResource,!0):n instanceof sh?o.set(n.resource,!0):s.warn("UNKNOWN edit type",n);this._disposables.add(t.onDidFilesChange(n=>{for(const d of o.keys())if(!i.getModel(d)&&n.contains(d)){this._conflicts.set(d,!0),this._onDidConflict.fire(this);break}}));const r=n=>{o.has(n.uri)&&(this._conflicts.set(n.uri,!0),this._onDidConflict.fire(this))};for(const n of i.getModels())this._disposables.add(n.onDidChangeContent(()=>r(n)))}dispose(){this._disposables.dispose(),this._onDidConflict.dispose()}list(){return[...this._conflicts.keys()]}hasConflicts(){return this._conflicts.size>0}};Qm=D([u(1,Ve),u(2,Ro),u(3,et)],Qm);var ew,Pd;class u1{constructor(){this._states=new WeakMap,this._checkedCount=0,this._onDidChange=new A,this.onDidChange=this._onDidChange.event}dispose(){this._onDidChange.dispose()}get checkedCount(){return this._checkedCount}isChecked(e){return this._states.get(e)??!1}updateChecked(e,t){const i=this._states.get(e);i!==t&&(i===void 0?t&&(this._checkedCount+=1):t?this._checkedCount+=1:this._checkedCount-=1,this._states.set(e,t),this._onDidChange.fire(e))}}class p1{constructor(e,t){this.parent=e,this.textEdit=t}}var gt;(function(a){a[a.TextEdit=1]="TextEdit",a[a.Create=2]="Create",a[a.Delete=4]="Delete",a[a.Rename=8]="Rename"})(gt||(gt={}));class g1{constructor(e,t){this.uri=e,this.parent=t,this.type=0,this.textEdits=[],this.originalEdits=new Map}addEdit(e,t,i){this.type|=t,this.originalEdits.set(e,i),i instanceof Io?this.textEdits.push(new p1(this,i)):t===gt.Rename&&(this.newUri=i.newResource)}needsConfirmation(){for(const[,e]of this.originalEdits)if(!this.parent.checked.isChecked(e))return!0;return!1}}const Zu=class Zu{static keyOf(e){return e?.label||"<default>"}constructor(e=Zu._defaultMetadata){this.metadata=e,this.operationByResource=new Map}get fileOperations(){return this.operationByResource.values()}};Zu._defaultMetadata=Object.freeze({label:c(4536,"Other"),icon:P.symbolFile,needsConfirmation:!1});let Fh=Zu,Bh=ew=class{static async create(e,t){return await e.get(z).createInstance(ew,t)._init()}constructor(e,t,i){this._bulkEdit=e,this._fileService=t,this.checked=new u1,this.fileOperations=[],this.categories=[],this.conflicts=i.createInstance(Qm,e)}dispose(){this.checked.dispose(),this.conflicts.dispose()}async _init(){const e=new Map,t=new Map,i=new js;for(let s=0;s<this._bulkEdit.length;s++){const o=this._bulkEdit[s];let r,n;if(this.checked.updateChecked(o,!o.metadata?.needsConfirmation),o instanceof Io)n=gt.TextEdit,r=o.resource;else if(o instanceof Qi)if(o.newResource&&o.oldResource){if(n=gt.Rename,r=o.oldResource,o.options?.overwrite===void 0&&o.options?.ignoreIfExists&&await this._fileService.exists(r))continue;i.set(o.newResource,r)}else if(o.oldResource){if(n=gt.Delete,r=o.oldResource,o.options?.ignoreIfNotExists&&!await this._fileService.exists(r))continue}else if(o.newResource){if(n=gt.Create,r=o.newResource,o.options?.overwrite===void 0&&o.options?.ignoreIfExists&&await this._fileService.exists(r))continue}else continue;else continue;const d=(p,g)=>{let f=Kg.getComparisonKey(p,!0),m=g.get(f);!m&&i.has(p)&&(p=i.get(p),f=Kg.getComparisonKey(p,!0),m=g.get(f)),m||(m=new g1(p,this),g.set(f,m)),m.addEdit(s,n,o)};d(r,e);const l=Fh.keyOf(o.metadata);let h=t.get(l);h||(h=new Fh(o.metadata),t.set(l,h)),d(r,h.operationByResource)}e.forEach(s=>this.fileOperations.push(s)),t.forEach(s=>this.categories.push(s));for(const s of this.fileOperations)if(s.type!==gt.TextEdit){let o=!0;for(const r of s.originalEdits.values())r instanceof Qi&&(o=o&&this.checked.isChecked(r));if(!o)for(const r of s.originalEdits.values())this.checked.updateChecked(r,o)}return this.categories.sort((s,o)=>s.metadata.needsConfirmation===o.metadata.needsConfirmation?s.metadata.label.localeCompare(o.metadata.label):s.metadata.needsConfirmation?-1:1),this}getWorkspaceEdit(){const e=[];let t=!0;for(let i=0;i<this._bulkEdit.length;i++){const s=this._bulkEdit[i];if(this.checked.isChecked(s)){e[i]=s;continue}t=!1}return t?this._bulkEdit:(fx(e),e)}async getFileEditOperation(e){const t=await e.options.contents;if(t)return tf.replaceMove(ze.lift({startLineNumber:0,startColumn:0,endLineNumber:Number.MAX_VALUE,endColumn:0}),t.toString())}async getFileEdits(e){for(const t of this.fileOperations)if(t.uri.toString()===e.toString()){const i=[];let s=!1;for(const o of t.originalEdits.values())o instanceof Qi?i.push(this.getFileEditOperation(o)):o instanceof Io?this.checked.isChecked(o)&&i.push(Promise.resolve(tf.replaceMove(ze.lift(o.textEdit.range),o.textEdit.insertAsSnippet?Lp.asInsertText(o.textEdit.text):o.textEdit.text))):this.checked.isChecked(o)||(s=!0);return s?[]:(await Promise.all(i)).filter(o=>o!==void 0).sort((o,r)=>ze.compareRangesUsingStarts(o.range,r.range))}return[]}getUriOfEdit(e){for(const t of this.fileOperations)for(const i of t.originalEdits.values())if(i===e)return t.uri;throw new Error("invalid edit")}};Bh=ew=D([u(1,Ve),u(2,z)],Bh);var yo;let Gh=(yo=class{static fromPreviewUri(e){return F.parse(e.query)}constructor(e,t,i,s){this._operations=e,this._languageService=t,this._modelService=i,this._textModelResolverService=s,this._disposables=new B,this._modelPreviewEdits=new Map,this._instanceId=fd(),this._disposables.add(this._textModelResolverService.registerTextModelContentProvider(Pd.Schema,this)),this._ready=this._init()}dispose(){this._disposables.dispose()}asPreviewUri(e){const t=e.scheme===ue.untitled?`/${e.path}`:e.path;return F.from({scheme:Pd.Schema,authority:this._instanceId,path:t,query:e.toString()})}async _init(){for(const e of this._operations.fileOperations)await this._applyTextEditsToPreviewModel(e.uri);this._disposables.add(K.debounce(this._operations.checked.onDidChange,(e,t)=>t,px)(e=>{const t=this._operations.getUriOfEdit(e);this._applyTextEditsToPreviewModel(t)}))}async _applyTextEditsToPreviewModel(e){const t=await this._getOrCreatePreviewModel(e),i=this._modelPreviewEdits.get(t.id);i&&t.applyEdits(i);const s=await this._operations.getFileEdits(e),o=t.applyEdits(s,!0);this._modelPreviewEdits.set(t.id,o)}async _getOrCreatePreviewModel(e){const t=this.asPreviewUri(e);let i=this._modelService.getModel(t);if(!i){try{const s=await this._textModelResolverService.createModelReference(e),o=s.object.textEditorModel;i=this._modelService.createModel(gx(o.createSnapshot()),this._languageService.createById(o.getLanguageId()),t),s.dispose()}catch{i=this._modelService.createModel("",this._languageService.createByFilepathOrFirstLine(t),t)}queueMicrotask(async()=>{this._disposables.add(await this._textModelResolverService.createModelReference(i.uri))})}return i}async provideTextContent(e){return e.toString()===Pd.emptyPreview.toString()?this._modelService.createModel("",null,e):(await this._ready,this._modelService.getModel(e))}},Pd=yo,yo.Schema="vscode-bulkeditpreview-editor",yo.emptyPreview=F.from({scheme:yo.Schema,fragment:"empty"}),yo);Gh=Pd=D([u(1,Es),u(2,Ro),u(3,$n)],Gh);var tw,iw,sw;class Ti{constructor(e,t){this.parent=e,this.category=t}isChecked(){const e=this.parent;let t=!0;for(const i of this.category.fileOperations)for(const s of i.originalEdits.values())t=t&&e.checked.isChecked(s);return t}setChecked(e){const t=this.parent;for(const i of this.category.fileOperations)for(const s of i.originalEdits.values())t.checked.updateChecked(s,e)}}class Li{constructor(e,t){this.parent=e,this.edit=t}isChecked(){const e=this.parent instanceof Ti?this.parent.parent:this.parent;let t=!0;this.edit.type===gt.TextEdit&&(t=!this.edit.textEdits.every(i=>!e.checked.isChecked(i.textEdit)));for(const i of this.edit.originalEdits.values())i instanceof Qi&&(t=t&&e.checked.isChecked(i));if(this.parent instanceof Ti&&this.edit.type===gt.TextEdit){for(const i of e.categories)for(const s of i.fileOperations)if(s.uri.toString()===this.edit.uri.toString())for(const o of s.originalEdits.values())o instanceof Qi&&(t=t&&e.checked.isChecked(o))}return t}setChecked(e){const t=this.parent instanceof Ti?this.parent.parent:this.parent;for(const i of this.edit.originalEdits.values())t.checked.updateChecked(i,e);if(this.parent instanceof Ti&&this.edit.type!==gt.TextEdit){for(const i of t.categories)for(const s of i.fileOperations)if(s.uri.toString()===this.edit.uri.toString())for(const o of s.originalEdits.values())t.checked.updateChecked(o,e)}}isDisabled(){if(this.parent instanceof Ti&&this.edit.type===gt.TextEdit){const e=this.parent.parent;let t=!0;for(const i of e.categories)for(const s of i.fileOperations)if(s.uri.toString()===this.edit.uri.toString())for(const o of s.originalEdits.values())o instanceof Qi&&(t=t&&e.checked.isChecked(o));return!t}return!1}}class Ao{constructor(e,t,i,s,o,r,n){this.parent=e,this.idx=t,this.edit=i,this.prefix=s,this.selecting=o,this.inserting=r,this.suffix=n}isChecked(){let e=this.parent.parent;return e instanceof Ti&&(e=e.parent),e.checked.isChecked(this.edit.textEdit)}setChecked(e){let t=this.parent.parent;if(t instanceof Ti&&(t=t.parent),t.checked.updateChecked(this.edit.textEdit,e),e)for(const i of this.parent.edit.originalEdits.values())i instanceof Qi&&t.checked.updateChecked(i,e)}isDisabled(){return this.parent.isDisabled()}}let ow=class{constructor(e,t){this._textModelService=e,this._instantiationService=t,this.groupByFile=!0}hasChildren(e){return e instanceof Li?e.edit.textEdits.length>0:!(e instanceof Ao)}async getChildren(e){if(e instanceof Bh)return this.groupByFile?e.fileOperations.map(t=>new Li(e,t)):e.categories.map(t=>new Ti(e,t));if(e instanceof Ti)return Array.from(e.category.fileOperations,t=>new Li(e,t));if(e instanceof Li&&e.edit.textEdits.length>0){let t,i;try{const o=await this._textModelService.createModelReference(e.edit.uri);t=o.object.textEditorModel,i=o}catch{t=this._instantiationService.createInstance(Ry,"",oh,Ry.DEFAULT_CREATION_OPTIONS,null),i=t}const s=e.edit.textEdits.map((o,r)=>{const n=t.validateRange(o.textEdit.textEdit.range),d=t.tokenization.getLineTokens(n.startLineNumber);let l=23;for(let g=d.findTokenIndexAtOffset(n.startColumn-1)-1;l<50&&g>=0;g--)l=n.startColumn-d.getStartOffset(g);const h=t.tokenization.getLineTokens(n.endLineNumber);let p=0;for(let g=h.findTokenIndexAtOffset(n.endColumn-1);p<50&&g<h.getCount();g++)p+=h.getEndOffset(g)-h.getStartOffset(g);return new Ao(e,r,o,t.getValueInRange(new ze(n.startLineNumber,n.startColumn-l,n.startLineNumber,n.startColumn)),t.getValueInRange(n),o.textEdit.textEdit.insertAsSnippet?Lp.asInsertText(o.textEdit.textEdit.text):o.textEdit.textEdit.text,t.getValueInRange(new ze(n.endLineNumber,n.endColumn,n.endLineNumber,n.endColumn+p)))});return i.dispose(),s}return[]}};ow=D([u(0,$n),u(1,z)],ow);class f1{compare(e,t){return e instanceof Li&&t instanceof Li?II(e.edit,t.edit):e instanceof Ao&&t instanceof Ao?ze.compareRangesUsingStarts(e.edit.textEdit.textEdit.range,t.edit.textEdit.textEdit.range):0}}function II(a,e){return Vp(a.uri.toString(),e.uri.toString())}let rw=class{constructor(e){this._labelService=e}getWidgetAriaLabel(){return c(4537,"Bulk Edit")}getRole(e){return"checkbox"}getAriaLabel(e){if(e instanceof Li){if(e.edit.textEdits.length>0)return e.edit.type&gt.Rename&&e.edit.newUri?c(4538,"Renaming {0} to {1}, also making text edits",this._labelService.getUriLabel(e.edit.uri,{relative:!0}),this._labelService.getUriLabel(e.edit.newUri,{relative:!0})):e.edit.type&gt.Create?c(4539,"Creating {0}, also making text edits",this._labelService.getUriLabel(e.edit.uri,{relative:!0})):e.edit.type&gt.Delete?c(4540,"Deleting {0}, also making text edits",this._labelService.getUriLabel(e.edit.uri,{relative:!0})):c(4541,"{0}, making text edits",this._labelService.getUriLabel(e.edit.uri,{relative:!0}));if(e.edit.type&gt.Rename&&e.edit.newUri)return c(4542,"Renaming {0} to {1}",this._labelService.getUriLabel(e.edit.uri,{relative:!0}),this._labelService.getUriLabel(e.edit.newUri,{relative:!0}));if(e.edit.type&gt.Create)return c(4543,"Creating {0}",this._labelService.getUriLabel(e.edit.uri,{relative:!0}));if(e.edit.type&gt.Delete)return c(4544,"Deleting {0}",this._labelService.getUriLabel(e.edit.uri,{relative:!0}))}if(e instanceof Ao){if(e.selecting.length>0&&e.inserting.length>0)return c(4545,"line {0}, replacing {1} with {2}",e.edit.textEdit.textEdit.range.startLineNumber,e.selecting,e.inserting);if(e.selecting.length>0&&e.inserting.length===0)return c(4546,"line {0}, removing {1}",e.edit.textEdit.textEdit.range.startLineNumber,e.selecting);if(e.selecting.length===0&&e.inserting.length>0)return c(4547,"line {0}, inserting {1}",e.edit.textEdit.textEdit.range.startLineNumber,e.selecting)}return null}};rw=D([u(0,rs)],rw);class m1{getId(e){return e instanceof Li?e.edit.uri+(e.parent instanceof Ti?JSON.stringify(e.parent.category.metadata):""):e instanceof Ao?e.parent.edit.uri.toString()+e.idx:JSON.stringify(e.category.metadata)}}class w1{constructor(e){e.classList.add("category"),this.icon=ve("div"),e.appendChild(this.icon),this.label=new Rp(e)}}var pn;let Wh=(pn=class{constructor(e){this._themeService=e,this.templateId=tw.id}renderTemplate(e){return new w1(e)}renderElement(e,t,i){i.icon.style.setProperty("--background-dark",null),i.icon.style.setProperty("--background-light",null),i.icon.style.color="";const{metadata:s}=e.element.category;if(Se.isThemeIcon(s.iconPath)){const o=Se.asClassName(s.iconPath);i.icon.className=o?`theme-icon ${o}`:"",i.icon.style.color=s.iconPath.color?this._themeService.getColorTheme().getColor(s.iconPath.color.id)?.toString()??"":""}else F.isUri(s.iconPath)?(i.icon.className="uri-icon",i.icon.style.setProperty("--background-dark",go(s.iconPath)),i.icon.style.setProperty("--background-light",go(s.iconPath))):s.iconPath&&(i.icon.className="uri-icon",i.icon.style.setProperty("--background-dark",go(s.iconPath.dark)),i.icon.style.setProperty("--background-light",go(s.iconPath.light)));i.label.setLabel(s.label,s.description,{descriptionMatches:An(e.filterData)})}disposeTemplate(e){e.label.dispose()}},tw=pn,pn.id="CategoryElementRenderer",pn);Wh=tw=D([u(0,we)],Wh);let nw=class{constructor(e,t,i){this._labelService=i,this._disposables=new B,this._localDisposables=new B,this._checkbox=ve("input"),this._checkbox.className="edit-checkbox",this._checkbox.type="checkbox",this._checkbox.setAttribute("role","checkbox"),e.appendChild(this._checkbox),this._label=t.create(e,{supportHighlights:!0}),this._details=ve("span"),this._details.className="details",e.appendChild(this._details)}dispose(){this._localDisposables.dispose(),this._disposables.dispose(),this._label.dispose()}set(e,t){if(this._localDisposables.clear(),this._checkbox.checked=e.isChecked(),this._checkbox.disabled=e.isDisabled(),this._localDisposables.add(X(this._checkbox,"change",()=>{e.setChecked(this._checkbox.checked)})),e.edit.type&gt.Rename&&e.edit.newUri)this._label.setResource({resource:e.edit.uri,name:c(4548,"{0}  {1}",this._labelService.getUriLabel(e.edit.uri,{relative:!0}),this._labelService.getUriLabel(e.edit.newUri,{relative:!0}))},{fileDecorations:{colors:!0,badges:!1}}),this._details.innerText=c(4549,"(renaming)");else{const i={matches:An(t),fileKind:$t.FILE,fileDecorations:{colors:!0,badges:!1},extraClasses:[]};e.edit.type&gt.Create?this._details.innerText=c(4550,"(creating)"):e.edit.type&gt.Delete?(this._details.innerText=c(4551,"(deleting)"),i.extraClasses.push("delete")):this._details.innerText="",this._label.setFile(e.edit.uri,i)}}};nw=D([u(2,rs)],nw);var gn;let Kh=(gn=class{constructor(e,t){this._resourceLabels=e,this._labelService=t,this.templateId=iw.id}renderTemplate(e){return new nw(e,this._resourceLabels,this._labelService)}renderElement(e,t,i){i.set(e.element,e.filterData)}disposeTemplate(e){e.dispose()}},iw=gn,gn.id="FileElementRenderer",gn);Kh=iw=D([u(1,rs)],Kh);let aw=class{constructor(e,t){this._themeService=t,this._disposables=new B,this._localDisposables=new B,e.classList.add("textedit"),this._checkbox=ve("input"),this._checkbox.className="edit-checkbox",this._checkbox.type="checkbox",this._checkbox.setAttribute("role","checkbox"),e.appendChild(this._checkbox),this._icon=ve("div"),e.appendChild(this._icon),this._label=this._disposables.add(new mx(e))}dispose(){this._localDisposables.dispose(),this._disposables.dispose()}set(e){this._localDisposables.clear(),this._localDisposables.add(X(this._checkbox,"change",d=>{e.setChecked(this._checkbox.checked),d.preventDefault()})),e.parent.isChecked()?(this._checkbox.checked=e.isChecked(),this._checkbox.disabled=e.isDisabled()):(this._checkbox.checked=e.isChecked(),this._checkbox.disabled=e.isDisabled());let t="";t+=e.prefix,t+=e.selecting,t+=e.inserting,t+=e.suffix;const i={start:e.prefix.length,end:e.prefix.length+e.selecting.length,extraClasses:["remove"]},s={start:i.end,end:i.end+e.inserting.length,extraClasses:["insert"]};let o;const{metadata:r}=e.edit.textEdit;r&&r.description?o=c(4552,"{0} - {1}",r.label,r.description):r&&(o=r.label);const n=r?.iconPath;if(!n)this._icon.style.display="none";else if(this._icon.style.display="block",this._icon.style.setProperty("--background-dark",null),this._icon.style.setProperty("--background-light",null),Se.isThemeIcon(n)){const d=Se.asClassName(n);this._icon.className=d?`theme-icon ${d}`:"",this._icon.style.color=n.color?this._themeService.getColorTheme().getColor(n.color.id)?.toString()??"":""}else F.isUri(n)?(this._icon.className="uri-icon",this._icon.style.setProperty("--background-dark",go(n)),this._icon.style.setProperty("--background-light",go(n))):(this._icon.className="uri-icon",this._icon.style.setProperty("--background-dark",go(n.dark)),this._icon.style.setProperty("--background-light",go(n.light)));this._label.set(t,[i,s],o,!0),this._icon.title=o||""}};aw=D([u(1,we)],aw);var fn;let Uh=(fn=class{constructor(e){this._themeService=e,this.templateId=sw.id}renderTemplate(e){return new aw(e,this._themeService)}renderElement({element:e},t,i){i.set(e)}disposeTemplate(e){}},sw=fn,fn.id="TextEditElementRenderer",fn);Uh=sw=D([u(0,we)],Uh);class b1{getHeight(){return 23}getTemplateId(e){return e instanceof Li?Kh.id:e instanceof Ao?Uh.id:Wh.id}}class v1{getKeyboardNavigationLabel(e){if(e instanceof Li)return Dt(e.edit.uri);if(e instanceof Ti)return e.category.metadata.label}}var Wo;xe(h1);var ec;(function(a){a.Data="data",a.Message="message"})(ec||(ec={}));var _i;let ft=(_i=class extends Pp{constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m,v,E){super({...e,titleMenuId:b.BulkEditTitle},p,g,f,l,h,t,m,v,E),this._instaService=t,this._editorService=i,this._labelService=s,this._textModelService=o,this._dialogService=r,this._contextMenuService=n,this._storageService=d,this._treeViewStates=new Map,this._disposables=new B,this._sessionDisposables=new B,this._computeResourceDiffEditorInputs=new wx(async x=>{const G=new bx(async H=>{const ie=H.uri,q=this._currentProvider.asPreviewUri(ie);if(H.type&gt.Delete)return{original:{resource:F.revive(q)},modified:{resource:void 0},goToFileResource:H.uri};{let ae;try{(await this._textModelService.createModelReference(ie)).dispose(),ae=ie}catch{ae=Gh.emptyPreview}return{original:{resource:F.revive(ae)},modified:{resource:F.revive(q)},goToFileResource:ae}}}),W=x.slice().sort(II),Y=[];for(const H of W)Y.push(await G.get(H));return{resources:Y,getResourceDiffEditorInputIdOfOperation:async H=>{const ie=await G.get(H);return{original:ie.original.resource,modified:ie.modified.resource}}}}),this.element.classList.add("bulk-edit-panel","show-file-icons"),this._ctxHasCategories=Wo.ctxHasCategories.bindTo(l),this._ctxGroupByFile=Wo.ctxGroupByFile.bindTo(l),this._ctxHasCheckedChanges=Wo.ctxHasCheckedChanges.bindTo(l)}dispose(){this._tree.dispose(),this._disposables.dispose(),super.dispose()}renderBody(e){super.renderBody(e);const t=this._instaService.createInstance(jc,{onDidChangeVisibility:this.onDidChangeBodyVisibility});this._disposables.add(t);const i=ve("div");i.className="content",e.appendChild(i);const s=ve("div");i.appendChild(s),this._treeDataSource=this._instaService.createInstance(ow),this._treeDataSource.groupByFile=this._storageService.getBoolean(Wo._memGroupByFile,ee.PROFILE,!0),this._ctxGroupByFile.set(this._treeDataSource.groupByFile),this._tree=this._instaService.createInstance(cd,this.id,s,new b1,[this._instaService.createInstance(Uh),this._instaService.createInstance(Kh,t),this._instaService.createInstance(Wh)],this._treeDataSource,{accessibilityProvider:this._instaService.createInstance(rw),identityProvider:new m1,expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,keyboardNavigationLabelProvider:new v1,sorter:new f1,selectionNavigation:!0}),this._disposables.add(this._tree.onContextMenu(this._onContextMenu,this)),this._disposables.add(this._tree.onDidOpen(l=>this._openElementInMultiDiffEditor(l)));const o=ve("div");o.className="buttons",i.appendChild(o);const r=new mb(o);this._disposables.add(r);const n=r.addButton({supportIcons:!0,...Xa});n.label=c(4531,"Apply"),n.onDidClick(()=>this.accept(),this,this._disposables);const d=r.addButton({...Xa,secondary:!0});d.label=c(4532,"Discard"),d.onDidClick(()=>this.discard(),this,this._disposables),this._message=ve("span"),this._message.className="message",this._message.innerText=c(4533,"Invoke a code action, like rename, to see a preview of its changes here."),e.appendChild(this._message),this._setState(ec.Message)}layoutBody(e,t){super.layoutBody(e,t);const i=e-50;this._tree.getHTMLElement().parentElement.style.height=`${i}px`,this._tree.layout(i,t)}_setState(e){this.element.dataset.state=e}async setInput(e,t){this._setState(ec.Data),this._sessionDisposables.clear(),this._treeViewStates.clear(),this._currentResolve&&(this._currentResolve(void 0),this._currentResolve=void 0);const i=await this._instaService.invokeFunction(Bh.create,e);this._currentProvider=this._instaService.createInstance(Gh,i),this._sessionDisposables.add(this._currentProvider),this._sessionDisposables.add(i);const s=i.categories.length>1;return this._ctxHasCategories.set(s),this._treeDataSource.groupByFile=!s||this._treeDataSource.groupByFile,this._ctxHasCheckedChanges.set(i.checked.checkedCount>0),this._currentInput=i,new Promise(o=>{t.onCancellationRequested(()=>o(void 0)),this._currentResolve=o,this._setTreeInput(i),this._sessionDisposables.add(i.checked.onDidChange(()=>{this._tree.updateChildren(),this._ctxHasCheckedChanges.set(i.checked.checkedCount>0)}))})}hasInput(){return!!this._currentInput}async _setTreeInput(e){const t=this._treeViewStates.get(this._treeDataSource.groupByFile);if(await this._tree.setInput(e,t),this._tree.domFocus(),t)return;const i=[...this._tree.getNode(e).children].slice(0,10);for(;i.length>0;){const{element:s}=i.shift();s instanceof Li&&await this._tree.expand(s,!0),s instanceof Ti&&(await this._tree.expand(s,!0),i.push(...this._tree.getNode(s).children))}}accept(){const e=this._currentInput?.conflicts.list();if(!e||e.length===0){this._done(!0);return}let t;e.length===1?t=c(4534,"Cannot apply refactoring because '{0}' has changed in the meantime.",this._labelService.getUriLabel(e[0],{relative:!0})):t=c(4535,"Cannot apply refactoring because {0} other files have changed in the meantime.",e.length),this._dialogService.warn(t).finally(()=>this._done(!1))}discard(){this._done(!1)}_done(e){this._currentResolve?.(e?this._currentInput?.getWorkspaceEdit():void 0),this._currentInput=void 0,this._setState(ec.Message),this._sessionDisposables.clear()}toggleChecked(){const[e]=this._tree.getFocus();((e instanceof Li||e instanceof Ao)&&!e.isDisabled()||e instanceof Ti)&&e.setChecked(!e.isChecked())}groupByFile(){this._treeDataSource.groupByFile||this.toggleGrouping()}groupByType(){this._treeDataSource.groupByFile&&this.toggleGrouping()}toggleGrouping(){const e=this._tree.getInput();if(e){const t=this._tree.getViewState();this._treeViewStates.set(this._treeDataSource.groupByFile,t),this._treeDataSource.groupByFile=!this._treeDataSource.groupByFile,this._setTreeInput(e),this._storageService.store(Wo._memGroupByFile,this._treeDataSource.groupByFile,ee.PROFILE,Ze.USER),this._ctxGroupByFile.set(this._treeDataSource.groupByFile)}}async _openElementInMultiDiffEditor(e){const t=this._currentInput?.fileOperations;if(!t)return;let i,s;if(e.element instanceof Ao)s=e.element.parent,i=e.element.edit.textEdit.textEdit.range;else if(e.element instanceof Li)s=e.element,i=e.element.edit.textEdits[0]?.textEdit.textEdit.range;else return;const o=await this._computeResourceDiffEditorInputs.get(t),r=await o.getResourceDiffEditorInputIdOfOperation(s.edit),n={...e.editorOptions,viewState:{revealData:{resource:r,range:i}}},d=F.from({scheme:Wo.Schema}),l="Refactor Preview";this._editorService.openEditor({multiDiffSource:d,label:l,options:n,isTransient:!0,description:l,resources:o.resources},e.sideBySide?Dn:SS)}_onContextMenu(e){this._contextMenuService.showContextMenu({menuId:b.BulkEditContext,contextKeyService:this.contextKeyService,getAnchor:()=>e.anchor})}},Wo=_i,_i.ID="refactorPreview",_i.Schema="vscode-bulkeditpreview-multieditor",_i.ctxHasCategories=new oe("refactorPreview.hasCategories",!1),_i.ctxGroupByFile=new oe("refactorPreview.groupByFile",!0),_i.ctxHasCheckedChanges=new oe("refactorPreview.hasCheckedChanges",!0),_i._memGroupByFile=`${_i.ID}.groupByFile`,_i);ft=Wo=D([u(1,z),u(2,O),u(3,rs),u(4,$n),u(5,Bi),u(6,st),u(7,ge),u(8,de),u(9,At),u(10,ot),u(11,st),u(12,te),u(13,tt),u(14,we),u(15,oi)],ft);var dw;async function Yn(a){const e=await a.openView(ft.ID,!0);if(e instanceof ft)return e}let cw=class{constructor(e,t){this._paneCompositeService=e,this._editorGroupsService=t,this._activePanel=e.getActivePaneComposite(ce.Panel)?.getId()}async restore(e,t){if(e&&(typeof this._activePanel=="string"?await this._paneCompositeService.openPaneComposite(this._activePanel,ce.Panel):this._paneCompositeService.hideActivePaneComposite(ce.Panel)),t)for(const i of this._editorGroupsService.groups){const s=[];for(const o of i.editors)Ue.getCanonicalUri(o,{supportSideBySide:Le.PRIMARY})?.scheme===ft.Schema&&s.push(o);s.length&&i.closeEditors(s,{preserveFocus:!0})}}};cw=D([u(0,_r),u(1,U)],cw);class xC{constructor(e,t=new _o){this.uxState=e,this.cts=t}}var nr;let is=(nr=class{constructor(e,t,i,s,o,r){this._paneCompositeService=e,this._viewsService=t,this._editorGroupsService=i,this._dialogService=s,o.setPreviewHandler(n=>this._previewEdit(n)),this._ctxEnabled=dw.ctxEnabled.bindTo(r)}async _previewEdit(e){this._ctxEnabled.set(!0);const t=this._activeSession?.uxState??new cw(this._paneCompositeService,this._editorGroupsService),i=await Yn(this._viewsService);if(!i)return this._ctxEnabled.set(!1),e;if(i.hasInput()){const{confirmed:o}=await this._dialogService.confirm({type:Te.Info,message:c(4520,"Another refactoring is being previewed."),detail:c(4521,"Press 'Continue' to discard the previous refactoring and continue with the current refactoring."),primaryButton:c(4522,"&&Continue")});if(!o)return[]}let s;this._activeSession?(await this._activeSession.uxState.restore(!1,!0),this._activeSession.cts.dispose(!0),s=new xC(t)):s=new xC(t),this._activeSession=s;try{return await i.setInput(e,s.cts.token)??[]}finally{this._activeSession===s&&(await this._activeSession.uxState.restore(!0,!0),this._activeSession.cts.dispose(),this._ctxEnabled.set(!1),this._activeSession=void 0)}}},dw=nr,nr.ID="workbench.contrib.bulkEditPreview",nr.ctxEnabled=new oe("refactorPreview.enabled",!1),nr);is=dw=D([u(0,_r),u(1,jt),u(2,U),u(3,Bi),u(4,DE),u(5,de)],is);S(class extends R{constructor(){super({id:"refactorPreview.apply",title:y(4523,"Apply Refactoring"),category:y(4524,"Refactor Preview"),icon:P.check,precondition:I.and(is.ctxEnabled,ft.ctxHasCheckedChanges),menu:[{id:b.BulkEditContext,order:1}],keybinding:{weight:L.EditorContrib-10,when:I.and(is.ctxEnabled,kl.isEqualTo(ft.ID)),primary:C.CtrlCmd+w.Enter}})}async run(e){const t=e.get(jt);(await Yn(t))?.accept()}});S(class extends R{constructor(){super({id:"refactorPreview.discard",title:y(4525,"Discard Refactoring"),category:y(4524,"Refactor Preview"),icon:P.clearAll,precondition:is.ctxEnabled,menu:[{id:b.BulkEditContext,order:2}]})}async run(e){const t=e.get(jt);(await Yn(t))?.discard()}});S(class extends R{constructor(){super({id:"refactorPreview.toggleCheckedState",title:y(4526,"Toggle Change"),category:y(4524,"Refactor Preview"),precondition:is.ctxEnabled,keybinding:{weight:L.WorkbenchContrib,when:Pe,primary:w.Space},menu:{id:b.BulkEditContext,group:"navigation"}})}async run(e){const t=e.get(jt);(await Yn(t))?.toggleChecked()}});S(class extends R{constructor(){super({id:"refactorPreview.groupByFile",title:y(4527,"Group Changes By File"),category:y(4524,"Refactor Preview"),icon:P.ungroupByRefType,precondition:I.and(ft.ctxHasCategories,ft.ctxGroupByFile.negate(),is.ctxEnabled),menu:[{id:b.BulkEditTitle,when:I.and(ft.ctxHasCategories,ft.ctxGroupByFile.negate()),group:"navigation",order:3}]})}async run(e){const t=e.get(jt);(await Yn(t))?.groupByFile()}});S(class extends R{constructor(){super({id:"refactorPreview.groupByType",title:y(4528,"Group Changes By Type"),category:y(4524,"Refactor Preview"),icon:P.groupByRefType,precondition:I.and(ft.ctxHasCategories,ft.ctxGroupByFile,is.ctxEnabled),menu:[{id:b.BulkEditTitle,when:I.and(ft.ctxHasCategories,ft.ctxGroupByFile),group:"navigation",order:3}]})}async run(e){const t=e.get(jt);(await Yn(t))?.groupByType()}});S(class extends R{constructor(){super({id:"refactorPreview.toggleGrouping",title:y(4528,"Group Changes By Type"),category:y(4524,"Refactor Preview"),icon:P.listTree,toggled:ft.ctxGroupByFile.negate(),precondition:I.and(ft.ctxHasCategories,is.ctxEnabled),menu:[{id:b.BulkEditContext,order:3}]})}async run(e){const t=e.get(jt);(await Yn(t))?.toggleGrouping()}});Vt(is.ID,is,Pt.BlockRestore);const DI=Ee("refactor-preview-view-icon",P.lightbulb,c(4529,"View icon of the refactor preview view.")),y1=se.as(qt.ViewContainersRegistry).registerViewContainer({id:ft.ID,title:y(4530,"Refactor Preview"),hideIfEmpty:!0,ctorDescriptor:new he(tl,[ft.ID,{mergeViewWithContainerWhenSingleView:!0}]),icon:DI,storageId:ft.ID},ce.Panel);se.as(qt.ViewsRegistry).registerViews([{id:ft.ID,name:y(4530,"Refactor Preview"),when:is.ctxEnabled,ctorDescriptor:new he(ft),containerIcon:DI}],y1);function C1(){return{[DE.toString()]:new he(Zm,[],!0)}}const S1=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class Vl{constructor(e,t,i,s){this.item=e,this.locations=t,this.model=i,this.parent=s}static compare(e,t){let i=Vp(e.item.uri.toString(),t.item.uri.toString());return i===0&&(i=ze.compareRangesUsingStarts(e.item.range,t.item.range)),i}}let E1=class{constructor(e){this.getDirection=e}hasChildren(){return!0}async getChildren(e){if(e instanceof kE)return e.roots.map(s=>new Vl(s,void 0,e,void 0));const{model:t,item:i}=e;return this.getDirection()===Wt.CallsFrom?(await t.resolveOutgoingCalls(i,Ni.None)).map(s=>new Vl(s.to,s.fromRanges.map(o=>({range:o,uri:i.uri})),t,e)):(await t.resolveIncomingCalls(i,Ni.None)).map(s=>new Vl(s.from,s.fromRanges.map(o=>({range:o,uri:s.from.uri})),t,e))}},_1=class{compare(e,t){return Vl.compare(e,t)}},I1=class{constructor(e){this.getDirection=e}getId(e){let t=this.getDirection()+JSON.stringify(e.item.uri)+JSON.stringify(e.item.range);return e.parent&&(t+=this.getId(e.parent)),t}};class D1{constructor(e,t){this.icon=e,this.label=t}}const Qu=class Qu{constructor(){this.templateId=Qu.id}renderTemplate(e){e.classList.add("callhierarchy-element");const t=ve("div");e.appendChild(t);const i=new Rp(e,{supportHighlights:!0});return new D1(t,i)}renderElement(e,t,i){const{element:s,filterData:o}=e,r=s.item.tags?.includes(AE.Deprecated);i.icon.className="",i.icon.classList.add("inline",...Se.asClassNameArray(TE.toIcon(s.item.kind))),i.label.setLabel(s.item.name,s.item.detail,{labelEscapeNewLines:!0,matches:An(o),strikethrough:r})}disposeTemplate(e){e.label.dispose()}};Qu.id="CallRenderer";let Hh=Qu,A1=class{getHeight(e){return 22}getTemplateId(e){return Hh.id}},T1=class{constructor(e){this.getDirection=e}getWidgetAriaLabel(){return c(4570,"Call Hierarchy")}getAriaLabel(e){return this.getDirection()===Wt.CallsFrom?c(4571,"calls from {0}",e.item.name):c(4572,"callers of {0}",e.item.name)}};var lw;xe(S1);var tc;(function(a){a.Loading="loading",a.Message="message",a.Data="data"})(tc||(tc={}));let LC=class{static store(e,t){t.store("callHierarchyPeekLayout",JSON.stringify(e),ee.PROFILE,Ze.MACHINE)}static retrieve(e){const t=e.get("callHierarchyPeekLayout",ee.PROFILE,"{}"),i={ratio:.7,height:17};try{return{...i,...JSON.parse(t)}}catch{return i}}constructor(e,t){this.ratio=e,this.height=t}};class k1 extends cd{}var mn;let id=(mn=class extends xE{constructor(e,t,i,s,o,r,n,d,l,h,p){super(e,{showFrame:!0,showArrow:!0,isResizeable:!0,isAccessible:!0},p),this._where=t,this._direction=i,this._peekViewService=o,this._editorService=r,this._textModelService=n,this._storageService=d,this._menuService=l,this._contextKeyService=h,this._instantiationService=p,this._treeViewStates=new Map,this._previewDisposable=new B,this.create(),this._peekViewService.addExclusiveWidget(e,this),this._applyTheme(s.getColorTheme()),this._disposables.add(s.onDidColorThemeChange(this._applyTheme,this)),this._disposables.add(this._previewDisposable)}dispose(){LC.store(this._layoutInfo,this._storageService),this._splitView.dispose(),this._tree.dispose(),this._editor.dispose(),super.dispose()}get direction(){return this._direction}_applyTheme(e){const t=e.getColor(LE)||ki.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(PE)||ki.transparent,primaryHeadingColor:e.getColor(VE),secondaryHeadingColor:e.getColor(RE)})}_fillHead(e){super._fillHead(e,!0);const t=this._menuService.createMenu(lw.TitleMenu,this._contextKeyService),i=()=>{const s=Op(t.getActions());this._actionbarWidget.clear(),this._actionbarWidget.push(s,{label:!1,icon:!0})};this._disposables.add(t),this._disposables.add(t.onDidChange(i)),i()}_fillBody(e){this._layoutInfo=LC.retrieve(this._storageService),this._dim=new Be(0,0),this._parent=e,e.classList.add("call-hierarchy");const t=ve("div");t.classList.add("message"),e.appendChild(t),this._message=t,this._message.tabIndex=0;const i=ve("div");i.classList.add("results"),e.appendChild(i),this._splitView=new bc(i,{orientation:le.HORIZONTAL});const s=ve("div");s.classList.add("editor"),i.appendChild(s);const o={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._editor=this._instantiationService.createInstance(OE,s,o,{},this.editor);const r=ve("div");r.classList.add("tree"),i.appendChild(r);const n={sorter:new _1,accessibilityProvider:new T1(()=>this._direction),identityProvider:new I1(()=>this._direction),expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:ME}};this._tree=this._instantiationService.createInstance(k1,"CallHierarchyPeek",r,new A1,[this._instantiationService.createInstance(Hh)],this._instantiationService.createInstance(E1,()=>this._direction),n),this._splitView.addView({onDidChange:K.None,element:s,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:d=>{this._dim.height&&this._editor.layout({height:this._dim.height,width:d})}},Ai.Distribute),this._splitView.addView({onDidChange:K.None,element:r,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:d=>{this._dim.height&&this._tree.layout(this._dim.height,d)}},Ai.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this._layoutInfo.ratio=this._splitView.getViewSize(0)/this._dim.width)})),this._disposables.add(this._tree.onDidChangeFocus(this._updatePreview,this)),this._disposables.add(this._editor.onMouseDown(d=>{const{event:l,target:h}=d;if(l.detail!==2)return;const[p]=this._tree.getFocus();p&&(this.dispose(),this._editorService.openEditor({resource:p.item.uri,options:{selection:h.range}}))})),this._disposables.add(this._tree.onMouseDblClick(d=>{d.target!==NE.Twistie&&d.element&&(this.dispose(),this._editorService.openEditor({resource:d.element.item.uri,options:{selection:d.element.item.selectionRange,pinned:!0}}))})),this._disposables.add(this._tree.onDidChangeSelection(d=>{const[l]=d.elements;l&&FE(d.browserEvent)&&(this.dispose(),this._editorService.openEditor({resource:l.item.uri,options:{selection:l.item.selectionRange,pinned:!0}}))}))}async _updatePreview(){const[e]=this._tree.getFocus();if(!e)return;this._previewDisposable.clear();const t={description:"call-hierarchy-decoration",stickiness:Wb.NeverGrowsWhenTypingAtEdges,className:"call-decoration",overviewRuler:{color:Ql(GE),position:md.Center}};let i;this._direction===Wt.CallsFrom?i=e.parent?e.parent.item.uri:e.model.root.uri:i=e.item.uri;const s=await this._textModelService.createModelReference(i);this._editor.setModel(s.object.textEditorModel);const o=[];let r,n=e.locations;n||(n=[{uri:e.item.uri,range:e.item.selectionRange}]);for(const l of n)l.uri.toString()===i.toString()&&(o.push({range:l.range,options:t}),r=r?ze.plusRange(l.range,r):l.range);if(r){this._editor.revealRangeInCenter(r,Nt.Immediate);const l=this._editor.createDecorationsCollection(o);this._previewDisposable.add(pe(()=>l.clear()))}this._previewDisposable.add(s);const d=this._direction===Wt.CallsFrom?c(4565,"Calls from '{0}'",e.model.root.name):c(4566,"Callers of '{0}'",e.model.root.name);this.setTitle(d)}showLoading(){this._parent.dataset.state=tc.Loading,this.setTitle(c(4567,"Loading...")),this._show()}showMessage(e){this._parent.dataset.state=tc.Message,this.setTitle(""),this.setMetaTitle(""),this._message.innerText=e,this._show(),this._message.focus()}async showModel(e){this._show();const t=this._treeViewStates.get(this._direction);await this._tree.setInput(e,t);const i=this._tree.getNode(e).children[0];await this._tree.expand(i.element),i.children.length===0?this.showMessage(this._direction===Wt.CallsFrom?c(4568,"No calls from '{0}'",e.root.name):c(4569,"No callers of '{0}'",e.root.name)):(this._parent.dataset.state=tc.Data,(!t||this._tree.getFocus().length===0)&&this._tree.setFocus([i.children[0].element]),this._tree.domFocus(),this._updatePreview())}getModel(){return this._tree.getInput()}getFocused(){return this._tree.getFocus()[0]}async updateDirection(e){const t=this._tree.getInput();t&&e!==this._direction&&(this._treeViewStates.set(this._direction,this._tree.getViewState()),this._direction=e,await this.showModel(t))}_show(){this._isShowing||(this.editor.revealLineInCenterIfOutsideViewport(this._where.lineNumber,Nt.Smooth),super.show(ze.fromPositions(this._where),this._layoutInfo.height))}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){(this._dim.height!==e||this._dim.width!==t)&&(super._doLayoutBody(e,t),this._dim=new Be(t,e),this._layoutInfo.height=this._viewZone?this._viewZone.heightInLines:this._layoutInfo.height,this._splitView.layout(t),this._splitView.resizeView(0,t*this._layoutInfo.ratio))}},lw=mn,mn.TitleMenu=new b("callhierarchy/title"),mn);id=lw=D([u(3,we),u(4,BE),u(5,O),u(6,$n),u(7,ge),u(8,Js),u(9,de),u(10,z)],id);var sa;const hw=new oe("editorHasCallHierarchyProvider",!1,c(4553,"Whether a call hierarchy provider is available")),dl=new oe("callHierarchyVisible",!1,c(4554,"Whether call hierarchy peek is currently showing")),Fc=new oe("callHierarchyDirection",void 0,{type:"string",description:c(4555,"Whether call hierarchy shows incoming or outgoing calls")});function x1(a){return a===Wt.CallsFrom||a===Wt.CallsTo?a:Wt.CallsTo}var ar;let To=(ar=class{static get(e){return e.getContribution(sa.Id)}constructor(e,t,i,s,o){this._editor=e,this._contextKeyService=t,this._storageService=i,this._editorService=s,this._instantiationService=o,this._dispoables=new B,this._sessionDisposables=new B,this._ctxIsVisible=dl.bindTo(this._contextKeyService),this._ctxHasProvider=hw.bindTo(this._contextKeyService),this._ctxDirection=Fc.bindTo(this._contextKeyService),this._dispoables.add(K.any(e.onDidChangeModel,e.onDidChangeModelLanguage,ug.onDidChange)(()=>{this._ctxHasProvider.set(e.hasModel()&&ug.has(e.getModel()))})),this._dispoables.add(this._sessionDisposables)}dispose(){this._ctxHasProvider.reset(),this._ctxIsVisible.reset(),this._dispoables.dispose()}async startCallHierarchyFromEditor(){if(this._sessionDisposables.clear(),!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getPosition();if(!ug.has(e))return;const i=new _o,s=kE.create(e,t,i.token),o=x1(this._storageService.get(sa._StorageDirection,ee.PROFILE,Wt.CallsTo));this._showCallHierarchyWidget(t,o,s,i)}async startCallHierarchyFromCallHierarchy(){if(!this._widget)return;const e=this._widget.getModel(),t=this._widget.getFocused();if(!t||!e)return;const i=await this._editorService.openCodeEditor({resource:t.item.uri},this._editor);if(!i)return;const s=e.fork(t.item);this._sessionDisposables.clear(),sa.get(i)?._showCallHierarchyWidget(ze.lift(s.root.selectionRange).getStartPosition(),this._widget.direction,Promise.resolve(s),new _o)}_showCallHierarchyWidget(e,t,i,s){this._ctxIsVisible.set(!0),this._ctxDirection.set(t),K.any(this._editor.onDidChangeModel,this._editor.onDidChangeModelLanguage)(this.endCallHierarchy,this,this._sessionDisposables),this._widget=this._instantiationService.createInstance(id,this._editor,e,t),this._widget.showLoading(),this._sessionDisposables.add(this._widget.onDidClose(()=>{this.endCallHierarchy(),this._storageService.store(sa._StorageDirection,this._widget.direction,ee.PROFILE,Ze.USER)})),this._sessionDisposables.add({dispose(){s.dispose(!0)}}),this._sessionDisposables.add(this._widget),i.then(o=>{s.token.isCancellationRequested||(o?(this._sessionDisposables.add(o),this._widget.showModel(o)):this._widget.showMessage(c(4556,"No results")))}).catch(o=>{if(dd(o)){this.endCallHierarchy();return}this._widget.showMessage(c(4557,"Failed to show call hierarchy"))})}showOutgoingCalls(){this._widget?.updateDirection(Wt.CallsFrom),this._ctxDirection.set(Wt.CallsFrom)}showIncomingCalls(){this._widget?.updateDirection(Wt.CallsTo),this._ctxDirection.set(Wt.CallsTo)}endCallHierarchy(){this._sessionDisposables.clear(),this._ctxIsVisible.set(!1),this._editor.focus()}},sa=ar,ar.Id="callHierarchy",ar._StorageDirection="callHierarchy/defaultDirection",ar);To=sa=D([u(1,de),u(2,ge),u(3,qn),u(4,z)],To);Bb(To.Id,To,Gb.Eager);S(class extends eo{constructor(){super({id:"editor.showCallHierarchy",title:y(4558,"Peek Call Hierarchy"),menu:{id:b.EditorContextPeek,group:"navigation",order:1e3,when:I.and(hw,rh.notInPeekEditor,mr.isInEmbeddedEditor.toNegated())},keybinding:{when:mr.editorTextFocus,weight:L.WorkbenchContrib,primary:C.Shift+C.Alt+w.KeyH},precondition:I.and(hw,rh.notInPeekEditor),f1:!0})}async runEditorCommand(e,t){return To.get(t)?.startCallHierarchyFromEditor()}});S(class extends eo{constructor(){super({id:"editor.showIncomingCalls",title:y(4559,"Show Incoming Calls"),icon:Ee("callhierarchy-incoming",P.callIncoming,c(4560,"Icon for incoming calls in the call hierarchy view.")),precondition:I.and(dl,Fc.isEqualTo(Wt.CallsFrom)),keybinding:{weight:L.WorkbenchContrib,primary:C.Shift+C.Alt+w.KeyH},menu:{id:id.TitleMenu,when:Fc.isEqualTo(Wt.CallsFrom),order:1}})}runEditorCommand(a,e){return To.get(e)?.showIncomingCalls()}});S(class extends eo{constructor(){super({id:"editor.showOutgoingCalls",title:y(4561,"Show Outgoing Calls"),icon:Ee("callhierarchy-outgoing",P.callOutgoing,c(4562,"Icon for outgoing calls in the call hierarchy view.")),precondition:I.and(dl,Fc.isEqualTo(Wt.CallsTo)),keybinding:{weight:L.WorkbenchContrib,primary:C.Shift+C.Alt+w.KeyH},menu:{id:id.TitleMenu,when:Fc.isEqualTo(Wt.CallsTo),order:1}})}runEditorCommand(a,e){return To.get(e)?.showOutgoingCalls()}});S(class extends eo{constructor(){super({id:"editor.refocusCallHierarchy",title:y(4563,"Refocus Call Hierarchy"),precondition:dl,keybinding:{weight:L.WorkbenchContrib,primary:C.Shift+w.Enter}})}async runEditorCommand(a,e){return To.get(e)?.startCallHierarchyFromCallHierarchy()}});S(class extends eo{constructor(){super({id:"editor.closeCallHierarchy",title:c(4564,"Close"),icon:P.close,precondition:dl,keybinding:{weight:L.WorkbenchContrib+10,primary:w.Escape,when:I.not("config.editor.stablePeek")},menu:{id:id.TitleMenu,order:1e3}})}runEditorCommand(a,e){return To.get(e)?.endCallHierarchy()}});const L1=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class Pl{constructor(e,t,i){this.item=e,this.model=t,this.parent=i}static compare(e,t){let i=Vp(e.item.uri.toString(),t.item.uri.toString());return i===0&&(i=ze.compareRangesUsingStarts(e.item.range,t.item.range)),i}}class R1{constructor(e){this.getDirection=e}hasChildren(){return!0}async getChildren(e){if(e instanceof WE)return e.roots.map(s=>new Pl(s,e,void 0));const{model:t,item:i}=e;return this.getDirection()===Kt.Supertypes?(await t.provideSupertypes(i,Ni.None)).map(s=>new Pl(s,t,e)):(await t.provideSubtypes(i,Ni.None)).map(s=>new Pl(s,t,e))}}class V1{compare(e,t){return Pl.compare(e,t)}}class P1{constructor(e){this.getDirection=e}getId(e){let t=this.getDirection()+JSON.stringify(e.item.uri)+JSON.stringify(e.item.range);return e.parent&&(t+=this.getId(e.parent)),t}}class O1{constructor(e,t){this.icon=e,this.label=t}}const ep=class ep{constructor(){this.templateId=ep.id}renderTemplate(e){e.classList.add("typehierarchy-element");const t=ve("div");e.appendChild(t);const i=new Rp(e,{supportHighlights:!0});return new O1(t,i)}renderElement(e,t,i){const{element:s,filterData:o}=e,r=s.item.tags?.includes(AE.Deprecated);i.icon.classList.add("inline",...Se.asClassNameArray(TE.toIcon(s.item.kind))),i.label.setLabel(s.item.name,s.item.detail,{labelEscapeNewLines:!0,matches:An(o),strikethrough:r})}disposeTemplate(e){e.label.dispose()}};ep.id="TypeRenderer";let zh=ep;class M1{getHeight(e){return 22}getTemplateId(e){return zh.id}}class N1{constructor(e){this.getDirection=e}getWidgetAriaLabel(){return c(12856,"Type Hierarchy")}getAriaLabel(e){return this.getDirection()===Kt.Supertypes?c(12857,"supertypes of {0}",e.item.name):c(12858,"subtypes of {0}",e.item.name)}}var uw;xe(L1);var ic;(function(a){a.Loading="loading",a.Message="message",a.Data="data"})(ic||(ic={}));class RC{static store(e,t){t.store("typeHierarchyPeekLayout",JSON.stringify(e),ee.PROFILE,Ze.MACHINE)}static retrieve(e){const t=e.get("typeHierarchyPeekLayout",ee.PROFILE,"{}"),i={ratio:.7,height:17};try{return{...i,...JSON.parse(t)}}catch{return i}}constructor(e,t){this.ratio=e,this.height=t}}class F1 extends cd{}var wn;let sd=(wn=class extends xE{constructor(e,t,i,s,o,r,n,d,l,h,p){super(e,{showFrame:!0,showArrow:!0,isResizeable:!0,isAccessible:!0},p),this._where=t,this._direction=i,this._peekViewService=o,this._editorService=r,this._textModelService=n,this._storageService=d,this._menuService=l,this._contextKeyService=h,this._instantiationService=p,this._treeViewStates=new Map,this._previewDisposable=new B,this.create(),this._peekViewService.addExclusiveWidget(e,this),this._applyTheme(s.getColorTheme()),this._disposables.add(s.onDidColorThemeChange(this._applyTheme,this)),this._disposables.add(this._previewDisposable)}dispose(){RC.store(this._layoutInfo,this._storageService),this._splitView.dispose(),this._tree.dispose(),this._editor.dispose(),super.dispose()}get direction(){return this._direction}_applyTheme(e){const t=e.getColor(LE)||ki.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(PE)||ki.transparent,primaryHeadingColor:e.getColor(VE),secondaryHeadingColor:e.getColor(RE)})}_fillHead(e){super._fillHead(e,!0);const t=this._menuService.createMenu(uw.TitleMenu,this._contextKeyService),i=()=>{const s=Op(t.getActions());this._actionbarWidget.clear(),this._actionbarWidget.push(s,{label:!1,icon:!0})};this._disposables.add(t),this._disposables.add(t.onDidChange(i)),i()}_fillBody(e){this._layoutInfo=RC.retrieve(this._storageService),this._dim=new Be(0,0),this._parent=e,e.classList.add("type-hierarchy");const t=ve("div");t.classList.add("message"),e.appendChild(t),this._message=t,this._message.tabIndex=0;const i=ve("div");i.classList.add("results"),e.appendChild(i),this._splitView=new bc(i,{orientation:le.HORIZONTAL});const s=ve("div");s.classList.add("editor"),i.appendChild(s);const o={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._editor=this._instantiationService.createInstance(OE,s,o,{},this.editor);const r=ve("div");r.classList.add("tree"),i.appendChild(r);const n={sorter:new V1,accessibilityProvider:new N1(()=>this._direction),identityProvider:new P1(()=>this._direction),expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:ME}};this._tree=this._instantiationService.createInstance(F1,"TypeHierarchyPeek",r,new M1,[this._instantiationService.createInstance(zh)],this._instantiationService.createInstance(R1,()=>this._direction),n),this._splitView.addView({onDidChange:K.None,element:s,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:d=>{this._dim.height&&this._editor.layout({height:this._dim.height,width:d})}},Ai.Distribute),this._splitView.addView({onDidChange:K.None,element:r,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:d=>{this._dim.height&&this._tree.layout(this._dim.height,d)}},Ai.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this._layoutInfo.ratio=this._splitView.getViewSize(0)/this._dim.width)})),this._disposables.add(this._tree.onDidChangeFocus(this._updatePreview,this)),this._disposables.add(this._editor.onMouseDown(d=>{const{event:l,target:h}=d;if(l.detail!==2)return;const[p]=this._tree.getFocus();p&&(this.dispose(),this._editorService.openEditor({resource:p.item.uri,options:{selection:h.range}}))})),this._disposables.add(this._tree.onMouseDblClick(d=>{d.target!==NE.Twistie&&d.element&&(this.dispose(),this._editorService.openEditor({resource:d.element.item.uri,options:{selection:d.element.item.selectionRange,pinned:!0}}))})),this._disposables.add(this._tree.onDidChangeSelection(d=>{const[l]=d.elements;l&&FE(d.browserEvent)&&(this.dispose(),this._editorService.openEditor({resource:l.item.uri,options:{selection:l.item.selectionRange,pinned:!0}}))}))}async _updatePreview(){const[e]=this._tree.getFocus();if(!e)return;this._previewDisposable.clear();const t={description:"type-hierarchy-decoration",stickiness:Wb.NeverGrowsWhenTypingAtEdges,className:"type-decoration",overviewRuler:{color:Ql(GE),position:md.Center}};let i;this._direction===Kt.Supertypes?i=e.parent?e.parent.item.uri:e.model.root.uri:i=e.item.uri;const s=await this._textModelService.createModelReference(i);this._editor.setModel(s.object.textEditorModel);const o=[];let r;const n={uri:e.item.uri,range:e.item.selectionRange};if(n.uri.toString()===i.toString()&&(o.push({range:n.range,options:t}),r=r?ze.plusRange(n.range,r):n.range),r){this._editor.revealRangeInCenter(r,Nt.Immediate);const l=this._editor.createDecorationsCollection(o);this._previewDisposable.add(pe(()=>l.clear()))}this._previewDisposable.add(s);const d=this._direction===Kt.Supertypes?c(12851,"Supertypes of '{0}'",e.model.root.name):c(12852,"Subtypes of '{0}'",e.model.root.name);this.setTitle(d)}showLoading(){this._parent.dataset.state=ic.Loading,this.setTitle(c(12853,"Loading...")),this._show()}showMessage(e){this._parent.dataset.state=ic.Message,this.setTitle(""),this.setMetaTitle(""),this._message.innerText=e,this._show(),this._message.focus()}async showModel(e){this._show();const t=this._treeViewStates.get(this._direction);await this._tree.setInput(e,t);const i=this._tree.getNode(e).children[0];await this._tree.expand(i.element),i.children.length===0?this.showMessage(this._direction===Kt.Supertypes?c(12854,"No supertypes of '{0}'",e.root.name):c(12855,"No subtypes of '{0}'",e.root.name)):(this._parent.dataset.state=ic.Data,(!t||this._tree.getFocus().length===0)&&this._tree.setFocus([i.children[0].element]),this._tree.domFocus(),this._updatePreview())}getModel(){return this._tree.getInput()}getFocused(){return this._tree.getFocus()[0]}async updateDirection(e){const t=this._tree.getInput();t&&e!==this._direction&&(this._treeViewStates.set(this._direction,this._tree.getViewState()),this._direction=e,await this.showModel(t))}_show(){this._isShowing||(this.editor.revealLineInCenterIfOutsideViewport(this._where.lineNumber,Nt.Smooth),super.show(ze.fromPositions(this._where),this._layoutInfo.height))}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){(this._dim.height!==e||this._dim.width!==t)&&(super._doLayoutBody(e,t),this._dim=new Be(t,e),this._layoutInfo.height=this._viewZone?this._viewZone.heightInLines:this._layoutInfo.height,this._splitView.layout(t),this._splitView.resizeView(0,t*this._layoutInfo.ratio))}},uw=wn,wn.TitleMenu=new b("typehierarchy/title"),wn);sd=uw=D([u(3,we),u(4,BE),u(5,O),u(6,$n),u(7,ge),u(8,Js),u(9,de),u(10,z)],sd);var oa;const pw=new oe("editorHasTypeHierarchyProvider",!1,c(12841,"Whether a type hierarchy provider is available")),cl=new oe("typeHierarchyVisible",!1,c(12842,"Whether type hierarchy peek is currently showing")),Bc=new oe("typeHierarchyDirection",void 0,{type:"string",description:c(12843,"whether type hierarchy shows super types or subtypes")});function B1(a){return a===Kt.Subtypes||a===Kt.Supertypes?a:Kt.Subtypes}var dr;let ko=(dr=class{static get(e){return e.getContribution(oa.Id)}constructor(e,t,i,s,o){this._editor=e,this._contextKeyService=t,this._storageService=i,this._editorService=s,this._instantiationService=o,this._disposables=new B,this._sessionDisposables=new B,this._ctxHasProvider=pw.bindTo(this._contextKeyService),this._ctxIsVisible=cl.bindTo(this._contextKeyService),this._ctxDirection=Bc.bindTo(this._contextKeyService),this._disposables.add(K.any(e.onDidChangeModel,e.onDidChangeModelLanguage,pg.onDidChange)(()=>{this._ctxHasProvider.set(e.hasModel()&&pg.has(e.getModel()))})),this._disposables.add(this._sessionDisposables)}dispose(){this._disposables.dispose()}async startTypeHierarchyFromEditor(){if(this._sessionDisposables.clear(),!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getPosition();if(!pg.has(e))return;const i=new _o,s=WE.create(e,t,i.token),o=B1(this._storageService.get(oa._storageDirectionKey,ee.PROFILE,Kt.Subtypes));this._showTypeHierarchyWidget(t,o,s,i)}_showTypeHierarchyWidget(e,t,i,s){this._ctxIsVisible.set(!0),this._ctxDirection.set(t),K.any(this._editor.onDidChangeModel,this._editor.onDidChangeModelLanguage)(this.endTypeHierarchy,this,this._sessionDisposables),this._widget=this._instantiationService.createInstance(sd,this._editor,e,t),this._widget.showLoading(),this._sessionDisposables.add(this._widget.onDidClose(()=>{this.endTypeHierarchy(),this._storageService.store(oa._storageDirectionKey,this._widget.direction,ee.PROFILE,Ze.USER)})),this._sessionDisposables.add({dispose(){s.dispose(!0)}}),this._sessionDisposables.add(this._widget),i.then(o=>{s.token.isCancellationRequested||(o?(this._sessionDisposables.add(o),this._widget.showModel(o)):this._widget.showMessage(c(12844,"No results")))}).catch(o=>{if(dd(o)){this.endTypeHierarchy();return}this._widget.showMessage(c(12845,"Failed to show type hierarchy"))})}async startTypeHierarchyFromTypeHierarchy(){if(!this._widget)return;const e=this._widget.getModel(),t=this._widget.getFocused();if(!t||!e)return;const i=await this._editorService.openCodeEditor({resource:t.item.uri},this._editor);if(!i)return;const s=e.fork(t.item);this._sessionDisposables.clear(),oa.get(i)?._showTypeHierarchyWidget(ze.lift(s.root.selectionRange).getStartPosition(),this._widget.direction,Promise.resolve(s),new _o)}showSupertypes(){this._widget?.updateDirection(Kt.Supertypes),this._ctxDirection.set(Kt.Supertypes)}showSubtypes(){this._widget?.updateDirection(Kt.Subtypes),this._ctxDirection.set(Kt.Subtypes)}endTypeHierarchy(){this._sessionDisposables.clear(),this._ctxIsVisible.set(!1),this._editor.focus()}},oa=dr,dr.Id="typeHierarchy",dr._storageDirectionKey="typeHierarchy/defaultDirection",dr);ko=oa=D([u(1,de),u(2,ge),u(3,qn),u(4,z)],ko);Bb(ko.Id,ko,Gb.Eager);S(class extends eo{constructor(){super({id:"editor.showTypeHierarchy",title:y(12846,"Peek Type Hierarchy"),menu:{id:b.EditorContextPeek,group:"navigation",order:1e3,when:I.and(pw,rh.notInPeekEditor)},precondition:I.and(pw,rh.notInPeekEditor),f1:!0})}async runEditorCommand(e,t){return ko.get(t)?.startTypeHierarchyFromEditor()}});S(class extends eo{constructor(){super({id:"editor.showSupertypes",title:y(12847,"Show Supertypes"),icon:P.typeHierarchySuper,precondition:I.and(cl,Bc.isEqualTo(Kt.Subtypes)),keybinding:{weight:L.WorkbenchContrib,primary:C.Shift+C.Alt+w.KeyH},menu:{id:sd.TitleMenu,when:Bc.isEqualTo(Kt.Subtypes),order:1}})}runEditorCommand(a,e){return ko.get(e)?.showSupertypes()}});S(class extends eo{constructor(){super({id:"editor.showSubtypes",title:y(12848,"Show Subtypes"),icon:P.typeHierarchySub,precondition:I.and(cl,Bc.isEqualTo(Kt.Supertypes)),keybinding:{weight:L.WorkbenchContrib,primary:C.Shift+C.Alt+w.KeyH},menu:{id:sd.TitleMenu,when:Bc.isEqualTo(Kt.Supertypes),order:1}})}runEditorCommand(a,e){return ko.get(e)?.showSubtypes()}});S(class extends eo{constructor(){super({id:"editor.refocusTypeHierarchy",title:y(12849,"Refocus Type Hierarchy"),precondition:cl,keybinding:{weight:L.WorkbenchContrib,primary:C.Shift+w.Enter}})}async runEditorCommand(a,e){return ko.get(e)?.startTypeHierarchyFromTypeHierarchy()}});S(class extends eo{constructor(){super({id:"editor.closeTypeHierarchy",title:c(12850,"Close"),icon:P.close,precondition:cl,keybinding:{weight:L.WorkbenchContrib+10,primary:w.Escape,when:I.not("config.editor.stablePeek")},menu:{id:sd.TitleMenu,order:1e3}})}runEditorCommand(a,e){return ko.get(e)?.endTypeHierarchy()}});const G1=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class W1 extends Je{constructor(e,t){super("vs.tree.collapse",c(42,"Collapse All"),"collapse-all",t),this.viewer=e}async run(){this.viewer.collapseAll(),this.viewer.setSelection([]),this.viewer.setFocus([])}}class K1 extends M{constructor(){super(...arguments),this._onDidChangeCheckboxState=this._register(new A),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event}setCheckboxState(e){this._onDidChangeCheckboxState.fire([e])}}const tp=class tp extends M{constructor(e,t,i,s){super(),this.checkboxStateHandler=t,this.hoverDelegate=i,this.hoverService=s,this.checkboxContainer=e}render(e){e.checkbox&&(this.toggle?this.toggle.checked=e.checkbox.isChecked:this.createCheckbox(e))}createCheckbox(e){e.checkbox&&(this.toggle=new mE("",e.checkbox.isChecked,{...bE,size:15}),this.setHover(e.checkbox),this.setAccessibilityInformation(e.checkbox),this.toggle.domNode.classList.add(tp.checkboxClass),this.toggle.domNode.tabIndex=1,ye(this.checkboxContainer,this.toggle.domNode),this.registerListener(e))}registerListener(e){this.toggle&&(this._register({dispose:()=>this.removeCheckbox()}),this._register(this.toggle),this._register(this.toggle.onChange(()=>{this.setCheckbox(e)})))}setHover(e){this.toggle&&(this.hover?this.hover.update(e.tooltip):this.hover=this._register(this.hoverService.setupManagedHover(this.hoverDelegate,this.toggle.domNode,this.checkboxHoverContent(e))))}setCheckbox(e){this.toggle&&e.checkbox&&(e.checkbox.isChecked=this.toggle.checked,this.setHover(e.checkbox),this.setAccessibilityInformation(e.checkbox),this.checkboxStateHandler.setCheckboxState(e))}checkboxHoverContent(e){return e.tooltip?e.tooltip:e.isChecked?c(3688,"Checked"):c(3689,"Unchecked")}setAccessibilityInformation(e){this.toggle&&e.accessibilityInformation&&(this.toggle.setTitle(e.accessibilityInformation.label),e.accessibilityInformation.role&&(this.toggle.domNode.role=e.accessibilityInformation.role))}removeCheckbox(){const e=this.checkboxContainer.children;for(const t of e)t.remove()}};tp.checkboxClass="custom-view-tree-node-item-checkbox";let $h=tp;var gw;xe(G1);let fw=class extends Pp{constructor(e,t,i,s,o,r,n,d,l,h,p,g){super({...e,titleMenuId:b.ViewTitle,donotForwardArgs:!1},t,i,s,o,r,n,d,l,p,g);const{treeView:f}=se.as(qt.ViewsRegistry).getView(e.id);this.treeView=f,this._register(this.treeView.onDidChangeActions(()=>this.updateActions(),this)),this._register(this.treeView.onDidChangeTitle(m=>this.updateTitle(m))),this._register(this.treeView.onDidChangeDescription(m=>this.updateTitleDescription(m))),this._register(pe(()=>{this._container&&this.treeView.container&&this._container===this.treeView.container&&this.treeView.setVisibility(!1)})),this._register(this.onDidChangeBodyVisibility(()=>this.updateTreeVisibility())),this._register(this.treeView.onDidChangeWelcomeState(()=>this._onDidChangeViewWelcomeState.fire())),e.title!==this.treeView.title&&this.updateTitle(this.treeView.title),e.titleDescription!==this.treeView.description&&this.updateTitleDescription(this.treeView.description),this._actionRunner=this._register(new kI(h,()=>this.treeView.getSelection())),this.updateTreeVisibility()}focus(){super.focus(),this.treeView.focus()}renderBody(e){this._container=e,super.renderBody(e),this.renderTreeView(e)}shouldShowWelcome(){return(this.treeView.dataProvider===void 0||!!this.treeView.dataProvider.isTreeEmpty)&&(this.treeView.message===void 0||this.treeView.message==="")}layoutBody(e,t){super.layoutBody(e,t),this.layoutTreeView(e,t)}getOptimalWidth(){return this.treeView.getOptimalWidth()}renderTreeView(e){this.treeView.show(e)}layoutTreeView(e,t){this.treeView.layout(e,t)}updateTreeVisibility(){this.treeView.setVisibility(this.isBodyVisible())}getActionRunner(){return this._actionRunner}getActionsContext(){return{$treeViewId:this.id,$focusedTreeItem:!0,$selectedTreeItems:!0}}};fw=D([u(1,ot),u(2,st),u(3,te),u(4,de),u(5,At),u(6,z),u(7,tt),u(8,we),u(9,Qe),u(10,oi),u(11,vx)],fw);class Lg{constructor(){this.label={label:"root"},this.handle="0",this.parentHandle=void 0,this.collapsibleState=Bs.Expanded,this.children=void 0}}function AI(a){const e=re.getCommand(a);if(e)return _.getCommand(e.id)?.precondition}function TI(a,e){const t=a.originalId?a.originalId:a.id,i=AI(t);return i?e.contextMatchesRules(i):!0}function VC(a){return!!a&&typeof a!="string"&&!!a.element&&!!a.disposables}const U1=c(3690,"There is no data provider registered that can provide view data."),H1=new oe("customTreeView",!1);class z1 extends cd{}let mw=class extends M{get onDidExpandItem(){return this._onDidExpandItem.event}get onDidCollapseItem(){return this._onDidCollapseItem.event}get onDidChangeSelectionAndFocus(){return this._onDidChangeSelectionAndFocus.event}get onDidChangeVisibility(){return this._onDidChangeVisibility.event}get onDidChangeActions(){return this._onDidChangeActions.event}get onDidChangeWelcomeState(){return this._onDidChangeWelcomeState.event}get onDidChangeTitle(){return this._onDidChangeTitle.event}get onDidChangeDescription(){return this._onDidChangeDescription.event}get onDidChangeCheckboxState(){return this._onDidChangeCheckboxState.event}constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m,v,E,x){super(),this.id=e,this._title=t,this.themeService=i,this.instantiationService=s,this.commandService=o,this.configurationService=r,this.progressService=n,this.contextMenuService=d,this.keybindingService=l,this.notificationService=h,this.viewDescriptorService=p,this.hoverService=g,this.contextKeyService=f,this.activityService=m,this.logService=v,this.openerService=E,this.markdownRendererService=x,this.isVisible=!1,this._hasIconForParentNode=!1,this._hasIconForLeafNode=!1,this.focused=!1,this._canSelectMany=!1,this._manuallyManageCheckboxes=!1,this.elementsToRefresh=[],this.lastSelection=[],this._onDidExpandItem=this._register(new A),this._onDidCollapseItem=this._register(new A),this._onDidChangeSelectionAndFocus=this._register(new A),this._onDidChangeVisibility=this._register(new A),this._onDidChangeActions=this._register(new A),this._onDidChangeWelcomeState=this._register(new A),this._onDidChangeTitle=this._register(new A),this._onDidChangeDescription=this._register(new A),this._onDidChangeCheckboxState=this._register(new A),this._onDidCompleteRefresh=this._register(new A),this._isInitialized=!1,this._activity=this._register(new Ae),this.activated=!1,this.treeDisposables=this._register(new B),this._height=0,this._width=0,this.refreshing=!1,this.root=new Lg,this.lastActive=this.root}initialize(){this._isInitialized||(this._isInitialized=!0,this.contextKeyService.bufferChangeEvents(()=>{this.initializeShowCollapseAllAction(),this.initializeCollapseAllToggle(),this.initializeShowRefreshAction()}),this.treeViewDnd=this.instantiationService.createInstance(yw,this.id),this._dragAndDropController&&(this.treeViewDnd.controller=this._dragAndDropController),this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("explorer.decorations")&&this.doRefresh([this.root])})),this._register(this.viewDescriptorService.onDidChangeLocation(({views:e,from:t,to:i})=>{e.some(s=>s.id===this.id)&&this.tree?.updateOptions({overrideStyles:Vy(this.viewLocation).listOverrideStyles})})),this.registerActions(),this.create())}get viewContainer(){return this.viewDescriptorService.getViewContainerByViewId(this.id)}get viewLocation(){return this.viewDescriptorService.getViewLocationById(this.id)}get dragAndDropController(){return this._dragAndDropController}set dragAndDropController(e){this._dragAndDropController=e,this.treeViewDnd&&(this.treeViewDnd.controller=e)}get dataProvider(){return this._dataProvider}set dataProvider(e){if(e){this.visible&&this.activate();const t=this;this._dataProvider=new class{constructor(){this._isEmpty=!0,this._onDidChangeEmpty=new A,this.onDidChangeEmpty=this._onDidChangeEmpty.event}get isTreeEmpty(){return this._isEmpty}async getChildren(i){return(await this.getChildrenBatch(i?[i]:void 0))?.[0]}updateEmptyState(i,s){if(i.length===1&&i[0]instanceof Lg){const o=this._isEmpty;this._isEmpty=s.length===0||s[0].length===0,o!==this._isEmpty&&this._onDidChangeEmpty.fire()}}findCheckboxesUpdated(i,s){if(s.length===0)return[];const o=[];for(let r=0;r<i.length;r++){const n=i[r],d=s[r];for(const l of d)l.parent=n,!t.manuallyManageCheckboxes&&n?.checkbox?.isChecked===!0&&l.checkbox?.isChecked===!1&&(l.checkbox.isChecked=!0,o.push(l))}return o}async getChildrenBatch(i){let s,o=[];if(i?.every(r=>!!r.children))s=i.map(r=>r.children);else{i=i??[t.root];const r=await(i.length===1&&i[0]instanceof Lg?ww(e,void 0):ww(e,i));for(let n=0;n<i.length;n++){const d=i[n];d.children=r?r[n]:void 0}s=r??[],o=this.findCheckboxesUpdated(i,s)}return this.updateEmptyState(i,s),o.length>0&&t._onDidChangeCheckboxState.fire(o),s}},this._dataProvider.onDidChangeEmpty&&this._register(this._dataProvider.onDidChangeEmpty(()=>{this.updateCollapseAllToggle(),this._onDidChangeWelcomeState.fire()})),this.updateMessage(),this.refresh()}else this._dataProvider=void 0,this.treeDisposables.clear(),this.activated=!1,this.updateMessage();this._onDidChangeWelcomeState.fire()}get message(){return this._message}set message(e){this._message=e,this.updateMessage(),this._onDidChangeWelcomeState.fire()}get title(){return this._title}set title(e){this._title=e,this.tree&&(this.tree.ariaLabel=this._title),this._onDidChangeTitle.fire(this._title)}get description(){return this._description}set description(e){this._description=e,this._onDidChangeDescription.fire(this._description)}get badge(){return this._badge}set badge(e){if(!(this._badge?.value===e?.value&&this._badge?.tooltip===e?.tooltip))if(this._badge=e,e){const t={badge:new Mp(e.value,()=>e.tooltip),priority:50};this._activity.value=this.activityService.showViewActivity(this.id,t)}else this._activity.clear()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){const t=this._canSelectMany;this._canSelectMany=e,this._canSelectMany!==t&&this.tree?.updateOptions({multipleSelectionSupport:this.canSelectMany})}get manuallyManageCheckboxes(){return this._manuallyManageCheckboxes}set manuallyManageCheckboxes(e){this._manuallyManageCheckboxes=e}get hasIconForParentNode(){return this._hasIconForParentNode}get hasIconForLeafNode(){return this._hasIconForLeafNode}get visible(){return this.isVisible}initializeShowCollapseAllAction(e=!1){return this.collapseAllContext||(this.collapseAllContextKey=new oe(`treeView.${this.id}.enableCollapseAll`,e,c(3691,"Whether the tree view with id {0} enables collapse all.",this.id)),this.collapseAllContext=this.collapseAllContextKey.bindTo(this.contextKeyService)),!0}get showCollapseAllAction(){return this.initializeShowCollapseAllAction(),!!this.collapseAllContext?.get()}set showCollapseAllAction(e){this.initializeShowCollapseAllAction(e),this.collapseAllContext?.set(e)}initializeShowRefreshAction(e=!1){this.refreshContext||(this.refreshContextKey=new oe(`treeView.${this.id}.enableRefresh`,e,c(3692,"Whether the tree view with id {0} enables refresh.",this.id)),this.refreshContext=this.refreshContextKey.bindTo(this.contextKeyService))}get showRefreshAction(){return this.initializeShowRefreshAction(),!!this.refreshContext?.get()}set showRefreshAction(e){this.initializeShowRefreshAction(e),this.refreshContext?.set(e)}registerActions(){const e=this;this._register(S(class extends R{constructor(){super({id:`workbench.actions.treeView.${e.id}.refresh`,title:c(3693,"Refresh"),menu:{id:b.ViewTitle,when:I.and(I.equals("view",e.id),e.refreshContextKey),group:"navigation",order:Number.MAX_SAFE_INTEGER-1},icon:P.refresh})}async run(){return e.refresh()}})),this._register(S(class extends R{constructor(){super({id:`workbench.actions.treeView.${e.id}.collapseAll`,title:c(3694,"Collapse All"),menu:{id:b.ViewTitle,when:I.and(I.equals("view",e.id),e.collapseAllContextKey),group:"navigation",order:Number.MAX_SAFE_INTEGER},precondition:e.collapseAllToggleContextKey,icon:P.collapseAll})}async run(){if(e.tree)return new W1(e.tree,!0).run()}}))}setVisibility(e){this.initialize(),e=!!e,this.isVisible!==e&&(this.isVisible=e,this.tree&&(this.isVisible?ja(this.tree.getHTMLElement()):ur(this.tree.getHTMLElement()),this.isVisible&&this.elementsToRefresh.length&&this.dataProvider&&(this.doRefresh(this.elementsToRefresh),this.elementsToRefresh=[])),Ex(()=>{this.dataProvider&&this._onDidChangeVisibility.fire(this.isVisible)}),this.visible&&this.activate())}focus(e=!0,t){if(this.tree&&this.root.children&&this.root.children.length>0){const i=t??this.tree.getSelection()[0];i&&e&&this.tree.reveal(i,.5),this.tree.domFocus()}else this.tree&&this.treeContainer&&!this.treeContainer.classList.contains("hide")?this.tree.domFocus():this.domNode.focus()}show(e){this._container=e,ye(e,this.domNode)}create(){this.domNode=N(".tree-explorer-viewlet-tree-view"),this.messageElement=ye(this.domNode,N(".message")),this.updateMessage(),this.treeContainer=ye(this.domNode,N(".customview-tree")),this.treeContainer.classList.add("file-icon-themable-tree","show-file-icons");const e=this._register(Eo(this.domNode));this._register(e.onDidFocus(()=>this.focused=!0)),this._register(e.onDidBlur(()=>this.focused=!1))}createTree(){this.treeDisposables.clear();const e=mp.bind(void 0,this.instantiationService),t=this.treeDisposables.add(this.instantiationService.createInstance(bw,this.id));this.treeLabels=this.treeDisposables.add(this.instantiationService.createInstance(jc,this));const i=this.instantiationService.createInstance(j1,this,h=>this.progressService.withProgress({location:this.id},()=>h)),s=this.treeDisposables.add(new Y1(this.themeService,this.logService)),o=this.treeDisposables.add(new K1),r=this.treeDisposables.add(this.instantiationService.createInstance(Gc,this.id,t,this.treeLabels,e,s,o,()=>this.manuallyManageCheckboxes));this.treeDisposables.add(r.onDidChangeCheckboxState(h=>this._onDidChangeCheckboxState.fire(h)));const n=this._title;this.tree=this.treeDisposables.add(this.instantiationService.createInstance(z1,this.id,this.treeContainer,new q1,[r],i,{identityProvider:new $1,accessibilityProvider:{getAriaLabel(h){if(h.accessibilityInformation)return h.accessibilityInformation.label;if(Za(h.tooltip))return h.tooltip;{if(h.resourceUri&&!h.label)return null;let p="";if(h.label){const g=jo(h.label.label)?h.label.label.value:h.label.label;p+=g+" "}return h.description&&(p+=h.description),p}},getRole(h){return h.accessibilityInformation?.role??"treeitem"},getWidgetAriaLabel(){return n}},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:h=>h.label?jo(h.label.label)?h.label.label.value:h.label.label:h.resourceUri?Dt(F.revive(h.resourceUri)):void 0},expandOnlyOnTwistieClick:h=>!!h.command||!!h.checkbox||this.configurationService.getValue("workbench.tree.expandMode")==="doubleClick",collapseByDefault:h=>h.collapsibleState!==Bs.Expanded,multipleSelectionSupport:this.canSelectMany,dnd:this.treeViewDnd,overrideStyles:Vy(this.viewLocation).listOverrideStyles})),this.treeDisposables.add(r.onDidChangeMenuContext(h=>h.forEach(p=>this.tree?.rerender(p)))),this.treeDisposables.add(this.tree),t.setContextKeyService(this.tree.contextKeyService),s.tree=this.tree;const d=this.treeDisposables.add(new kI(this.notificationService,()=>this.tree.getSelection()));r.actionRunner=d,this.tree.contextKeyService.createKey(this.id,!0),H1.bindTo(this.tree.contextKeyService).set(!0),this.treeDisposables.add(this.tree.onContextMenu(h=>this.onContextMenu(t,h,d))),this.treeDisposables.add(this.tree.onDidChangeSelection(h=>{this.lastSelection=h.elements,this.lastActive=this.tree?.getFocus()[0]??this.lastActive,this._onDidChangeSelectionAndFocus.fire({selection:this.lastSelection,focus:this.lastActive})})),this.treeDisposables.add(this.tree.onDidChangeFocus(h=>{h.elements.length&&h.elements[0]!==this.lastActive&&(this.lastActive=h.elements[0],this.lastSelection=this.tree?.getSelection()??this.lastSelection,this._onDidChangeSelectionAndFocus.fire({selection:this.lastSelection,focus:this.lastActive}))})),this.treeDisposables.add(this.tree.onDidChangeCollapseState(h=>{if(!h.node.element)return;const p=Array.isArray(h.node.element.element)?h.node.element.element[0]:h.node.element.element;h.node.collapsed?this._onDidCollapseItem.fire(p):this._onDidExpandItem.fire(p)})),this.tree.setInput(this.root).then(()=>this.updateContentAreas()),this.treeDisposables.add(this.tree.onDidOpen(async h=>{if(!h.browserEvent||h.browserEvent.target&&h.browserEvent.target.classList.contains($h.checkboxClass))return;const p=this.tree.getSelection(),g=await this.resolveCommand(p.length===1?p[0]:void 0);if(g&&TI(g,this.contextKeyService)){let f=g.arguments||[];(g.id===Ff||g.id===Bf)&&(f=[...f,h]);try{await this.commandService.executeCommand(g.id,...f)}catch(m){this.notificationService.error(m)}}})),this.treeDisposables.add(t.onDidChange(h=>{this.tree?.hasNode(h)&&this.tree?.rerender(h)}))}async resolveCommand(e){let t=e?.command;return e&&!t&&e instanceof UE&&e.hasResolve&&(await e.resolve(Ni.None),t=e.command),t}onContextMenu(e,t,i){this.hoverService.hideHover();const s=t.element;if(s===null)return;const o=t.browserEvent;o.preventDefault(),o.stopPropagation(),this.tree.setFocus([s]);let r=this.canSelectMany?this.getSelection():[];r.find(d=>d.handle===s.handle)||(r=[s]);const n=e.getResourceContextActions(r);n.length&&this.contextMenuService.showContextMenu({getAnchor:()=>t.anchor,getActions:()=>n,getActionViewItem:d=>{const l=this.keybindingService.lookupKeybinding(d.id);if(l)return new $E(d,d,{label:!0,keybinding:l.getLabel()})},onHide:d=>{d&&this.tree.domFocus()},getActionsContext:()=>({$treeViewId:this.id,$treeItemHandle:s.handle}),actionRunner:i})}updateMessage(){this._message?this.showMessage(this._message):this.dataProvider?this.hideMessage():this.showMessage(U1),this.updateContentAreas()}processMessage(e,t){const i=e.value.split(`
`),s=[];let o=!1;for(const n of i){const d=eh(n);if(d.nodes.length===1&&typeof d.nodes[0]!="string"){const l=d.nodes[0],h=ve("div");h.classList.add("button-container");const p=new qE(h,{title:l.title,secondary:o,supportIcons:!0,...Xa});p.label=l.label,p.onDidClick(f=>{this.openerService.open(l.href,{allowCommands:!0})},null,t);const g=F.parse(l.href);if(g.scheme===ue.command){const f=AI(g.path);f&&(p.enabled=this.contextKeyService.contextMatchesRules(f),t.add(this.contextKeyService.onDidChangeContext(m=>{m.affectsSome(new Set(f.keys()))&&(p.enabled=this.contextKeyService.contextMatchesRules(f))})))}t.add(p),o=!0,s.push(h)}else{o=!1;const l=this.markdownRendererService.render(new Zi(n,{isTrusted:e.isTrusted,supportThemeIcons:e.supportThemeIcons,supportHtml:e.supportHtml}));s.push(l.element),t.add(l)}}const r=ve("div");r.classList.add("rendered-message");for(const n of s)Ln(n)?r.appendChild(n):r.appendChild(n.element);return r}showMessage(e){if(VC(this._messageValue)&&this._messageValue.disposables.dispose(),jo(e)){const t=new B,i=this.processMessage(e,t);this._messageValue={element:i,disposables:t}}else this._messageValue=e;this.messageElement&&(this.messageElement.classList.remove("hide"),this.resetMessageElement(),typeof this._messageValue=="string"&&!Nr(this._messageValue)?this.messageElement.textContent=this._messageValue:VC(this._messageValue)&&this.messageElement.appendChild(this._messageValue.element),this.layout(this._height,this._width))}hideMessage(){this.resetMessageElement(),this.messageElement?.classList.add("hide"),this.layout(this._height,this._width)}resetMessageElement(){this.messageElement&&Ut(this.messageElement)}layout(e,t){if(e&&t&&this.messageElement&&this.treeContainer){this._height=e,this._width=t;const i=e-_x(this.messageElement);this.treeContainer.style.height=i+"px",this.tree?.layout(i,t)}}getOptimalWidth(){if(this.tree){const e=this.tree.getHTMLElement(),t=[].slice.call(e.querySelectorAll(".outline-item-label > a"));return Ix(e,t)}return 0}updateCheckboxes(e){return xI(e)}async refresh(e,t){if(this.dataProvider&&this.tree){this.refreshing&&await K.toPromise(this._onDidCompleteRefresh.event),e||(e=[this.root],this.elementsToRefresh=[]);for(const i of e)i.children=void 0;if(this.isVisible){const i=this.updateCheckboxes(t??[]);return this.doRefresh(e.concat(i))}else if(this.elementsToRefresh.length){const i=new Set;this.elementsToRefresh.forEach(s=>i.add(s.handle));for(const s of e)i.has(s.handle)||this.elementsToRefresh.push(s)}else this.elementsToRefresh.push(...e)}}async expand(e){const t=this.tree;if(t)try{e=Array.isArray(e)?e:[e];for(const i of e)await t.expand(i,!1)}catch{}}isCollapsed(e){return!!this.tree?.isCollapsed(e)}setSelection(e){this.tree?.setSelection(e)}getSelection(){return this.tree?.getSelection()??[]}setFocus(e){this.tree&&(e?(this.focus(!0,e),this.tree.setFocus([e])):this.tree.getFocus().length===0&&this.tree.setFocus([]))}async reveal(e){if(this.tree)return this.tree.reveal(e)}async doRefresh(e){const t=this.tree;if(t&&this.visible){this.refreshing=!0;const i=t.getSelection();try{await Promise.all(e.map(o=>t.updateChildren(o,!0,!0)))}catch(o){this.logService.error(o)}const s=t.getSelection();(i.length!==s.length||i.some((o,r)=>o.handle!==s[r].handle))&&(this.lastSelection=s,this._onDidChangeSelectionAndFocus.fire({selection:this.lastSelection,focus:this.lastActive})),this.refreshing=!1,this._onDidCompleteRefresh.fire(),this.updateContentAreas(),this.focused&&this.focus(!1),this.updateCollapseAllToggle()}}initializeCollapseAllToggle(){this.collapseAllToggleContext||(this.collapseAllToggleContextKey=new oe(`treeView.${this.id}.toggleCollapseAll`,!1,c(3695,"Whether collapse all is toggled for the tree view with id {0}.",this.id)),this.collapseAllToggleContext=this.collapseAllToggleContextKey.bindTo(this.contextKeyService))}updateCollapseAllToggle(){this.showCollapseAllAction&&(this.initializeCollapseAllToggle(),this.collapseAllToggleContext?.set(!!this.root.children&&this.root.children.length>0&&this.root.children.some(e=>e.collapsibleState!==Bs.None)))}updateContentAreas(){const e=!this.root.children||this.root.children.length===0;this._messageValue&&e&&!this.refreshing&&this.treeContainer?(this.dragAndDropController||this.treeContainer.classList.add("hide"),this.domNode.setAttribute("tabindex","0")):this.treeContainer&&(this.treeContainer.classList.remove("hide"),this.domNode===Hs()&&this.focus(),this.domNode.removeAttribute("tabindex"))}get container(){return this._container}};mw=D([u(2,we),u(3,z),u(4,ke),u(5,te),u(6,Xc),u(7,st),u(8,ot),u(9,Qe),u(10,At),u(11,oi),u(12,de),u(13,Ir),u(14,et),u(15,tt),u(16,KE)],mw);class $1{getId(e){return e.handle}}class q1{getHeight(e){return Gc.ITEM_HEIGHT}getTemplateId(e){return Gc.TREE_TEMPLATE_ID}}async function ww(a,e){return a.getChildrenBatch?a.getChildrenBatch(e):e?Promise.all(e.map(t=>a.getChildren(t).then(i=>i??[]))):[await a.getChildren()].filter(t=>t!==void 0)}class j1{constructor(e,t){this.treeView=e,this.withProgress=t}hasChildren(e){return!!this.treeView.dataProvider&&e.collapsibleState!==Bs.None}async getChildren(e){const t=this.treeView.dataProvider;if(!t)return[];this.batch===void 0?(this.batch=[e],this.batchPromise=void 0):this.batch.push(e);const i=this.batch.length-1;return new Promise((s,o)=>{setTimeout(async()=>{const r=this.batch;this.batch=void 0,this.batchPromise||(this.batchPromise=this.withProgress(ww(t,r)));try{const n=await this.batchPromise;s(n&&i<n.length?n[i]:[])}catch(n){n.message.startsWith("Bad progress location:")||o(n)}},0)})}}var cr;let Gc=(cr=class extends M{constructor(e,t,i,s,o,r,n,d,l,h,p,g,f){super(),this.treeViewId=e,this.menus=t,this.labels=i,this.actionViewItemProvider=s,this.aligner=o,this.checkboxStateHandler=r,this.manuallyManageCheckboxes=n,this.themeService=d,this.configurationService=l,this.labelService=h,this.contextKeyService=p,this.hoverService=g,this._onDidChangeCheckboxState=this._register(new A),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidChangeMenuContext=this._register(new A),this.onDidChangeMenuContext=this._onDidChangeMenuContext.event,this._hasCheckbox=!1,this._renderedElements=new Map,this._hoverDelegate=this._register(f.createInstance(yx,"mouse",void 0,{})),this._register(this.themeService.onDidFileIconThemeChange(()=>this.rerender())),this._register(this.themeService.onDidColorThemeChange(()=>this.rerender())),this._register(r.onDidChangeCheckboxState(m=>{this.updateCheckboxes(m)})),this._register(this.contextKeyService.onDidChangeContext(m=>this.onDidChangeContext(m)))}get templateId(){return gw.TREE_TEMPLATE_ID}set actionRunner(e){this._actionRunner=e}renderTemplate(e){e.classList.add("custom-view-tree-node-item");const t=ye(e,N("")),i=this.labels.create(e,{supportHighlights:!0,hoverDelegate:this._hoverDelegate}),s=JC(i.element,N(".custom-view-tree-node-item-icon")),o=ye(i.element,N(".actions")),r=new Sr(o,{actionViewItemProvider:this.actionViewItemProvider});return{resourceLabel:i,icon:s,checkboxContainer:t,actionBar:r,container:e}}getHover(e,t,i){return!(i instanceof UE)||!i.hasResolve?t&&!i.tooltip?void 0:i.tooltip===void 0?jo(e)?{markdown:e,markdownNotSupportedFallback:e.value}:e:Za(i.tooltip)?i.tooltip!==""?i.tooltip:void 0:{markdown:i.tooltip,markdownNotSupportedFallback:t?void 0:Cx(i.tooltip)}:{markdown:typeof i.tooltip=="string"?i.tooltip:s=>new Promise(o=>{i.resolve(s).then(()=>o(i.tooltip))}),markdownNotSupportedFallback:t?void 0:e?jo(e)?e.value:e:""}}processLabel(e,t){if(!jo(e))return{label:e};let i=e.value.trim(),s=!1,o=!1,r=!1;function n(h){if(t)for(const p of t)p.start-=h,p.end-=h}const d=[{open:"~~",close:"~~",mark:()=>{r=!0}},{open:"**",close:"**",mark:()=>{s=!0}},{open:"*",close:"*",mark:()=>{o=!0}},{open:"_",close:"_",mark:()=>{o=!0}}];function l(){let h=!1;for(const p of d)if(i.startsWith(p.open)&&i.endsWith(p.close)){if(t?.some(g=>g.start<p.open.length||g.end>i.length-p.close.length))return!1;p.mark(),i=i.substring(p.open.length,i.length-p.close.length),n(p.open.length),h=!0}return h}for(let h=0;h<10&&l();h++);return{label:i,bold:s,italic:o,strikethrough:r,supportIcons:e.supportThemeIcons}}renderElement(e,t,i){const s=e.element,o=s.resourceUri?F.revive(s.resourceUri):null,r=s.label?s.label:o?{label:Dt(o)}:void 0,n=Za(s.description)?s.description:o&&s.description===!0?this.labelService.getUriLabel(qc(o),{relative:!0}):void 0,d=r?jo(r.label)?r.label.value:r.label:void 0,l=r?.highlights&&d?r.highlights.map(([$,H])=>{if($<0&&($=d.length+$),H<0&&(H=d.length+H),$>=d.length||H>d.length)return{start:0,end:0};if($>H){const ie=$;$=H,H=ie}return{start:$,end:H}}):void 0,{label:h,bold:p,italic:g,strikethrough:f,supportIcons:m}=this.processLabel(r?.label,l),v=HE(this.themeService.getColorTheme().type)?s.iconDark:s.icon,E=v?F.revive(v):void 0,x=this.getHover(r?.label,o,s);i.actionBar.clear(),i.icon.style.color="";let G=!0;if(s.command&&(G=TI(s.command,this.contextKeyService)),this.renderCheckbox(s,i),o){const $=this.configurationService.getValue("explorer.decorations"),H=o||F.parse("missing:_icon_resource");i.resourceLabel.setResource({name:h,description:n,resource:H},{fileKind:this.getFileKind(s),title:x,hideIcon:this.shouldHideResourceLabelIcon(E,s.themeIcon),fileDecorations:$,extraClasses:["custom-view-tree-node-item-resourceLabel"],matches:l||An(e.filterData),bold:p,italic:g,strikethrough:f,disabledCommand:!G,labelEscapeNewLines:!0,forceLabel:!!s.label,supportIcons:m})}else i.resourceLabel.setResource({name:h,description:n},{title:x,hideIcon:!0,extraClasses:["custom-view-tree-node-item-resourceLabel"],matches:l||An(e.filterData),bold:p,italic:g,strikethrough:f,disabledCommand:!G,labelEscapeNewLines:!0,supportIcons:m});if(E)i.icon.className="custom-view-tree-node-item-icon",i.icon.style.backgroundImage=go(E);else{let $;this.shouldShowThemeIcon(!!o,s.themeIcon)&&($=Se.asClassName(s.themeIcon),s.themeIcon.color&&(i.icon.style.color=this.themeService.getColorTheme().getColor(s.themeIcon.color.id)?.toString()??"")),i.icon.className=$?`custom-view-tree-node-item-icon ${$}`:"",i.icon.style.backgroundImage=""}G||(i.icon.className=i.icon.className+" disabled",i.container.parentElement&&(i.container.parentElement.className=i.container.parentElement.className+" disabled")),i.actionBar.context={$treeViewId:this.treeViewId,$treeItemHandle:s.handle};const W=this.menus.getResourceActions([s]);i.actionBar.push(W,{icon:!0,label:!1}),this._actionRunner&&(i.actionBar.actionRunner=this._actionRunner),this.setAlignment(i.container,s);const Y=this._renderedElements.get(e.element.handle)??[];this._renderedElements.set(e.element.handle,[...Y,{original:e,rendered:i}])}rerender(){const e=new Set(this._renderedElements.keys());for(const t of e){const i=this._renderedElements.get(t)??[];for(const s of i)this.disposeElement(s.original,0,s.rendered),this.renderElement(s.original,0,s.rendered)}}renderCheckbox(e,t){if(e.checkbox){if(this._hasCheckbox||(this._hasCheckbox=!0,this.rerender()),!t.checkbox){const i=new $h(t.checkboxContainer,this.checkboxStateHandler,this._hoverDelegate,this.hoverService);t.checkbox=i}t.checkbox.render(e)}else t.checkbox&&(t.checkbox.dispose(),t.checkbox=void 0)}setAlignment(e,t){e.parentElement.classList.toggle("align-icon-with-twisty",this.aligner.alignIconWithTwisty(t))}shouldHideResourceLabelIcon(e,t){return!!e||!!t&&!this.isFileKindThemeIcon(t)}shouldShowThemeIcon(e,t){return t?!(e&&this.isFileKindThemeIcon(t)):!1}isFileKindThemeIcon(e){return Se.isFile(e)||Se.isFolder(e)}getFileKind(e){if(e.themeIcon)switch(e.themeIcon.id){case Sx.id:return $t.FILE;case zE.id:return $t.FOLDER}return e.collapsibleState===Bs.Collapsed||e.collapsibleState===Bs.Expanded?$t.FOLDER:$t.FILE}onDidChangeContext(e){const t=e.affectsSome(this.menus.getEntireMenuContexts()),i=[];for(const[s,o]of this._renderedElements)for(const r of o)(t||e.affectsSome(this.menus.getElementOverlayContexts(r.original.element)))&&i.push(r.original.element);i.length&&this._onDidChangeMenuContext.fire(i)}updateCheckboxes(e){let t=[];this.manuallyManageCheckboxes()?t=e:t=xI(e),t.forEach(i=>{const s=this._renderedElements.get(i.handle);s&&s.forEach(o=>o.rendered.checkbox?.render(i))}),this._onDidChangeCheckboxState.fire(t)}disposeElement(e,t,i){const s=this._renderedElements.get(e.element.handle)??[],o=s.findIndex(r=>i===r.rendered);s.length===1?this._renderedElements.delete(e.element.handle):s.length>0&&s.splice(o,1),i.checkbox?.dispose(),i.checkbox=void 0}disposeTemplate(e){e.resourceLabel.dispose(),e.actionBar.dispose()}},gw=cr,cr.ITEM_HEIGHT=22,cr.TREE_TEMPLATE_ID="treeExplorer",cr);Gc=gw=D([u(7,we),u(8,te),u(9,rs),u(10,de),u(11,oi),u(12,z)],Gc);class Y1 extends M{constructor(e,t){super(),this.themeService=e,this.logService=t}set tree(e){this._tree=e}alignIconWithTwisty(e){if(e.collapsibleState!==Bs.None||!this.hasIconOrCheckbox(e))return!1;if(this._tree){const t=this._tree.getInput();let i;try{i=this._tree.getParentElement(e)||t}catch(s){return this.logService.error(`[TreeView] Failed to resolve parent for ${e.handle}`,s),!1}return this.hasIconOrCheckbox(i)?!!i.children&&i.children.some(s=>s.collapsibleState!==Bs.None&&!this.hasIconOrCheckbox(s)):!!i.children&&i.children.every(s=>s.collapsibleState===Bs.None||!this.hasIconOrCheckbox(s))}else return!1}hasIconOrCheckbox(e){return this.hasIcon(e)||!!e.checkbox}hasIcon(e){if(HE(this.themeService.getColorTheme().type)?e.iconDark:e.icon)return!0;if(e.resourceUri||e.themeIcon){const i=this.themeService.getFileIconTheme();return(e.themeIcon?e.themeIcon.id===zE.id:e.collapsibleState!==Bs.None)?i.hasFileIcons&&i.hasFolderIcons:i.hasFileIcons}return!1}}class kI extends Ab{constructor(e,t){super(),this.getSelectedResources=t,this._register(this.onDidRun(i=>{i.error&&!dd(i.error)&&e.error(c(3696,"Error running command {1}: {0}. This is likely caused by the extension that contributes {1}.",i.error.message,i.action.id))}))}async runAction(e,t){const i=this.getSelectedResources();let s,o=!1;i.length>1&&(s=i.map(r=>((r.handle===t.$treeItemHandle||t.$selectedTreeItems)&&(o=!0),{$treeViewId:t.$treeViewId,$treeItemHandle:r.handle}))),!o&&s&&(s=void 0),await e.run(t,s)}}let bw=class{constructor(e,t){this.id=e,this.menuService=t,this._onDidChange=new A,this.onDidChange=this._onDidChange.event}getResourceActions(e){return this.getActions(this.getMenuId(),e).primary}getResourceContextActions(e){return this.getActions(this.getMenuId(),e).secondary}setContextKeyService(e){this.contextKeyService=e}filterNonUniversalActions(e,t){const i=new Set(t.map(s=>s.id));for(const s of e){const o=s.keys();for(const r of o)i.has(r)||s.delete(r)}}buildMenu(e){const t=[];for(const i of e)i.size>0&&(t.length&&t.push(new ys),t.push(...i.values()));return t}createGroups(e){const t=[];let i=new Map;for(const s of e)s instanceof ys?(t.push(i),i=new Map):i.set(s.id,s);return t.push(i),t}getElementOverlayContexts(e){return new Map([["view",this.id],["viewItem",e.contextValue]])}getEntireMenuContexts(){return this.menuService.getMenuContexts(this.getMenuId())}getMenuId(){return b.ViewItemContext}getActions(e,t){if(!this.contextKeyService)return{primary:[],secondary:[]};let i=[],s=[];for(let o=0;o<t.length;o++){const r=t[o],n=this.contextKeyService.createOverlay(this.getElementOverlayContexts(r)),d=this.menuService.getMenuActions(e,n,{shouldForwardArgs:!0}),l=Ul(d,"inline");o===0?(i=this.createGroups(l.primary),s=this.createGroups(l.secondary)):(this.filterNonUniversalActions(i,l.primary),this.filterNonUniversalActions(s,l.secondary))}return{primary:this.buildMenu(i),secondary:this.buildMenu(s)}}dispose(){this.contextKeyService=void 0}};bw=D([u(1,Js)],bw);let vw=class extends mw{constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m,v,E,x,G,W,Y){super(e,t,s,o,r,n,d,l,h,p,g,m,f,E,G,W,Y),this.extensionId=i,this.extensionService=v,this.telemetryService=x}activate(){this.activated||(this.telemetryService.publicLog2("Extension:ViewActivate",{extensionId:new YS(this.extensionId),id:this.id}),this.createTree(),this.progressService.withProgress({location:this.id},()=>this.extensionService.activateByEvent(`onView:${this.id}`)).then(()=>fr(2e3)).then(()=>{this.updateMessage()}),this.activated=!0)}};vw=D([u(3,we),u(4,z),u(5,ke),u(6,te),u(7,Xc),u(8,st),u(9,ot),u(10,Qe),u(11,At),u(12,de),u(13,oi),u(14,si),u(15,Ir),u(16,nt),u(17,et),u(18,tt),u(19,KE)],vw);let yw=class{constructor(e,t,i,s,o){this.treeId=e,this.labelService=t,this.instantiationService=i,this.treeViewsDragAndDropService=s,this.logService=o,this.treeItemsTransfer=Ws.getInstance(),this.treeMimeType=`application/vnd.code.tree.${e.toLowerCase()}`}set controller(e){this.dndController=e}handleDragAndLog(e,t,i,s){return e.handleDrag(t,i,s).then(o=>{if(o){const r=[];for(const n of o)n[0]!==this.treeMimeType&&e.dragMimeTypes.findIndex(d=>d===n[0])<0&&r.push(n[0]);r.length&&this.logService.warn(`Drag and drop controller for tree ${this.treeId} adds the following data transfer types but does not declare them in dragMimeTypes: ${r.join(", ")}`)}return o})}addExtensionProvidedTransferTypes(e,t){if(!e.dataTransfer||!this.dndController)return;const i=fd();this.dragCancellationToken=new _o,this.treeViewsDragAndDropService.addDragOperationTransfer(i,this.handleDragAndLog(this.dndController,t,i,this.dragCancellationToken.token)),this.treeItemsTransfer.setData([new Fs(i)],Fs.prototype),e.dataTransfer.clearData(Fd.text),this.dndController.dragMimeTypes.find(s=>s===Fd.uriList)&&e.dataTransfer?.setData(Sa.RESOURCES,""),this.dndController.dragMimeTypes.forEach(s=>{e.dataTransfer?.setData(s,"")})}addResourceInfoToTransfer(e,t){if(t.length&&e.dataTransfer){this.instantiationService.invokeFunction(s=>jl(s,t,e));const i=t.filter(s=>s.scheme===ue.file).map(s=>s.fsPath);i.length&&e.dataTransfer.setData($g.FILES,JSON.stringify(i))}}onDragStart(e,t){if(t.dataTransfer){const i=e.getData(),s=[],o={id:this.treeId,itemHandles:[]};i.forEach(r=>{o.itemHandles.push(r.handle),r.resourceUri&&s.push(F.revive(r.resourceUri))}),this.addResourceInfoToTransfer(t,s),this.addExtensionProvidedTransferTypes(t,o.itemHandles),t.dataTransfer.setData(this.treeMimeType,JSON.stringify(o))}}debugLog(e){e.size?this.logService.debug(`TreeView dragged mime types: ${Array.from(e).join(", ")}`):this.logService.debug("TreeView dragged with no supported mime types.")}onDragOver(e,t,i,s,o){const r=Py(o.dataTransfer),n=new Set(Array.from(r,h=>h[0]));if(o.dataTransfer){for(const h of o.dataTransfer.items)if(h.kind==="file"||h.type===Sa.RESOURCES.toLowerCase()){n.add(Fd.uriList);break}}this.debugLog(n);const d=this.dndController;return!d||!o.dataTransfer||d.dropMimeTypes.length===0?!1:Array.from(n).some((h,p)=>h===this.treeMimeType?!0:d.dropMimeTypes.indexOf(h)>=0)?{accept:!0,bubble:Dx.Down,autoExpand:!0}:!1}getDragURI(e){return this.dndController?e.resourceUri?F.revive(e.resourceUri).toString():e.handle:null}getDragLabel(e){if(!this.dndController)return;if(e.length>1)return String(e.length);const t=e[0];return t.label?jo(t.label.label)?t.label.label.value:t.label.label:t.resourceUri?this.labelService.getUriLabel(F.revive(t.resourceUri)):void 0}async drop(e,t,i,s,o){const r=this.dndController;if(!o.dataTransfer||!r)return;let n,d;this.treeItemsTransfer.hasData(Fs.prototype)&&(d=this.treeItemsTransfer.getData(Fs.prototype)[0].identifier);const l=Py(o.dataTransfer,!0),h=new Ax;for(const[g,f]of l)if((g===this.treeMimeType||r.dropMimeTypes.includes(g)||f.asFile()&&r.dropMimeTypes.includes(Sa.FILES.toLowerCase()))&&(h.append(g,f),g===this.treeMimeType))try{n=JSON.parse(await f.asString())}catch{}const p=await this.treeViewsDragAndDropService.removeDragOperationTransfer(d);if(p)for(const[g,f]of p)h.append(g,f);return r.handleDrop(h,t,Ni.None,d,n?.id,n?.itemHandles)}onDragEnd(e){e.dataTransfer?.dropEffect==="none"&&this.dragCancellationToken?.cancel()}dispose(){}};yw=D([u(1,rs),u(2,z),u(3,Rb),u(4,et)],yw);function xI(a){const e=[];for(const t of a)if(t.checkbox!==void 0){const i=r=>{for(const n of r.children??[])n.checkbox!==void 0&&r.checkbox!==void 0&&n.checkbox.isChecked!==r.checkbox.isChecked&&(n.checkbox.isChecked=r.checkbox.isChecked,e.push(n),i(n))};i(t);const s=new Set,o=r=>{if(r.parent?.checkbox!==void 0&&r.parent.children){if(s.has(r.parent))return;s.add(r.parent);let n=!1,d=!1;for(const l of r.parent.children){if(n&&d)break;l.checkbox!==void 0&&(l.checkbox.isChecked?d=!0:n=!0)}d&&!n&&r.parent.checkbox.isChecked!==!0?(r.parent.checkbox.isChecked=!0,e.push(r.parent),o(r.parent)):n&&r.parent.checkbox.isChecked!==!1&&(r.parent.checkbox.isChecked=!1,e.push(r.parent),o(r.parent))}};o(t)}return a.concat(e)}const X1=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));Ee("remote-explorer-get-started",P.star,c(10268,"Getting started icon in the remote explorer view."));Ee("remote-explorer-documentation",P.book,c(10269,"Documentation icon in the remote explorer view."));Ee("remote-explorer-feedback",P.twitter,c(10270,"Feedback icon in the remote explorer view."));Ee("remote-explorer-review-issues",P.issues,c(10271,"Review issue icon in the remote explorer view."));Ee("remote-explorer-report-issues",P.comment,c(10272,"Report issue icon in the remote explorer view."));Ee("remote-explorer-view-icon",P.remoteExplorer,c(10273,"View icon of the remote explorer view."));const LI=Ee("ports-view-icon",P.plug,c(10274,"View icon of the remote ports view."));Ee("ports-view-icon",P.plug,c(10275,"Icon representing a remote port."));const RI=Ee("private-ports-view-icon",P.lock,c(10276,"Icon representing a private remote port.")),J1=Ee("ports-forward-icon",P.plus,c(10277,"Icon for the forward action.")),Z1=Ee("ports-stop-forward-icon",P.x,c(10278,"Icon for the stop forwarding action.")),Q1=Ee("ports-open-browser-icon",P.globe,c(10279,"Icon for the open browser action.")),eN=Ee("ports-open-preview-icon",P.openPreview,c(10280,"Icon for the open preview action.")),tN=Ee("ports-copy-address-icon",P.clippy,c(10281,"Icon for the copy local address action.")),VI=Ee("ports-label-icon",P.tag,c(10282,"Icon for the label port action.")),iN=Ee("ports-forwarded-without-process-icon",P.circleOutline,c(10283,"Icon for forwarded ports that don't have a running process.")),sN=Ee("ports-forwarded-with-process-icon",P.circleFilled,c(10284,"Icon for forwarded ports that do have a running process."));var Cw;xe(X1);const oN=new oe("openPreviewEnabled",!1);class rN{constructor(e){this.remoteExplorerService=e,this.headerRowHeight=22}getHeight(e){return e.tunnelType===ct.Add&&!this.remoteExplorerService.getEditableData(void 0)?30:22}}let Sw=class{constructor(e,t){this.remoteExplorerService=e,this.tunnelService=t,this._candidates=new Map,this.input={label:c(10314,"Add Port"),icon:void 0,tunnelType:ct.Add,hasRunningProcess:!1,remoteHost:"",remotePort:0,processDescription:"",tooltipPostfix:"",iconTooltip:"",portTooltip:"",processTooltip:"",originTooltip:"",privacyTooltip:"",source:{source:Xb.User,description:""},protocol:So.Http,privacy:{id:nh.Private,themeIcon:RI.id,label:c(10315,"Private")},strip:()=>{}},this.model=e.tunnelModel,this.onForwardedPortsChanged=K.any(this.model.onForwardPort,this.model.onClosePort,this.model.onPortName,this.model.onCandidatesChanged)}get all(){const e=[];return this._candidates=new Map,this.model.candidates.forEach(t=>{this._candidates.set(Qt(t.host,t.port),t)}),(this.model.forwarded.size>0||this.remoteExplorerService.getEditableData(void 0))&&e.push(...this.forwarded),this.model.detected.size>0&&e.push(...this.detected),e.push(this.input),e}addProcessInfoFromCandidate(e){const t=Qt(e.remoteHost,e.remotePort);this._candidates.has(t)&&(e.processDescription=this._candidates.get(t).detail)}get forwarded(){return Array.from(this.model.forwarded.values()).map(t=>{const i=Tt.createFromTunnel(this.remoteExplorerService,this.tunnelService,t);return this.addProcessInfoFromCandidate(i),i}).sort((t,i)=>t.remotePort===i.remotePort?t.remoteHost<i.remoteHost?-1:1:t.remotePort<i.remotePort?-1:1)}get detected(){return Array.from(this.model.detected.values()).map(e=>{const t=Tt.createFromTunnel(this.remoteExplorerService,this.tunnelService,e,ct.Detected,!1);return this.addProcessInfoFromCandidate(t),t})}isEmpty(){return this.detected.length===0&&(this.forwarded.length===0||this.forwarded.length===1&&this.forwarded[0].tunnelType===ct.Add&&!this.remoteExplorerService.getEditableData(void 0))}};Sw=D([u(0,St),u(1,Fi)],Sw);function ll(a){return{label:"",tunnel:a,editId:ti.None,tooltip:""}}class nN{constructor(){this.label="",this.tooltip="",this.weight=1,this.minimumWidth=40,this.maximumWidth=40,this.templateId="actionbar"}project(e){if(e.tunnelType===ct.Add)return ll(e);const t=e.processDescription?sN:iN;let i="";return e instanceof Tt&&(i=`${e.iconTooltip} ${e.tooltipPostfix}`),{label:"",icon:t,tunnel:e,editId:ti.None,tooltip:i}}}class aN{constructor(){this.label=c(10316,"Port"),this.tooltip=c(10317,"The label and remote port number of the forwarded port."),this.weight=1,this.templateId="actionbar"}project(e){const t=e.tunnelType===ct.Add,i=e.label;let s="";return e instanceof Tt&&!t?s=`${e.portTooltip} ${e.tooltipPostfix}`:s=i,{label:i,tunnel:e,menuId:b.TunnelPortInline,editId:e.tunnelType===ct.Add?ti.New:ti.Label,tooltip:s}}}class Iv{constructor(){this.label=c(10318,"Forwarded Address"),this.tooltip=c(10319,"The address that the forwarded port is available at."),this.weight=1,this.templateId="actionbar"}project(e){if(e.tunnelType===ct.Add)return ll(e);const t=e.localAddress??"";let i=t;return e instanceof Tt&&(i=e.tooltipPostfix),{label:t,menuId:b.TunnelLocalAddressInline,tunnel:e,editId:ti.LocalPort,tooltip:i,markdownTooltip:t?Iv.getHoverText(t):void 0}}static getHoverText(e){return function(t){const i=t.getValue("editor");let s="";i.multiCursorModifier==="ctrlCmd"?Ge?s=c(10320,"option + click"):s=c(10321,"alt + click"):Ge?s=c(10322,"cmd + click"):s=c(10323,"ctrl + click");const o=new Zi("",!0),r=e.startsWith("http")?e:`http://${e}`;return o.appendLink(r,"Follow link").appendMarkdown(` (${s})`)}}}class dN{constructor(){this.label=c(10324,"Running Process"),this.tooltip=c(10325,"The command line of the process that is using the port."),this.weight=2,this.templateId="actionbar"}project(e){return e.tunnelType===ct.Add?ll(e):{label:e.processDescription??"",tunnel:e,editId:ti.None,tooltip:e instanceof Tt?e.processTooltip:""}}}class cN{constructor(){this.label=c(10326,"Origin"),this.tooltip=c(10327,"The source that a forwarded port originates from. Can be an extension, user forwarded, statically forwarded, or automatically forwarded."),this.weight=1,this.templateId="actionbar"}project(e){if(e.tunnelType===ct.Add)return ll(e);const t=e.source.description,i=`${e instanceof Tt?e.originTooltip:""}. ${e instanceof Tt?e.tooltipPostfix:""}`;return{label:t,menuId:b.TunnelOriginInline,tunnel:e,editId:ti.None,tooltip:i}}}class lN{constructor(){this.label=c(10328,"Visibility"),this.tooltip=c(10329,"The availability of the forwarded port."),this.weight=1,this.templateId="actionbar"}project(e){if(e.tunnelType===ct.Add)return ll(e);const t=e.privacy?.label;let i="";return e instanceof Tt&&(i=`${e.privacy.label} ${e.tooltipPostfix}`),{label:t,tunnel:e,icon:{id:e.privacy.themeIcon},editId:ti.None,tooltip:i}}}let Ew=class extends M{constructor(e,t,i,s,o,r,n){super(),this.instantiationService=e,this.contextKeyService=t,this.menuService=i,this.contextViewService=s,this.remoteExplorerService=o,this.commandService=r,this.configurationService=n,this.templateId="actionbar",this._hoverDelegate=zc("mouse")}set actionRunner(e){this._actionRunner=e}renderTemplate(e){const t=ye(e,N(".ports-view-actionbar-cell")),i=ye(t,N(".ports-view-actionbar-cell-icon")),s=new Rp(t,{supportHighlights:!0,hoverDelegate:this._hoverDelegate}),o=ye(t,N(".actions")),r=new Sr(o,{actionViewItemProvider:mp.bind(void 0,this.instantiationService),hoverDelegate:this._hoverDelegate});return{label:s,icon:i,actionBar:r,container:t,elementDisposable:M.None}}renderElement(e,t,i){i.actionBar.clear(),i.icon.className="ports-view-actionbar-cell-icon",i.icon.style.display="none",i.label.setLabel(""),i.label.element.style.display="none",i.container.style.height="22px",i.button&&(i.button.element.style.display="none",i.button.dispose()),i.container.style.paddingLeft="0px",i.elementDisposable.dispose();let s;e.editId===ti.New&&(s=this.remoteExplorerService.getEditableData(void 0))?this.renderInputBox(i.container,s):(s=this.remoteExplorerService.getEditableData(e.tunnel,e.editId),s?this.renderInputBox(i.container,s):e.tunnel.tunnelType===ct.Add&&e.menuId===b.TunnelPortInline?this.renderButton(e,i):this.renderActionBarItem(e,i))}renderButton(e,t){t.container.style.paddingLeft="7px",t.container.style.height="28px",t.button=this._register(new qE(t.container,Xa)),t.button.label=e.label,t.button.element.title=e.tooltip,this._register(t.button.onDidClick(()=>{this.commandService.executeCommand(kt.INLINE_ID)}))}tunnelContext(e){let t;return e instanceof Tt&&(t=e.strip()),t||(t={tunnelType:e.tunnelType,remoteHost:e.remoteHost,remotePort:e.remotePort,localAddress:e.localAddress,protocol:e.protocol,localUri:e.localUri,localPort:e.localPort,name:e.name,closeable:e.closeable,source:e.source,privacy:e.privacy,processDescription:e.processDescription,label:e.label}),t}renderActionBarItem(e,t){t.label.element.style.display="flex",t.label.setLabel(e.label,void 0,{title:e.markdownTooltip?{markdown:e.markdownTooltip(this.configurationService),markdownNotSupportedFallback:e.tooltip}:e.tooltip,extraClasses:e.menuId===b.TunnelLocalAddressInline?["ports-view-actionbar-cell-localaddress"]:void 0}),t.actionBar.context=this.tunnelContext(e.tunnel),t.container.style.paddingLeft="10px";const i=[["view",Fr],[hl.key,e.tunnel.tunnelType],[ul.key,e.tunnel.closeable],[_w.key,e.tunnel.privacy.id],[Jp.key,e.tunnel.protocol]],s=this.contextKeyService.createOverlay(i),o=new B;if(t.elementDisposable=o,e.menuId){const r=o.add(this.menuService.createMenu(e.menuId,s));let n=Op(r.getActions({shouldForwardArgs:!0}));if(n){const d=n.filter(l=>l.id.toLowerCase().indexOf("label")>=0);d.length>1&&(d.sort((l,h)=>l.label.length-h.label.length),d.pop(),n=n.filter(l=>d.indexOf(l)<0)),t.actionBar.push(n,{icon:!0,label:!1}),this._actionRunner&&(t.actionBar.actionRunner=this._actionRunner)}}e.icon&&(t.icon.className=`ports-view-actionbar-cell-icon ${Se.asClassName(e.icon)}`,t.icon.title=e.tooltip,t.icon.style.display="inline")}renderInputBox(e,t){this.inputDone&&(this.inputDone(!1,!1),this.inputDone=void 0),e.style.paddingLeft="5px";const i=t.startingValue||"",s=new fE(e,this.contextViewService,{ariaLabel:c(10330,"Press Enter to confirm or Escape to cancel."),validationOptions:{validation:n=>{const d=t.validationMessage(n);return d?{content:d.content,formatContent:!0,type:d.severity===Te.Error?wl.ERROR:wl.INFO}:null}},placeholder:t.placeholder||"",inputBoxStyles:Ap});s.value=i,s.focus(),s.select({start:0,end:t.startingValue?t.startingValue.length:0});const o=$b(async(n,d)=>{dt(r),this.inputDone&&(this.inputDone=void 0),s.element.style.display="none";const l=s.value;if(d)return t.onFinish(l,n)});this.inputDone=o;const r=[s,wb(s.inputElement,Q.KEY_DOWN,async n=>{if(n.equals(w.Enter))return n.stopPropagation(),s.validate()!==wl.ERROR?o(!0,!0):o(!1,!0);if(n.equals(w.Escape))return n.preventDefault(),n.stopPropagation(),o(!1,!0)}),X(s.inputElement,Q.BLUR,()=>o(s.validate()!==wl.ERROR,!0))];return pe(()=>{o(!1,!1)})}disposeElement(e,t,i){i.elementDisposable.dispose()}disposeTemplate(e){e.label.dispose(),e.actionBar.dispose(),e.elementDisposable.dispose(),e.button?.dispose()}};Ew=D([u(0,z),u(1,de),u(2,Js),u(3,Bn),u(4,St),u(5,ke),u(6,te)],Ew);class Tt{static createFromTunnel(e,t,i,s=ct.Forwarded,o){return new Tt(s,i.remoteHost,i.remotePort,i.source,!!i.hasRunningProcess,i.protocol,i.localUri,i.localAddress,i.localPort,o===void 0?i.closeable:o,i.name,i.runningProcess,i.pid,i.privacy,e,t)}strip(){return new Tt(this.tunnelType,this.remoteHost,this.remotePort,this.source,this.hasRunningProcess,this.protocol,this.localUri,this.localAddress,this.localPort,this.closeable,this.name,this.runningProcess,this.pid,this._privacy)}constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m,v,E){this.tunnelType=e,this.remoteHost=t,this.remotePort=i,this.source=s,this.hasRunningProcess=o,this.protocol=r,this.localUri=n,this.localAddress=d,this.localPort=l,this.closeable=h,this.name=p,this.runningProcess=g,this.pid=f,this._privacy=m,this.remoteExplorerService=v,this.tunnelService=E}get label(){if(this.tunnelType===ct.Add&&this.name)return this.name;const e=xx(this.remoteHost)||Lx(this.remoteHost)?`${this.remotePort}`:`${this.remoteHost}:${this.remotePort}`;return this.name?`${this.name} (${e})`:e}set processDescription(e){this.runningProcess=e}get processDescription(){let e="";return this.runningProcess?(this.pid&&this.remoteExplorerService?.namedProcesses.has(this.pid)?e=this.remoteExplorerService.namedProcesses.get(this.pid):e=this.runningProcess.replace(/\0/g," ").trim(),this.pid&&(e+=` (${this.pid})`)):this.hasRunningProcess&&(e=c(10331,"Process information unavailable")),e}get tooltipPostfix(){let e;return this.localAddress?e=c(10332,"Remote port {0}:{1} forwarded to local address {2}. ",this.remoteHost,this.remotePort,this.localAddress):e=c(10333,"Remote port {0}:{1} not forwarded. ",this.remoteHost,this.remotePort),e}get iconTooltip(){return this.tunnelType===ct.Add?this.label:`${this.processDescription?c(10334,"Port has running process."):c(10335,"No running process.")}`}get portTooltip(){return this.tunnelType===ct.Add?"":`${this.name?c(10336,"Port labeled {0}. ",this.name):""}`}get processTooltip(){return this.processDescription??""}get originTooltip(){return this.source.description}get privacy(){return this.tunnelService?.privacyOptions?this.tunnelService?.privacyOptions.find(e=>e.id===this._privacy)??{id:"",themeIcon:P.question.id,label:c(10337,"Unknown")}:{id:nh.Private,themeIcon:RI.id,label:c(10315,"Private")}}}const hl=new oe("tunnelType",ct.Add,!0),ul=new oe("tunnelCloseable",!1,!0),_w=new oe("tunnelPrivacy",void 0,!0),PI=new oe("tunnelPrivacyEnabled",!1,!0),Jp=new oe("tunnelProtocol",So.Http,!0),Zp=new oe("tunnelViewFocus",!1,c(10338,"Whether the Ports view has focus.")),pl="tunnelViewSelection",hN=new oe(pl,void 0,!0),OI="tunnelViewMultiSelection",MI=new oe(OI,void 0,!0),NI=new oe("portChangable",!1,!0),FI=new oe("protocolChangable",!0,!0);var lr;let Hr=(lr=class extends Pp{constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m,v,E,x){super(t,i,s,r,o,d,n,l,f,v),this.viewModel=e,this.quickInputService=h,this.commandService=p,this.menuService=g,this.remoteExplorerService=m,this.tunnelService=E,this.contextViewService=x,this.tableDisposables=this._register(new B),this.isEditing=!1,this.titleActions=[],this.lastFocus=[],this.height=0,this.width=0,this.tunnelTypeContext=hl.bindTo(o),this.tunnelCloseableContext=ul.bindTo(o),this.tunnelPrivacyContext=_w.bindTo(o),this.tunnelPrivacyEnabledContext=PI.bindTo(o),this.tunnelPrivacyEnabledContext.set(E.canChangePrivacy),this.protocolChangableContextKey=FI.bindTo(o),this.protocolChangableContextKey.set(E.canChangeProtocol),this.tunnelProtocolContext=Jp.bindTo(o),this.tunnelViewFocusContext=Zp.bindTo(o),this.tunnelViewSelectionContext=hN.bindTo(o),this.tunnelViewMultiSelectionContext=MI.bindTo(o),this.portChangableContextKey=NI.bindTo(o);const G=this.contextKeyService.createOverlay([["view",Cw.ID]]),W=this._register(this.menuService.createMenu(b.TunnelTitle,G)),Y=()=>{this.titleActions=Op(W.getActions()),this.updateActions()};this._register(W.onDidChange(Y)),Y(),this._register(pe(()=>{this.titleActions=[]})),this.registerPrivacyActions(),this._register(K.once(this.tunnelService.onAddedTunnelProvider)(()=>{let $=!1;this.tunnelPrivacyEnabledContext.get()===!1&&(this.tunnelPrivacyEnabledContext.set(E.canChangePrivacy),$=!0),this.protocolChangableContextKey.get()===!0&&(this.protocolChangableContextKey.set(E.canChangeProtocol),$=!0),$&&(Y(),this.registerPrivacyActions(),this.createTable(),this.table?.layout(this.height,this.width))}))}registerPrivacyActions(){for(const e of this.tunnelService.privacyOptions){const t=`remote.tunnel.privacy${e.id}`;re.registerCommand(t,Iw.handler(e.id)),_.appendMenuItem(b.TunnelPrivacy,{order:0,command:{id:t,title:e.label,toggled:_w.isEqualTo(e.id)}})}}get portCount(){return this.remoteExplorerService.tunnelModel.forwarded.size+this.remoteExplorerService.tunnelModel.detected.size}createTable(){if(!this.panelContainer)return;this.tableDisposables.clear(),Ut(this.panelContainer);const e=ye(this.panelContainer,N(".customview-tree"));e.classList.add("ports-view"),e.classList.add("file-icon-themable-tree","show-file-icons");const t=new Ew(this.instantiationService,this.contextKeyService,this.menuService,this.contextViewService,this.remoteExplorerService,this.commandService,this.configurationService),i=[new nN,new aN,new Iv,new dN];this.tunnelService.canChangePrivacy&&i.push(new lN),i.push(new cN),this.table=this.instantiationService.createInstance(Tx,"RemoteTunnels",e,new rN(this.remoteExplorerService),i,[t],{keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:n=>n.label},multipleSelectionSupport:!0,accessibilityProvider:{getAriaLabel:n=>n instanceof Tt?`${n.tooltipPostfix} ${n.portTooltip} ${n.iconTooltip} ${n.processTooltip} ${n.originTooltip} ${this.tunnelService.canChangePrivacy?n.privacy.label:""}`:n.label,getWidgetAriaLabel:()=>c(10340,"Tunnel View")},openOnSingleClick:!0});const s=this.tableDisposables.add(new Ab);t.actionRunner=s,this.tableDisposables.add(this.table),this.tableDisposables.add(this.table.onContextMenu(n=>this.onContextMenu(n,s))),this.tableDisposables.add(this.table.onMouseDblClick(n=>this.onMouseDblClick(n))),this.tableDisposables.add(this.table.onDidChangeFocus(n=>this.onFocusChanged(n))),this.tableDisposables.add(this.table.onDidChangeSelection(n=>this.onSelectionChanged(n))),this.tableDisposables.add(this.table.onDidFocus(()=>this.tunnelViewFocusContext.set(!0))),this.tableDisposables.add(this.table.onDidBlur(()=>this.tunnelViewFocusContext.set(!1)));const o=()=>this.table?.splice(0,Number.POSITIVE_INFINITY,this.viewModel.all);o();let r=this.portCount;this.tableDisposables.add(K.debounce(this.viewModel.onForwardedPortsChanged,(n,d)=>d,50)(()=>{const n=this.portCount;(r===0||n===0)&&r!==n&&this._onDidChangeViewWelcomeState.fire(),r=n,o()})),this.tableDisposables.add(this.table.onMouseClick(n=>{if(this.hasOpenLinkModifier(n.browserEvent)&&this.table){const d=this.table.getSelectedElements();(d.length===0||d.length===1&&d[0]===n.element)&&this.commandService.executeCommand(Pi.ID,n.element)}})),this.tableDisposables.add(this.table.onDidOpen(n=>{!n.element||n.element.tunnelType!==ct.Forwarded||n.browserEvent?.type==="dblclick"&&this.commandService.executeCommand(xo.ID)})),this.tableDisposables.add(this.remoteExplorerService.onDidChangeEditable(n=>{this.isEditing=!!this.remoteExplorerService.getEditableData(n?.tunnel,n?.editId),this._onDidChangeViewWelcomeState.fire(),this.isEditing||e.classList.remove("highlight"),o(),this.isEditing?(e.classList.add("highlight"),n||this.table?.reveal(this.table.indexOf(this.viewModel.input))):(n&&n.tunnel.tunnelType!==ct.Add&&this.table?.setFocus(this.lastFocus),this.focus())}))}renderBody(e){super.renderBody(e),this.panelContainer=ye(e,N(".tree-explorer-viewlet-tree-view")),this.createTable()}shouldShowWelcome(){return this.viewModel.isEmpty()&&!this.isEditing}focus(){super.focus(),this.table?.domFocus()}onFocusChanged(e){e.indexes.length>0&&e.elements.length>0&&(this.lastFocus=[...e.indexes]);const t=e.elements,i=t&&t.length?t[0]:void 0;i?(this.tunnelViewSelectionContext.set(Qt(i.remoteHost,i.remotePort)),this.tunnelTypeContext.set(i.tunnelType),this.tunnelCloseableContext.set(!!i.closeable),this.tunnelPrivacyContext.set(i.privacy.id),this.tunnelProtocolContext.set(i.protocol===So.Https?So.Https:So.Https),this.portChangableContextKey.set(!!i.localPort)):(this.tunnelTypeContext.reset(),this.tunnelViewSelectionContext.reset(),this.tunnelCloseableContext.reset(),this.tunnelPrivacyContext.reset(),this.tunnelProtocolContext.reset(),this.portChangableContextKey.reset())}hasOpenLinkModifier(e){const t=this.configurationService.getValue("editor");let i=!1;return t.multiCursorModifier==="ctrlCmd"?i=e.altKey:Ge?i=e.metaKey:i=e.ctrlKey,i}onSelectionChanged(e){const t=e.elements;t.length>1?this.tunnelViewMultiSelectionContext.set(t.map(i=>Qt(i.remoteHost,i.remotePort))):this.tunnelViewMultiSelectionContext.set(void 0)}onContextMenu(e,t){if(e.element!==void 0&&!(e.element instanceof Tt))return;e.browserEvent.preventDefault(),e.browserEvent.stopPropagation();const i=e.element;i?(this.table?.setFocus([this.table.indexOf(i)]),this.tunnelTypeContext.set(i.tunnelType),this.tunnelCloseableContext.set(!!i.closeable),this.tunnelPrivacyContext.set(i.privacy.id),this.tunnelProtocolContext.set(i.protocol),this.portChangableContextKey.set(!!i.localPort)):(this.tunnelTypeContext.set(ct.Add),this.tunnelCloseableContext.set(!1),this.tunnelPrivacyContext.set(void 0),this.tunnelProtocolContext.set(void 0),this.portChangableContextKey.set(!1)),this.contextMenuService.showContextMenu({menuId:b.TunnelContext,menuActionOptions:{shouldForwardArgs:!0},contextKeyService:this.table?.contextKeyService,getAnchor:()=>e.anchor,getActionViewItem:s=>{const o=this.keybindingService.lookupKeybinding(s.id);if(o)return new $E(s,s,{label:!0,keybinding:o.getLabel()})},onHide:s=>{s&&this.table?.domFocus()},getActionsContext:()=>i?.strip(),actionRunner:t})}onMouseDblClick(e){e.element||this.commandService.executeCommand(kt.INLINE_ID)}layoutBody(e,t){this.height=e,this.width=t,super.layoutBody(e,t),this.table?.layout(e,t)}},Cw=lr,lr.ID=Fr,lr.TITLE=y(10339,"Ports"),lr);Hr=Cw=D([u(2,ot),u(3,st),u(4,de),u(5,te),u(6,z),u(7,At),u(8,tt),u(9,lt),u(10,ke),u(11,Js),u(12,we),u(13,St),u(14,oi),u(15,Fi),u(16,Bn)],Hr);class uN{constructor(e,t){this.id=Hr.ID,this.name=Hr.TITLE,this.canToggleVisibility=!0,this.hideByDefault=!1,this.group="details@0",this.order=-500,this.canMoveView=!0,this.containerIcon=LI,this.ctorDescriptor=new he(Hr,[e]),this.remoteAuthority=t.remoteAuthority?t.remoteAuthority.split("+")[0]:void 0}}function Ar(a){return a&&a.tunnelType&&a.remoteHost&&a.source}var xo;(function(a){a.ID="remote.tunnel.label",a.LABEL=c(10341,"Set Port Label"),a.COMMAND_ID_KEYWORD="label";function e(){return async(t,i)=>{const s=t.get(St);let o;if(Ar(i))o=i;else{const r=t.get(de).getContextKeyValue(pl),n=r?s.tunnelModel.forwarded.get(r):void 0;if(n){const d=t.get(Fi);o=Tt.createFromTunnel(s,d,n)}}if(o){const r=o;return new Promise(n=>{const d=r.name?r.name:`${r.remotePort}`;s.setEditable(r,ti.Label,{onFinish:async(l,h)=>{l=l.trim(),s.setEditable(r,ti.Label,null);const p=h&&l!==d;p&&await s.tunnelModel.name(r.remoteHost,r.remotePort,l),n(p?{port:r.remotePort,label:l}:void 0)},validationMessage:()=>null,placeholder:c(10342,"Port label"),startingValue:d})})}}}a.handler=e})(xo||(xo={}));const pN=c(10343,"Forwarded port should be a number or a host:port."),Dv=65536,BI=c(10344,"Port number must be  0 and < {0}.",Dv),GI=c(10345,"May Require Sudo"),gN=c(10346,"Port is already forwarded");var kt;(function(a){a.INLINE_ID="remote.tunnel.forwardInline",a.COMMANDPALETTE_ID="remote.tunnel.forwardCommandPalette",a.LABEL=y(10347,"Forward a Port"),a.TREEITEM_LABEL=c(10348,"Forward Port");const e=c(10349,"Port number or address (eg. 3000 or 10.10.10.10:2000).");function t(r,n,d,l){const h=gg(d);if(h){if(h.port>=Dv)return{content:BI,severity:Te.Error};if(l&&n.isPortPrivileged(h.port))return{content:GI,severity:Te.Info};if(_a(r.tunnelModel.forwarded,h.host,h.port))return{content:gN,severity:Te.Error}}else return{content:pN,severity:Te.Error};return null}function i(r,n,d,l){n?typeof n=="string"&&r.warn(c(10351,"Unable to forward {0}:{1}. {2}",d,l,n)):r.warn(c(10350,"Unable to forward {0}:{1}. The host may not be available or that remote port may already be forwarded",d,l))}function s(){return async(r,n)=>{const d=r.get(St),l=r.get(Qe),h=r.get(Fi);d.setEditable(void 0,ti.New,{onFinish:async(p,g)=>{d.setEditable(void 0,ti.New,null);let f;g&&(f=gg(p))&&d.forward({remote:{host:f.host,port:f.port},elevateIfNeeded:!0}).then(m=>i(l,m,f.host,f.port))},validationMessage:p=>t(d,h,p,h.canElevate),placeholder:e})}}a.inlineHandler=s;function o(){return async(r,n)=>{const d=r.get(St),l=r.get(Qe),h=r.get(jt),p=r.get(lt),g=r.get(Fi);await h.openView(Hr.ID,!0);const f=await p.input({prompt:e,validateInput:v=>Promise.resolve(t(d,g,v,g.canElevate))});let m;f&&(m=gg(f))&&d.forward({remote:{host:m.host,port:m.port},elevateIfNeeded:!0}).then(v=>i(l,v,m.host,m.port))}}a.commandPaletteHandler=o})(kt||(kt={}));function WI(a,e,t){const i=a.map(s=>{const o=Tt.createFromTunnel(e,t,s);return{label:o.label,description:o.processDescription,tunnel:o}});return i.length===0&&i.push({label:c(10352,"No ports currently forwarded. Try running the {0} command",kt.LABEL.value)}),i}var ss;(function(a){a.INLINE_ID="remote.tunnel.closeInline",a.COMMANDPALETTE_ID="remote.tunnel.closeCommandPalette",a.LABEL=y(10353,"Stop Forwarding Port");function e(){return async(i,s)=>{const o=i.get(de),r=i.get(St);let n=[];const d=o.getContextKeyValue(OI);if(d)d.forEach(l=>{const h=r.tunnelModel.forwarded.get(l);h&&n?.push(h)});else if(Ar(s))n=[s];else{const l=o.getContextKeyValue(pl),h=l?r.tunnelModel.forwarded.get(l):void 0;h&&(n=[h])}if(!(!n||n.length===0))return Promise.all(n.map(l=>r.close({host:l.remoteHost,port:l.remotePort},Vn.User)))}}a.inlineHandler=e;function t(){return async i=>{const s=i.get(lt),o=i.get(St),r=i.get(Fi),n=i.get(ke),d=WI(Array.from(o.tunnelModel.forwarded.values()).filter(h=>h.closeable),o,r),l=await s.pick(d,{placeHolder:c(10354,"Choose a port to stop forwarding")});l&&l.tunnel?await o.close({host:l.tunnel.remoteHost,port:l.tunnel.remotePort},Vn.User):l&&await n.executeCommand(kt.COMMANDPALETTE_ID)}}a.commandPaletteHandler=t})(ss||(ss={}));var Pi;(function(a){a.ID="remote.tunnel.open",a.LABEL=c(10355,"Open in Browser");function e(){return async(i,s)=>{let o;if(Ar(s)?o=Qt(s.remoteHost,s.remotePort):jE(s)&&(o=Qt(s.tunnelRemoteHost,s.tunnelRemotePort)),o){const r=i.get(St).tunnelModel,n=i.get(tt);return t(r,n,o)}}}a.handler=e;function t(i,s,o){const r=i.forwarded.get(o)||i.detected.get(o);return r?s.open(r.localUri,{allowContributedOpeners:!1}):Promise.resolve()}a.run=t})(Pi||(Pi={}));var vs;(function(a){a.ID="remote.tunnel.openPreview",a.LABEL=c(10356,"Preview in Editor");function e(){return async(i,s)=>{let o;if(Ar(s)?o=Qt(s.remoteHost,s.remotePort):jE(s)&&(o=Qt(s.tunnelRemoteHost,s.tunnelRemotePort)),o){const r=i.get(St).tunnelModel,n=i.get(tt),d=i.get(YE);return t(r,n,d,o)}}}a.handler=e;async function t(i,s,o,r){const n=i.forwarded.get(r)||i.detected.get(r);if(n){const d=n.remoteHost.includes(":")?`[${n.remoteHost}]`:n.remoteHost,l=F.parse(`http://${d}:${n.remotePort}`),h=await o.getOpener(n.localUri,{sourceUri:l},Ni.None);return h?h.openExternalUri(n.localUri,{sourceUri:l},Ni.None):s.open(n.localUri)}return Promise.resolve()}a.run=t})(vs||(vs={}));var od;(function(a){a.ID="remote.tunnel.openCommandPalette",a.LABEL=c(10357,"Open Port in Browser");function e(){return async(t,i)=>{const s=t.get(St),o=t.get(Fi),r=s.tunnelModel,n=t.get(lt),d=t.get(tt),l=t.get(ke),h=[...r.forwarded,...r.detected].map(g=>{const f=Tt.createFromTunnel(s,o,g[1]);return{label:f.label,description:f.processDescription,tunnel:f}});h.length===0?h.push({label:c(10358,"No ports currently forwarded. Open the Ports view to get started.")}):h.push({label:c(10359,"Open the Ports view...")});const p=await n.pick(h,{placeHolder:c(10360,"Choose the port to open")});if(p&&p.tunnel)return Pi.run(r,d,Qt(p.tunnel.remoteHost,p.tunnel.remotePort));if(p)return l.executeCommand(`${Fr}.focus`)}}a.handler=e})(od||(od={}));var os;(function(a){a.INLINE_ID="remote.tunnel.copyAddressInline",a.COMMANDPALETTE_ID="remote.tunnel.copyAddressCommandPalette",a.INLINE_LABEL=c(10361,"Copy Local Address"),a.COMMANDPALETTE_LABEL=c(10362,"Copy Forwarded Port Address");async function e(s,o,r){const n=s.tunnelModel.address(r.remoteHost,r.remotePort);n&&await o.writeText(n.toString())}function t(){return async(s,o)=>{const r=s.get(St);let n;if(Ar(o))n=o;else{const d=s.get(de).getContextKeyValue(pl);n=d?r.tunnelModel.forwarded.get(d):void 0}if(n)return e(r,s.get(yc),n)}}a.inlineHandler=t;function i(){return async(s,o)=>{const r=s.get(lt),n=s.get(St),d=s.get(Fi),l=s.get(ke),h=s.get(yc),p=Array.from(n.tunnelModel.forwarded.values()).concat(Array.from(n.tunnelModel.detected.values())),g=await r.pick(WI(p,n,d),{placeHolder:c(10363,"Choose a forwarded port")});g&&g.tunnel?await e(n,h,g.tunnel):g&&await l.executeCommand(kt.COMMANDPALETTE_ID)}}a.commandPaletteHandler=i})(os||(os={}));var rd;(function(a){a.ID="remote.tunnel.changeLocalPort",a.LABEL=c(10364,"Change Local Address Port");function e(i,s,o){if(s.match(/^[0-9]+$/)){if(Number(s)>=Dv)return{content:BI,severity:Te.Error};if(o&&i.isPortPrivileged(Number(s)))return{content:GI,severity:Te.Info}}else return{content:c(10365,"Local port should be a number."),severity:Te.Error};return null}function t(){return async(i,s)=>{const o=i.get(St),r=i.get(Qe),n=i.get(Fi);let d;if(Ar(s))d=s;else{const l=i.get(de).getContextKeyValue(pl),h=l?o.tunnelModel.forwarded.get(l):void 0;if(h){const p=i.get(Fi);d=Tt.createFromTunnel(o,p,h)}}if(d){const l=d;o.setEditable(l,ti.LocalPort,{onFinish:async(h,p)=>{if(o.setEditable(l,ti.LocalPort,null),p){await o.close({host:l.remoteHost,port:l.remotePort},Vn.Other);const g=Number(h),f=await o.forward({remote:{host:l.remoteHost,port:l.remotePort},local:g,name:l.name,elevateIfNeeded:!0,source:l.source});f&&typeof f!="string"&&f.tunnelLocalPort!==g&&r.warn(c(10366,"The local port {0} is not available. Port number {1} has been used instead",h,f.tunnelLocalPort??f.localAddress))}},validationMessage:h=>e(n,h,n.canElevate),placeholder:c(10367,"New local port")})}}}a.handler=t})(rd||(rd={}));var Iw;(function(a){function e(t){return async(i,s)=>{if(Ar(s)){const o=i.get(St);return await o.close({host:s.remoteHost,port:s.remotePort},Vn.Other),o.forward({remote:{host:s.remoteHost,port:s.remotePort},local:s.localPort,name:s.name,elevateIfNeeded:!0,privacy:t,source:s.source})}}}a.handler=e})(Iw||(Iw={}));var Xs;(function(a){a.ID_HTTP="remote.tunnel.setProtocolHttp",a.ID_HTTPS="remote.tunnel.setProtocolHttps",a.LABEL_HTTP=c(10368,"HTTP"),a.LABEL_HTTPS=c(10369,"HTTPS");async function e(s,o,r,n){if(Ar(s)){const d={protocol:o},l=n.remoteAuthority?Ot.USER_REMOTE:Ot.USER_LOCAL;return r.tunnelModel.configPortsAttributes.addAttributes(s.remotePort,d,l)}}function t(){return async(s,o)=>e(o,So.Http,s.get(St),s.get(wi))}a.handlerHttp=t;function i(){return async(s,o)=>e(o,So.Https,s.get(St),s.get(wi))}a.handlerHttps=i})(Xs||(Xs={}));const Av=10,Xn=hl.isEqualTo(ct.Forwarded),Jn=I.or(Xn,hl.isEqualTo(ct.Detected)),Tr=MI.isEqualTo(void 0);Z.registerCommandAndKeybindingRule({id:xo.ID,weight:L.WorkbenchContrib+Av,when:I.and(Zp,Xn,Tr),primary:w.F2,mac:{primary:w.Enter},handler:xo.handler()});re.registerCommand(kt.INLINE_ID,kt.inlineHandler());re.registerCommand(kt.COMMANDPALETTE_ID,kt.commandPaletteHandler());Z.registerCommandAndKeybindingRule({id:ss.INLINE_ID,weight:L.WorkbenchContrib+Av,when:I.and(ul,Zp),primary:w.Delete,mac:{primary:C.CtrlCmd|w.Backspace,secondary:[w.Delete]},handler:ss.inlineHandler()});re.registerCommand(ss.COMMANDPALETTE_ID,ss.commandPaletteHandler());re.registerCommand(Pi.ID,Pi.handler());re.registerCommand(vs.ID,vs.handler());re.registerCommand(od.ID,od.handler());Z.registerCommandAndKeybindingRule({id:os.INLINE_ID,weight:L.WorkbenchContrib+Av,when:I.and(Zp,Jn,Tr),primary:C.CtrlCmd|w.KeyC,handler:os.inlineHandler()});re.registerCommand(os.COMMANDPALETTE_ID,os.commandPaletteHandler());re.registerCommand(rd.ID,rd.handler());re.registerCommand(Xs.ID_HTTP,Xs.handlerHttp());re.registerCommand(Xs.ID_HTTPS,Xs.handlerHttps());_.appendMenuItem(b.CommandPalette,{command:{id:ss.COMMANDPALETTE_ID,title:ss.LABEL},when:Wr});_.appendMenuItem(b.CommandPalette,{command:{id:kt.COMMANDPALETTE_ID,title:kt.LABEL},when:Wr});_.appendMenuItem(b.CommandPalette,{command:{id:os.COMMANDPALETTE_ID,title:os.COMMANDPALETTE_LABEL},when:Wr});_.appendMenuItem(b.CommandPalette,{command:{id:od.ID,title:od.LABEL},when:Wr});_.appendMenuItem(b.TunnelContext,{group:"._open",order:0,command:{id:Pi.ID,title:Pi.LABEL},when:I.and(Jn,Tr)});_.appendMenuItem(b.TunnelContext,{group:"._open",order:1,command:{id:vs.ID,title:vs.LABEL},when:I.and(Jn,Tr)});_.appendMenuItem(b.TunnelContext,{group:"0_manage",order:1,command:{id:xo.ID,title:xo.LABEL,icon:VI},when:I.and(Xn,Tr)});_.appendMenuItem(b.TunnelContext,{group:"2_localaddress",order:0,command:{id:os.INLINE_ID,title:os.INLINE_LABEL},when:I.and(Jn,Tr)});_.appendMenuItem(b.TunnelContext,{group:"2_localaddress",order:1,command:{id:rd.ID,title:rd.LABEL},when:I.and(Xn,NI,Tr)});_.appendMenuItem(b.TunnelContext,{group:"2_localaddress",order:2,submenu:b.TunnelPrivacy,title:c(10370,"Port Visibility"),when:I.and(Xn,PI)});_.appendMenuItem(b.TunnelContext,{group:"2_localaddress",order:3,submenu:b.TunnelProtocol,title:c(10371,"Change Port Protocol"),when:I.and(Xn,Tr,FI)});_.appendMenuItem(b.TunnelContext,{group:"3_forward",order:0,command:{id:ss.INLINE_ID,title:ss.LABEL},when:ul});_.appendMenuItem(b.TunnelContext,{group:"3_forward",order:1,command:{id:kt.INLINE_ID,title:kt.LABEL}});_.appendMenuItem(b.TunnelProtocol,{order:0,command:{id:Xs.ID_HTTP,title:Xs.LABEL_HTTP,toggled:Jp.isEqualTo(So.Http)}});_.appendMenuItem(b.TunnelProtocol,{order:1,command:{id:Xs.ID_HTTPS,title:Xs.LABEL_HTTPS,toggled:Jp.isEqualTo(So.Https)}});_.appendMenuItem(b.TunnelPortInline,{group:"0_manage",order:0,command:{id:kt.INLINE_ID,title:kt.TREEITEM_LABEL,icon:J1},when:hl.isEqualTo(ct.Candidate)});_.appendMenuItem(b.TunnelPortInline,{group:"0_manage",order:4,command:{id:xo.ID,title:xo.LABEL,icon:VI},when:Xn});_.appendMenuItem(b.TunnelPortInline,{group:"0_manage",order:5,command:{id:ss.INLINE_ID,title:ss.LABEL,icon:Z1},when:ul});_.appendMenuItem(b.TunnelLocalAddressInline,{order:-1,command:{id:os.INLINE_ID,title:os.INLINE_LABEL,icon:tN},when:Jn});_.appendMenuItem(b.TunnelLocalAddressInline,{order:0,command:{id:Pi.ID,title:Pi.LABEL,icon:Q1},when:Jn});_.appendMenuItem(b.TunnelLocalAddressInline,{order:1,command:{id:vs.ID,title:vs.LABEL,icon:eN},when:Jn});De("ports.iconRunningProcessForeground",kx,c(10372,"The color of the icon for a port that has an associated running process."));const Rs=class Rs extends M{constructor(e,t){super(),this._onDidMatchLocalUrl=new A,this.onDidMatchLocalUrl=this._onDidMatchLocalUrl.event,this.listeners=new Map,this.replPositions=new Map,e.instances.forEach(i=>{this.registerTerminalInstance(i)}),this._register(e.onDidCreateInstance(i=>{this.registerTerminalInstance(i)})),this._register(e.onDidDisposeInstance(i=>{this.listeners.get(i)?.dispose(),this.listeners.delete(i)})),this._register(t.onDidNewSession(i=>{(!i.parentSession||i.parentSession&&i.hasSeparateRepl())&&this.listeners.set(i.getId(),i.onDidChangeReplElements(()=>{this.processNewReplElements(i)}))})),this._register(t.onDidEndSession(({session:i})=>{this.listeners.has(i.getId())&&(this.listeners.get(i.getId())?.dispose(),this.listeners.delete(i.getId()))}))}registerTerminalInstance(e){Rs.excludeTerminals.includes(e.title)||this.listeners.set(e,e.onData(t=>{this.processData(t)}))}processNewReplElements(e){const t=this.replPositions.get(e.getId()),i=e.getReplElements();if(this.replPositions.set(e.getId(),{position:i.length-1,tail:i[i.length-1]}),!t&&i.length>0)i.forEach(s=>this.processData(s.toString()));else if(t&&i.length-1!==t.position)for(let s=i.length-1;s>=0;s--){const o=i[s];if(o===t.tail)break;this.processData(o.toString())}}dispose(){super.dispose();const e=this.listeners.values();for(const t of e)t.dispose()}processData(e){e=Rx(e);const t=e.match(Rs.localUrlRegex)||[];if(t&&t.length>0)t.forEach(i=>{let s;try{s=new URL(i)}catch{}if(s){const o=i.match(Rs.extractPortRegex),r=parseFloat(s.port?s.port:o?o[2]:"NaN");if(!isNaN(r)&&Number.isInteger(r)&&r>0&&r<=65535){let n=s.hostname;if(n!=="0.0.0.0"&&n!=="127.0.0.1"&&(n="localhost"),r!==9229&&e.startsWith("Debugger listening on"))return;this._onDidMatchLocalUrl.fire({port:r,host:n})}}});else{const i=e.match(Rs.localPythonServerRegex);i&&i.length===3&&this._onDidMatchLocalUrl.fire({host:i[1],port:Number(i[2])})}}};Rs.localUrlRegex=/\b\w{0,20}(?::\/\/)?(?:localhost|127\.0\.0\.1|0\.0\.0\.0|:\d{2,5})[\w\-\.\~:\/\?\#[\]\@!\$&\(\)\*\+\,\;\=]*/gim,Rs.extractPortRegex=/(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d{1,5})/,Rs.localPythonServerRegex=/HTTP\son\s(127\.0\.0\.1|0\.0\.0\.0)\sport\s(\d+)/,Rs.excludeTerminals=["Dev Containers"];let Dw=Rs;const Rg="workbench.view.remote";let PC=class extends M{constructor(e,t,i,s,o,r){super(),this.contextKeyService=e,this.environmentService=t,this.remoteExplorerService=i,this.tunnelService=s,this.activityService=o,this.statusbarService=r,this.contextKeyListener=this._register(new Ae),this.activityBadge=this._register(new Ae),this.hasPortsInSession=!1,this._register(se.as(qt.ViewsRegistry).registerViewWelcomeContent(Fr,{content:this.environmentService.remoteAuthority?c(10252,`No forwarded ports. Forward a port to access your running services locally.
[Forward a Port]({0})`,`command:${kt.INLINE_ID}`):c(10253,`No forwarded ports. Forward a port to access your locally running services over the internet.
[Forward a Port]({0})`,`command:${kt.INLINE_ID}`)})),this.enableBadgeAndStatusBar(),this.enableForwardedPortsFeatures(),this.environmentService.remoteAuthority||this._register(K.once(this.tunnelService.onTunnelOpened)(()=>{this.hasPortsInSession=!0}))}async getViewContainer(){return se.as(qt.ViewContainersRegistry).registerViewContainer({id:fg,title:y(10254,"Ports"),icon:LI,ctorDescriptor:new he(tl,[fg,{mergeViewWithContainerWhenSingleView:!0}]),storageId:fg,hideIfEmpty:!0,order:5},ce.Panel)}async enableForwardedPortsFeatures(){this.contextKeyListener.clear();const e=!!Oy.getValue(this.contextKeyService),t=!!Wr.getValue(this.contextKeyService);if(e||t){t||this.contextKeyService.createKey(Wr.key,!0);const i=await this.getViewContainer(),s=new uN(new Sw(this.remoteExplorerService,this.tunnelService),this.environmentService),o=se.as(qt.ViewsRegistry);i&&(this.remoteExplorerService.enablePortsFeatures(!e),o.registerViews([s],i))}else this.contextKeyListener.value=this.contextKeyService.onDidChangeContext(i=>{i.affectsSome(new Set([...Oy.keys(),...Wr.keys()]))&&this.enableForwardedPortsFeatures()})}enableBadgeAndStatusBar(){const e=se.as(qt.ViewsRegistry).onViewsRegistered(t=>{t.find(i=>i.views.find(s=>s.id===Fr))&&(this._register(K.debounce(this.remoteExplorerService.tunnelModel.onForwardPort,(i,s)=>s,50)(()=>{this.updateActivityBadge(),this.updateStatusBar()})),this._register(K.debounce(this.remoteExplorerService.tunnelModel.onClosePort,(i,s)=>s,50)(()=>{this.updateActivityBadge(),this.updateStatusBar()})),this.updateActivityBadge(),this.updateStatusBar(),e.dispose())})}async updateActivityBadge(){this.remoteExplorerService.tunnelModel.forwarded.size>0?this.activityBadge.value=this.activityService.showViewActivity(Fr,{badge:new Mp(this.remoteExplorerService.tunnelModel.forwarded.size,e=>e===1?c(10255,"1 forwarded port"):c(10256,"{0} forwarded ports",e))}):this.activityBadge.clear()}updateStatusBar(){!this.environmentService.remoteAuthority&&!this.hasPortsInSession||(this.entryAccessor?this.entryAccessor.update(this.entry):this._register(this.entryAccessor=this.statusbarService.addEntry(this.entry,"status.forwardedPorts",_t.LEFT,40)))}get entry(){let e;const t=this.remoteExplorerService.tunnelModel.forwarded.size+this.remoteExplorerService.tunnelModel.detected.size,i=`${t}`;if(t===0)e=c(10257,"No Ports Forwarded");else{const s=Array.from(this.remoteExplorerService.tunnelModel.forwarded.values());s.push(...Array.from(this.remoteExplorerService.tunnelModel.detected.values())),e=c(10258,"Forwarded Ports: {0}",s.map(o=>o.remotePort).join(", "))}return{name:c(10259,"Forwarded Ports"),text:`$(radio-tower) ${i}`,ariaLabel:e,tooltip:e,command:`${Fr}.focus`}}};PC=D([u(0,de),u(1,wi),u(2,St),u(3,Fi),u(4,Ir),u(5,Ss)],PC);let OC=class{constructor(e,t){this.remoteExplorerService=e,this.logService=t,this.remoteExplorerService.tunnelModel.environmentTunnelsSet?this.restore():K.once(this.remoteExplorerService.tunnelModel.onEnvironmentTunnelsSet)(async()=>{await this.restore()})}async restore(){return this.logService.trace("ForwardedPorts: Doing first restore."),this.remoteExplorerService.restore()}};OC=D([u(0,St),u(1,et)],OC);let MC=class extends M{constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m,v){super(),this.terminalService=e,this.notificationService=t,this.openerService=i,this.externalOpenerService=s,this.remoteExplorerService=o,this.contextKeyService=n,this.configurationService=d,this.debugService=l,this.tunnelService=p,this.hostService=g,this.logService=f,this.storageService=m,this.preferencesService=v,r.remoteAuthority&&(d.whenRemoteConfigurationLoaded().then(()=>h.getEnvironment()).then(E=>{this.setup(E),this._register(d.onDidChangeConfiguration(x=>{x.affectsConfiguration(ro)?this.setup(E):x.affectsConfiguration(bl)&&!this.portListener&&this.listenForPorts()}))}),this.storageService.getBoolean("processPortForwardingFallback",ee.WORKSPACE,!0)||this.configurationService.updateValue(bl,0,Ot.WORKSPACE))}getPortAutoFallbackNumber(){const e=this.configurationService.inspect(bl);if(e.value!==void 0&&(e.value===0||e.value!==e.defaultValue))return e.value;const t=this.configurationService.inspect(ro);return t.applicationValue===so||t.userValue===so||t.userLocalValue===so||t.userRemoteValue===so||t.workspaceFolderValue===so||t.workspaceValue===so?0:e.value??20}listenForPorts(){let e=this.getPortAutoFallbackNumber();if(e===0){this.portListener?.dispose();return}this.procForwarder&&!this.portListener&&this.configurationService.getValue(ro)===so?this.portListener=this._register(this.remoteExplorerService.tunnelModel.onForwardPort(async()=>{if(e=this.getPortAutoFallbackNumber(),e===0){this.portListener?.dispose();return}Array.from(this.remoteExplorerService.tunnelModel.forwarded.values()).filter(t=>t.source.source===Xb.Auto).length>e&&(await this.configurationService.updateValue(ro,sf),this.notificationService.notify({message:c(10260,"Over 20 ports have been automatically forwarded. The `process` based automatic port forwarding has been switched to `hybrid` in settings. Some ports may no longer be detected."),severity:Te.Warning,actions:{primary:[Gt({id:"switchBack",label:c(10261,"Undo"),run:async()=>{await this.configurationService.updateValue(ro,so),await this.configurationService.updateValue(bl,0,Ot.WORKSPACE),this.portListener?.dispose(),this.portListener=void 0}}),Gt({id:"showPortSourceSetting",label:c(10262,"Show Setting"),run:async()=>{await this.preferencesService.openSettings({query:"remote.autoForwardPortsSource"})}})]}}))})):(this.portListener?.dispose(),this.portListener=void 0)}setup(e){const t=this.procForwarder?.forwarded,i=this.outputForwarder||this.procForwarder;if(this.procForwarder?.dispose(),this.procForwarder=void 0,this.outputForwarder?.dispose(),this.outputForwarder=void 0,e?.os!==bs.Linux)this.configurationService.inspect(ro).default?.value!==My&&se.as(Lo.Configuration).registerDefaultConfigurations([{overrides:{"remote.autoForwardPortsSource":My}}]),this.outputForwarder=this._register(new NC(this.terminalService,this.notificationService,this.openerService,this.externalOpenerService,this.remoteExplorerService,this.configurationService,this.debugService,this.tunnelService,this.hostService,this.logService,this.contextKeyService,()=>!1));else{const s=()=>this.configurationService.getValue(ro)===so;s()?this.procForwarder=this._register(new FC(!1,t,!i,this.configurationService,this.remoteExplorerService,this.notificationService,this.openerService,this.externalOpenerService,this.tunnelService,this.hostService,this.logService,this.contextKeyService)):this.configurationService.getValue(ro)===sf&&(this.procForwarder=this._register(new FC(!0,t,!i,this.configurationService,this.remoteExplorerService,this.notificationService,this.openerService,this.externalOpenerService,this.tunnelService,this.hostService,this.logService,this.contextKeyService))),this.outputForwarder=this._register(new NC(this.terminalService,this.notificationService,this.openerService,this.externalOpenerService,this.remoteExplorerService,this.configurationService,this.debugService,this.tunnelService,this.hostService,this.logService,this.contextKeyService,s))}this.listenForPorts()}};MC=D([u(0,Vx),u(1,Qe),u(2,tt),u(3,YE),u(4,St),u(5,wi),u(6,de),u(7,Px),u(8,Ox),u(9,Mx),u(10,Fi),u(11,Rt),u(12,et),u(13,ge),u(14,ld)],MC);const ip=class ip extends M{constructor(e,t,i,s,o,r,n,d){super(),this.notificationService=e,this.remoteExplorerService=t,this.openerService=i,this.externalOpenerService=s,this.tunnelService=o,this.hostService=r,this.logService=n,this.contextKeyService=d,this.alreadyOpenedOnce=new Set,this.lastNotifyTime=new Date,this.lastNotifyTime.setFullYear(this.lastNotifyTime.getFullYear()-1)}async doAction(e){this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) Starting action for ${e[0]?.tunnelRemotePort}`),this.doActionTunnels=e;const t=await this.portNumberHeuristicDelay();if(this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) Heuristic chose ${t?.tunnelRemotePort}`),t){const s=(await this.remoteExplorerService.tunnelModel.getAttributes([{port:t.tunnelRemotePort,host:t.tunnelRemoteHost}]))?.get(t.tunnelRemotePort)?.onAutoForward;switch(this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) onAutoForward action is ${s}`),s){case aa.OpenBrowserOnce:{if(this.alreadyOpenedOnce.has(t.localAddress))break;this.alreadyOpenedOnce.add(t.localAddress)}case aa.OpenBrowser:{const o=Qt(t.tunnelRemoteHost,t.tunnelRemotePort);await Pi.run(this.remoteExplorerService.tunnelModel,this.openerService,o);break}case aa.OpenPreview:{const o=Qt(t.tunnelRemoteHost,t.tunnelRemotePort);await vs.run(this.remoteExplorerService.tunnelModel,this.openerService,this.externalOpenerService,o);break}case aa.Silent:break;default:{const o=new Date().getTime()-this.lastNotifyTime.getTime();this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) time elapsed since last notification ${o} ms`),o>ip.NOTIFY_COOL_DOWN&&await this.showNotification(t)}}}}hide(e){this.doActionTunnels&&(this.doActionTunnels=this.doActionTunnels.filter(t=>!e.includes(t.tunnelRemotePort))),this.lastShownPort&&e.indexOf(this.lastShownPort)>=0&&this.lastNotification?.close()}async portNumberHeuristicDelay(){if(this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) Starting heuristic delay"),!this.doActionTunnels||this.doActionTunnels.length===0)return;this.doActionTunnels=this.doActionTunnels.sort((t,i)=>t.tunnelRemotePort-i.tunnelRemotePort);const e=this.doActionTunnels.shift();return e.tunnelRemotePort%1e3===0?(this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) Heuristic chose tunnel because % 1000: ${e.tunnelRemotePort}`),this.newerTunnel=e,e):e.tunnelRemotePort<1e4&&e.tunnelRemotePort!==9229?(this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) Heuristic chose tunnel because < 10000: ${e.tunnelRemotePort}`),this.newerTunnel=e,e):(this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) Waiting for "better" tunnel than ${e.tunnelRemotePort}`),this.newerTunnel=void 0,new Promise(t=>{setTimeout(()=>{this.newerTunnel?t(void 0):this.doActionTunnels?.includes(e)?t(e):t(void 0)},3e3)}))}async basicMessage(e){const i=(await this.remoteExplorerService.tunnelModel.getAttributes([{host:e.tunnelRemoteHost,port:e.tunnelRemotePort}],!1))?.get(e.tunnelRemotePort)?.label;return c(10263,"Your application{0} running on port {1} is available.  ",i?` (${i})`:"",e.tunnelRemotePort)}linkMessage(){return c(10264,"[See all forwarded ports]({0})",`command:${Hr.ID}.focus`)}async showNotification(e){if(!await this.hostService.hadLastFocus())return;this.lastNotification?.close();let t=await this.basicMessage(e);const i=[this.openBrowserChoice(e)];(!ei||oN.getValue(this.contextKeyService))&&i.push(this.openPreviewChoice(e)),e.tunnelLocalPort!==e.tunnelRemotePort&&this.tunnelService.canElevate&&this.tunnelService.isPortPrivileged(e.tunnelRemotePort)&&(t+=c(10265,"You'll need to run as superuser to use port {0} locally.  ",e.tunnelRemotePort),i.unshift(this.elevateChoice(e))),e.privacy===nh.Private&&ei&&this.tunnelService.canChangePrivacy&&i.push(this.makePublicChoice(e)),t+=this.linkMessage(),this.lastNotification=this.notificationService.prompt(Te.Info,t,i,{neverShowAgain:{id:"remote.tunnelsView.autoForwardNeverShow",isSecondary:!0}}),this.lastShownPort=e.tunnelRemotePort,this.lastNotifyTime=new Date,this.lastNotification.onDidClose(()=>{this.lastNotification=void 0,this.lastShownPort=void 0})}makePublicChoice(e){return{label:c(10266,"Make Public"),run:async()=>{const t=_a(this.remoteExplorerService.tunnelModel.forwarded,e.tunnelRemoteHost,e.tunnelRemotePort);return await this.remoteExplorerService.close({host:e.tunnelRemoteHost,port:e.tunnelRemotePort},Vn.Other),this.remoteExplorerService.forward({remote:{host:e.tunnelRemoteHost,port:e.tunnelRemotePort},local:e.tunnelLocalPort,name:t?.name,elevateIfNeeded:!0,privacy:nh.Public,source:t?.source})}}}openBrowserChoice(e){const t=Qt(e.tunnelRemoteHost,e.tunnelRemotePort);return{label:Pi.LABEL,run:()=>Pi.run(this.remoteExplorerService.tunnelModel,this.openerService,t)}}openPreviewChoice(e){const t=Qt(e.tunnelRemoteHost,e.tunnelRemotePort);return{label:vs.LABEL,run:()=>vs.run(this.remoteExplorerService.tunnelModel,this.openerService,this.externalOpenerService,t)}}elevateChoice(e){return{label:c(10267,"Use Port {0} as Sudo...",e.tunnelRemotePort),run:async()=>{await this.remoteExplorerService.close({host:e.tunnelRemoteHost,port:e.tunnelRemotePort},Vn.Other);const t=await this.remoteExplorerService.forward({remote:{host:e.tunnelRemoteHost,port:e.tunnelRemotePort},local:e.tunnelRemotePort,elevateIfNeeded:!0,source:Jb});!t||typeof t=="string"||(this.lastNotification?.close(),this.lastShownPort=t.tunnelRemotePort,this.lastNotification=this.notificationService.prompt(Te.Info,await this.basicMessage(t)+this.linkMessage(),[this.openBrowserChoice(t),this.openPreviewChoice(e)],{neverShowAgain:{id:"remote.tunnelsView.autoForwardNeverShow",isSecondary:!0}}),this.lastNotification.onDidClose(()=>{this.lastNotification=void 0,this.lastShownPort=void 0}))}}}};ip.NOTIFY_COOL_DOWN=5e3;let qh=ip;class NC extends M{constructor(e,t,i,s,o,r,n,d,l,h,p,g){super(),this.terminalService=e,this.notificationService=t,this.openerService=i,this.externalOpenerService=s,this.remoteExplorerService=o,this.configurationService=r,this.debugService=n,this.tunnelService=d,this.hostService=l,this.logService=h,this.contextKeyService=p,this.privilegedOnly=g,this.notifier=new qh(t,o,i,s,d,l,h,p),this._register(r.onDidChangeConfiguration(f=>{f.affectsConfiguration(Kd)&&this.tryStartStopUrlFinder()})),this.portsFeatures=this._register(this.remoteExplorerService.onEnabledPortsFeatures(()=>{this.tryStartStopUrlFinder()})),this.tryStartStopUrlFinder(),r.getValue(ro)===sf&&this._register(this.tunnelService.onTunnelClosed(f=>this.notifier.hide([f.port])))}tryStartStopUrlFinder(){this.configurationService.getValue(Kd)?this.startUrlFinder():this.stopUrlFinder()}startUrlFinder(){!this.urlFinder&&this.remoteExplorerService.portsFeaturesEnabled!==XE.AdditionalFeatures||(this.portsFeatures?.dispose(),this.urlFinder=this._register(new Dw(this.terminalService,this.debugService)),this._register(this.urlFinder.onDidMatchLocalUrl(async e=>{if(_a(this.remoteExplorerService.tunnelModel.detected,e.host,e.port))return;const t=(await this.remoteExplorerService.tunnelModel.getAttributes([e]))?.get(e.port);if(t?.onAutoForward===aa.Ignore||this.privilegedOnly()&&!this.tunnelService.isPortPrivileged(e.port))return;const i=await this.remoteExplorerService.forward({remote:e,source:Jb},t??null);i&&typeof i!="string"&&this.notifier.doAction([i])})))}stopUrlFinder(){this.urlFinder&&(this.urlFinder.dispose(),this.urlFinder=void 0)}}class FC extends M{constructor(e,t,i,s,o,r,n,d,l,h,p,g){super(),this.unforwardOnly=e,this.alreadyAutoForwarded=t,this.needsInitialCandidates=i,this.configurationService=s,this.remoteExplorerService=o,this.notificationService=r,this.openerService=n,this.externalOpenerService=d,this.tunnelService=l,this.hostService=h,this.logService=p,this.contextKeyService=g,this.autoForwarded=new Set,this.notifiedOnly=new Set,this.initialCandidates=new Set,this.notifier=new qh(r,o,n,d,l,h,p,g),t?.forEach(f=>this.autoForwarded.add(f)),this.initialize()}get forwarded(){return this.autoForwarded}async initialize(){this.remoteExplorerService.tunnelModel.environmentTunnelsSet||await new Promise(e=>this.remoteExplorerService.tunnelModel.onEnvironmentTunnelsSet(()=>e())),this._register(this.configurationService.onDidChangeConfiguration(async e=>{e.affectsConfiguration(Kd)&&await this.startStopCandidateListener()})),this.portsFeatures=this._register(this.remoteExplorerService.onEnabledPortsFeatures(async()=>{await this.startStopCandidateListener()})),this.startStopCandidateListener()}async startStopCandidateListener(){this.configurationService.getValue(Kd)?await this.startCandidateListener():this.stopCandidateListener()}stopCandidateListener(){this.candidateListener&&(this.candidateListener.dispose(),this.candidateListener=void 0)}async startCandidateListener(){this.candidateListener||this.remoteExplorerService.portsFeaturesEnabled!==XE.AdditionalFeatures||(this.portsFeatures?.dispose(),await this.setInitialCandidates(),this.configurationService.getValue(Kd)&&(this.candidateListener=this._register(this.remoteExplorerService.tunnelModel.onCandidatesChanged(this.handleCandidateUpdate,this))))}async setInitialCandidates(){if(!this.needsInitialCandidates){this.logService.debug("ForwardedPorts: (ProcForwarding) Not setting initial candidates");return}let e=this.remoteExplorerService.tunnelModel.candidatesOrUndefined;e||(await new Promise(t=>this.remoteExplorerService.tunnelModel.onCandidatesChanged(()=>t())),e=this.remoteExplorerService.tunnelModel.candidates);for(const t of e)this.initialCandidates.add(Qt(t.host,t.port));this.logService.debug(`ForwardedPorts: (ProcForwarding) Initial candidates set to ${e.map(t=>t.port).join(", ")}`)}async forwardCandidates(){let e;const t=[];this.logService.trace(`ForwardedPorts: (ProcForwarding) Attempting to forward ${this.remoteExplorerService.tunnelModel.candidates.length} candidates`);for(const i of this.remoteExplorerService.tunnelModel.candidates){if(!i.detail){this.logService.trace(`ForwardedPorts: (ProcForwarding) Port ${i.port} missing detail`);continue}e||(e=await this.remoteExplorerService.tunnelModel.getAttributes(this.remoteExplorerService.tunnelModel.candidates));const s=e?.get(i.port),o=Qt(i.host,i.port);if(this.initialCandidates.has(o)&&s?.onAutoForward===void 0||this.notifiedOnly.has(o)||this.autoForwarded.has(o))continue;const r=_a(this.remoteExplorerService.tunnelModel.forwarded,i.host,i.port);if(_a(this.remoteExplorerService.tunnelModel.detected,i.host,i.port))continue;if(s?.onAutoForward===aa.Ignore){this.logService.trace(`ForwardedPorts: (ProcForwarding) Port ${i.port} is ignored`);continue}const n=await this.remoteExplorerService.forward({remote:i,source:Jb},s??null);!r&&n?(this.logService.trace(`ForwardedPorts: (ProcForwarding) Port ${i.port} has been forwarded`),this.autoForwarded.add(o)):n&&(this.logService.trace(`ForwardedPorts: (ProcForwarding) Port ${i.port} has been notified`),this.notifiedOnly.add(o)),n&&typeof n!="string"&&t.push(n)}if(this.logService.trace(`ForwardedPorts: (ProcForwarding) Forwarded ${t.length} candidates`),t.length!==0)return t}async handleCandidateUpdate(e){const t=[];let i;if(this.unforwardOnly){i=new Map;for(const o of this.remoteExplorerService.tunnelModel.forwarded.entries())o[1].source.source===Xb.Auto&&i.set(o[0],o[1])}else i=new Map(this.autoForwarded.entries());for(const o of e){const r=o[0];let n=o[1];const d=_a(i,n.host,n.port);d?(typeof d=="string"?this.autoForwarded.delete(r):n={host:d.remoteHost,port:d.remotePort},await this.remoteExplorerService.close(n,Vn.AutoForwardEnd),t.push(n.port)):this.notifiedOnly.delete(r)?t.push(n.port):this.initialCandidates.delete(r)}if(this.unforwardOnly)return;t.length>0&&await this.notifier.hide(t);const s=await this.forwardCandidates();s&&await this.notifier.doAction(s)}}var Aw;const Vg={webviewState:"webviewState"};var Aa;let Tw=(Aa=class extends Pp{static getOriginStore(e){return this._originStore??=new Nx("webviewViews.origins",e),this._originStore}constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m,v,E,x){super({...e,titleMenuId:b.ViewTitle,showActions:Fx.WhenExpanded},r,s,t,i,h,o,n,l,d),this.activityService=p,this.extensionService=g,this.progressService=f,this.storageService=m,this.viewService=v,this.webviewService=E,this.webviewViewService=x,this._webview=this._register(new Ae),this._webviewDisposables=this._register(new B),this._activated=!1,this.activity=this._register(new Ae),this._onDidChangeVisibility=this._register(new A),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDispose=this._register(new A),this.onDispose=this._onDispose.event,this.extensionId=e.fromExtensionId,this.defaultTitle=this.title,this.memento=new aE(`webviewView.${this.id}`,m),this.viewState=this.memento.getMemento(ee.WORKSPACE,Ze.MACHINE),this._register(this.onDidChangeBodyVisibility(()=>this.updateTreeVisibility())),this._register(this.webviewViewService.onNewResolverRegistered(G=>{G.viewType===this.id&&this.updateTreeVisibility()})),this.updateTreeVisibility()}dispose(){this._onDispose.fire(),clearTimeout(this._repositionTimeout),super.dispose()}focus(){super.focus(),this._webview.value?.focus()}renderBody(e){super.renderBody(e),this._container=e,this._rootContainer=void 0,this._resizeObserver||(this._resizeObserver=new ResizeObserver(()=>{setTimeout(()=>{this.layoutWebview()},0)}),this._register(pe(()=>{this._resizeObserver?.disconnect()})),this._resizeObserver.observe(e))}saveState(){this._webview.value&&(this.viewState[Vg.webviewState]=this._webview.value.state),this.memento.saveMemento(),super.saveState()}layoutBody(e,t){super.layoutBody(e,t),this.layoutWebview(new Be(t,e))}updateTreeVisibility(){this.isBodyVisible()?(this.activate(),this._webview.value?.claim(this,He(this.element),void 0)):this._webview.value?.release(this)}activate(){if(this._activated)return;this._activated=!0;const e=this.extensionId?Aw.getOriginStore(this.storageService).getOrigin(this.id,this.extensionId):void 0,t=this.webviewService.createWebviewOverlay({origin:e,providedViewType:this.id,title:this.title,options:{purpose:ZE.WebviewView},contentOptions:{},extension:this.extensionId?{id:this.extensionId}:void 0});t.state=this.viewState[Vg.webviewState],this._webview.value=t,this._container&&this.layoutWebview(),this._webviewDisposables.add(pe(()=>{this._webview.value?.release(this)})),this._webviewDisposables.add(t.onDidUpdateState(()=>{this.viewState[Vg.webviewState]=t.state}));for(const s of[Q.DRAG,Q.DRAG_END,Q.DRAG_ENTER,Q.DRAG_LEAVE,Q.DRAG_START])this._webviewDisposables.add(X(this._webview.value.container,s,o=>{o.preventDefault(),o.stopImmediatePropagation(),this.dropTargetElement.dispatchEvent(new DragEvent(o.type,o))}));this._webviewDisposables.add(new Bx(He(this.element),()=>this._webview.value));const i=this._webviewDisposables.add(new _o);this.withProgress(async()=>{await this.extensionService.activateByEvent(`onView:${this.id}`);const s=this,o={webview:t,onDidChangeVisibility:this.onDidChangeBodyVisibility,onDispose:this.onDispose,get title(){return s.setTitle},set title(r){s.updateTitle(r)},get description(){return s.titleDescription},set description(r){s.updateTitleDescription(r)},get badge(){return s.badge},set badge(r){s.updateBadge(r)},dispose:()=>{this._activated=!1,this._webview.clear(),this._webviewDisposables.clear()},show:r=>{this.viewService.openView(this.id,!r)}};await this.webviewViewService.resolve(this.id,o,i.token)})}updateTitle(e){this.setTitle=e,super.updateTitle(typeof e=="string"?e:this.defaultTitle)}updateBadge(e){if(!(this.badge?.value===e?.value&&this.badge?.tooltip===e?.tooltip)&&(this.badge=e,e)){const t={badge:new Mp(e.value,()=>e.tooltip),priority:150};this.activity.value=this.activityService.showViewActivity(this.id,t)}}async withProgress(e){return this.progressService.withProgress({location:this.id,delay:500},e)}onDidScrollRoot(){this.layoutWebview()}doLayoutWebview(e){const t=this._webview.value;!this._container||!t||((!this._rootContainer||!this._rootContainer.isConnected)&&(this._rootContainer=this.findRootContainer(this._container)),t.layoutWebviewOverElement(this._container,e,this._rootContainer))}layoutWebview(e){this.doLayoutWebview(e),clearTimeout(this._repositionTimeout),this._repositionTimeout=setTimeout(()=>this.doLayoutWebview(e),200)}findRootContainer(e){return Xl(e,"monaco-scrollable-element")??void 0}},Aw=Aa,Aa);Tw=Aw=D([u(1,te),u(2,de),u(3,st),u(4,z),u(5,ot),u(6,tt),u(7,oi),u(8,we),u(9,At),u(10,Ir),u(11,si),u(12,Xc),u(13,ge),u(14,jt),u(15,Hn),u(16,JE)],Tw);const Pg={type:"object",properties:{id:{description:c(2576,"Unique id used to identify the container in which views can be contributed using 'views' contribution point"),type:"string",pattern:"^[a-zA-Z0-9_-]+$"},title:{description:c(2577,"Human readable string used to render the container"),type:"string"},icon:{description:c(2578,"Path to the container icon. Icons are 24x24 centered on a 50x40 block and have a fill color of 'rgb(215, 218, 224)' or '#d7dae0'. It is recommended that icons be in SVG, though any image file type is accepted."),type:"string"}},required:["id","title","icon"]},fN={description:c(2579,"Contributes views containers to the editor"),type:"object",properties:{activitybar:{description:c(2580,"Contribute views containers to Activity Bar"),type:"array",items:Pg},panel:{description:c(2581,"Contribute views containers to Panel"),type:"array",items:Pg},secondarySidebar:{description:c(2582,"Contribute views containers to Secondary Side Bar"),type:"array",items:Pg}},additionalProperties:!1};var Uo;(function(a){a.Tree="tree",a.Webview="webview"})(Uo||(Uo={}));var ha;(function(a){a.Visible="visible",a.Hidden="hidden",a.Collapsed="collapsed"})(ha||(ha={}));const kd={type:"object",required:["id","name","icon"],defaultSnippets:[{body:{id:"${1:id}",name:"${2:name}",icon:"${3:icon}"}}],properties:{type:{markdownDescription:c(2583,"Type of the view. This can either be `tree` for a tree view based view or `webview` for a webview based view. The default is `tree`."),type:"string",enum:["tree","webview"],markdownEnumDescriptions:[c(2584,"The view is backed by a `TreeView` created by `createTreeView`."),c(2585,"The view is backed by a `WebviewView` registered by `registerWebviewViewProvider`.")]},id:{markdownDescription:c(2586,"Identifier of the view. This should be unique across all views. It is recommended to include your extension id as part of the view id. Use this to register a data provider through `vscode.window.registerTreeDataProviderForView` API. Also to trigger activating your extension by registering `onView:${id}` event to `activationEvents`."),type:"string"},name:{description:c(2587,"The human-readable name of the view. Will be shown"),type:"string"},when:{description:c(2588,"Condition which must be true to show this view"),type:"string"},icon:{description:c(2589,"Path to the view icon. View icons are displayed when the name of the view cannot be shown. It is recommended that icons be in SVG, though any image file type is accepted."),type:"string"},contextualTitle:{description:c(2590,"Human-readable context for when the view is moved out of its original location. By default, the view's container name will be used."),type:"string"},visibility:{description:c(2591,"Initial state of the view when the extension is first installed. Once the user has changed the view state by collapsing, moving, or hiding the view, the initial state will not be used again."),type:"string",enum:["visible","hidden","collapsed"],default:"visible",enumDescriptions:[c(2592,"The default initial state for the view. In most containers the view will be expanded, however; some built-in containers (explorer, scm, and debug) show all contributed views collapsed regardless of the `visibility`."),c(2593,"The view will not be shown in the view container, but will be discoverable through the views menu and other view entry points and can be un-hidden by the user."),c(2594,"The view will show in the view container, but will be collapsed.")]},initialSize:{type:"number",description:c(2595,"The initial size of the view. The size will behave like the css 'flex' property, and will set the initial size when the view is first shown. In the side bar, this is the height of the view. This value is only respected when the same extension owns both the view and the view container.")},accessibilityHelpContent:{type:"string",markdownDescription:c(2596,"When the accessibility help dialog is invoked in this view, this content will be presented to the user as a markdown string. Keybindings will be resolved when provided in the format of <keybinding:commandId>. If there is no keybinding, that will be indicated and this command will be included in a quickpick for easy configuration.")}}},mN={type:"object",required:["id","name"],properties:{id:{description:c(2586,"Identifier of the view. This should be unique across all views. It is recommended to include your extension id as part of the view id. Use this to register a data provider through `vscode.window.registerTreeDataProviderForView` API. Also to trigger activating your extension by registering `onView:${id}` event to `activationEvents`."),type:"string"},name:{description:c(2587,"The human-readable name of the view. Will be shown"),type:"string"},when:{description:c(2588,"Condition which must be true to show this view"),type:"string"},group:{description:c(2597,"Nested group in the viewlet"),type:"string"},remoteName:{description:c(2598,"The name of the remote type associated with this view"),type:["string","array"],items:{type:"string"}}}},wN={description:c(2599,"Contributes views to the editor"),type:"object",properties:{explorer:{description:c(2600,"Contributes views to Explorer container in the Activity bar"),type:"array",items:kd,default:[]},debug:{description:c(2601,"Contributes views to Debug container in the Activity bar"),type:"array",items:kd,default:[]},scm:{description:c(2602,"Contributes views to SCM container in the Activity bar"),type:"array",items:kd,default:[]},test:{description:c(2603,"Contributes views to Test container in the Activity bar"),type:"array",items:kd,default:[]},remote:{description:c(2604,"Contributes views to Remote container in the Activity bar. To contribute to this container, the 'contribViewsRemote' API proposal must be enabled."),type:"array",items:mN,default:[]}},additionalProperties:{description:c(2605,"Contributes views to contributed views container"),type:"array",items:kd,default:[]}},KI=Un.registerExtensionPoint({extensionPoint:"viewsContainers",jsonSchema:fN}),bN=Un.registerExtensionPoint({extensionPoint:"views",deps:[KI],jsonSchema:wN,activationEventsGenerator:function*(a){for(const e of a)for(const t of Object.values(e))for(const i of t)i.id&&(yield`onView:${i.id}`)}}),vN=7;var Ta;let jh=(Ta=class{constructor(e,t){this.instantiationService=e,this.logService=t,this.viewContainersRegistry=se.as(qt.ViewContainersRegistry),this.viewsRegistry=se.as(qt.ViewsRegistry),this.handleAndRegisterCustomViewContainers(),this.handleAndRegisterCustomViews()}handleAndRegisterCustomViewContainers(){KI.setHandler((e,{added:t,removed:i})=>{i.length&&this.removeCustomViewContainers(i),t.length&&this.addCustomViewContainers(t,this.viewContainersRegistry.all)})}addCustomViewContainers(e,t){const i=se.as(qt.ViewContainersRegistry);let s=vN+i.all.filter(n=>!!n.extensionId&&i.getViewContainerLocation(n)===ce.Sidebar).length,o=5+i.all.filter(n=>!!n.extensionId&&i.getViewContainerLocation(n)===ce.Panel).length+1,r=100+i.all.filter(n=>!!n.extensionId&&i.getViewContainerLocation(n)===ce.AuxiliaryBar).length+1;for(const{value:n,collector:d,description:l}of e)Object.entries(n).forEach(([h,p])=>{if(this.isValidViewsContainer(p,d))switch(h){case"activitybar":s=this.registerCustomViewContainers(p,l,s,t,ce.Sidebar);break;case"panel":o=this.registerCustomViewContainers(p,l,o,t,ce.Panel);break;case"secondarySidebar":r=this.registerCustomViewContainers(p,l,r,t,ce.AuxiliaryBar);break}})}removeCustomViewContainers(e){const t=se.as(qt.ViewContainersRegistry),i=e.reduce((s,o)=>(s.add(o.description.identifier),s),new Ny);for(const s of t.all)if(s.extensionId&&i.has(s.extensionId)){const o=this.viewsRegistry.getViews(s);o.length&&this.viewsRegistry.moveViews(o,this.getDefaultViewContainer()),this.deregisterCustomViewContainer(s)}}isValidViewsContainer(e,t){if(!Array.isArray(e))return t.error(c(2606,"views containers must be an array")),!1;for(const i of e){if(typeof i.id!="string"&&Nr(i.id))return t.error(c(2607,"property `{0}` is mandatory and must be of type `string` with non-empty value. Only alphanumeric characters, '_', and '-' are allowed.","id")),!1;if(!/^[a-z0-9_-]+$/i.test(i.id))return t.error(c(2607,"property `{0}` is mandatory and must be of type `string` with non-empty value. Only alphanumeric characters, '_', and '-' are allowed.","id")),!1;if(typeof i.title!="string")return t.error(c(2608,"property `{0}` is mandatory and must be of type `string`","title")),!1;if(typeof i.icon!="string")return t.error(c(2608,"property `{0}` is mandatory and must be of type `string`","icon")),!1;if(Nr(i.title))return t.warn(c(2609,"property `{0}` is mandatory and must be of type `string` with non-empty value","title")),!0}return!0}registerCustomViewContainers(e,t,i,s,o){return e.forEach(r=>{const d=Se.fromString(r.icon)||po(t.extensionLocation,r.icon),l=`workbench.view.extension.${r.id}`,h=r.title||l,p=this.registerCustomViewContainer(l,h,d,i++,t.identifier,o);if(s.length){const g=[];for(const f of s)p!==f&&g.push(...this.viewsRegistry.getViews(f).filter(m=>m.originalContainerId===r.id));g.length&&this.viewsRegistry.moveViews(g,p)}}),i}registerCustomViewContainer(e,t,i,s,o,r){let n=this.viewContainersRegistry.get(e);return n||(n=this.viewContainersRegistry.registerViewContainer({id:e,title:{value:t,original:t},extensionId:o,ctorDescriptor:new he(tl,[e,{mergeViewWithContainerWhenSingleView:!0}]),hideIfEmpty:!0,order:s,icon:i},r)),n}deregisterCustomViewContainer(e){this.viewContainersRegistry.deregisterViewContainer(e),se.as(Us.Viewlets).deregisterPaneComposite(e.id)}handleAndRegisterCustomViews(){bN.setHandler((e,{added:t,removed:i})=>{i.length&&this.removeViews(i),t.length&&this.addViews(t)})}addViews(e){const t=new Set,i=[];for(const s of e){const{value:o,collector:r}=s;Object.entries(o).forEach(([n,d])=>{if(!this.isValidViewDescriptors(d,r))return;if(n==="remote"&&!Il(s.description,"contribViewsRemote")){r.warn(c(2610,`View container '{0}' requires 'enabledApiProposals: ["contribViewsRemote"]' to be added to 'Remote'.`,n));return}if(n==="agentSessions"&&!Il(s.description,"chatSessionsProvider")){r.warn(c(2611,`View container '{0}' requires 'enabledApiProposals: ["chatSessionsProvider"]'.`,n));return}const l=this.getViewContainer(n);l||r.warn(c(2612,"View container '{0}' does not exist and all views registered to it will be added to 'Explorer'.",n));const h=l||this.getDefaultViewContainer(),p=[];for(let g=0;g<d.length;g++){const f=d[g];if(t.has(f.id)){r.error(c(2613,"Cannot register multiple views with same id `{0}`",f.id));continue}if(this.viewsRegistry.getView(f.id)!==null){r.error(c(2614,"A view with id `{0}` is already registered.",f.id));continue}const m=QE.equals(s.description.identifier,h.extensionId)?g+1:h.viewOrderDelegate?h.viewOrderDelegate.getOrder(f.group):void 0;let v;typeof f.icon=="string"&&(v=Se.fromString(f.icon)||po(s.description.extensionLocation,f.icon));const E=this.convertInitialVisibility(f.visibility),x=this.getViewType(f.type);if(!x){r.error(c(2615,"Unknown view type `{0}`.",f.type));continue}let G;typeof f.initialSize=="number"&&(h.extensionId?.value===s.description.identifier.value?G=f.initialSize:this.logService.warn(`${s.description.identifier.value} tried to set the view size of ${f.id} but it was ignored because the view container does not belong to it.`));let W;Il(s.description,"contribAccessibilityHelpContent")&&f.accessibilityHelpContent&&(W=new Zi(f.accessibilityHelpContent));const Y={type:x,ctorDescriptor:x===Uo.Tree?new he(fw):new he(Tw),id:f.id,name:{value:f.name,original:f.name},when:I.deserialize(f.when),containerIcon:v||l?.icon,containerTitle:f.contextualTitle||l&&(typeof l.title=="string"?l.title:l.title.value),canToggleVisibility:!0,canMoveView:l?.id!==Rg,treeView:x===Uo.Tree?this.instantiationService.createInstance(vw,f.id,f.name,s.description.identifier.value):void 0,collapsed:this.showCollapsed(h)||E===ha.Collapsed,order:m,extensionId:s.description.identifier,originalContainerId:n,group:f.group,remoteAuthority:f.remoteName||f.remoteAuthority,virtualWorkspace:f.virtualWorkspace,hideByDefault:E===ha.Hidden,workspace:l?.id===Rg?!0:void 0,weight:G,accessibilityHelpContent:W};t.add(Y.id),p.push(Y)}i.push({viewContainer:h,views:p})})}this.viewsRegistry.registerViews2(i)}getViewType(e){if(e===Uo.Webview)return Uo.Webview;if(!e||e===Uo.Tree)return Uo.Tree}getDefaultViewContainer(){return this.viewContainersRegistry.get(Ud)}removeViews(e){const t=e.reduce((i,s)=>(i.add(s.description.identifier),i),new Ny);for(const i of this.viewContainersRegistry.all){const s=this.viewsRegistry.getViews(i).filter(o=>o.extensionId&&t.has(o.extensionId));if(s.length){this.viewsRegistry.deregisterViews(s,i);for(const o of s){const r=o;r.treeView&&r.treeView.dispose()}}}}convertInitialVisibility(e){if(Object.values(ha).includes(e))return e}isValidViewDescriptors(e,t){if(!Array.isArray(e))return t.error(c(2616,"views must be an array")),!1;for(const i of e){if(typeof i.id!="string")return t.error(c(2608,"property `{0}` is mandatory and must be of type `string`","id")),!1;if(typeof i.name!="string")return t.error(c(2608,"property `{0}` is mandatory and must be of type `string`","name")),!1;if(i.when&&typeof i.when!="string")return t.error(c(2617,"property `{0}` can be omitted or must be of type `string`","when")),!1;if(i.icon&&typeof i.icon!="string")return t.error(c(2617,"property `{0}` can be omitted or must be of type `string`","icon")),!1;if(i.contextualTitle&&typeof i.contextualTitle!="string")return t.error(c(2617,"property `{0}` can be omitted or must be of type `string`","contextualTitle")),!1;if(i.visibility&&!this.convertInitialVisibility(i.visibility))return t.error(c(2618,"property `{0}` can be omitted or must be one of {1}","visibility",Object.values(ha).join(", "))),!1}return!0}getViewContainer(e){switch(e){case"explorer":return this.viewContainersRegistry.get(Ud);case"debug":return this.viewContainersRegistry.get(By);case"scm":return this.viewContainersRegistry.get(Fy);case"remote":return this.viewContainersRegistry.get(Rg);default:return this.viewContainersRegistry.get(`workbench.view.extension.${e}`)}}showCollapsed(e){switch(e.id){case Ud:case Fy:case By:return!0}return!1}},Ta.ID="workbench.contrib.viewsExtensionHandler",Ta);jh=D([u(0,z),u(1,et)],jh);class yN extends M{constructor(){super(...arguments),this.type="table"}shouldRender(e){return!!e.contributes?.viewsContainers}render(e){const t=e.contributes?.viewsContainers||{},i=Object.keys(t).reduce((r,n)=>{const d=t[n];return r.push(...d.map(l=>({...l,location:n}))),r},[]);if(!i.length)return{data:{headers:[],rows:[]},dispose:()=>{}};const s=[c(2619,"ID"),c(2620,"Title"),c(2621,"Where")],o=i.sort((r,n)=>r.id.localeCompare(n.id)).map(r=>[r.id,r.title,r.location]);return{data:{headers:s,rows:o},dispose:()=>{}}}}class CN extends M{constructor(){super(...arguments),this.type="table"}shouldRender(e){return!!e.contributes?.views}render(e){const t=e.contributes?.views||{},i=Object.keys(t).reduce((r,n)=>{const d=t[n];return r.push(...d.map(l=>({...l,location:n}))),r},[]);if(!i.length)return{data:{headers:[],rows:[]},dispose:()=>{}};const s=[c(2622,"ID"),c(2623,"Name"),c(2621,"Where")],o=i.sort((r,n)=>r.id.localeCompare(n.id)).map(r=>[r.id,r.name,r.location]);return{data:{headers:s,rows:o},dispose:()=>{}}}}se.as(Ip.ExtensionFeaturesRegistry).registerExtensionFeature({id:"viewsContainers",label:c(2624,"View Containers"),access:{canToggle:!1},renderer:new he(yN)});se.as(Ip.ExtensionFeaturesRegistry).registerExtensionFeature({id:"views",label:c(2625,"Views"),access:{canToggle:!1},renderer:new he(CN)});Vt(jh.ID,jh,Pt.BlockStartup);class UI extends Ac{constructor(){super(...arguments),this.editorControl=void 0}get scopedContextKeyService(){return this.editorControl?.invokeWithinContext(e=>e.get(de))}getTitle(){return this.input?this.input.getName():c(3508,"Text Editor")}createEditorControl(e,t){this.editorControl=this._register(this.instantiationService.createInstance(e_,e,t,this.getCodeEditorWidgetOptions()))}getCodeEditorWidgetOptions(){return Object.create(null)}updateEditorControlOptions(e){this.editorControl?.updateOptions(e)}getMainControl(){return this.editorControl}getControl(){return this.editorControl}computeEditorViewState(e){if(!this.editorControl)return;const t=this.editorControl.getModel();if(!t)return;const i=t.uri;if(i&&qe(i,e))return this.editorControl.saveViewState()??void 0}setOptions(e){super.setOptions(e),e&&Tn(e,fe(this.editorControl),Nt.Smooth)}focus(){super.focus(),this.editorControl?.focus()}hasFocus(){return this.editorControl?.hasTextFocus()||super.hasFocus()}setEditorVisible(e){super.setEditorVisible(e),e?this.editorControl?.onVisible():this.editorControl?.onHide()}layout(e){this.editorControl?.layout(e)}}var kw;let xw=class extends UI{constructor(e,t,i,s,o,r,n,d,l,h){super(e,t,i,s,o,r,n,l,d,h)}async setInput(e,t,i,s){await super.setInput(e,t,i,s);const o=await e.resolve();if(s.isCancellationRequested)return;if(!(o instanceof Wx))throw new Error("Unable to open file as text");const r=fe(this.editorControl),n=o.textEditorModel;if(r.setModel(n),!Sb(t?.viewState)){const d=this.loadEditorViewState(e,i);d&&(t?.selection&&(d.cursorState=[]),r.restoreViewState(d))}t&&Tn(t,r,Nt.Immediate),r.updateOptions(this.getReadonlyConfiguration(o.isReadonly()))}revealLastLine(){const e=this.editorControl;if(!e)return;const t=e.getModel();if(t){const i=t.getLineCount();e.revealPosition({lineNumber:i,column:t.getLineMaxColumn(i)},Nt.Smooth)}}clearInput(){super.clearInput(),this.editorControl?.setModel(null)}tracksEditorViewState(e){return e instanceof Ys||e instanceof t_}};xw=D([u(2,nt),u(3,z),u(4,ge),u(5,Cs),u(6,we),u(7,U),u(8,O),u(9,Ve)],xw);var bn;let Yh=(bn=class extends xw{constructor(e,t,i,s,o,r,n,d,l,h,p){super(kw.ID,e,t,i,s,o,r,d,n,p),this.modelService=l,this.languageService=h}createEditorControl(e,t){super.createEditorControl(e,t);const i=this.editorControl;i&&this._register(i.onDidPaste(s=>this.onDidEditorPaste(s,i)))}onDidEditorPaste(e,t){if(this.input instanceof Ys&&this.input.hasLanguageSetExplicitly||e.range.startLineNumber!==1||e.range.startColumn!==1||t.getOption(li.readOnly))return;const i=t.getModel();if(!i||!(i.getLineCount()===e.range.endLineNumber&&i.getLineMaxColumn(e.range.endLineNumber)===e.range.endColumn)||i.getLanguageId()!==oh)return;let r;if(e.languageId)r={id:e.languageId,source:"event"};else{const n=this.languageService.guessLanguageIdByFilepathOrFirstLine(i.uri,i.getLineContent(1).substr(0,Gx.FIRST_LINE_DETECTION_LENGTH_LIMIT))??void 0;n&&(r={id:n,source:"guess"})}if(r&&r.id!==oh){this.input instanceof Ys&&r.source==="event"?this.input.setLanguageId(r.id):i.setLanguage(this.languageService.createById(r.id));const n=this.modelService.getCreationOptions(i.getLanguageId(),i.uri,i.isForSimpleWidget);i.detectIndentation(n.insertSpaces,n.tabSize)}}},kw=bn,bn.ID="workbench.editors.textResourceEditor",bn);Yh=kw=D([u(1,nt),u(2,z),u(3,ge),u(4,Cs),u(5,we),u(6,O),u(7,U),u(8,Ro),u(9,Es),u(10,Ve)],Yh);let wo=class extends _c{constructor(e,t,i,s,o,r){super(e,t,s,o,r),this.callbacks=i,this._onDidChangeMetadata=this._register(new A),this.onDidChangeMetadata=this._onDidChangeMetadata.event,this._onDidOpenInPlace=this._register(new A),this.onDidOpenInPlace=this._onDidOpenInPlace.event}getTitle(){return this.input?this.input.getName():c(3053,"Binary Viewer")}async getContents(e,t){const i=await e.resolve();if(!(i instanceof A_))throw new Error("Unable to open file as binary");const s=i.getSize();return this.handleMetadataChanged(typeof s=="number"?vp.formatSize(s):""),{icon:"$(warning)",label:c(3054,"The file is not displayed in the text editor because it is either binary or uses an unsupported text encoding."),actions:[{label:c(3055,"Open Anyway"),run:async()=>{await this.callbacks.openInternal(e,t),this._onDidOpenInPlace.fire()}}]}}handleMetadataChanged(e){this.metadata=e,this._onDidChangeMetadata.fire()}getMetadata(){return this.metadata}};wo=D([u(5,ge)],wo);var ka;let zr=(ka=class extends Ks{constructor(e,t,i,s,o,r,n,d,l){super(e,t,i,s,o,r,n,d,l)}getMetadata(){const e=this.getPrimaryEditorPane(),t=this.getSecondaryEditorPane();if(e instanceof wo&&t instanceof wo)return c(3052,"{0}  {1}",t.getMetadata(),e.getMetadata())}},ka.ID=Kx,ka);zr=D([u(1,nt),u(2,z),u(3,we),u(4,ge),u(5,te),u(6,Cs),u(7,O),u(8,U)],zr);const SN=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var Lw;xe(SN);class EN{constructor(e,t){this.primary=e,this.secondary=t}getEncoding(){return this.primary.getEncoding()}async setEncoding(e,t){await _p.settled([this.primary,this.secondary].map(i=>i.setEncoding(e,t)))}}class _N{constructor(e,t){this.primary=e,this.secondary=t}setLanguageId(e,t){[this.primary,this.secondary].forEach(i=>i.setLanguageId(e,t))}}function Wc(a){if(a instanceof Ys)return a;if(a instanceof Zt){const t=Wc(a.primary),i=Wc(a.secondary);return t&&i?new EN(t,i):t}const e=a;return iL(e.setEncoding,e.getEncoding)?e:null}function Xh(a){if(a instanceof Ys)return a;if(a instanceof Zt){const t=Xh(a.primary),i=Xh(a.secondary);return t&&i?new _N(t,i):t}const e=a;return typeof e.setLanguageId=="function"?e:null}class IN{constructor(){this.indentation=!1,this.selectionStatus=!1,this.languageId=!1,this.languageStatus=!1,this.encoding=!1,this.EOL=!1,this.tabFocusMode=!1,this.inputMode=!1,this.columnSelectionMode=!1,this.metadata=!1}combine(e){this.indentation=this.indentation||e.indentation,this.selectionStatus=this.selectionStatus||e.selectionStatus,this.languageId=this.languageId||e.languageId,this.languageStatus=this.languageStatus||e.languageStatus,this.encoding=this.encoding||e.encoding,this.EOL=this.EOL||e.EOL,this.tabFocusMode=this.tabFocusMode||e.tabFocusMode,this.inputMode=this.inputMode||e.inputMode,this.columnSelectionMode=this.columnSelectionMode||e.columnSelectionMode,this.metadata=this.metadata||e.metadata}hasChanges(){return this.indentation||this.selectionStatus||this.languageId||this.languageStatus||this.encoding||this.EOL||this.tabFocusMode||this.inputMode||this.columnSelectionMode||this.metadata}}class DN{get selectionStatus(){return this._selectionStatus}get languageId(){return this._languageId}get encoding(){return this._encoding}get EOL(){return this._EOL}get indentation(){return this._indentation}get tabFocusMode(){return this._tabFocusMode}get inputMode(){return this._inputMode}get columnSelectionMode(){return this._columnSelectionMode}get metadata(){return this._metadata}update(e){const t=new IN;switch(e.type){case"selectionStatus":this._selectionStatus!==e.selectionStatus&&(this._selectionStatus=e.selectionStatus,t.selectionStatus=!0);break;case"indentation":this._indentation!==e.indentation&&(this._indentation=e.indentation,t.indentation=!0);break;case"languageId":this._languageId!==e.languageId&&(this._languageId=e.languageId,t.languageId=!0);break;case"encoding":this._encoding!==e.encoding&&(this._encoding=e.encoding,t.encoding=!0);break;case"EOL":this._EOL!==e.EOL&&(this._EOL=e.EOL,t.EOL=!0);break;case"tabFocusMode":this._tabFocusMode!==e.tabFocusMode&&(this._tabFocusMode=e.tabFocusMode,t.tabFocusMode=!0);break;case"inputMode":this._inputMode!==e.inputMode&&(this._inputMode=e.inputMode,t.inputMode=!0);break;case"columnSelectionMode":this._columnSelectionMode!==e.columnSelectionMode&&(this._columnSelectionMode=e.columnSelectionMode,t.columnSelectionMode=!0);break;case"metadata":this._metadata!==e.metadata&&(this._metadata=e.metadata,t.metadata=!0);break}return t}}let Rw=class extends M{constructor(e){super(),this.configurationService=e,this._onDidChange=this._register(new A),this.onDidChange=this._onDidChange.event,this.registerListeners();const t=e.getValue("editor.tabFocusMode")===!0;mg.setTabFocusMode(t)}registerListeners(){this._register(mg.onDidChangeTabFocus(e=>this._onDidChange.fire(e))),this._register(this.configurationService.onDidChangeConfiguration(e=>{if(e.affectsConfiguration("editor.tabFocusMode")){const t=this.configurationService.getValue("editor.tabFocusMode")===!0;mg.setTabFocusMode(t),this._onDidChange.fire(t)}}))}};Rw=D([u(0,te)],Rw);class AN extends M{constructor(){super(),this._onDidChange=this._register(new A),this.onDidChange=this._onDidChange.event,Uy.setInputMode("insert"),this._register(Uy.onDidChangeInputMode(e=>this._onDidChange.fire(e)))}}const TN=c(3444,"Ln {0}, Col {1} ({2} selected)"),kN=c(3445,"Ln {0}, Col {1}"),xN=c(3446,"{0} selections ({1} characters selected)"),LN=c(3447,"{0} selections"),HI=c(3448,"LF"),zI=c(3449,"CRLF");let Vw=class extends M{constructor(e,t,i,s,o,r,n,d){super(),this.targetWindowId=e,this.editorService=t,this.quickInputService=i,this.languageService=s,this.textFileService=o,this.statusbarService=r,this.configurationService=d,this.tabFocusModeElement=this._register(new Ae),this.inputModeElement=this._register(new Ae),this.columnSelectionModeElement=this._register(new Ae),this.indentationElement=this._register(new Ae),this.selectionElement=this._register(new Ae),this.encodingElement=this._register(new Ae),this.eolElement=this._register(new Ae),this.languageElement=this._register(new Ae),this.metadataElement=this._register(new Ae),this.state=new DN,this.toRender=void 0,this.activeEditorListeners=this._register(new B),this.delayedRender=this._register(new Ae),this.currentMarkerStatus=this._register(n.createInstance(Pw)),this.tabFocusMode=this._register(n.createInstance(Rw)),this.inputMode=this._register(n.createInstance(AN)),this.registerCommands(),this.registerListeners()}registerListeners(){this._register(this.editorService.onDidActiveEditorChange(()=>this.updateStatusBar())),this._register(this.textFileService.untitled.onDidChangeEncoding(e=>this.onResourceEncodingChange(e.resource))),this._register(this.textFileService.files.onDidChangeEncoding(e=>this.onResourceEncodingChange(e.resource))),this._register(K.runAndSubscribe(this.tabFocusMode.onDidChange,e=>{e!==void 0?this.onTabFocusModeChange(e):this.onTabFocusModeChange(this.configurationService.getValue("editor.tabFocusMode"))})),this._register(K.runAndSubscribe(this.inputMode.onDidChange,e=>this.onInputModeChange(e??"insert")))}registerCommands(){this._register(re.registerCommand({id:`changeEditorIndentation${this.targetWindowId}`,handler:()=>this.showIndentationPicker()}))}async showIndentationPicker(){const e=gs(this.editorService.activeTextEditorControl);if(!e)return this.quickInputService.pick([{label:c(3450,"No text editor active at this time")}]);if(this.editorService.activeEditor?.isReadonly())return this.quickInputService.pick([{label:c(3451,"The active code editor is read-only.")}]);const t=[fe(e.getAction(qx.ID)),fe(e.getAction(jx.ID)),fe(e.getAction(Yx.ID)),fe(e.getAction(Xx.ID)),fe(e.getAction(Jx.ID)),fe(e.getAction(Zx.ID)),fe(e.getAction(Qx.ID))].map(s=>({id:s.id,label:s.label,detail:i_.isDefaultVariant()||s.label===s.alias?void 0:s.alias,run:()=>{e.focus(),s.run()}}));return t.splice(3,0,{type:"separator",label:c(3452,"convert file")}),t.unshift({type:"separator",label:c(3453,"change view")}),(await this.quickInputService.pick(t,{placeHolder:c(3454,"Select Action"),matchOnDetail:!0}))?.run()}updateTabFocusModeElement(e){if(e){if(!this.tabFocusModeElement.value){const t=c(3455,"Tab Moves Focus");this.tabFocusModeElement.value=this.statusbarService.addEntry({name:c(3456,"Accessibility Mode"),text:t,ariaLabel:t,tooltip:c(3457,"Disable Accessibility Mode"),command:"editor.action.toggleTabFocusMode",kind:"prominent"},"status.editor.tabFocusMode",_t.RIGHT,100.7)}}else this.tabFocusModeElement.clear()}updateInputModeElement(e){if(e==="overtype"){if(!this.inputModeElement.value){const t=c(3458,"OVR"),i=c(3459,"Enable Insert Mode");this.inputModeElement.value=this.statusbarService.addEntry({name:i,text:t,ariaLabel:t,tooltip:i,command:"editor.action.toggleOvertypeInsertMode",kind:"prominent"},"status.editor.inputMode",_t.RIGHT,100.6)}}else this.inputModeElement.clear()}updateColumnSelectionModeElement(e){if(e){if(!this.columnSelectionModeElement.value){const t=c(3460,"Column Selection");this.columnSelectionModeElement.value=this.statusbarService.addEntry({name:c(3461,"Column Selection Mode"),text:t,ariaLabel:t,tooltip:c(3462,"Disable Column Selection Mode"),command:"editor.action.toggleColumnSelection",kind:"prominent"},"status.editor.columnSelectionMode",_t.RIGHT,100.8)}}else this.columnSelectionModeElement.clear()}updateSelectionElement(e){if(!e){this.selectionElement.clear();return}if(gs(this.editorService.activeTextEditorControl)?.getModel()?.uri?.scheme===ue.vscodeNotebookCell){this.selectionElement.clear();return}const i={name:c(3463,"Editor Selection"),text:e,ariaLabel:e,tooltip:c(3464,"Go to Line/Column"),command:"workbench.action.gotoLine"};this.updateElement(this.selectionElement,i,"status.editor.selection",_t.RIGHT,100.5)}updateIndentationElement(e){if(!e){this.indentationElement.clear();return}if(gs(this.editorService.activeTextEditorControl)?.getModel()?.uri?.scheme===ue.vscodeNotebookCell){this.indentationElement.clear();return}const i={name:c(3465,"Editor Indentation"),text:e,ariaLabel:e,tooltip:c(3466,"Select Indentation"),command:`changeEditorIndentation${this.targetWindowId}`};this.updateElement(this.indentationElement,i,"status.editor.indentation",_t.RIGHT,100.4)}updateEncodingElement(e){if(!e){this.encodingElement.clear();return}const t={name:c(3467,"Editor Encoding"),text:e,ariaLabel:e,tooltip:c(3468,"Select Encoding"),command:"workbench.action.editor.changeEncoding"};this.updateElement(this.encodingElement,t,"status.editor.encoding",_t.RIGHT,100.3)}updateEOLElement(e){if(!e){this.eolElement.clear();return}const t={name:c(3469,"Editor End of Line"),text:e,ariaLabel:e,tooltip:c(3470,"Select End of Line Sequence"),command:"workbench.action.editor.changeEOL"};this.updateElement(this.eolElement,t,"status.editor.eol",_t.RIGHT,100.2)}updateLanguageIdElement(e){if(!e){this.languageElement.clear();return}const t={name:c(3471,"Editor Language"),text:e,ariaLabel:e,tooltip:c(3472,"Select Language Mode"),command:"workbench.action.editor.changeLanguageMode"};this.updateElement(this.languageElement,t,"status.editor.mode",_t.RIGHT,100.1)}updateMetadataElement(e){if(!e){this.metadataElement.clear();return}const t={name:c(3473,"File Information"),text:e,ariaLabel:e,tooltip:c(3474,"File Information")};this.updateElement(this.metadataElement,t,"status.editor.info",_t.RIGHT,100)}updateElement(e,t,i,s,o){e.value?e.value.update(t):e.value=this.statusbarService.addEntry(t,i,s,o)}updateState(e){const t=this.state.update(e);t.hasChanges()&&(this.toRender?this.toRender.combine(t):(this.toRender=t,this.delayedRender.value=eL($c(this.targetWindowId,!0).window,()=>{this.delayedRender.clear();const i=this.toRender;this.toRender=void 0,i&&this.doRenderNow()})))}doRenderNow(){this.updateTabFocusModeElement(!!this.state.tabFocusMode),this.updateInputModeElement(this.state.inputMode),this.updateColumnSelectionModeElement(!!this.state.columnSelectionMode),this.updateIndentationElement(this.state.indentation),this.updateSelectionElement(this.state.selectionStatus),this.updateEncodingElement(this.state.encoding),this.updateEOLElement(this.state.EOL?this.state.EOL===`\r
`?zI:HI:void 0),this.updateLanguageIdElement(this.state.languageId),this.updateMetadataElement(this.state.metadata)}getSelectionLabel(e){if(e?.selections){if(e.selections.length===1)return e.charactersSelected?xd(TN,e.selections[0].positionLineNumber,e.selections[0].positionColumn,e.charactersSelected):xd(kN,e.selections[0].positionLineNumber,e.selections[0].positionColumn);if(e.charactersSelected)return xd(xN,e.selections.length,e.charactersSelected);if(e.selections.length>0)return xd(LN,e.selections.length)}}updateStatusBar(){const e=this.editorService.activeEditor,t=this.editorService.activeEditorPane,i=t?gs(t.getControl())??void 0:void 0;if(this.onColumnSelectionModeChange(i),this.onSelectionChange(i),this.onLanguageChange(i,e),this.onEOLChange(i),this.onEncodingChange(t,i),this.onIndentationChange(i),this.onMetadataChange(t),this.currentMarkerStatus.update(i),this.activeEditorListeners.clear(),t&&this.activeEditorListeners.add(t.onDidChangeControl(()=>{this.updateStatusBar()})),i)this.activeEditorListeners.add(i.onDidChangeConfiguration(s=>{s.hasChanged(li.columnSelection)&&this.onColumnSelectionModeChange(i)})),this.activeEditorListeners.add(K.defer(i.onDidChangeCursorPosition)(()=>{this.onSelectionChange(i),this.currentMarkerStatus.update(i)})),this.activeEditorListeners.add(i.onDidChangeModelLanguage(()=>{this.onLanguageChange(i,e)})),this.activeEditorListeners.add(K.accumulate(i.onDidChangeModelContent)(s=>{this.onEOLChange(i),this.currentMarkerStatus.update(i);const o=i.getSelections();if(o){for(const r of s)for(const n of r.changes)if(o.some(d=>ze.areIntersecting(d,n.range))){this.onSelectionChange(i);break}}})),this.activeEditorListeners.add(i.onDidChangeModelOptions(()=>{this.onIndentationChange(i)}));else if(t instanceof wo||t instanceof zr){const s=[];if(t instanceof zr){const o=t.getPrimaryEditorPane();o instanceof wo&&s.push(o);const r=t.getSecondaryEditorPane();r instanceof wo&&s.push(r)}else s.push(t);for(const o of s)this.activeEditorListeners.add(o.onDidChangeMetadata(()=>{this.onMetadataChange(t)})),this.activeEditorListeners.add(o.onDidOpenInPlace(()=>{this.updateStatusBar()}))}}onLanguageChange(e,t){const i={type:"languageId",languageId:void 0};if(e&&t&&Xh(t)){const s=e.getModel();if(s){const o=s.getLanguageId();i.languageId=this.languageService.getLanguageName(o)??void 0}}this.updateState(i)}onIndentationChange(e){const t={type:"indentation",indentation:void 0};if(e){const i=e.getModel();if(i){const s=i.getOptions();t.indentation=s.insertSpaces?s.tabSize===s.indentSize?c(3475,"Spaces: {0}",s.indentSize):c(3476,"Spaces: {0} (Tab Size: {1})",s.indentSize,s.tabSize):c(3477,"Tab Size: {0}",s.tabSize)}}this.updateState(t)}onMetadataChange(e){const t={type:"metadata",metadata:void 0};(e instanceof wo||e instanceof zr)&&(t.metadata=e.getMetadata()),this.updateState(t)}onColumnSelectionModeChange(e){const t={type:"columnSelectionMode",columnSelectionMode:!1};e?.getOption(li.columnSelection)&&(t.columnSelectionMode=!0),this.updateState(t)}onSelectionChange(e){const t=Object.create(null);if(e){t.selections=e.getSelections()||[],t.charactersSelected=0;const i=e.getModel();if(i)for(const s of t.selections)typeof t.charactersSelected!="number"&&(t.charactersSelected=0),t.charactersSelected+=i.getCharacterCountInRange(s);if(t.selections.length===1){const s=e.getPosition(),o=new s_(t.selections[0].selectionStartLineNumber,t.selections[0].selectionStartColumn,t.selections[0].positionLineNumber,s?e.getStatusbarColumn(s):t.selections[0].positionColumn);t.selections[0]=o}}this.updateState({type:"selectionStatus",selectionStatus:this.getSelectionLabel(t)})}onEOLChange(e){const t={type:"EOL",EOL:void 0};if(e&&!e.getOption(li.readOnly)){const i=e.getModel();i&&(t.EOL=i.getEOL())}this.updateState(t)}onEncodingChange(e,t){if(e&&!this.isActiveEditor(e))return;const i={type:"encoding",encoding:void 0};if(e&&t?.hasModel()){const s=e.input?Wc(e.input):null;if(s){const o=s.getEncoding(),r=typeof o=="string"?no[o]:void 0;r?i.encoding=r.labelShort:i.encoding=o}}this.updateState(i)}onResourceEncodingChange(e){const t=this.editorService.activeEditorPane;if(t){const i=Ue.getCanonicalUri(t.input,{supportSideBySide:Le.PRIMARY});if(i&&qe(i,e)){const s=gs(t.getControl())??void 0;return this.onEncodingChange(t,s)}}}onTabFocusModeChange(e){const t={type:"tabFocusMode",tabFocusMode:e};this.updateState(t)}onInputModeChange(e){const t={type:"inputMode",inputMode:e};this.updateState(t)}isActiveEditor(e){const t=this.editorService.activeEditorPane;return!!t&&t===e}};Vw=D([u(1,O),u(2,lt),u(3,Es),u(4,zn),u(5,Ss),u(6,z),u(7,te)],Vw);var xa;let Jh=(xa=class extends M{constructor(e){super(),this.editorGroupService=e;for(const t of e.parts)this.createEditorStatus(t);this._register(e.onDidCreateAuxiliaryEditorPart(t=>this.createEditorStatus(t)))}createEditorStatus(e){const t=new B;K.once(e.onWillDispose)(()=>t.dispose());const i=this.editorGroupService.getScopedInstantiationService(e);t.add(i.createInstance(Vw,e.windowId))}},xa.ID="workbench.contrib.editorStatus",xa);Jh=D([u(0,U)],Jh);let Pw=class extends M{constructor(e,t,i){super(),this.statusbarService=e,this.markerService=t,this.configurationService=i,this.editor=void 0,this.markers=[],this.currentMarker=null,this.statusBarEntryAccessor=this._register(new Ae),this._register(t.onMarkerChanged(s=>this.onMarkerChanged(s))),this._register(K.filter(i.onDidChangeConfiguration,s=>s.affectsConfiguration("problems.showCurrentInStatus"))(()=>this.updateStatus()))}update(e){this.editor=e,this.updateMarkers(),this.updateStatus()}updateStatus(){const e=this.currentMarker;if(this.currentMarker=this.getMarker(),this.hasToUpdateStatus(e,this.currentMarker))if(this.currentMarker){const t=tL(this.currentMarker.message)[0],i=`${this.getType(this.currentMarker)} ${t}`;this.statusBarEntryAccessor.value?this.statusBarEntryAccessor.value.update({name:c(3478,"Current Problem"),text:i,ariaLabel:i}):this.statusBarEntryAccessor.value=this.statusbarService.addEntry({name:c(3478,"Current Problem"),text:i,ariaLabel:i},"statusbar.currentProblem",_t.LEFT)}else this.statusBarEntryAccessor.clear()}hasToUpdateStatus(e,t){return!t||!e?!0:Ky.makeKey(e)!==Ky.makeKey(t)}getType(e){switch(e.severity){case kr.Error:return"$(error)";case kr.Warning:return"$(warning)";case kr.Info:return"$(info)"}return""}getMarker(){if(!this.configurationService.getValue("problems.showCurrentInStatus")||!this.editor||!this.editor.getModel())return null;const t=this.editor.getPosition();return t&&this.markers.find(i=>ze.containsPosition(i,t))||null}onMarkerChanged(e){if(!this.editor)return;const t=this.editor.getModel();t&&(t&&!e.some(i=>qe(t.uri,i))||this.updateMarkers())}updateMarkers(){if(!this.editor)return;const e=this.editor.getModel();e&&(e?(this.markers=this.markerService.read({resource:e.uri,severities:kr.Error|kr.Warning|kr.Info}),this.markers.sort(this.compareMarker)):this.markers=[],this.updateStatus())}compareMarker(e,t){let i=Vp(e.resource.toString(),t.resource.toString());return i===0&&(i=kr.compare(e.severity,t.severity)),i===0&&(i=ze.compareRangesUsingStarts(e,t)),i}};Pw=D([u(0,Ss),u(1,Ux),u(2,te)],Pw);var vn;let Ow=(vn=class extends Je{constructor(e,t,i){super(Lw.ID,c(3479,"Search Marketplace Extensions for '{0}'...",e)),this.fileExtension=e,this.commandService=t,this.enabled=i.isEnabled()}async run(){await this.commandService.executeCommand("workbench.extensions.action.showExtensionsForLanguage",this.fileExtension)}},Lw=vn,vn.ID="workbench.action.showLanguageExtensions",vn);Ow=Lw=D([u(1,ke),u(2,Hx)],Ow);const ac=class ac extends R{constructor(){super({id:ac.ID,title:y(3480,"Change Language Mode"),f1:!0,keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,w.KeyM)},precondition:I.not("notebookEditorFocused"),metadata:{description:c(3481,"Change the language mode of the active text editor."),args:[{name:c(3482,"The name of the language mode to change to."),constraint:e=>typeof e=="string"}]}})}async run(e,t){const i=e.get(lt),s=e.get(O),o=e.get(Es),r=e.get(zx),n=e.get(zn),d=e.get(ld),l=e.get(z),h=e.get(te),p=e.get(nt),g=gs(s.activeTextEditorControl);if(!g){await i.pick([{label:c(3450,"No text editor active at this time")}]);return}const f=g.getModel(),m=Ue.getOriginalUri(s.activeEditor,{supportSideBySide:Le.PRIMARY});let v,E;f&&(E=f.getLanguageId(),v=o.getLanguageName(E)??void 0);let x=!!m;m?.scheme===ue.untitled&&!n.untitled.get(m)?.hasAssociatedFilePath&&(x=!1);const W=o.getSortedRegisteredLanguageNames().map(({languageName:$e,languageId:vt})=>{const Ci=o.getExtensions(vt).join(" ");let Et;return v===$e?Et=c(3483,"({0}) - Configured Language",vt):Et=c(3484,"({0})",vt),{label:$e,meta:Ci,iconClasses:Gy(vt),description:Et}});W.unshift({type:"separator",label:c(3485,"languages (identifier)")});let Y,$,H;if(x&&m){const $e=Yi(m)||Dt(m);H=l.createInstance(Ow,$e),H.enabled&&W.unshift(H),$={label:c(3486,"Configure '{0}' language based settings...",v)},W.unshift($),Y={label:c(3487,"Configure File Association for '{0}'...",$e)},W.unshift(Y)}const ie={label:c(3488,"Auto Detect")};f&&f.getValueLength()>0&&W.unshift(ie);const q=typeof t=="string"?{label:t}:await i.pick(W,{placeHolder:c(3489,"Select Language Mode"),matchOnDescription:!0});if(!q)return;if(q===H){H.run();return}if(q===Y){m&&this.configureFileAssociation(m,o,i,h);return}if(q===$){d.openUserSettings({jsonEditor:!0,revealSetting:{key:`[${E??null}]`,edit:!0}});return}const ae=s.activeEditor;if(ae){const $e=Xh(ae);if($e){let vt,Ci;if(q===ie){if(f){const Et=Ue.getOriginalUri(ae,{supportSideBySide:Le.PRIMARY});if(Et){let Gi=o.guessLanguageIdByFilepathOrFirstLine(Et,f.getLineContent(1))??void 0;(!Gi||Gi==="unknown")&&(Ci=await r.detectLanguage(Et),Gi=Ci),Gi&&(vt=o.createById(Gi))}}}else{const Et=o.getLanguageIdByLanguageName(q.label);vt=o.createById(Et),m&&r.detectLanguage(m).then(Gi=>{const Ft=o.getLanguageIdByLanguageName(q.label)||"unknown";if(Gi===E&&E!==Ft){const rD=h.getValue("workbench.editor.preferHistoryBasedLanguageDetection")?"history":"classic";p.publicLog2($x,{currentLanguageId:v??"unknown",nextLanguageId:q.label,lineCount:f?.getLineCount()??-1,modelPreference:rD})}})}if(typeof vt<"u"&&($e.setLanguageId(vt.languageId,ac.ID),m?.scheme===ue.untitled)){const Et=h.getValue("workbench.editor.preferHistoryBasedLanguageDetection")?"history":"classic";p.publicLog2("setUntitledDocumentLanguage",{to:vt.languageId,from:E??"none",modelPreference:Et})}}g.focus()}}configureFileAssociation(e,t,i,s){const o=Yi(e),r=Dt(e),n=t.guessLanguageIdByFilepathOrFirstLine(F.file(r)),l=t.getSortedRegisteredLanguageNames().map(({languageName:h,languageId:p})=>({id:p,label:h,iconClasses:Gy(p),description:p===n?c(3490,"Current Association"):void 0}));setTimeout(async()=>{const h=await i.pick(l,{placeHolder:c(3491,"Select Language Mode to Associate with '{0}'",o||r)});if(h){const p=s.inspect(Wy);let g;o&&r[0]!=="."?g=`*${o}`:g=r;let f=Ot.USER;p.workspaceValue?.[g]&&(f=Ot.WORKSPACE);const m=Cb(f===Ot.WORKSPACE?p.workspaceValue:p.userValue)||Object.create(null);m[g]=h.id,s.updateValue(Wy,m,f)}},50)}};ac.ID="workbench.action.editor.changeLanguageMode";let Mw=ac;class RN extends R{constructor(){super({id:"workbench.action.editor.changeEOL",title:y(3492,"Change End of Line Sequence"),f1:!0})}async run(e){const t=e.get(O),i=e.get(lt),s=gs(t.activeTextEditorControl);if(!s){await i.pick([{label:c(3450,"No text editor active at this time")}]);return}if(t.activeEditor?.isReadonly()){await i.pick([{label:c(3451,"The active code editor is read-only.")}]);return}let o=s.getModel();const r=[{label:HI,eol:Hy.LF},{label:zI,eol:Hy.CRLF}],n=o?.getEOL()===`
`?0:1,d=await i.pick(r,{placeHolder:c(3493,"Select End of Line Sequence"),activeItem:r[n]});if(d){const l=gs(t.activeTextEditorControl);l?.hasModel()&&!t.activeEditor?.isReadonly()&&(o=l.getModel(),o.pushStackElement(),o.pushEOL(d.eol),o.pushStackElement())}s.focus()}}class VN extends R{constructor(){super({id:"workbench.action.editor.changeEncoding",title:y(3494,"Change File Encoding"),f1:!0})}async run(e){const t=e.get(O),i=e.get(lt),s=e.get(Ve),o=e.get(zn),r=e.get(Cs),n=e.get(Bi),d=gs(t.activeTextEditorControl);if(!d){await i.pick([{label:c(3450,"No text editor active at this time")}]);return}const l=t.activeEditorPane;if(!l){await i.pick([{label:c(3450,"No text editor active at this time")}]);return}const h=Wc(l.input);if(!h){await i.pick([{label:c(3495,"No file active at this time")}]);return}const p={label:c(3496,"Save with Encoding")},g={label:c(3497,"Reopen with Encoding")};if(!i_.isDefaultVariant()){const q="Save with Encoding";q!==p.label&&(p.detail=q);const ae="Reopen with Encoding";ae!==g.label&&(g.detail=ae)}let f;if(h instanceof Ys?f=p:l.input.isReadonly()?f=g:f=await i.pick([g,p],{placeHolder:c(3454,"Select Action"),matchOnDetail:!0}),!f)return;await fr(50);const m=Ue.getOriginalUri(l.input,{supportSideBySide:Le.PRIMARY});if(!m||!s.hasProvider(m)&&m.scheme!==ue.untitled)return;let v;s.hasProvider(m)&&(v=(await o.readStream(m,{autoGuessEncoding:!0,candidateGuessEncodings:r.getValue(m,"files.candidateGuessEncodings")})).encoding);const E=f===g,x=r.getValue(m,"files.encoding");let G,W;const Y=Object.keys(no).sort((q,ae)=>q===x?-1:ae===x?1:no[q].order-no[ae].order).filter(q=>q===v&&v!==x?!1:!E||!no[q].encodeOnly).map((q,ae)=>(q===h.getEncoding()?G=ae:no[q].alias===h.getEncoding()&&(W=ae),{id:q,label:no[q].labelLong,description:q})),$=Y.slice();v&&x!==v&&no[v]&&(Y.unshift({type:"separator"}),Y.unshift({id:v,label:no[v].labelLong,description:c(3498,"Guessed from content")}));const H=await i.pick(Y,{placeHolder:E?c(3499,"Select File Encoding to Reopen File"):c(3500,"Select File Encoding to Save with"),activeItem:$[typeof G=="number"?G:typeof W=="number"?W:-1]});if(!H||!t.activeEditorPane)return;const ie=Wc(t.activeEditorPane.input);if(typeof H.id<"u"&&ie){if(E&&t.activeEditorPane.input.isDirty()){const{confirmed:q}=await n.confirm({message:c(3501,"Do you want to revert the active text editor and reopen with a different encoding?"),detail:c(3502,"This will discard any unsaved changes."),primaryButton:c(3503,"Discard Changes and Reopen")});if(!q)return;await t.activeEditorPane.input.revert(t.activeEditorPane.group.id)}await ie.setEncoding(H.id,E?zy.Decode:zy.Encode)}d.focus()}}let Nw=class{constructor(e,t,i){this.filesConfigurationService=e,this.environmentService=t,this.pathService=i}canSerialize(e){return this.filesConfigurationService.isHotExitEnabled&&!e.isDisposed()}serialize(e){if(!this.canSerialize(e))return;const t=e;let i=t.resource;t.hasAssociatedFilePath&&(i=o_(i,this.environmentService.remoteAuthority,this.pathService.defaultUriScheme));let s;const o=t.getLanguageId();(o!==oh||t.hasLanguageSetExplicitly)&&(s=o);const r={resourceJSON:i.toJSON(),modeId:s,encoding:t.getEncoding()};return JSON.stringify(r)}deserialize(e,t){return e.invokeFunction(i=>{const s=JSON.parse(t),o=F.revive(s.resourceJSON),r=s.modeId,n=s.encoding;return i.get(il).createTextEditor({resource:o,languageId:r,encoding:n,forceUntitled:!0})})}};Nw=D([u(0,ud),u(1,wi),u(2,Gn)],Nw);var La;let Zh=(La=class extends M{constructor(e,t,i,s,o){super(),this.environmentService=t,this.pathService=i,this.textEditorService=s,this.untitledTextEditorService=o,this._register(e.registerHandler(this))}handles(e){return e.resource.scheme===ue.untitled&&e.typeId===of}isOpen(e,t){return this.handles(e)?t instanceof Ys&&qe(e.resource,t.resource):!1}createEditor(e){let t;return this.untitledTextEditorService.isUntitledWithAssociatedResource(e.resource)?t=o_(e.resource,this.environmentService.remoteAuthority,this.pathService.defaultUriScheme):t=e.resource,this.textEditorService.createTextEditor({resource:t,forceUntitled:!0})}},La.ID="workbench.contrib.untitledTextEditorWorkingCopyEditorHandler",La);Zh=D([u(0,Np),u(1,wi),u(2,Gn),u(3,il),u(4,_b)],Zh);var ra,Os;let Qh=(Os=class extends M{constructor(e,t,i){super(),this.editorResolverService=e,this.environmentService=i,this.configurationRegistry=se.as(Lo.Configuration),(async()=>(await t.whenInstalledExtensionsRegistered(),this.updateDynamicEditorConfigurations(),this.registerListeners()))()}registerListeners(){this._register(K.debounce(this.editorResolverService.onDidChangeEditorRegistrations,(e,t)=>t)(()=>this.updateDynamicEditorConfigurations()))}updateDynamicEditorConfigurations(){const e=[...this.editorResolverService.getEditors(),...ra.AUTO_LOCK_EXTRA_EDITORS].filter(l=>!ra.AUTO_LOCK_REMOVE_EDITORS.has(l.id)),t=this.editorResolverService.getEditors().filter(l=>l.priority!==rt.exclusive).map(l=>l.id),i=Object.create(null);for(const l of e)i[l.id]={type:"boolean",default:ra.AUTO_LOCK_DEFAULT_ENABLED.has(l.id),description:l.label};const s=Object.create(null);for(const l of e)s[l.id]=ra.AUTO_LOCK_DEFAULT_ENABLED.has(l.id);const o=this.autoLockConfigurationNode;this.autoLockConfigurationNode={...Ld,properties:{"workbench.editor.autoLockGroups":{type:"object",description:c(3402,"If an editor matching one of the listed types is opened as the first in an editor group and more than one group is open, the group is automatically locked. Locked groups will only be used for opening editors when explicitly chosen by a user gesture (for example drag and drop), but not by default. Consequently, the active editor in a locked group is less likely to be replaced accidentally with a different editor."),properties:i,default:s,additionalProperties:!1}}};const r=this.defaultBinaryEditorConfigurationNode;this.defaultBinaryEditorConfigurationNode={...Ld,properties:{"workbench.editor.defaultBinaryEditor":{type:"string",default:"",enum:[...t,""],description:c(3403,"The default editor for files detected as binary. If undefined, the user will be presented with a picker.")}}};const n=this.editorAssociationsConfigurationNode;this.editorAssociationsConfigurationNode={...Ld,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:c(3404,'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),patternProperties:{".*":{type:"string",enum:t}}}}};const d=this.editorLargeFileConfirmationConfigurationNode;this.editorLargeFileConfirmationConfigurationNode={...Ld,properties:{"workbench.editorLargeFileConfirmation":{type:"number",default:sL(this.environmentService.remoteAuthority)/vp.MB,minimum:1,scope:Me.RESOURCE,markdownDescription:c(3405,"Controls the minimum size of a file in MB before asking for confirmation when opening in the editor. Note that this setting may not apply to all editor types and environments.")}}},this.configurationRegistry.updateConfigurations({add:[this.autoLockConfigurationNode,this.defaultBinaryEditorConfigurationNode,this.editorAssociationsConfigurationNode,this.editorLargeFileConfirmationConfigurationNode],remove:Mi([o,r,n,d])})}},ra=Os,Os.ID="workbench.contrib.dynamicEditorConfigurations",Os.AUTO_LOCK_DEFAULT_ENABLED=new Set(["terminalEditor","mainThreadWebview-simpleBrowser.view","mainThreadWebview-browserPreview","workbench.editor.processExplorer"]),Os.AUTO_LOCK_EXTRA_EDITORS=[{id:"workbench.input.interactive",label:c(3398,"Interactive Window"),priority:rt.builtin},{id:"mainThreadWebview-markdown.preview",label:c(3399,"Markdown Preview"),priority:rt.builtin},{id:"mainThreadWebview-simpleBrowser.view",label:c(3400,"Simple Browser"),priority:rt.builtin},{id:"mainThreadWebview-browserPreview",label:c(3401,"Live Preview"),priority:rt.builtin}],Os.AUTO_LOCK_REMOVE_EDITORS=new Set(["vscode-interactive-input","interactive","vscode.markdown.preview.editor"]),Os);Qh=ra=D([u(0,Qs),u(1,si),u(2,wi)],Qh);se.as(Lt.EditorPane).registerEditorPane(Oi.create(Yh,Yh.ID,c(3117,"Text Editor")),[new he(Ys),new he(t_)]);se.as(Lt.EditorPane).registerEditorPane(Oi.create(Qo,Qo.ID,c(3118,"Text Diff Editor")),[new he(Jt)]);se.as(Lt.EditorPane).registerEditorPane(Oi.create(zr,zr.ID,c(3119,"Binary Diff Editor")),[new he(Jt)]);se.as(Lt.EditorPane).registerEditorPane(Oi.create(Ks,Ks.ID,c(3120,"Side by Side Editor")),[new he(Zt)]);se.as(Lt.EditorFactory).registerEditorSerializer(Ys.ID,Nw);se.as(Lt.EditorFactory).registerEditorSerializer(Zt.ID,oL);se.as(Lt.EditorFactory).registerEditorSerializer(Jt.ID,rL);Vt(Jh.ID,Jh,Pt.BlockRestore);Vt(Zh.ID,Zh,Pt.BlockRestore);Vt(Qh.ID,Qh,Pt.BlockRestore);const Tv=se.as(nL.Quickaccess),Qp="inEditorsPicker",$I=I.and(aL,I.has(Qp));Tv.registerQuickAccessProvider({ctor:vr,prefix:vr.PREFIX,contextKey:Qp,placeholder:c(3121,"Type the name of an editor to open it."),helpEntries:[{description:c(3122,"Show Editors in Active Group by Most Recently Used"),commandId:yh.ID}]});Tv.registerQuickAccessProvider({ctor:Dc,prefix:Dc.PREFIX,contextKey:Qp,placeholder:c(3121,"Type the name of an editor to open it."),helpEntries:[{description:c(3123,"Show All Opened Editors By Appearance"),commandId:Ch.ID}]});Tv.registerQuickAccessProvider({ctor:On,prefix:On.PREFIX,contextKey:Qp,placeholder:c(3121,"Type the name of an editor to open it."),helpEntries:[{description:c(3124,"Show All Opened Editors By Most Recently Used"),commandId:Sh.ID}]});S(Mw);S(RN);S(VN);S(kc);S(xc);S(NP);S(FP);S(BP);S(GP);S(WP);S(KP);S(iO);S(sO);S(oO);S(rO);S(bh);S(vh);S(Ch);S(Sh);S(yh);S(Uf);S(yP);S(vP);S(CP);S(SP);S(bP);S(Gf);S(sP);S(oP);S(rP);S(Wf);S(Kf);S(nP);S(aP);S(dP);S(VP);S(PP);S(OP);S(MP);S(LP);S(RP);S(dO);S(cO);S(lO);S(hO);S(EP);S(_P);S(IP);S(DP);S(AP);S(TP);S(kP);S(xP);S(uO);S(pO);S(bO);S(vO);S(mO);S(wO);S(gO);S(fO);S(yO);S(CO);S(IO);S(DO);S(zf);S(_O);S(SO);S(EO);S(cP);S(lP);S(hP);S(pP);S(uP);S(gP);S(fP);S(mP);S(wP);S(AO);S(TO);S(kO);S(xO);S(UP);S(HP);S(zP);S($P);S(qP);S(jP);S(YP);S(XP);S(JP);S(aO);S(nO);S(Eh);S(_h);S(Ih);S(Dh);S(Ah);S(Th);S(xh);S(kh);S(LO);S(RO);S(ZP);S(QP);S(eO);S(tO);S(Hf);S(VO);S(PO);S(OO);S(MO);S(NO);S(FO);const BC="workbench.action.quickOpenNavigateNextInEditorPicker";Z.registerCommandAndKeybindingRule({id:BC,weight:L.WorkbenchContrib+50,handler:r_(BC,!0),when:$I,primary:C.CtrlCmd|w.Tab,mac:{primary:C.WinCtrl|w.Tab}});const GC="workbench.action.quickOpenNavigatePreviousInEditorPicker";Z.registerCommandAndKeybindingRule({id:GC,weight:L.WorkbenchContrib+50,handler:r_(GC,!1),when:$I,primary:C.CtrlCmd|C.Shift|w.Tab,mac:{primary:C.WinCtrl|C.Shift|w.Tab}});iP();Ge&&(_.appendMenuItem(b.TouchBarContext,{command:{id:xc.ID,title:xc.LABEL,icon:{dark:Gd.asFileUri("vs/workbench/browser/parts/editor/media/back-tb.png")}},group:"navigation",order:0}),_.appendMenuItem(b.TouchBarContext,{command:{id:kc.ID,title:kc.LABEL,icon:{dark:Gd.asFileUri("vs/workbench/browser/parts/editor/media/forward-tb.png")}},group:"navigation",order:1}));_.appendMenuItem(b.EmptyEditorGroup,{command:{id:wv,title:c(3125,"Lock Group"),icon:P.unlock},group:"navigation",order:10,when:I.and(Er,$s.toNegated())});_.appendMenuItem(b.EmptyEditorGroup,{command:{id:yd,title:c(3126,"Unlock Group"),icon:P.lock,toggled:I.true()},group:"navigation",order:10,when:$s});_.appendMenuItem(b.EmptyEditorGroup,{command:{id:pv,title:c(3127,"Close Group"),icon:P.close},group:"navigation",order:20,when:I.or(Er,Jc)});_.appendMenuItem(b.EmptyEditorGroupContext,{command:{id:Mn,title:c(3128,"Split Up")},group:"2_split",order:10});_.appendMenuItem(b.EmptyEditorGroupContext,{command:{id:yr,title:c(3129,"Split Down")},group:"2_split",order:20});_.appendMenuItem(b.EmptyEditorGroupContext,{command:{id:Nn,title:c(3130,"Split Left")},group:"2_split",order:30});_.appendMenuItem(b.EmptyEditorGroupContext,{command:{id:Cr,title:c(3131,"Split Right")},group:"2_split",order:40});_.appendMenuItem(b.EmptyEditorGroupContext,{command:{id:eI,title:c(3132,"New Window")},group:"3_window",order:10});_.appendMenuItem(b.EmptyEditorGroupContext,{command:{id:mv,title:c(3133,"Lock Group"),toggled:$s},group:"4_lock",order:10,when:Er.toNegated()});_.appendMenuItem(b.EmptyEditorGroupContext,{command:{id:pv,title:c(3134,"Close")},group:"5_close",order:10,when:vi});_.appendMenuItem(b.EditorTabsBarContext,{command:{id:Mn,title:c(3128,"Split Up")},group:"2_split",order:10});_.appendMenuItem(b.EditorTabsBarContext,{command:{id:yr,title:c(3129,"Split Down")},group:"2_split",order:20});_.appendMenuItem(b.EditorTabsBarContext,{command:{id:Nn,title:c(3130,"Split Left")},group:"2_split",order:30});_.appendMenuItem(b.EditorTabsBarContext,{command:{id:Cr,title:c(3131,"Split Right")},group:"2_split",order:40});_.appendMenuItem(b.EditorTabsBarContext,{command:{id:Z_,title:c(3135,"Move into New Window")},group:"3_window",order:10});_.appendMenuItem(b.EditorTabsBarContext,{command:{id:Q_,title:c(3136,"Copy into New Window")},group:"3_window",order:20});_.appendMenuItem(b.EditorTabsBarContext,{submenu:b.EditorTabsBarShowTabsSubmenu,title:c(3137,"Tab Bar"),group:"4_config",order:10,when:n_.negate()});_.appendMenuItem(b.EditorTabsBarShowTabsSubmenu,{command:{id:dL.ID,title:c(3138,"Multiple Tabs"),toggled:I.equals("config.workbench.editor.showTabs","multiple")},group:"1_config",order:10});_.appendMenuItem(b.EditorTabsBarShowTabsSubmenu,{command:{id:cL.ID,title:c(3139,"Single Tab"),toggled:I.equals("config.workbench.editor.showTabs","single")},group:"1_config",order:20});_.appendMenuItem(b.EditorTabsBarShowTabsSubmenu,{command:{id:lL.ID,title:c(3140,"Hidden"),toggled:I.equals("config.workbench.editor.showTabs","none")},group:"1_config",order:30});_.appendMenuItem(b.EditorTabsBarContext,{submenu:b.EditorTabsBarShowTabsZenModeSubmenu,title:c(3137,"Tab Bar"),group:"4_config",order:10,when:n_});_.appendMenuItem(b.EditorTabsBarShowTabsZenModeSubmenu,{command:{id:hL.ID,title:c(3138,"Multiple Tabs"),toggled:I.equals("config.zenMode.showTabs","multiple")},group:"1_config",order:10});_.appendMenuItem(b.EditorTabsBarShowTabsZenModeSubmenu,{command:{id:uL.ID,title:c(3139,"Single Tab"),toggled:I.equals("config.zenMode.showTabs","single")},group:"1_config",order:20});_.appendMenuItem(b.EditorTabsBarShowTabsZenModeSubmenu,{command:{id:pL.ID,title:c(3140,"Hidden"),toggled:I.equals("config.zenMode.showTabs","none")},group:"1_config",order:30});_.appendMenuItem(b.EditorTabsBarContext,{submenu:b.EditorActionsPositionSubmenu,title:c(3141,"Editor Actions Position"),group:"4_config",order:20});_.appendMenuItem(b.EditorActionsPositionSubmenu,{command:{id:gL.ID,title:c(3137,"Tab Bar"),toggled:I.equals("config.workbench.editor.editorActionsLocation","default")},group:"1_config",order:10,when:I.equals("config.workbench.editor.showTabs","none").negate()});_.appendMenuItem(b.EditorActionsPositionSubmenu,{command:{id:fL.ID,title:c(3142,"Title Bar"),toggled:I.or(I.equals("config.workbench.editor.editorActionsLocation","titleBar"),I.and(I.equals("config.workbench.editor.showTabs","none"),I.equals("config.workbench.editor.editorActionsLocation","default")))},group:"1_config",order:20});_.appendMenuItem(b.EditorActionsPositionSubmenu,{command:{id:mL.ID,title:c(3143,"Hidden"),toggled:I.equals("config.workbench.editor.editorActionsLocation","hidden")},group:"1_config",order:30});_.appendMenuItem(b.EditorTabsBarContext,{command:{id:wL.ID,title:c(3144,"Configure Tabs")},group:"9_configure",order:10});_.appendMenuItem(b.EditorTitleContext,{command:{id:to,title:c(3134,"Close")},group:"1_close",order:10});_.appendMenuItem(b.EditorTitleContext,{command:{id:gv,title:c(3145,"Close Others"),precondition:jS.notEqualsTo("1")},group:"1_close",order:20});_.appendMenuItem(b.EditorTitleContext,{command:{id:uv,title:c(3146,"Close to the Right"),precondition:I.and(Cp.toNegated(),Qc.negate())},group:"1_close",order:30,when:sl});_.appendMenuItem(b.EditorTitleContext,{command:{id:Up,title:c(3147,"Close Saved")},group:"1_close",order:40});_.appendMenuItem(b.EditorTitleContext,{command:{id:vd,title:c(3148,"Close All")},group:"1_close",order:50});_.appendMenuItem(b.EditorTitleContext,{command:{id:bv,title:c(3149,"Reopen Editor With...")},group:"1_open",order:10,when:hd});_.appendMenuItem(b.EditorTitleContext,{command:{id:fv,title:c(3150,"Keep Open"),precondition:Tb.toNegated()},group:"3_preview",order:10,when:I.has("config.workbench.editor.enablePreview")});_.appendMenuItem(b.EditorTitleContext,{command:{id:vv,title:c(3151,"Pin")},group:"3_preview",order:20,when:qs.toNegated()});_.appendMenuItem(b.EditorTitleContext,{command:{id:jn,title:c(3152,"Unpin")},group:"3_preview",order:20,when:qs});_.appendMenuItem(b.EditorTitleContext,{command:{id:Cd,title:c(3131,"Split Right")},group:"5_split",order:10,when:Fp.negate()});_.appendMenuItem(b.EditorTitleContext,{command:{id:Cd,title:c(3129,"Split Down")},group:"5_split",order:10,when:Fp});_.appendMenuItem(b.EditorTitleContext,{submenu:b.EditorSplitMoveSubmenu,title:c(3153,"Split & Move"),group:"5_split",order:15});_.appendMenuItem(b.EditorTitleContext,{command:{id:Sv,title:c(3154,"Move into New Window")},group:"7_new_window",order:10});_.appendMenuItem(b.EditorTitleContext,{command:{id:Ev,title:c(3155,"Copy into New Window")},group:"7_new_window",order:20});_.appendMenuItem(b.EditorTitleContext,{submenu:b.EditorTitleContextShare,title:c(3156,"Share"),group:"11_share",order:-1,when:Qc.negate()});_.appendMenuItem(b.EditorSplitMoveSubmenu,{command:{id:Mn,title:c(3128,"Split Up")},group:"1_split",order:10});_.appendMenuItem(b.EditorSplitMoveSubmenu,{command:{id:yr,title:c(3129,"Split Down")},group:"1_split",order:20});_.appendMenuItem(b.EditorSplitMoveSubmenu,{command:{id:Nn,title:c(3130,"Split Left")},group:"1_split",order:30});_.appendMenuItem(b.EditorSplitMoveSubmenu,{command:{id:Cr,title:c(3131,"Split Right")},group:"1_split",order:40});_.appendMenuItem(b.EditorSplitMoveSubmenu,{command:{id:gh,title:c(3157,"Move Above")},group:"2_move",order:10});_.appendMenuItem(b.EditorSplitMoveSubmenu,{command:{id:fh,title:c(3158,"Move Below")},group:"2_move",order:20});_.appendMenuItem(b.EditorSplitMoveSubmenu,{command:{id:mh,title:c(3159,"Move Left")},group:"2_move",order:30});_.appendMenuItem(b.EditorSplitMoveSubmenu,{command:{id:wh,title:c(3160,"Move Right")},group:"2_move",order:40});_.appendMenuItem(b.EditorSplitMoveSubmenu,{command:{id:yv,title:c(3161,"Split in Group"),precondition:Qc.negate()},group:"3_split_in_group",order:10,when:Br});_.appendMenuItem(b.EditorSplitMoveSubmenu,{command:{id:Cv,title:c(3162,"Join in Group"),precondition:Qc.negate()},group:"3_split_in_group",order:10,when:gi});_.appendMenuItem(b.EditorTitle,{command:{id:Pf,title:c(3163,"Inline View"),toggled:I.equals("config.diffEditor.renderSideBySide",!1)},group:"1_diff",order:10,when:I.has("isInDiffEditor")});_.appendMenuItem(b.EditorTitle,{command:{id:j_,title:c(3164,"Show Opened Editors")},group:"3_open",order:10});_.appendMenuItem(b.EditorTitle,{command:{id:vd,title:c(3148,"Close All")},group:"5_close",order:10});_.appendMenuItem(b.EditorTitle,{command:{id:Up,title:c(3147,"Close Saved")},group:"5_close",order:20});_.appendMenuItem(b.EditorTitle,{command:{id:q_,title:c(3165,"Enable Preview Editors"),toggled:I.has("config.workbench.editor.enablePreview")},group:"7_settings",order:10});_.appendMenuItem(b.EditorTitle,{command:{id:Hp,title:c(3166,"Maximize Group")},group:"8_group_operations",order:5,when:I.and($o.negate(),Jc)});_.appendMenuItem(b.EditorTitle,{command:{id:Hp,title:c(3167,"Unmaximize Group")},group:"8_group_operations",order:5,when:$o});_.appendMenuItem(b.EditorTitle,{command:{id:mv,title:c(3168,"Lock Group"),toggled:$s},group:"8_group_operations",order:10,when:Er.toNegated()});_.appendMenuItem(b.EditorTitle,{command:{id:bL.ID,title:c(3169,"Configure Editors")},group:"9_configure",order:10});function ns(a,e,t,i,s,o){const r={command:{id:a.id,title:a.title,icon:a.icon,toggled:a.toggled,precondition:s},group:"navigation",when:e,order:t};i&&(r.alt={id:i.id,title:i.title,icon:i.icon}),_.appendMenuItem(b.EditorTitle,r),o&&_.appendMenuItem(b.CompactWindowEditorTitle,r)}const kv=1e5,Ed=1e6;ns({id:Cd,title:c(3170,"Split Editor Right"),icon:P.splitHorizontal},Fp.negate(),kv,{id:yr,title:c(3171,"Split Editor Down"),icon:P.splitVertical});ns({id:Cd,title:c(3171,"Split Editor Down"),icon:P.splitVertical},Fp,kv,{id:Cr,title:c(3170,"Split Editor Right"),icon:P.splitHorizontal});ns({id:Y_,title:c(3172,"Toggle Layout"),icon:P.editorLayout},gi,kv-1);ns({id:to,title:c(3134,"Close"),icon:P.close},I.and(sl.toNegated(),Zc.toNegated(),qs.toNegated()),Ed,{id:vd,title:c(3148,"Close All"),icon:P.closeAll});ns({id:to,title:c(3134,"Close"),icon:P.closeDirty},I.and(sl.toNegated(),Zc,qs.toNegated()),Ed,{id:vd,title:c(3148,"Close All"),icon:P.closeAll});ns({id:jn,title:c(3152,"Unpin"),icon:P.pinned},I.and(sl.toNegated(),Zc.toNegated(),qs),Ed,{id:to,title:c(3134,"Close"),icon:P.close});ns({id:jn,title:c(3152,"Unpin"),icon:P.pinnedDirty},I.and(sl.toNegated(),Zc,qs),Ed,{id:to,title:c(3134,"Close"),icon:P.close});ns({id:wv,title:c(3173,"Lock Group"),icon:P.unlock},I.and(Er,$s.toNegated()),Ed-1);ns({id:yd,title:c(3174,"Unlock Group"),icon:P.lock,toggled:I.true()},$s,Ed-1);const PN=Ee("diff-editor-previous-change",P.arrowUp,c(3175,"Icon for the previous change action in the diff editor."));ns({id:Mf,title:c(3176,"Previous Change"),icon:PN},Ri,10,void 0,mr.hasChanges,!0);const ON=Ee("diff-editor-next-change",P.arrowDown,c(3177,"Icon for the next change action in the diff editor."));ns({id:Of,title:c(3178,"Next Change"),icon:ON},Ri,11,void 0,mr.hasChanges,!0);ns({id:Nf,title:c(3179,"Swap Left and Right Side"),icon:P.arrowSwap},I.and(Ri,Eb),15,void 0,void 0);const MN=Ee("diff-editor-toggle-whitespace",P.whitespace,c(3180,"Icon for the toggle whitespace action in the diff editor."));_.appendMenuItem(b.EditorTitle,{command:{id:H_,title:c(3181,"Show Leading/Trailing Whitespace Differences"),icon:MN,precondition:Ri,toggled:I.equals("config.diffEditor.ignoreTrimWhitespace",!1)},group:"navigation",when:Ri,order:20});_.appendMenuItem(b.CommandPalette,{command:{id:fv,title:y(3182,"Keep Editor"),category:T.View},when:I.has("config.workbench.editor.enablePreview")});_.appendMenuItem(b.CommandPalette,{command:{id:vv,title:y(3183,"Pin Editor"),category:T.View}});_.appendMenuItem(b.CommandPalette,{command:{id:jn,title:y(3184,"Unpin Editor"),category:T.View}});_.appendMenuItem(b.CommandPalette,{command:{id:to,title:y(3185,"Close Editor"),category:T.View}});_.appendMenuItem(b.CommandPalette,{command:{id:$_,title:y(3186,"Close Pinned Editor"),category:T.View}});_.appendMenuItem(b.CommandPalette,{command:{id:vd,title:y(3187,"Close All Editors in Group"),category:T.View}});_.appendMenuItem(b.CommandPalette,{command:{id:Up,title:y(3188,"Close Saved Editors in Group"),category:T.View}});_.appendMenuItem(b.CommandPalette,{command:{id:gv,title:y(3189,"Close Other Editors in Group"),category:T.View}});_.appendMenuItem(b.CommandPalette,{command:{id:uv,title:y(3190,"Close Editors to the Right in Group"),category:T.View},when:Cp.toNegated()});_.appendMenuItem(b.CommandPalette,{command:{id:z_,title:y(3191,"Close Editor Group"),category:T.View},when:vi});_.appendMenuItem(b.CommandPalette,{command:{id:bv,title:y(3149,"Reopen Editor With..."),category:T.View},when:hd});_.appendMenuItem(b.MenubarRecentMenu,{group:"1_editor",command:{id:bh.ID,title:c(3192,"&&Reopen Closed Editor"),precondition:I.has("canReopenClosedEditor")},order:1});_.appendMenuItem(b.MenubarRecentMenu,{group:"z_clear",command:{id:vh.ID,title:c(3193,"&&Clear Recently Opened...")},order:1});_.appendMenuItem(b.MenubarFileMenu,{title:c(3194,"Share"),submenu:b.MenubarShare,group:"45_share",order:1});_.appendMenuItem(b.MenubarViewMenu,{group:"2_appearance",title:c(3195,"Editor &&Layout"),submenu:b.MenubarLayoutMenu,order:2});_.appendMenuItem(b.MenubarLayoutMenu,{group:"1_split",command:{id:Mn,title:{...y(3196,"Split Up"),mnemonicTitle:c(3197,"Split &&Up")}},order:1});_.appendMenuItem(b.MenubarLayoutMenu,{group:"1_split",command:{id:yr,title:{...y(3198,"Split Down"),mnemonicTitle:c(3199,"Split &&Down")}},order:2});_.appendMenuItem(b.MenubarLayoutMenu,{group:"1_split",command:{id:Nn,title:{...y(3200,"Split Left"),mnemonicTitle:c(3201,"Split &&Left")}},order:3});_.appendMenuItem(b.MenubarLayoutMenu,{group:"1_split",command:{id:Cr,title:{...y(3202,"Split Right"),mnemonicTitle:c(3203,"Split &&Right")}},order:4});_.appendMenuItem(b.MenubarLayoutMenu,{group:"2_split_in_group",command:{id:yv,title:{...y(3204,"Split in Group"),mnemonicTitle:c(3205,"Split in &&Group")}},when:Br,order:1});_.appendMenuItem(b.MenubarLayoutMenu,{group:"2_split_in_group",command:{id:Cv,title:{...y(3206,"Join in Group"),mnemonicTitle:c(3207,"Join in &&Group")}},when:gi,order:1});_.appendMenuItem(b.MenubarLayoutMenu,{group:"3_new_window",command:{id:Sv,title:{...y(3208,"Move Editor into New Window"),mnemonicTitle:c(3209,"&&Move Editor into New Window")}},order:1});_.appendMenuItem(b.MenubarLayoutMenu,{group:"3_new_window",command:{id:Ev,title:{...y(3210,"Copy Editor into New Window"),mnemonicTitle:c(3211,"&&Copy Editor into New Window")}},order:2});_.appendMenuItem(b.MenubarLayoutMenu,{group:"4_layouts",command:{id:Eh.ID,title:{...y(3212,"Single"),mnemonicTitle:c(3213,"&&Single")}},order:1});_.appendMenuItem(b.MenubarLayoutMenu,{group:"4_layouts",command:{id:_h.ID,title:{...y(3214,"Two Columns"),mnemonicTitle:c(3215,"&&Two Columns")}},order:3});_.appendMenuItem(b.MenubarLayoutMenu,{group:"4_layouts",command:{id:Ih.ID,title:{...y(3216,"Three Columns"),mnemonicTitle:c(3217,"T&&hree Columns")}},order:4});_.appendMenuItem(b.MenubarLayoutMenu,{group:"4_layouts",command:{id:Dh.ID,title:{...y(3218,"Two Rows"),mnemonicTitle:c(3219,"T&&wo Rows")}},order:5});_.appendMenuItem(b.MenubarLayoutMenu,{group:"4_layouts",command:{id:Ah.ID,title:{...y(3220,"Three Rows"),mnemonicTitle:c(3221,"Three &&Rows")}},order:6});_.appendMenuItem(b.MenubarLayoutMenu,{group:"4_layouts",command:{id:Th.ID,title:{...y(3222,"Grid (2x2)"),mnemonicTitle:c(3223,"&&Grid (2x2)")}},order:7});_.appendMenuItem(b.MenubarLayoutMenu,{group:"4_layouts",command:{id:xh.ID,title:{...y(3224,"Two Rows Right"),mnemonicTitle:c(3225,"Two R&&ows Right")}},order:8});_.appendMenuItem(b.MenubarLayoutMenu,{group:"4_layouts",command:{id:kh.ID,title:{...y(3226,"Two Columns Bottom"),mnemonicTitle:c(3227,"Two &&Columns Bottom")}},order:9});_.appendMenuItem(b.MenubarGoMenu,{group:"1_history_nav",command:{id:"workbench.action.navigateToLastEditLocation",title:c(3228,"&&Last Edit Location"),precondition:I.has("canNavigateToLastEditLocation")},order:3});_.appendMenuItem(b.MenubarSwitchEditorMenu,{group:"1_sideBySide",command:{id:X_,title:c(3229,"&&First Side in Editor")},when:I.or(gi,Ri),order:1});_.appendMenuItem(b.MenubarSwitchEditorMenu,{group:"1_sideBySide",command:{id:J_,title:c(3230,"&&Second Side in Editor")},when:I.or(gi,Ri),order:2});_.appendMenuItem(b.MenubarSwitchEditorMenu,{group:"2_any",command:{id:"workbench.action.nextEditor",title:c(3231,"&&Next Editor")},order:1});_.appendMenuItem(b.MenubarSwitchEditorMenu,{group:"2_any",command:{id:"workbench.action.previousEditor",title:c(3232,"&&Previous Editor")},order:2});_.appendMenuItem(b.MenubarSwitchEditorMenu,{group:"3_any_used",command:{id:"workbench.action.openNextRecentlyUsedEditor",title:c(3233,"&&Next Used Editor")},order:1});_.appendMenuItem(b.MenubarSwitchEditorMenu,{group:"3_any_used",command:{id:"workbench.action.openPreviousRecentlyUsedEditor",title:c(3234,"&&Previous Used Editor")},order:2});_.appendMenuItem(b.MenubarSwitchEditorMenu,{group:"4_group",command:{id:"workbench.action.nextEditorInGroup",title:c(3235,"&&Next Editor in Group")},order:1});_.appendMenuItem(b.MenubarSwitchEditorMenu,{group:"4_group",command:{id:"workbench.action.previousEditorInGroup",title:c(3236,"&&Previous Editor in Group")},order:2});_.appendMenuItem(b.MenubarSwitchEditorMenu,{group:"5_group_used",command:{id:"workbench.action.openNextRecentlyUsedEditorInGroup",title:c(3237,"&&Next Used Editor in Group")},order:1});_.appendMenuItem(b.MenubarSwitchEditorMenu,{group:"5_group_used",command:{id:"workbench.action.openPreviousRecentlyUsedEditorInGroup",title:c(3238,"&&Previous Used Editor in Group")},order:2});_.appendMenuItem(b.MenubarGoMenu,{group:"2_editor_nav",title:c(3239,"Switch &&Editor"),submenu:b.MenubarSwitchEditorMenu,order:1});_.appendMenuItem(b.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusFirstEditorGroup",title:c(3240,"Group &&1")},order:1});_.appendMenuItem(b.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusSecondEditorGroup",title:c(3241,"Group &&2")},order:2});_.appendMenuItem(b.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusThirdEditorGroup",title:c(3242,"Group &&3"),precondition:vi},order:3});_.appendMenuItem(b.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusFourthEditorGroup",title:c(3243,"Group &&4"),precondition:vi},order:4});_.appendMenuItem(b.MenubarSwitchGroupMenu,{group:"1_focus_index",command:{id:"workbench.action.focusFifthEditorGroup",title:c(3244,"Group &&5"),precondition:vi},order:5});_.appendMenuItem(b.MenubarSwitchGroupMenu,{group:"2_next_prev",command:{id:"workbench.action.focusNextGroup",title:c(3245,"&&Next Group"),precondition:vi},order:1});_.appendMenuItem(b.MenubarSwitchGroupMenu,{group:"2_next_prev",command:{id:"workbench.action.focusPreviousGroup",title:c(3246,"&&Previous Group"),precondition:vi},order:2});_.appendMenuItem(b.MenubarSwitchGroupMenu,{group:"3_directional",command:{id:"workbench.action.focusLeftGroup",title:c(3247,"Group &&Left"),precondition:vi},order:1});_.appendMenuItem(b.MenubarSwitchGroupMenu,{group:"3_directional",command:{id:"workbench.action.focusRightGroup",title:c(3248,"Group &&Right"),precondition:vi},order:2});_.appendMenuItem(b.MenubarSwitchGroupMenu,{group:"3_directional",command:{id:"workbench.action.focusAboveGroup",title:c(3249,"Group &&Above"),precondition:vi},order:3});_.appendMenuItem(b.MenubarSwitchGroupMenu,{group:"3_directional",command:{id:"workbench.action.focusBelowGroup",title:c(3250,"Group &&Below"),precondition:vi},order:4});_.appendMenuItem(b.MenubarGoMenu,{group:"2_editor_nav",title:c(3251,"Switch &&Group"),submenu:b.MenubarSwitchGroupMenu,order:2});vL(yL);var Ra;let Kc=(Ra=class{constructor(e){this._webviewWorkbenchService=e}canSerialize(e){return this._webviewWorkbenchService.shouldPersist(e)}serialize(e){if(!this.canSerialize(e))return;const t=this.toJson(e);try{return JSON.stringify(t)}catch{return}}deserialize(e,t){const i=this.fromJson(JSON.parse(t));return this._webviewWorkbenchService.openRevivedWebview({webviewInitInfo:{providedViewType:i.providedId,origin:i.origin,title:i.title,options:i.webviewOptions,contentOptions:i.contentOptions,extension:i.extension},viewType:i.viewType,title:i.title,iconPath:i.iconPath,state:i.state,group:i.group})}fromJson(e){return{...e,extension:qI(e.extensionId,e.extensionLocation),iconPath:jI(e.iconPath),state:NN(e.state),webviewOptions:e.options,contentOptions:YI(e.options)}}toJson(e){return{origin:e.webview.origin,viewType:e.viewType,providedId:e.providerId,title:e.getName(),options:{...e.webview.options,...e.webview.contentOptions},extensionLocation:e.extension?.location,extensionId:e.extension?.id.value,state:e.webview.state,iconPath:e.iconPath?Se.isThemeIcon(e.iconPath)?e.iconPath:{light:e.iconPath.light,dark:e.iconPath.dark}:void 0,group:e.group}}},Ra.ID=ed.typeId,Ra);Kc=D([u(0,Zb)],Kc);function qI(a,e){if(!a)return;const t=eu(e);if(t)return{id:new QE(a),location:t}}function jI(a){if(!a)return;if(Se.isThemeIcon(a))return a;const e=eu(a.light),t=eu(a.dark);return e&&t?{light:e,dark:t}:void 0}function eu(a){if(a)try{return typeof a=="string"?F.parse(a):F.from(a)}catch{return}}function NN(a){return typeof a=="string"?a:void 0}function YI(a){return{...a,localResourceRoots:a.localResourceRoots?.map(e=>eu(e))}}var Va;let tu=(Va=class extends Kc{constructor(e,t,i){super(e),this._instantiationService=t,this._webviewService=i}serialize(e){const t=e.isDirty(),i={...this.toJson(e),editorResource:e.resource.toJSON(),dirty:t,backupId:t?e.backupId:void 0};try{return JSON.stringify(i)}catch{return}}fromJson(e){return{...super.fromJson(e),editorResource:F.from(e.editorResource),dirty:e.dirty}}deserialize(e,t){const i=this.fromJson(JSON.parse(t)),s=XI(this._webviewService,i),o=this._instantiationService.createInstance(ci,{resource:i.editorResource,viewType:i.viewType,webviewTitle:i.title,iconPath:i.iconPath},s,{startsDirty:i.dirty,backupId:i.backupId});return typeof i.group=="number"&&o.updateGroup(i.group),o}},Va.ID=ci.typeId,Va);tu=D([u(0,Zb),u(1,z),u(2,Hn)],tu);function XI(a,e){const t=a.createWebviewOverlay({providedViewType:e.viewType,origin:e.origin,title:e.title,options:{purpose:ZE.CustomEditor,enableFindWidget:e.webviewOptions.enableFindWidget,retainContextWhenHidden:e.webviewOptions.retainContextWhenHidden},contentOptions:e.contentOptions,extension:e.extension});return t.state=e.state,t}var Pa;let iu=(Pa=class extends M{constructor(e,t,i,s,o){super(),this._instantiationService=e,this._workingCopyBackupService=i,this._webviewService=s,this._register(t.registerHandler(this))}handles(e){return e.resource.scheme===ue.vscodeCustomEditor}isOpen(e,t){if(!this.handles(e))return!1;if(e.resource.authority==="jupyter-notebook-ipynb"&&t instanceof CL)try{const i=JSON.parse(e.resource.query),s=F.from(i);return qe(s,t.resource)}catch{return!1}if(!(t instanceof ci)||e.resource.authority!==t.viewType.replace(/[^a-z0-9\-_]/gi,"-").toLowerCase())return!1;try{const i=JSON.parse(e.resource.query),s=F.from(i);return qe(s,t.resource)}catch{return!1}}async createEditor(e){const t=await this._workingCopyBackupService.resolve(e);if(!t?.meta)throw new Error(`No backup found for custom editor: ${e.resource}`);const i=t.meta,s=qI(i.extension?.id,i.extension?.location),o=XI(this._webviewService,{viewType:i.viewType,origin:i.webview.origin,webviewOptions:i.webview.options,contentOptions:YI(i.webview.options),state:i.webview.state,extension:s,title:i.customTitle}),r=this._instantiationService.createInstance(ci,{resource:F.revive(i.editorResource),viewType:i.viewType,webviewTitle:i.customTitle,iconPath:jI(i.iconPath)},o,{backupId:i.backupId});return r.updateGroup(0),r}},Pa.ID="workbench.contrib.complexCustomWorkingCopyEditorHandler",Pa);iu=D([u(0,z),u(1,Np),u(2,SL),u(3,Hn),u(4,a_)],iu);se.as(Lt.EditorPane).registerEditorPane(Oi.create(Sc,Sc.ID,"Webview Editor"),[new he(ci)]);se.as(Lt.EditorFactory).registerEditorSerializer(tu.ID,tu);Vt(iu.ID,iu,Pt.BlockStartup);const eg=I.and(I.equals("activeEditor",Sc.ID),mr.focus.toNegated()),ga=class ga extends R{constructor(){super({id:ga.ID,title:ga.LABEL,keybinding:{when:I.and(eg,gE),primary:C.CtrlCmd|w.KeyF,weight:L.EditorContrib}})}run(e){tg(e)?.showFind()}};ga.ID="editor.action.webvieweditor.showFind",ga.LABEL=c(13159,"Show find");let Fw=ga;const fa=class fa extends R{constructor(){super({id:fa.ID,title:fa.LABEL,keybinding:{when:I.and(eg,pE),primary:w.Escape,weight:L.EditorContrib}})}run(e){tg(e)?.hideFind()}};fa.ID="editor.action.webvieweditor.hideFind",fa.LABEL=c(13160,"Stop find");let Bw=fa;const ma=class ma extends R{constructor(){super({id:ma.ID,title:ma.LABEL,keybinding:{when:I.and(eg,qb),primary:w.Enter,weight:L.EditorContrib}})}run(e){tg(e)?.runFindAction(!1)}};ma.ID="editor.action.webvieweditor.findNext",ma.LABEL=c(13161,"Find next");let Gw=ma;const wa=class wa extends R{constructor(){super({id:wa.ID,title:wa.LABEL,keybinding:{when:I.and(eg,qb),primary:C.Shift|w.Enter,weight:L.EditorContrib}})}run(e){tg(e)?.runFindAction(!0)}};wa.ID="editor.action.webvieweditor.findPrevious",wa.LABEL=c(13162,"Find previous");let Ww=wa;const ba=class ba extends R{constructor(){super({id:ba.ID,title:ba.LABEL,category:T.Developer,menu:[{id:b.CommandPalette}]})}async run(e){const t=e.get(Hn);for(const i of t.webviews)i.reload()}};ba.ID="workbench.action.webview.reloadWebviewAction",ba.LABEL=y(13163,"Reload Webviews");let Kw=ba;function tg(a){const t=a.get(O).activeEditor;return t instanceof ed?t.webview:void 0}se.as(Lt.EditorPane).registerEditorPane(Oi.create(Sc,Sc.ID,c(13165,"webview editor")),[new he(ed)]);var Oa;let su=(Oa=class extends M{constructor(e,t){super(),this.editorGroupService=t,this._register(e.onWillOpenEditor(i=>{const s=t.getGroup(i.groupId);s&&this.onEditorOpening(i.editor,s)}))}onEditorOpening(e,t){if(!(e instanceof ed)||e.typeId!==ed.typeId||t.contains(e))return;let i;const s=this.editorGroupService.groups;for(const o of s)if(o.contains(e)){i=o;break}i&&i.closeEditor(e)}},Oa.ID="workbench.contrib.webviewPanel",Oa);su=D([u(0,O),u(1,U)],su);Vt(su.ID,su,Pt.BlockStartup);se.as(Lt.EditorFactory).registerEditorSerializer(Kc.ID,Kc);S(Fw);S(Bw);S(Gw);S(Ww);S(Kw);let WC=class extends M{constructor(e,t,i,s,o){super(),this.configurationService=t,this.logService=i,this.preferencesService=s,this.quickInputService=o,this._providers=new _E,this._register(e.registerExternalOpener(this))}registerExternalOpenerProvider(e){return{dispose:this._providers.push(e)}}async getOpeners(e,t,i,s){const o=await this.getAllOpenersForUri(e);if(o.size===0)return[];if(i.preferredOpenerId){if(i.preferredOpenerId===wg)return[];const l=o.get(i.preferredOpenerId);if(l)return[l]}const r=this.getConfiguredOpenerForUri(o,e);if(r)return r===wg?[]:[r];const n=[];if(await Promise.all(Array.from(o.values()).map(async l=>{let h;try{h=await l.canOpen(i.sourceUri,s)}catch(p){this.logService.error(p);return}switch(h){case Ad.Option:case Ad.Default:case Ad.Preferred:n.push({opener:l,priority:h});break}})),n.length===0)return[];const d=n.filter(l=>l.priority===Ad.Preferred).at(0);return d?[d.opener]:!t&&n.every(l=>l.priority===Ad.Option)?[]:n.map(l=>l.opener)}async openExternal(e,t,i){const s=typeof e=="string"?F.parse(e):e,o=await this.getOpeners(s,!1,t,i);return o.length===0?!1:o.length===1?o[0].openExternalUri(s,t,i):this.showOpenerPrompt(o,s,t,i)}async getOpener(e,t,i){const s=await this.getOpeners(e,!0,t,i);if(s.length>=1)return s[0]}async getAllOpenersForUri(e){const t=new Map;return await Promise.all(EL.map(this._providers,async i=>{for await(const s of i.getOpeners(e))t.set(s.id,s)})),t}getConfiguredOpenerForUri(e,t){const i=this.configurationService.getValue($y)||{};for(const[s,o]of Object.entries(i))if(_L(t,s)){if(o===wg)return"default";const r=e.get(o);if(r)return r}}async showOpenerPrompt(e,t,i,s){const o=e.map(n=>({label:n.label,opener:n}));o.push({label:ei?c(7887,"Open in new browser window"):c(7888,"Open in default browser"),opener:void 0},{type:"separator"},{label:c(7889,"Configure default opener..."),opener:"configureDefault"});const r=await this.quickInputService.pick(o,{placeHolder:c(7890,"How would you like to open: {0}",t.toString())});return r?typeof r.opener>"u"?!1:r.opener==="configureDefault"?(await this.preferencesService.openUserSettings({jsonEditor:!0,revealSetting:{key:$y,edit:!0}}),!0):r.opener.openExternalUri(t,i,s):!0}};WC=D([u(0,tt),u(1,te),u(2,et),u(3,ld),u(4,lt)],WC);se.as(Lo.Configuration).registerConfiguration(IL);const FN=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var Ki;xe(FN);class KC{constructor(e,t){this.combined=e,this.dedicated=t}isEqual(e){return In(this.combined,e.combined)&&In(this.dedicated,e.dedicated)}}let Uw=class{constructor(e,t){this._storageService=e,this._key=t}get value(){return this._storageService.getNumber(this._key,ee.PROFILE,0)}increment(){const e=this.value+1;return this._storageService.store(this._key,e,ee.PROFILE,Ze.MACHINE),e}};Uw=D([u(0,ge)],Uw);var Ma;let ou=(Ma=class extends M{constructor(e){super(),this.editorGroupService=e;for(const t of e.parts)this.createLanguageStatus(t);this._register(e.onDidCreateAuxiliaryEditorPart(t=>this.createLanguageStatus(t)))}createLanguageStatus(e){const t=new B;K.once(e.onWillDispose)(()=>t.dispose());const i=this.editorGroupService.getScopedInstantiationService(e);t.add(i.createInstance(Hw))}},Ma.Id="status.languageStatus",Ma);ou=D([u(0,U)],ou);var hr;let Hw=(hr=class{constructor(e,t,i,s,o,r){this._languageStatusService=e,this._statusBarService=t,this._editorService=i,this._hoverService=s,this._openerService=o,this._storageService=r,this._disposables=new B,this._dedicated=new Set,this._dedicatedEntries=new Map,this._renderDisposables=new B,this._combinedEntryTooltip=ve("div"),r.onDidChangeValue(ee.PROFILE,Ki._keyDedicatedItems,this._disposables)(this._handleStorageChange,this,this._disposables),this._restoreState(),this._interactionCounter=new Uw(r,"languageStatus.interactCount"),e.onDidChange(this._update,this,this._disposables),i.onDidActiveEditorChange(this._update,this,this._disposables),this._update(),t.onDidChangeEntryVisibility(n=>{!n.visible&&this._dedicated.has(n.id)&&(this._dedicated.delete(n.id),this._update(),this._storeState())},void 0,this._disposables)}dispose(){this._disposables.dispose(),this._combinedEntry?.dispose(),dt(this._dedicatedEntries.values()),this._renderDisposables.dispose()}_handleStorageChange(){this._restoreState(),this._update()}_restoreState(){const e=this._storageService.get(Ki._keyDedicatedItems,ee.PROFILE,"[]");try{const t=JSON.parse(e);this._dedicated=new Set(t)}catch{this._dedicated.clear()}}_storeState(){if(this._dedicated.size===0)this._storageService.remove(Ki._keyDedicatedItems,ee.PROFILE);else{const e=JSON.stringify(Array.from(this._dedicated.keys()));this._storageService.store(Ki._keyDedicatedItems,e,ee.PROFILE,Ze.USER)}}_createViewModel(e){if(!e?.hasModel())return new KC([],[]);const t=this._languageStatusService.getLanguageStatus(e.getModel()),i=[],s=[];for(const o of t)this._dedicated.has(o.id)&&s.push(o),i.push(o);return new KC(i,s)}_update(){const e=gs(this._editorService.activeTextEditorControl),t=this._createViewModel(e);if(this._model?.isEqual(t))return;if(this._renderDisposables.clear(),this._model=t,e?.onDidChangeModelLanguage(this._update,this,this._renderDisposables),t.combined.length===0)this._combinedEntry?.dispose(),this._combinedEntry=void 0;else{const[s]=t.combined,o=s.severity>=Te.Warning,r=Ki._severityToComboCodicon(s.severity);let n=!1;const d=[];for(const m of t.combined){const v=t.dedicated.includes(m);this._renderStatus(this._combinedEntryTooltip,m,o,v,this._renderDisposables),d.push(Ki._accessibilityInformation(m).label),n=n||!v&&m.busy}const l={name:c(8508,"Editor Language Status"),ariaLabel:c(8509,"Editor Language Status: {0}",d.join(", next: ")),tooltip:this._combinedEntryTooltip,command:DL,text:n?"$(loading~spin)":r};this._combinedEntry?this._combinedEntry.update(l):this._combinedEntry=this._statusBarService.addEntry(l,Ki._id,_t.RIGHT,{location:{id:"status.editor.mode",priority:100.1},alignment:_t.LEFT,compact:!0});const h=this._interactionCounter.value>=3,p=He(e?.getContainerDomNode()),g=p.document.querySelector(".monaco-workbench .statusbar DIV#status\\.languageStatus A>SPAN.codicon"),f=p.document.querySelector(".monaco-workbench .statusbar DIV#status\\.languageStatus");if(Ln(g)&&f){const m="wiggle",v="flash";n?(g.classList.remove(m),f.classList.remove(v)):(g.classList.toggle(m,o||!h),this._renderDisposables.add(X(g,"animationend",E=>g.classList.remove(m))),f.classList.toggle(v,o),this._renderDisposables.add(X(f,"animationend",E=>f.classList.remove(v))))}if(!h){const m=p.document.querySelector(".monaco-workbench .context-view");if(Ln(m)){const v=new MutationObserver(()=>{p.document.contains(this._combinedEntryTooltip)&&(this._interactionCounter.increment(),v.disconnect())});v.observe(m,{childList:!0,subtree:!0}),this._renderDisposables.add(pe(()=>v.disconnect()))}}}const i=new Map;for(const s of t.dedicated){const o=Ki._asStatusbarEntry(s);let r=this._dedicatedEntries.get(s.id);r?(r.update(o),this._dedicatedEntries.delete(s.id)):r=this._statusBarService.addEntry(o,s.id,_t.RIGHT,{location:{id:"status.editor.mode",priority:100.1},alignment:_t.RIGHT}),i.set(s.id,r)}dt(this._dedicatedEntries.values()),this._dedicatedEntries=i}_renderStatus(e,t,i,s,o){const r=ve("div");r.classList.add("hover-language-status"),e.appendChild(r),o.add(pe(()=>r.remove()));const n=ve("div");n.classList.add("severity",`sev${t.severity}`),n.classList.toggle("show",i);const d=Ki._severityToSingleCodicon(t.severity);ye(n,...ws(d)),r.appendChild(n);const l=ve("div");l.classList.add("element"),r.appendChild(l);const h=ve("div");h.classList.add("left"),l.appendChild(h);const p=typeof t.label=="string"?t.label:t.label.value;ye(h,...ws(UC(p,t.busy))),this._renderTextPlus(h,t.detail,o);const g=ve("div");g.classList.add("right"),l.appendChild(g);const{command:f}=t;f&&o.add(new qy(g,{label:f.title,title:f.tooltip,href:F.from({scheme:"command",path:f.id,query:f.arguments&&JSON.stringify(f.arguments)}).toString()},{hoverDelegate:jy},this._hoverService,this._openerService));const m=new Sr(g,{hoverDelegate:jy}),v=s?c(8510,"Remove from Status Bar"):c(8511,"Add to Status Bar");m.setAriaLabel(v),o.add(m);let E;return s?E=new Je("unpin",v,Se.asClassName(P.pinned),!0,()=>{this._dedicated.delete(t.id),this._statusBarService.updateEntryVisibility(t.id,!1),this._update(),this._storeState()}):E=new Je("pin",v,Se.asClassName(P.pin),!0,()=>{this._dedicated.add(t.id),this._statusBarService.updateEntryVisibility(t.id,!0),this._update(),this._storeState()}),m.push(E,{icon:!0,label:!1}),o.add(E),r}static _severityToComboCodicon(e){switch(e){case Te.Error:return"$(bracket-error)";case Te.Warning:return"$(bracket-dot)";default:return"$(bracket)"}}static _severityToSingleCodicon(e){switch(e){case Te.Error:return"$(error)";case Te.Warning:return"$(info)";default:return"$(check)"}}_renderTextPlus(e,t,i){let s=!1;for(const o of eh(t).nodes)if(s||(ye(e,N("span.separator")),s=!0),typeof o=="string"){const r=ws(o);ye(e,...r)}else i.add(new qy(e,o,void 0,this._hoverService,this._openerService))}static _accessibilityInformation(e){if(e.accessibilityInfo)return e.accessibilityInfo;const t=typeof e.label=="string"?e.label:e.label.value;return e.detail?{label:c(8512,"{0}, {1}",t,e.detail)}:{label:c(8513,"{0}",t)}}static _asStatusbarEntry(e){let t;e.severity===Te.Warning?t="warning":e.severity===Te.Error&&(t="error");const i=typeof e.label=="string"?e.label:e.label.shortValue;return{name:c(8514,"{0} (Language Status)",e.name),text:UC(i,e.busy),ariaLabel:Ki._accessibilityInformation(e).label,role:e.accessibilityInfo?.role,tooltip:e.command?.tooltip||new Zi(e.detail,{isTrusted:!0,supportThemeIcons:!0}),kind:t,command:e.command}}},Ki=hr,hr._id="status.languageStatus",hr._keyDedicatedItems="languageStatus.dedicated",hr);Hw=Ki=D([u(0,d_),u(1,Ss),u(2,O),u(3,oi),u(4,tt),u(5,ge)],Hw);class BN extends R{constructor(){super({id:"editor.inlayHints.Reset",title:y(8515,"Reset Language Status Interaction Counter"),category:T.View,f1:!0})}run(e){e.get(ge).remove("languageStatus.interactCount",ee.PROFILE)}}function UC(a,e){return AL([a!==""&&a,e&&"$(loading~spin)"],"")}Vt(ou.Id,ou,Pt.AfterRestored);S(BN);const GN=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));De("mergeEditor.change.background","#9bb95533",c(9148,"The background color for changes."));De("mergeEditor.change.word.background",{dark:"#9ccc2c33",light:"#9ccc2c66",hcDark:"#9ccc2c33",hcLight:"#9ccc2c66"},c(9149,"The background color for word changes."));De("mergeEditor.changeBase.background",{dark:"#4B1818FF",light:"#FFCCCCFF",hcDark:"#4B1818FF",hcLight:"#FFCCCCFF"},c(9150,"The background color for changes in base."));De("mergeEditor.changeBase.word.background",{dark:"#6F1313FF",light:"#FFA3A3FF",hcDark:"#6F1313FF",hcLight:"#FFA3A3FF"},c(9151,"The background color for word changes in base."));De("mergeEditor.conflict.unhandledUnfocused.border",{dark:"#ffa6007a",light:"#ffa600FF",hcDark:"#ffa6007a",hcLight:"#ffa6007a"},c(9152,"The border color of unhandled unfocused conflicts."));De("mergeEditor.conflict.unhandledFocused.border","#ffa600",c(9153,"The border color of unhandled focused conflicts."));De("mergeEditor.conflict.handledUnfocused.border","#86868649",c(9154,"The border color of handled unfocused conflicts."));De("mergeEditor.conflict.handledFocused.border","#c1c1c1cc",c(9155,"The border color of handled focused conflicts."));const nd=De("mergeEditor.conflict.handled.minimapOverViewRuler","#adaca8ee",c(9156,"The foreground color for changes in input 1.")),ad=De("mergeEditor.conflict.unhandled.minimapOverViewRuler","#fcba03FF",c(9157,"The foreground color for changes in input 1."));De("mergeEditor.conflictingLines.background","#ffea0047",c(9158,'The background of the "Conflicting Lines" text.'));const JI=.4;De("mergeEditor.conflict.input1.background",Pn(TL,JI),c(9159,"The background color of decorations in input 1."));De("mergeEditor.conflict.input2.background",Pn(kL,JI),c(9160,"The background color of decorations in input 2."));class xv extends M{constructor(e,t,i){super(),this._editor=e,this._domNode=t,this.itemProvider=i,this.scrollTop=Hd(this,this._editor.onDidScrollChange,r=>this._editor.getScrollTop()),this.isScrollTopZero=this.scrollTop.map(r=>r===0),this.modelAttached=Hd(this,this._editor.onDidChangeModel,r=>this._editor.hasModel()),this.editorOnDidChangeViewZones=Yy("onDidChangeViewZones",this._editor.onDidChangeViewZones),this.editorOnDidContentSizeChange=Yy("onDidContentSizeChange",this._editor.onDidContentSizeChange),this.domNodeSizeChanged=xL("domNodeSizeChanged"),this.views=new Map,this._domNode.className="gutter monaco-editor";const s=this._domNode.appendChild(Ct("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),o=new ResizeObserver(()=>{it(r=>{this.domNodeSizeChanged.trigger(r)})});o.observe(this._domNode),this._register(pe(()=>o.disconnect())),this._register(ts(r=>{s.className=this.isScrollTopZero.read(r)?"":"scroll-decoration"})),this._register(ts(r=>this.render(r)))}dispose(){super.dispose(),ms(this._domNode)}render(e){if(!this.modelAttached.read(e))return;this.domNodeSizeChanged.read(e),this.editorOnDidChangeViewZones.read(e),this.editorOnDidContentSizeChange.read(e);const t=this.scrollTop.read(e),i=this._editor.getVisibleRanges(),s=new Set(this.views.keys());if(i.length>0){const o=i[0],r=Bp.fromLength(o.startLineNumber,o.endLineNumber-o.startLineNumber).deltaEnd(1),n=this.itemProvider.getIntersectingGutterItems(r,e);for(const d of n){if(!d.range.intersectsOrTouches(r))continue;s.delete(d.id);let l=this.views.get(d.id);if(l)l.gutterItemView.update(d);else{const f=ve("div");this._domNode.appendChild(f);const m=this.itemProvider.createView(d,f);l=new WN(m,f),this.views.set(d.id,l)}const h=d.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(d.range.startLineNumber,!0)-t:this._editor.getBottomForLineNumber(d.range.startLineNumber-1,!1)-t,g=this._editor.getBottomForLineNumber(d.range.endLineNumberExclusive-1,!0)-t-h;l.domNode.style.top=`${h}px`,l.domNode.style.height=`${g}px`,l.gutterItemView.layout(h,g,0,this._domNode.clientHeight)}}for(const o of s){const r=this.views.get(o);r.gutterItemView.dispose(),r.domNode.remove(),this.views.delete(o)}}}class WN{constructor(e,t){this.gutterItemView=e,this.domNode=t}}class Lv extends M{updateOptions(e){this.editor.updateOptions(e)}constructor(e,t,i){super(),this.instantiationService=e,this.viewModel=t,this.configurationService=i,this.model=this.viewModel.map(s=>s?.model),this.htmlElements=Ct("div.code-view",[Ct("div.header@header",[Ct("span.title@title"),Ct("span.description@description"),Ct("span.detail@detail"),Ct("span.toolbar@toolbar")]),Ct("div.container",[Ct("div.gutter@gutterDiv"),Ct("div@editor")])]),this._onDidViewChange=new A,this.view={element:this.htmlElements.root,minimumWidth:$l.width,maximumWidth:ql.width,minimumHeight:$l.height,maximumHeight:ql.height,onDidChange:this._onDidViewChange.event,layout:(s,o,r,n)=>{LL(this.htmlElements.root,{width:s,height:o,top:r,left:n}),this.editor.layout({width:s-this.htmlElements.gutterDiv.clientWidth,height:o-this.htmlElements.header.clientHeight})}},this.checkboxesVisible=xl("mergeEditor.showCheckboxes",!1,this.configurationService),this.showDeletionMarkers=xl("mergeEditor.showDeletionMarkers",!0,this.configurationService),this.useSimplifiedDecorations=xl("mergeEditor.useSimplifiedDecorations",!1,this.configurationService),this.editor=this.instantiationService.createInstance(e_,this.htmlElements.editor,{},{contributions:this.getEditorContributions()}),this.isFocused=Hd(this,K.any(this.editor.onDidBlurEditorWidget,this.editor.onDidFocusEditorWidget),()=>this.editor.hasWidgetFocus()),this.cursorPosition=Hd(this,this.editor.onDidChangeCursorPosition,()=>this.editor.getPosition()),this.selection=Hd(this,this.editor.onDidChangeCursorSelection,()=>this.editor.getSelections()),this.cursorLineNumber=this.cursorPosition.map(s=>s?.lineNumber)}getEditorContributions(){return RL.getEditorContributions().filter(e=>e.id!==c_.ID&&e.id!==VL.ID)}}function Rv(a,e){const t=fi(i=>{const s=a.viewModel.read(i);if(!s)return[];const o=s.selectionInBase.read(i);return!o||o.sourceEditor===a?[]:o.rangesInBase.map(r=>e(r,s))});return ts(i=>{const s=t.read(i);s.length!==0&&a.editor.setSelections(s.map(o=>new s_(o.startLineNumber,o.startColumn,o.endLineNumber,o.endColumn)))})}let Uc=class extends M{constructor(e,t,i){super();const s=i.createInstance(XC,t,e,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:o=>o==="primary"}});this._store.add(s)}};Uc=D([u(2,z)],Uc);let zw=class extends Lv{constructor(e,t,i){super(t,e,i),this.decorations=fi(this,s=>{const o=this.viewModel.read(s);if(!o)return[];const r=o.model,n=r.base,d=o.activeModifiedBaseRange.read(s),l=o.showNonConflictingChanges.read(s),h=this.showDeletionMarkers.read(s),p=[];for(const g of r.modifiedBaseRanges.read(s)){const f=g.baseRange;if(!f)continue;const m=r.isHandled(g).read(s);if(!g.isConflicting&&m&&!l)continue;const v=["merge-editor-block"];let E=[0,0,0,0];m&&v.push("handled"),g===d&&(v.push("focused"),E=[0,2,0,2]),v.push("base");const x=o.baseShowDiffAgainst.read(s);if(x)for(const G of g.getInputDiffs(x)){const W=G.inputRange.toInclusiveRange();W&&p.push({range:W,options:{className:"merge-editor-diff base",description:"Merge Editor",isWholeLine:!0}});for(const Y of G.rangeMappings)(h||!Y.inputRange.isEmpty())&&p.push({range:Y.inputRange,options:{className:Y.inputRange.isEmpty()?"merge-editor-diff-empty-word base":"merge-editor-diff-word base",description:"Merge Editor",showIfCollapsed:!0}})}p.push({range:f.toInclusiveRangeOrEmpty(),options:{showIfCollapsed:!0,blockClassName:v.join(" "),blockPadding:E,blockIsAfterEnd:f.startLineNumber>n.getLineCount(),description:"Merge Editor",minimap:{position:Qb.Gutter,color:{id:m?nd:ad}},overviewRuler:g.isConflicting?{position:md.Center,color:{id:m?nd:ad}}:void 0}})}return p}),this._register(Rv(this,(s,o)=>s)),this._register(t.createInstance(Uc,b.MergeBaseToolbar,this.htmlElements.title)),this._register(ev((s,o)=>{this.checkboxesVisible.read(s)&&o.add(new xv(this.editor,this.htmlElements.gutterDiv,{getIntersectingGutterItems:(r,n)=>[],createView:(r,n)=>{throw new Qa}}))})),this._register(ts(s=>{const o=this.viewModel.read(s);if(!o)return;this.editor.setModel(o.model.base),ms(this.htmlElements.title,...ws(c(9179,"Base")));const r=o.baseShowDiffAgainst.read(s);let n;if(r){const d=c(9180,"Comparing with {0}",r===1?o.model.input1.title:o.model.input2.title),l=c(9181,"Differences are highlighted with a background color.");n=Ct("span",{title:l},[d]).root}ms(this.htmlElements.description,...n?[n]:[])})),this._register(tv(this.editor,this.decorations))}};zw=D([u(1,z),u(2,te)],zw);class KN extends M{get model(){return this.viewModel.get()?.model}get lockResultWithInputs(){return this.layout.get().kind==="columns"}get lockBaseWithInputs(){return this.layout.get().kind==="mixed"&&!this.layout.get().showBaseAtTop}constructor(e,t,i,s,o,r){super(),this.viewModel=e,this.input1View=t,this.input2View=i,this.baseView=s,this.inputResultView=o,this.layout=r,this.reentrancyBarrier=new l_,this._isSyncing=!0;const n=fi(d=>{const l=this.baseView.read(d),h=[this.input1View,this.input2View,this.inputResultView,l].filter(fo),p=(g,f,m)=>{this.reentrancyBarrier.runExclusivelyOrSkip(()=>{if(f){const v=g.editor.getScrollLeft();for(const E of h)E!==g&&E.editor.setScrollLeft(v,Nt.Immediate)}if(m){const v=g.editor.getScrollTop();for(const E of h)if(E!==g)if(this._shouldLock(g,E))E.editor.setScrollTop(v,Nt.Immediate);else{const x=this._getMapping(g,E);x&&this._synchronizeScrolling(g.editor,E.editor,x)}}})};for(const g of h)d.store.add(g.editor.onDidScrollChange(f=>{this._isSyncing&&p(g,f.scrollLeftChanged,f.scrollTopChanged)}));return{update:()=>{p(this.inputResultView,!0,!0)}}}).recomputeInitiallyAndOnChange(this._store);this.updateScrolling=()=>{n.get().update()}}stopSync(){this._isSyncing=!1}startSync(){this._isSyncing=!0}_shouldLock(e,t){const i=s=>s===this.input1View||s===this.input2View;return i(e)&&t===this.inputResultView||i(t)&&e===this.inputResultView?this.lockResultWithInputs:i(e)&&t===this.baseView.get()||i(t)&&e===this.baseView.get()?this.lockBaseWithInputs:!!(i(e)&&i(t))}_getMapping(e,t){if(e===this.input1View){if(t===this.input2View)return;if(t===this.inputResultView)return this.model?.input1ResultMapping.get();if(t===this.baseView.get()){const i=this.model?.baseInput1Diffs.get();return i?new vl(i,-1).reverse():void 0}}else if(e===this.input2View){if(t===this.input1View)return;if(t===this.inputResultView)return this.model?.input2ResultMapping.get();if(t===this.baseView.get()){const i=this.model?.baseInput2Diffs.get();return i?new vl(i,-1).reverse():void 0}}else if(e===this.inputResultView){if(t===this.input1View)return this.model?.resultInput1Mapping.get();if(t===this.input2View)return this.model?.resultInput2Mapping.get();if(t===this.baseView.get()){const i=this.model?.resultBaseMapping.get();return i||void 0}}else if(e===this.baseView.get()){if(t===this.input1View){const i=this.model?.baseInput1Diffs.get();return i?new vl(i,-1):void 0}else if(t===this.input2View){const i=this.model?.baseInput2Diffs.get();return i?new vl(i,-1):void 0}else if(t===this.inputResultView){const i=this.model?.baseResultMapping.get();return i||void 0}}throw new Qa}_synchronizeScrolling(e,t,i){if(!i)return;const s=e.getVisibleRanges();if(s.length===0)return;const o=s[0].startLineNumber-1,r=i.project(o),n=r.inputRange,d=r.outputRange,l=t.getTopForLineNumber(d.startLineNumber),h=t.getTopForLineNumber(d.endLineNumberExclusive),p=e.getTopForLineNumber(n.startLineNumber),g=e.getTopForLineNumber(n.endLineNumberExclusive),f=Math.min((e.getScrollTop()-p)/(g-p),1),m=l+(h-l)*f;t.setScrollTop(m,Nt.Immediate)}}let $w=class extends M{constructor(e,t,i,s,o,r,n,d){super(),this.model=e,this.inputCodeEditorView1=t,this.inputCodeEditorView2=i,this.resultCodeEditorView=s,this.baseCodeEditorView=o,this.showNonConflictingChanges=r,this.configurationService=n,this.notificationService=d,this.manuallySetActiveModifiedBaseRange=hs(this,{range:void 0,counter:0}),this.attachedHistory=this._register(new UN(this.model.resultTextModel)),this.shouldUseAppendInsteadOfAccept=xl("mergeEditor.shouldUseAppendInsteadOfAccept",!1,this.configurationService),this.counter=0,this.lastFocusedEditor=PL(this,(l,h)=>{const g=[this.inputCodeEditorView1,this.inputCodeEditorView2,this.resultCodeEditorView,this.baseCodeEditorView.read(l)].find(f=>f&&f.isFocused.read(l));return g?{view:g,counter:this.counter++}:h||{view:void 0,counter:this.counter++}}),this.baseShowDiffAgainst=fi(this,l=>{const h=this.lastFocusedEditor.read(l);if(h.view===this.inputCodeEditorView1)return 1;if(h.view===this.inputCodeEditorView2)return 2}),this.focusedEditorType=fi(this,l=>{const h=this.lastFocusedEditor.read(l);if(h.view){if(h.view===this.inputCodeEditorView1)return"input1";if(h.view===this.inputCodeEditorView2)return"input2";if(h.view===this.resultCodeEditorView)return"result";if(h.view===this.baseCodeEditorView.read(l))return"base"}}),this.selectionInBase=fi(this,l=>{const h=this.lastFocusedEditor.read(l).view;return h?{rangesInBase:(h.selection.read(l)||[]).map(f=>h===this.inputCodeEditorView1?this.model.translateInputRangeToBase(1,f):h===this.inputCodeEditorView2?this.model.translateInputRangeToBase(2,f):h===this.resultCodeEditorView?this.model.translateResultRangeToBase(f):(h===this.baseCodeEditorView.read(l),f)),sourceEditor:h}:void 0}),this.activeModifiedBaseRange=fi(this,l=>{const h=this.lastFocusedEditor.read(l),p=this.manuallySetActiveModifiedBaseRange.read(l);if(p.counter>h.counter)return p.range;if(!h.view)return;const g=h.view.cursorLineNumber.read(l);return g?this.model.modifiedBaseRanges.read(l).find(m=>{const v=this.getRangeOfModifiedBaseRange(h.view,m,l);return v.isEmpty?v.startLineNumber===g:v.contains(g)}):void 0}),this._register(s.editor.onDidChangeModelContent(l=>{if(this.model.isApplyingEditInResult||l.isRedoing||l.isUndoing)return;const h=[];for(const g of l.changes){const f=this.model.translateResultRangeToBase(ze.lift(g.range)),m=this.model.findModifiedBaseRangesInRange(Bp.fromLength(f.startLineNumber,f.endLineNumber-f.startLineNumber));m.length===1&&(this.model.isHandled(m[0]).get()||h.push(m[0]))}if(h.length===0)return;const p={model:this.model,redo(){it(g=>{for(const f of h)this.model.setHandled(f,!0,g)})},undo(){it(g=>{for(const f of h)this.model.setHandled(f,!1,g)})}};this.attachedHistory.pushAttachedHistoryElement(p),p.redo()}))}getRangeOfModifiedBaseRange(e,t,i){if(e===this.resultCodeEditorView)return this.model.getLineRangeInResult(t.baseRange,i);if(e===this.baseCodeEditorView.get())return t.baseRange;{const s=e===this.inputCodeEditorView1?1:2;return t.getInputRange(s)}}setActiveModifiedBaseRange(e,t){this.manuallySetActiveModifiedBaseRange.set({range:e,counter:this.counter++},t)}setState(e,t,i,s){this.manuallySetActiveModifiedBaseRange.set({range:e,counter:this.counter++},i),this.model.setState(e,t,s,i),this.lastFocusedEditor.clearCache(i)}goToConflict(e){let t=this.lastFocusedEditor.get().view;t||(t=this.resultCodeEditorView);const i=t.editor.getPosition()?.lineNumber;if(i===void 0)return;const s=e(t,i);if(s){const o=this.getRangeOfModifiedBaseRange(t,s,void 0);t.editor.focus();let r=o.startLineNumber,n=o.endLineNumberExclusive;o.startLineNumber>t.editor.getModel().getLineCount()&&(it(d=>{this.setActiveModifiedBaseRange(s,d)}),r=n=t.editor.getModel().getLineCount()),t.editor.setPosition({lineNumber:r,column:t.editor.getModel().getLineFirstNonWhitespaceColumn(r)}),t.editor.revealLinesNearTop(r,n,Nt.Smooth)}}goToNextModifiedBaseRange(e){this.goToConflict((t,i)=>this.model.modifiedBaseRanges.get().find(s=>e(s)&&this.getRangeOfModifiedBaseRange(t,s,void 0).startLineNumber>i)||this.model.modifiedBaseRanges.get().find(s=>e(s)))}goToPreviousModifiedBaseRange(e){this.goToConflict((t,i)=>Xy(this.model.modifiedBaseRanges.get(),s=>e(s)&&this.getRangeOfModifiedBaseRange(t,s,void 0).endLineNumberExclusive<i)||Xy(this.model.modifiedBaseRanges.get(),s=>e(s)))}toggleActiveConflict(e){const t=this.activeModifiedBaseRange.get();if(!t){this.notificationService.error(c(9198,"There is currently no conflict focused that can be toggled."));return}it(i=>{this.setState(t,this.model.getState(t).get().toggle(e),i,e)})}acceptAll(e){it(t=>{for(const i of this.model.modifiedBaseRanges.get())this.setState(i,this.model.getState(i).get().withInputValue(e,!0),t,e)})}};$w=D([u(6,te),u(7,Qe)],$w);class UN extends M{constructor(e){super(),this.model=e,this.attachedHistory=[],this.previousAltId=this.model.getAlternativeVersionId(),this._register(e.onDidChangeContent(t=>{const i=e.getAlternativeVersionId();if(t.isRedoing)for(const s of this.attachedHistory)this.previousAltId<s.altId&&s.altId<=i&&s.element.redo();else if(t.isUndoing)for(let s=this.attachedHistory.length-1;s>=0;s--){const o=this.attachedHistory[s];i<o.altId&&o.altId<=this.previousAltId&&o.element.undo()}else for(;this.attachedHistory.length>0&&this.attachedHistory[this.attachedHistory.length-1].altId>this.previousAltId;)this.attachedHistory.pop();this.previousAltId=i}))}pushAttachedHistoryElement(e){this.attachedHistory.push({altId:this.model.getAlternativeVersionId(),element:e})}}const sp=class sp extends M{constructor(e,t,i,s,o){super(),this.editor=e,this.overlayWidgetId=`fixedZoneWidget-${sp.counter++}`,this.widgetDomNode=Ct("div.fixed-zone-widget").root,this.overlayWidget={getId:()=>this.overlayWidgetId,getDomNode:()=>this.widgetDomNode,getPosition:()=>null},this.viewZoneId=t.addZone({domNode:ve("div"),afterLineNumber:i,heightInPx:s,ordinal:50001,onComputedHeight:r=>{this.widgetDomNode.style.height=`${r}px`},onDomNodeTop:r=>{this.widgetDomNode.style.top=`${r}px`}}),o.push(this.viewZoneId),this._register(K.runAndSubscribe(this.editor.onDidLayoutChange,()=>{this.widgetDomNode.style.left=this.editor.getLayoutInfo().contentLeft+"px"})),this.editor.addOverlayWidget(this.overlayWidget),this._register({dispose:()=>{this.editor.removeOverlayWidget(this.overlayWidget)}})}};sp.counter=0;let qw=sp;class Og extends M{constructor(e){super(),this._editor=e,this._register(this._editor.onDidChangeConfiguration(t=>{(t.hasChanged(li.fontInfo)||t.hasChanged(li.codeLensFontSize)||t.hasChanged(li.codeLensFontFamily))&&this._updateLensStyle()})),this._styleClassName="_conflictActionsFactory_"+Ep(this._editor.getId()).toString(16),this._styleElement=wp(OL(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,void 0,this._store),this._updateLensStyle()}_updateLensStyle(){const{codeLensHeight:e,fontSize:t}=this._getLayoutInfo(),i=this._editor.getOption(li.codeLensFontFamily),s=this._editor.getOption(li.fontInfo),o=`--codelens-font-family${this._styleClassName}`,r=`--codelens-font-features${this._styleClassName}`;let n=`
		.${this._styleClassName} { line-height: ${e}px; font-size: ${t}px; padding-right: ${Math.round(t*.5)}px; font-feature-settings: var(${r}) }
		.monaco-workbench .${this._styleClassName} span.codicon { line-height: ${e}px; font-size: ${t}px; }
		`;i&&(n+=`${this._styleClassName} { font-family: var(${o}), ${Tl.fontFamily}}`),this._styleElement.textContent=n,this._editor.getContainerDomNode().style?.setProperty(o,i??"inherit"),this._editor.getContainerDomNode().style?.setProperty(r,s.fontFeatureSettings)}_getLayoutInfo(){const e=Math.max(1.3,this._editor.getOption(li.lineHeight)/this._editor.getOption(li.fontSize));let t=this._editor.getOption(li.codeLensFontSize);return(!t||t<5)&&(t=this._editor.getOption(li.fontSize)*.9|0),{fontSize:t,codeLensHeight:t*e|0}}createWidget(e,t,i,s){const o=this._getLayoutInfo();return new zN(this._editor,e,t,o.codeLensHeight+2,this._styleClassName,i,s)}}class HN{constructor(e,t){this.viewModel=e,this.modifiedBaseRange=t,this.itemsInput1=this.getItemsInput(1),this.itemsInput2=this.getItemsInput(2),this.resultItems=fi(this,i=>{const s=this.viewModel,o=this.modifiedBaseRange,r=s.model.getState(o).read(i),n=s.model,d=[];if(r.kind===xr.unrecognized)d.push({text:c(9161,"Manual Resolution"),tooltip:c(9162,"This conflict has been resolved manually.")});else if(r.kind===xr.base)d.push({text:c(9163,"No Changes Accepted"),tooltip:c(9164,"The current resolution of this conflict equals the common ancestor of both the right and left changes.")});else{const h=[];r.includesInput1&&h.push(n.input1.title),r.includesInput2&&h.push(n.input2.title),r.kind===xr.both&&r.firstInput===2&&h.reverse(),d.push({text:`${h.join(" + ")}`})}const l=[];return r.includesInput1&&l.push(Bo(c(9165,"Remove {0}",n.input1.title),async()=>{it(h=>{n.setState(o,r.withInputValue(1,!1),!0,h),n.telemetry.reportRemoveInvoked(1,r.includesInput(2))})},c(9166,"Remove {0} from the result document.",n.input1.title))),r.includesInput2&&l.push(Bo(c(9165,"Remove {0}",n.input2.title),async()=>{it(h=>{n.setState(o,r.withInputValue(2,!1),!0,h),n.telemetry.reportRemoveInvoked(2,r.includesInput(1))})},c(9166,"Remove {0} from the result document.",n.input2.title))),r.kind===xr.both&&r.firstInput===2&&l.reverse(),d.push(...l),r.kind===xr.unrecognized&&d.push(Bo(c(9167,"Reset to base"),async()=>{it(h=>{n.setState(o,Jy.base,!0,h),n.telemetry.reportResetToBaseInvoked()})},c(9168,"Reset this conflict to the common ancestor of both the right and left changes."))),d}),this.isEmpty=fi(this,i=>this.itemsInput1.read(i).length+this.itemsInput2.read(i).length+this.resultItems.read(i).length===0),this.inputIsEmpty=fi(this,i=>this.itemsInput1.read(i).length+this.itemsInput2.read(i).length===0)}getItemsInput(e){return fi(t=>{const i=this.viewModel,s=this.modifiedBaseRange;if(!i.model.hasBaseRange(s))return[];const o=i.model.getState(s).read(t),r=i.model.isHandled(s).read(t),n=i.model,d=[],l=e===1?i.model.input1:i.model.input2,h=i.showNonConflictingChanges.read(t);if(!s.isConflicting&&r&&!h)return[];const p=e===1?2:1;if(o.kind!==xr.unrecognized&&!o.isInputIncluded(e)){if(!o.isInputIncluded(p)||!this.viewModel.shouldUseAppendInsteadOfAccept.read(t)){if(d.push(Bo(c(9169,"Accept {0}",l.title),async()=>{it(g=>{n.setState(s,o.withInputValue(e,!0,!1),e,g),n.telemetry.reportAcceptInvoked(e,o.includesInput(p))})},c(9170,"Accept {0} in the result document.",l.title))),s.canBeCombined){const g=s.isOrderRelevant?c(9171,"Accept Combination ({0} First)",l.title):c(9172,"Accept Combination");d.push(Bo(g,async()=>{it(f=>{n.setState(s,Jy.base.withInputValue(e,!0).withInputValue(p,!0,!0),!0,f),n.telemetry.reportSmartCombinationInvoked(o.includesInput(p))})},c(9173,"Accept an automatic combination of both sides in the result document.")))}}else d.push(Bo(c(9174,"Append {0}",l.title),async()=>{it(g=>{n.setState(s,o.withInputValue(e,!0,!1),e,g),n.telemetry.reportAcceptInvoked(e,o.includesInput(p))})},c(9175,"Append {0} to the result document.",l.title))),s.canBeCombined&&d.push(Bo(c(9176,"Accept Combination",l.title),async()=>{it(g=>{n.setState(s,o.withInputValue(e,!0,!0),e,g),n.telemetry.reportSmartCombinationInvoked(o.includesInput(p))})},c(9173,"Accept an automatic combination of both sides in the result document.")));n.isInputHandled(s,e).read(t)||d.push(Bo(c(9177,"Ignore"),async()=>{it(g=>{n.setInputHandled(s,e,!0,g)})},c(9178,"Don't take this side of the conflict.")))}return d})}}function Bo(a,e,t){return{text:a,action:e,tooltip:t}}class zN extends qw{constructor(e,t,i,s,o,r,n){super(e,t,i,s,n),this._domNode=Ct("div.merge-editor-conflict-actions").root,this.widgetDomNode.appendChild(this._domNode),this._domNode.classList.add(o),this._register(ts(d=>{const l=r.read(d);this.setState(l)}))}setState(e){const t=[];let i=!0;for(const s of e){i?i=!1:t.push(N("span",void 0,"|"));const o=ws(s.text);s.action?t.push(N("a",{title:s.tooltip,role:"button",onclick:()=>s.action()},...o)):t.push(N("span",{title:s.tooltip},...o))}ms(this._domNode,...t)}}function $N(a){const e=HC(a.input1Diffs.flatMap(n=>n.rangeMappings),a.baseRange.toExclusiveRange(),a.input1Range.toExclusiveRange()),t=HC(a.input2Diffs.flatMap(n=>n.rangeMappings),a.baseRange.toExclusiveRange(),a.input2Range.toExclusiveRange()),i=qN(e,t);let s=[];s.push([a.input1Range.startLineNumber-1,a.baseRange.startLineNumber-1,a.input2Range.startLineNumber-1]);function o(n){return n.every(d=>d!==void 0)}for(const n of i){const d=[n.output1Pos?.lineNumber,n.inputPos.lineNumber,n.output2Pos?.lineNumber],l=o(d);let h=!0;if(l){const p=!s.some(g=>o(g)&&g.some((f,m)=>f!==void 0&&f===d[m]));p&&(s=s.filter(g=>!g.some((f,m)=>f!==void 0&&f===d[m]))),h=p}else h=!s.some(g=>g.some((f,m)=>f!==void 0&&f===d[m]));h?s.push(d):n.length.isGreaterThan(new ML(1,0))&&s.push([n.output1Pos?n.output1Pos.lineNumber+1:void 0,n.inputPos.lineNumber+1,n.output2Pos?n.output2Pos.lineNumber+1:void 0])}const r=[a.input1Range.endLineNumberExclusive,a.baseRange.endLineNumberExclusive,a.input2Range.endLineNumberExclusive];return s=s.filter(n=>n.every((d,l)=>d!==r[l])),s.push(r),rf(()=>bg(s.map(n=>n[0]).filter(fo),(n,d)=>n<d)&&bg(s.map(n=>n[1]).filter(fo),(n,d)=>n<=d)&&bg(s.map(n=>n[2]).filter(fo),(n,d)=>n<d)&&s.every(n=>n.filter(fo).length>=2)),s}function HC(a,e,t){const i=[];let s=e.getStartPosition(),o=t.getStartPosition();for(const n of a){const d=new Zy(ze.fromPositions(s,n.inputRange.getStartPosition()),ze.fromPositions(o,n.outputRange.getStartPosition()));rf(()=>yl(d.inputRange).equals(yl(d.outputRange))),d.inputRange.isEmpty()||i.push(d),s=n.inputRange.getEndPosition(),o=n.outputRange.getEndPosition()}const r=new Zy(ze.fromPositions(s,e.getEndPosition()),ze.fromPositions(o,t.getEndPosition()));return rf(()=>yl(r.inputRange).equals(yl(r.outputRange))),r.inputRange.isEmpty()||i.push(r),i}function qN(a,e){const t=[],i=[];for(const[r,n]of[[0,a],[1,e]])for(const d of n)i.push({input:r,start:!0,inputPos:d.inputRange.getStartPosition(),outputPos:d.outputRange.getStartPosition()}),i.push({input:r,start:!1,inputPos:d.inputRange.getEndPosition(),outputPos:d.outputRange.getEndPosition()});i.sort(NL(r=>r.inputPos,Dl.compare));const s=[void 0,void 0];let o;for(const r of i){if(o&&s.some(n=>!!n)){const n=FL(o,r.inputPos);n.isZero()||(t.push({inputPos:o,length:n,output1Pos:s[0],output2Pos:s[1]}),s[0]&&(s[0]=Qy(s[0],n)),s[1]&&(s[1]=Qy(s[1],n)))}s[r.input]=r.start?r.outputPos:void 0,o=r.inputPos}return t}class jN{constructor(e,t,i){this.input1Editor=e,this.input2Editor=t,this.resultEditor=i,this.conflictActionsFactoryInput1=new Og(this.input1Editor),this.conflictActionsFactoryInput2=new Og(this.input2Editor),this.conflictActionsFactoryResult=new Og(this.resultEditor)}computeViewZones(e,t,i){let s=0,o=0,r=0,n=0;const d=[],l=[],h=[],p=[],g=t.model,f=g.baseResultDiffs.read(e),m=h_(g.modifiedBaseRanges.read(e),f,(W,Y)=>W.baseRange.intersectsOrTouches(Y.inputRange)?u_.neitherLessOrGreaterThan:Bp.compareByStart(W.baseRange,Y.inputRange)),v=i.codeLensesVisible,E=i.showNonConflictingChanges;let x,G;for(const W of m){if(v&&W.left&&(W.left.isConflicting||E||!g.isHandled(W.left).read(e))){const H=new HN(t,W.left);(i.shouldAlignResult||!H.inputIsEmpty.read(e))&&(d.push(new Mg(this.conflictActionsFactoryInput1,W.left.input1Range.startLineNumber-1,H.itemsInput1)),l.push(new Mg(this.conflictActionsFactoryInput2,W.left.input2Range.startLineNumber-1,H.itemsInput2)),i.shouldAlignBase&&h.push(new XN(W.left.baseRange.startLineNumber-1,16)));const ie=W.left.baseRange.startLineNumber+(G?.resultingDeltaFromOriginalToModified??0)-1;p.push(new Mg(this.conflictActionsFactoryResult,ie,H.resultItems))}const Y=W.rights.at(-1);Y&&(G=Y);let $;W.left?($=$N(W.left).map(H=>({input1Line:H[0],baseLine:H[1],input2Line:H[2],resultLine:void 0})),x=W.left,$[$.length-1].resultLine=W.left.baseRange.endLineNumberExclusive+(G?G.resultingDeltaFromOriginalToModified:0)):$=[{baseLine:Y.inputRange.endLineNumberExclusive,input1Line:Y.inputRange.endLineNumberExclusive+(x?x.input1Range.endLineNumberExclusive-x.baseRange.endLineNumberExclusive:0),input2Line:Y.inputRange.endLineNumberExclusive+(x?x.input2Range.endLineNumberExclusive-x.baseRange.endLineNumberExclusive:0),resultLine:Y.outputRange.endLineNumberExclusive}];for(const{input1Line:H,baseLine:ie,input2Line:q,resultLine:ae}of $){if(!i.shouldAlignBase&&(H===void 0||q===void 0))continue;const $e=H!==void 0?H+s:-1,vt=q!==void 0?q+o:-1,Ci=ie+r,Et=ae!==void 0?ae+n:-1,Gi=Math.max(i.shouldAlignBase?Ci:0,$e,vt,i.shouldAlignResult?Et:0);if(H!==void 0){const Ft=Gi-$e;Ft>0&&(d.push(new _l(H-1,Ft)),s+=Ft)}if(q!==void 0){const Ft=Gi-vt;Ft>0&&(l.push(new _l(q-1,Ft)),o+=Ft)}if(i.shouldAlignBase){const Ft=Gi-Ci;Ft>0&&(h.push(new _l(ie-1,Ft)),r+=Ft)}if(i.shouldAlignResult&&ae!==void 0){const Ft=Gi-Et;Ft>0&&(p.push(new _l(ae-1,Ft)),n+=Ft)}}}return new YN(d,l,h,p)}}class YN{constructor(e,t,i,s){this.input1ViewZones=e,this.input2ViewZones=t,this.baseViewZones=i,this.resultViewZones=s}}class Vv{}class _l extends Vv{constructor(e,t){super(),this.afterLineNumber=e,this.heightInLines=t}create(e,t,i){t.push(e.addZone({afterLineNumber:this.afterLineNumber,heightInLines:this.heightInLines,domNode:N("div.diagonal-fill")}))}}class XN extends Vv{constructor(e,t){super(),this.afterLineNumber=e,this.heightPx=t}create(e,t,i){t.push(e.addZone({afterLineNumber:this.afterLineNumber,heightInPx:this.heightPx,domNode:N("div.conflict-actions-placeholder")}))}}class Mg extends Vv{constructor(e,t,i){super(),this.conflictActionsFactory=e,this.lineNumber=t,this.items=i}create(e,t,i){i.add(this.conflictActionsFactory.createWidget(e,this.lineNumber,this.items,t))}}const JN=De("settings.headerForeground",{light:"#444444",dark:"#e7e7e7",hcDark:"#ffffff",hcLight:"#292929"},c(10153,"The foreground color for a section header or active title."));De("settings.settingsHeaderHoverForeground",Pn(JN,.7),c(10154,"The foreground color for a section header or hovered title."));De("settings.modifiedItemIndicator",{light:new ki(new Cl(102,175,224)),dark:new ki(new Cl(12,125,157)),hcDark:new ki(new Cl(0,73,122)),hcLight:new ki(new Cl(102,175,224))},c(10155,"The color of the modified setting indicator."));De("settings.headerBorder",Zl,c(10156,"The color of the header container border."));const ZN=De("settings.sashBorder",Zl,c(10157,"The color of the Settings editor splitview sash border."));De("settings.dropdownBackground",BL,c(10158,"Settings editor dropdown background."));De("settings.dropdownForeground",GL,c(10159,"Settings editor dropdown foreground."));De("settings.dropdownBorder",WL,c(10160,"Settings editor dropdown border."));De("settings.dropdownListBorder",KL,c(10161,"Settings editor dropdown list border. This surrounds the options and separates the options from the description."));De("settings.checkboxBackground",UL,c(10162,"Settings editor checkbox background."));De("settings.checkboxForeground",HL,c(10163,"Settings editor checkbox foreground."));De("settings.checkboxBorder",zL,c(10164,"Settings editor checkbox border."));De("settings.textInputBackground",p_,c(10165,"Settings editor text input box background."));De("settings.textInputForeground",g_,c(10166,"Settings editor text input box foreground."));De("settings.textInputBorder",f_,c(10167,"Settings editor text input box border."));De("settings.numberInputBackground",p_,c(10168,"Settings editor number input box background."));De("settings.numberInputForeground",g_,c(10169,"Settings editor number input box foreground."));De("settings.numberInputBorder",f_,c(10170,"Settings editor number input box border."));De("settings.focusedRowBackground",{dark:Pn(ah,.6),light:Pn(ah,.6),hcDark:null,hcLight:null},c(10171,"The background color of a settings row when focused."));De("settings.rowHoverBackground",{dark:Pn(ah,.3),light:Pn(ah,.3),hcDark:null,hcLight:null},c(10172,"The background color of a settings row when hovered."));De("settings.focusedRowBorder",$L,c(10173,"The color of the row's top and bottom border when the row is focused."));let ru=class extends Lv{constructor(e,t,i,s,o){super(i,t,o),this.inputNumber=e,this.otherInputNumber=this.inputNumber===1?2:1,this.modifiedBaseRangeGutterItemInfos=eC({debugName:`input${this.inputNumber}.modifiedBaseRangeGutterItemInfos`},r=>{const n=this.viewModel.read(r);if(!n)return[];const d=n.model,l=this.inputNumber,h=n.showNonConflictingChanges.read(r);return d.modifiedBaseRanges.read(r).filter(p=>p.getInputDiffs(this.inputNumber).length>0&&(h||p.isConflicting||!d.isHandled(p).read(r))).map((p,g)=>new QN(g.toString(),p,l,n))}),this.decorations=eC({debugName:`input${this.inputNumber}.decorations`},r=>{const n=this.viewModel.read(r);if(!n)return[];const d=n.model,l=(this.inputNumber===1?d.input1:d.input2).textModel,h=n.activeModifiedBaseRange.read(r),p=new Array,g=n.showNonConflictingChanges.read(r),f=this.showDeletionMarkers.read(r),v=!(n.baseCodeEditorView.read(r)!==void 0&&n.baseShowDiffAgainst.read(r)===this.inputNumber)&&this.useSimplifiedDecorations.read(r);for(const E of d.modifiedBaseRanges.read(r)){const x=E.getInputRange(this.inputNumber);if(!x)continue;const G=["merge-editor-block"];let W=[0,0,0,0];const Y=d.isInputHandled(E,this.inputNumber).read(r);Y&&G.push("handled"),E===h&&(G.push("focused"),W=[0,2,0,2]),E.isConflicting&&G.push("conflicting");const $=this.inputNumber===1?"input i1":"input i2";if(G.push($),!(!E.isConflicting&&!g&&Y)&&(v&&!Y&&G.push("use-simplified-decorations"),p.push({range:x.toInclusiveRangeOrEmpty(),options:{showIfCollapsed:!0,blockClassName:G.join(" "),blockPadding:W,blockIsAfterEnd:x.startLineNumber>l.getLineCount(),description:"Merge Editor",minimap:{position:Qb.Gutter,color:{id:Y?nd:ad}},overviewRuler:E.isConflicting?{position:md.Center,color:{id:Y?nd:ad}}:void 0}}),!v&&(E.isConflicting||!d.isHandled(E).read(r)))){const H=E.getInputDiffs(this.inputNumber);for(const ie of H){const q=ie.outputRange.toInclusiveRange();if(q&&p.push({range:q,options:{className:`merge-editor-diff ${$}`,description:"Merge Editor",isWholeLine:!0}}),ie.rangeMappings)for(const ae of ie.rangeMappings)(f||!ae.outputRange.isEmpty())&&p.push({range:ae.outputRange,options:{className:ae.outputRange.isEmpty()?`merge-editor-diff-empty-word ${$}`:`merge-editor-diff-word ${$}`,description:"Merge Editor",showIfCollapsed:!0}})}}}return p}),this.htmlElements.root.classList.add("input"),this._register(new xv(this.editor,this.htmlElements.gutterDiv,{getIntersectingGutterItems:(r,n)=>this.checkboxesVisible.read(n)?this.modifiedBaseRangeGutterItemInfos.read(n):[],createView:(r,n)=>new e0(r,n,s)})),this._register(Rv(this,(r,n)=>n.model.translateBaseRangeToInput(this.inputNumber,r))),this._register(i.createInstance(Uc,e===1?b.MergeInput1Toolbar:b.MergeInput2Toolbar,this.htmlElements.toolbar)),this._register(qL({debugName:`input${this.inputNumber}: update labels & text model`},r=>{const n=this.viewModel.read(r);if(!n)return;this.editor.setModel(this.inputNumber===1?n.model.input1.textModel:n.model.input2.textModel);const d=this.inputNumber===1?n.model.input1.title||c(9182,"Input 1"):n.model.input2.title||c(9183,"Input 2"),l=this.inputNumber===1?n.model.input1.description:n.model.input2.description,h=this.inputNumber===1?n.model.input1.detail:n.model.input2.detail;ms(this.htmlElements.title,...ws(d)),ms(this.htmlElements.description,...l?ws(l):[]),ms(this.htmlElements.detail,...h?ws(h):[])})),this._register(tv(this.editor,this.decorations))}};ru=D([u(2,z),u(3,st),u(4,te)],ru);class QN{constructor(e,t,i,s){this.id=e,this.baseRange=t,this.inputNumber=i,this.viewModel=s,this.model=this.viewModel.model,this.range=this.baseRange.getInputRange(this.inputNumber),this.enabled=this.model.isUpToDate,this.toggleState=fi(this,o=>{const r=this.model.getState(this.baseRange).read(o).getInput(this.inputNumber);return r===da.second&&!this.baseRange.isOrderRelevant?da.first:r}),this.state=fi(this,o=>{const r=this.viewModel.activeModifiedBaseRange.read(o);return this.model.hasBaseRange(this.baseRange)?{handled:this.model.isHandled(this.baseRange).read(o),focused:this.baseRange===r}:{handled:!1,focused:!1}})}setState(e,t){this.viewModel.setState(this.baseRange,this.model.getState(this.baseRange).get().withInputValue(this.inputNumber,e),t,this.inputNumber)}toggleBothSides(){it(e=>{const t=this.model.getState(this.baseRange).get();this.model.setState(this.baseRange,t.toggle(this.inputNumber).toggle(this.inputNumber===1?2:1),!0,e)})}getContextMenuActions(){const e=this.model.getState(this.baseRange).get(),t=this.model.isHandled(this.baseRange).get(),i=r=>{it(n=>this.viewModel.setState(this.baseRange,r,n,this.inputNumber))};function s(r,n,d,l){const h=new Je(r,n,void 0,!0,()=>{i(d)});return h.checked=l,h}const o=e.includesInput1&&e.includesInput2;return[this.baseRange.input1Diffs.length>0?s("mergeEditor.acceptInput1",c(9184,"Accept {0}",this.model.input1.title),e.toggle(1),e.includesInput1):void 0,this.baseRange.input2Diffs.length>0?s("mergeEditor.acceptInput2",c(9184,"Accept {0}",this.model.input2.title),e.toggle(2),e.includesInput2):void 0,this.baseRange.isConflicting?vg(s("mergeEditor.acceptBoth",c(9185,"Accept Both"),e.withInputValue(1,!o).withInputValue(2,!o),o),{enabled:this.baseRange.canBeCombined}):void 0,new ys,this.baseRange.isConflicting?vg(s("mergeEditor.swap",c(9186,"Swap"),e.swap(),!1),{enabled:!e.kind&&(!o||this.baseRange.isOrderRelevant)}):void 0,vg(new Je("mergeEditor.markAsHandled",c(9187,"Mark as Handled"),void 0,!0,()=>{it(r=>{this.model.setHandled(this.baseRange,!t,r)})}),{checked:t})].filter(fo)}}class e0 extends M{constructor(e,t,i){super(),this.isMultiLine=hs(this,!1),this.item=hs(this,e);const s=new jL({isChecked:!1,title:"",icon:P.check,...hE});s.domNode.classList.add("accept-conflict-group"),this._register(X(s.domNode,Q.MOUSE_DOWN,o=>{const r=this.item.get();r&&(o.button===2?(o.stopPropagation(),o.preventDefault(),i.showContextMenu({getAnchor:()=>s.domNode,getActions:()=>r.getContextMenuActions()})):o.button===1&&(o.stopPropagation(),o.preventDefault(),r.toggleBothSides()))})),this._register(ts(o=>{const r=this.item.read(o),n=r.toggleState.read(o),l={[da.excluded]:{icon:void 0,checked:!1,title:c(9188,"Accept")},[da.unrecognized]:{icon:P.circleFilled,checked:!1,title:c(9189,"Accept (result is dirty)")},[da.first]:{icon:P.check,checked:!0,title:c(9190,"Undo accept")},[da.second]:{icon:P.checkAll,checked:!0,title:c(9191,"Undo accept (currently second)")}}[n];s.setIcon(l.icon),s.checked=l.checked,s.setTitle(l.title),r.enabled.read(o)?s.enable():s.disable()})),this._register(ts(o=>{const r=this.item.read(o).state.read(o),n=["merge-accept-gutter-marker",r.handled&&"handled",r.focused&&"focused",this.isMultiLine.read(o)?"multi-line":"single-line"];t.className=n.filter(d=>typeof d=="string").join(" ")})),this._register(s.onChange(()=>{it(o=>{this.item.get().setState(s.checked,o)})})),t.appendChild(Ct("div.background",[YL]).root),t.appendChild(this.checkboxDiv=Ct("div.checkbox",[Ct("div.checkbox-background",[s.domNode])]).root)}layout(e,t,i,s){const o=this.checkboxDiv.clientHeight,r=t/2-o/2,n=o;let d=e+r;const l=[n,i+s-n-o],h=[e+n,e+t-o-n];h[0]<h[1]&&(d=dh(d,l[0],l[1]),d=dh(d,h[0],h[1])),this.checkboxDiv.style.top=`${d-e}px`,it(p=>{this.isMultiLine.set(t>30,p)})}update(e){it(t=>{this.item.set(e,t)})}}let jw=class extends Lv{constructor(e,t,i,s){super(t,e,s),this._labelService=i,this.decorations=fi(this,r=>{const n=this.viewModel.read(r);if(!n)return[];const d=n.model,l=d.resultTextModel,h=new Array,p=h_(d.modifiedBaseRanges.read(r),d.baseResultDiffs.read(r),(m,v)=>m.baseRange.intersectsOrTouches(v.inputRange)?u_.neitherLessOrGreaterThan:Bp.compareByStart(m.baseRange,v.inputRange)),g=n.activeModifiedBaseRange.read(r),f=n.showNonConflictingChanges.read(r);for(const m of p){const v=m.left;if(v){const E=["merge-editor-block"];let x=[0,0,0,0];const G=d.isHandled(v).read(r);if(G&&E.push("handled"),v===g&&(E.push("focused"),x=[0,2,0,2]),v.isConflicting&&E.push("conflicting"),E.push("result"),!v.isConflicting&&!f&&G)continue;const W=d.getLineRangeInResult(v.baseRange,r);h.push({range:W.toInclusiveRangeOrEmpty(),options:{showIfCollapsed:!0,blockClassName:E.join(" "),blockPadding:x,blockIsAfterEnd:W.startLineNumber>l.getLineCount(),description:"Result Diff",minimap:{position:Qb.Gutter,color:{id:G?nd:ad}},overviewRuler:v.isConflicting?{position:md.Center,color:{id:G?nd:ad}}:void 0}})}if(!v||v.isConflicting)for(const E of m.rights){const x=E.outputRange.toInclusiveRange();if(x&&h.push({range:x,options:{className:"merge-editor-diff result",description:"Merge Editor",isWholeLine:!0}}),E.rangeMappings)for(const G of E.rangeMappings)h.push({range:G.outputRange,options:{className:"merge-editor-diff-word result",description:"Merge Editor"}})}}return h}),this.editor.invokeWithinContext(r=>{const n=r.get(de),d=XL.bindTo(n);d.set(!0),this._register(pe(()=>d.reset()))}),this.htmlElements.gutterDiv.style.width="5px",this.htmlElements.root.classList.add("result"),this._register(ev((r,n)=>{this.checkboxesVisible.read(r)&&n.add(new xv(this.editor,this.htmlElements.gutterDiv,{getIntersectingGutterItems:(d,l)=>[],createView:(d,l)=>{throw new Qa}}))})),this._register(ts(r=>{const n=this.viewModel.read(r);n&&(this.editor.setModel(n.model.resultTextModel),ms(this.htmlElements.title,...ws(c(9192,"Result"))),ms(this.htmlElements.description,...ws(this._labelService.getUriLabel(n.model.resultTextModel.uri,{relative:!0}))))}));const o=this._register(new Sr(this.htmlElements.detail));this._register(ts(r=>{const n=this.viewModel.read(r);if(!n)return;const d=n.model;if(!d)return;const l=d.unhandledConflictsCount.read(r),h=l===1?c(9193,"{0} Conflict Remaining",l):c(9194,"{0} Conflicts Remaining ",l);o.clear(),o.push({class:void 0,enabled:l>0,id:"nextConflict",label:h,run(){n.model.telemetry.reportConflictCounterClicked(),n.goToNextModifiedBaseRange(p=>!d.isHandled(p).read(void 0))},tooltip:l>0?c(9195,"Go to next conflict"):c(9196,"All conflicts handled, the merge can be completed now.")})})),this._register(tv(this.editor,this.decorations)),this._register(Rv(this,(r,n)=>n.model.translateBaseRangeToResult(r))),this._register(t.createInstance(Uc,b.MergeInputResultToolbar,this.htmlElements.toolbar))}};jw=D([u(1,z),u(2,rs),u(3,te)],jw);var Yw,Ol;xe(GN);var yn;let ii=(yn=class extends Ac{get viewModel(){return this._viewModel}get inputModel(){return this._inputModel}get model(){return this.inputModel.get()?.model}constructor(e,t,i,s,o,r,n,d,l,h,p){super(Yw.ID,e,s,t,o,n,r,d,l,h),this.contextKeyService=i,this._codeEditorService=p,this._sessionDisposables=new B,this._viewModel=hs(this,void 0),this._grid=this._register(new Ae),this.input1View=this._register(this.instantiationService.createInstance(ru,1,this._viewModel)),this.baseView=hs(this,void 0),this.baseViewOptions=hs(this,void 0),this.input2View=this._register(this.instantiationService.createInstance(ru,2,this._viewModel)),this.inputResultView=this._register(this.instantiationService.createInstance(jw,this._viewModel)),this._layoutMode=this.instantiationService.createInstance(Xw),this._layoutModeObs=hs(this,this._layoutMode.value),this._ctxIsMergeEditor=Ke.bindTo(this.contextKeyService),this._ctxUsesColumnLayout=wd.bindTo(this.contextKeyService),this._ctxShowBase=Gp.bindTo(this.contextKeyService),this._ctxShowBaseAtTop=iv.bindTo(this.contextKeyService),this._ctxResultUri=JL.bindTo(this.contextKeyService),this._ctxBaseUri=ZL.bindTo(this.contextKeyService),this._ctxShowNonConflictingChanges=m_.bindTo(this.contextKeyService),this._inputModel=hs(this,void 0),this.viewZoneComputer=new jN(this.input1View.editor,this.input2View.editor,this.inputResultView.editor),this.scrollSynchronizer=this._register(new KN(this._viewModel,this.input1View,this.input2View,this.baseView,this.inputResultView,this._layoutModeObs)),this._onDidChangeSizeConstraints=new A,this.onDidChangeSizeConstraints=this._onDidChangeSizeConstraints.event,this.baseViewDisposables=this._register(new B),this.showNonConflictingChangesStore=this.instantiationService.createInstance(QL,"mergeEditor/showNonConflictingChanges"),this.showNonConflictingChanges=hs(this,this.showNonConflictingChangesStore.get()??!1)}dispose(){this._sessionDisposables.dispose(),this._ctxIsMergeEditor.reset(),this._ctxUsesColumnLayout.reset(),this._ctxShowNonConflictingChanges.reset(),super.dispose()}get minimumWidth(){return this._layoutMode.value.kind==="mixed"?this.input1View.view.minimumWidth+this.input2View.view.minimumWidth:this.input1View.view.minimumWidth+this.input2View.view.minimumWidth+this.inputResultView.view.minimumWidth}getTitle(){return this.input?this.input.getName():c(9197,"Text Merge Editor")}createEditorControl(e,t){this.rootHtmlElement=e,e.classList.add("merge-editor"),this.applyLayout(this._layoutMode.value),this.applyOptions(t)}updateEditorControlOptions(e){this.applyOptions(e)}applyOptions(e){const t=tC(e,{minimap:{enabled:!1},glyphMargin:!1,lineNumbersMinChars:2}),i=tC(t,{readOnly:!0,readOnlyMessage:void 0});this.input1View.updateOptions(i),this.input2View.updateOptions(i),this.baseViewOptions.set({...this.input2View.editor.getRawOptions()},void 0),this.inputResultView.updateOptions(t)}getMainControl(){return this.inputResultView.editor}layout(e){this._grid.value?.layout(e.width,e.height)}async setInput(e,t,i,s){if(!(e instanceof Zo))throw new Qa("ONLY MergeEditorInput is supported");await super.setInput(e,t,i,s),this._sessionDisposables.clear(),it(g=>{this._viewModel.set(void 0,g),this._inputModel.set(void 0,g)});const o=await e.resolve(),r=o.model,n=this.instantiationService.createInstance($w,r,this.input1View,this.input2View,this.inputResultView,this.baseView,this.showNonConflictingChanges);r.telemetry.reportMergeEditorOpened({combinableConflictCount:r.combinableConflictCount,conflictCount:r.conflictCount,baseTop:this._layoutModeObs.get().showBaseAtTop,baseVisible:this._layoutModeObs.get().showBase,isColumnView:this._layoutModeObs.get().kind==="columns"}),it(g=>{this._viewModel.set(n,g),this._inputModel.set(o,g)}),this._sessionDisposables.add(n),this._sessionDisposables.add(ts(g=>{const f=n.focusedEditorType.read(g);e instanceof Zo&&e.updateFocusedEditor(f||"result")})),this._ctxResultUri.set(o.resultUri.toString()),this._ctxBaseUri.set(r.base.uri.toString()),this._sessionDisposables.add(pe(()=>{this._ctxBaseUri.reset(),this._ctxResultUri.reset()}));const d=new B;this._sessionDisposables.add(d),this._sessionDisposables.add(ev(g=>{const f=this.baseView.read(g),m=this.inputResultView.editor.getScrollTop();this.scrollSynchronizer.stopSync(),d.clear(),this.inputResultView.editor.changeViewZones(v=>{const E=this._layoutModeObs.read(g),x=E.kind==="columns",G=E.kind==="mixed"&&!E.showBaseAtTop;this.input1View.editor.changeViewZones(W=>{this.input2View.editor.changeViewZones(Y=>{f?f.editor.changeViewZones($=>{d.add(this.setViewZones(g,n,this.input1View.editor,W,this.input2View.editor,Y,f.editor,$,G,this.inputResultView.editor,v,x))}):d.add(this.setViewZones(g,n,this.input1View.editor,W,this.input2View.editor,Y,void 0,void 0,!1,this.inputResultView.editor,v,x))})})}),this.inputResultView.editor.setScrollTop(m,Nt.Smooth),this.scrollSynchronizer.startSync(),this.scrollSynchronizer.updateScrolling()}));const l=this.loadEditorViewState(e,i);l?this._applyViewState(l):this._sessionDisposables.add(eR(r.onInitialized,()=>{const g=r.modifiedBaseRanges.get().find(f=>f.isConflicting);g&&(this.input1View.editor.revealLineInCenter(g.input1Range.startLineNumber),it(f=>{n.setActiveModifiedBaseRange(g,f)}))}));const h=g=>{const f=tR(g,this._codeEditorService);Sl(r.input2.textModel,f,this._codeEditorService),Sl(r.input1.textModel,f,this._codeEditorService),Sl(r.resultTextModel,f,this._codeEditorService);const m=this.baseView.get()?.editor.getModel();m&&Sl(m,f,this._codeEditorService)};this._sessionDisposables.add(this._codeEditorService.onDidChangeTransientModelProperty(g=>{h(g)})),h(this.inputResultView.editor.getModel());const p=this;this._sessionDisposables.add(new class{constructor(){this._disposable=new B;for(const g of this.baseInput1Input2())this._disposable.add(g.onDidChangeContent(()=>this._checkBaseInput1Input2AllEmpty()))}dispose(){this._disposable.dispose()}*baseInput1Input2(){yield r.base,yield r.input1.textModel,yield r.input2.textModel}_checkBaseInput1Input2AllEmpty(){for(const g of this.baseInput1Input2())if(g.getValueLength()>0)return;p.editorService.replaceEditors([{editor:e,replacement:{resource:e.result,options:{preserveFocus:!0}},forceReplaceDirty:!0}],p.group)}})}setViewZones(e,t,i,s,o,r,n,d,l,h,p,g){const f=[],m=[],v=[],E=[],x=this.viewZoneComputer.computeViewZones(e,t,{codeLensesVisible:!0,showNonConflictingChanges:this.showNonConflictingChanges.read(e),shouldAlignBase:l,shouldAlignResult:g}),G=new B;if(d)for(const W of x.baseViewZones)W.create(d,v,G);for(const W of x.resultViewZones)W.create(p,E,G);for(const W of x.input1ViewZones)W.create(s,f,G);for(const W of x.input2ViewZones)W.create(r,m,G);return G.add({dispose:()=>{i.changeViewZones(W=>{for(const Y of f)W.removeZone(Y)}),o.changeViewZones(W=>{for(const Y of m)W.removeZone(Y)}),n?.changeViewZones(W=>{for(const Y of v)W.removeZone(Y)}),h.changeViewZones(W=>{for(const Y of E)W.removeZone(Y)})}}),G}setOptions(e){super.setOptions(e),e&&Tn(e,this.inputResultView.editor,Nt.Smooth)}clearInput(){super.clearInput(),this._sessionDisposables.clear();for(const{editor:e}of[this.input1View,this.input2View,this.inputResultView])e.setModel(null)}focus(){super.focus(),(this.getControl()??this.inputResultView.editor).focus()}hasFocus(){for(const{editor:e}of[this.input1View,this.input2View,this.inputResultView])if(e.hasTextFocus())return!0;return super.hasFocus()}setEditorVisible(e){super.setEditorVisible(e);for(const{editor:t}of[this.input1View,this.input2View,this.inputResultView])e?t.onVisible():t.onHide();this._ctxIsMergeEditor.set(e)}getControl(){return this.inputResultView.editor}get scopedContextKeyService(){return this.getControl()?.invokeWithinContext(t=>t.get(de))}toggleBase(){this.setLayout({...this._layoutMode.value,showBase:!this._layoutMode.value.showBase})}toggleShowBaseTop(){const e=this._layoutMode.value.showBase&&this._layoutMode.value.showBaseAtTop;this.setLayout({...this._layoutMode.value,showBaseAtTop:!0,showBase:!e})}toggleShowBaseCenter(){const e=this._layoutMode.value.showBase&&!this._layoutMode.value.showBaseAtTop;this.setLayout({...this._layoutMode.value,showBaseAtTop:!1,showBase:!e})}setLayoutKind(e){this.setLayout({...this._layoutMode.value,kind:e})}setLayout(e){const t=this._layoutMode.value;JSON.stringify(t)!==JSON.stringify(e)&&(this.model?.telemetry.reportLayoutChange({baseTop:e.showBaseAtTop,baseVisible:e.showBase,isColumnView:e.kind==="columns"}),this.applyLayout(e))}applyLayout(e){it(t=>{if(e.showBase&&!this.baseView.get()){this.baseViewDisposables.clear();const i=this.baseViewDisposables.add(this.instantiationService.createInstance(zw,this.viewModel));this.baseViewDisposables.add(ts(s=>{const o=this.baseViewOptions.read(s);o&&i.updateOptions(o)})),this.baseView.set(i,t)}else!e.showBase&&this.baseView.get()&&(this.baseView.set(void 0,t),this.baseViewDisposables.clear());e.kind==="mixed"?this.setGrid([e.showBaseAtTop&&e.showBase?{size:38,data:this.baseView.get().view}:void 0,{size:38,groups:[{data:this.input1View.view},!e.showBaseAtTop&&e.showBase?{data:this.baseView.get().view}:void 0,{data:this.input2View.view}].filter(fo)},{size:62,data:this.inputResultView.view}].filter(fo)):e.kind==="columns"&&this.setGrid([e.showBase?{size:40,data:this.baseView.get().view}:void 0,{size:60,groups:[{data:this.input1View.view},{data:this.inputResultView.view},{data:this.input2View.view}]}].filter(fo)),this._layoutMode.value=e,this._ctxUsesColumnLayout.set(e.kind),this._ctxShowBase.set(e.showBase),this._ctxShowBaseAtTop.set(e.showBaseAtTop),this._onDidChangeSizeConstraints.fire(),this._layoutModeObs.set(e,t)})}setGrid(e){let t=-1,i=-1;this._grid.value&&(t=this._grid.value.width,i=this._grid.value.height),this._grid.value=Yo.from({orientation:le.VERTICAL,size:100,groups:e},{styles:{separatorBorder:this.theme.getColor(ZN)??ki.transparent},proportionalLayout:!0}),ms(this.rootHtmlElement,this._grid.value.element),t!==-1&&this._grid.value.layout(t,i)}_applyViewState(e){e&&(this.inputResultView.editor.restoreViewState(e),e.input1State&&this.input1View.editor.restoreViewState(e.input1State),e.input2State&&this.input2View.editor.restoreViewState(e.input2State),e.focusIndex>=0&&[this.input1View.editor,this.input2View.editor,this.inputResultView.editor][e.focusIndex].focus())}computeEditorViewState(e){if(!qe(this.inputModel.get()?.resultUri,e))return;const t=this.inputResultView.editor.saveViewState();if(!t)return;const i=this.input1View.editor.saveViewState()??void 0,s=this.input2View.editor.saveViewState()??void 0,o=[this.input1View.editor,this.input2View.editor,this.inputResultView.editor].findIndex(r=>r.hasWidgetFocus());return{...t,input1State:i,input2State:s,focusIndex:o}}tracksEditorViewState(e){return e instanceof Zo}toggleShowNonConflictingChanges(){this.showNonConflictingChanges.set(!this.showNonConflictingChanges.get(),void 0),this.showNonConflictingChangesStore.set(this.showNonConflictingChanges.get()),this._ctxShowNonConflictingChanges.set(this.showNonConflictingChanges.get())}},Yw=yn,yn.ID="mergeEditor",yn);ii=Yw=D([u(1,z),u(2,de),u(3,nt),u(4,ge),u(5,we),u(6,Cs),u(7,O),u(8,U),u(9,Ve),u(10,qn)],ii);var Cn;let Xw=(Cn=class{constructor(e){this._storageService=e,this._value={kind:"mixed",showBase:!1,showBaseAtTop:!0};const t=e.get(Ol._key,ee.PROFILE,"mixed");if(t==="mixed"||t==="columns")this._value={kind:t,showBase:!1,showBaseAtTop:!0};else if(t)try{this._value=JSON.parse(t)}catch(i){gr(i)}}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this._storageService.store(Ol._key,JSON.stringify(this._value),ee.PROFILE,Ze.USER))}},Ol=Cn,Cn._key="mergeEditor/layout",Cn);Xw=Ol=D([u(0,ge)],Xw);let Jw=class extends M{constructor(e,t){super(),this._editorService=e,this._store.add(t.registerCodeEditorOpenHandler(this.openCodeEditorFromMergeEditor.bind(this)))}async openCodeEditorFromMergeEditor(e,t,i){const s=this._editorService.activeEditorPane;if(!i&&e.options&&s instanceof ii&&s.getControl()&&s.input instanceof Zo&&qe(e.resource,s.input.result)){const o=s.getControl();return Tn(e.options,o,Nt.Smooth),o}return null}};Jw=D([u(0,O),u(1,qn)],Jw);var Na;let nu=(Na=class extends M{constructor(e,t){super();const i=s=>({editor:t.createInstance(Zo,s.base.resource,{uri:s.input1.resource,title:s.input1.label??Dt(s.input1.resource),description:s.input1.description??"",detail:s.input1.detail},{uri:s.input2.resource,title:s.input2.label??Dt(s.input2.resource),description:s.input2.description??"",detail:s.input2.detail},s.result.resource)});this._register(e.registerEditor("*",{id:Mt.id,label:Mt.displayName,detail:Mt.providerDisplayName,priority:rt.builtin},{},{createMergeEditorInput:i}))}},Na.ID="workbench.contrib.mergeEditorResolver",Na);nu=D([u(0,Qs),u(1,z)],nu);class Ts extends R{constructor(e){super(e)}run(e){const{activeEditorPane:t}=e.get(O);if(t instanceof ii){const i=t.viewModel.get();if(!i)return;this.runWithViewModel(i,e)}}}class Pv extends R{constructor(e){super(e)}run(e,...t){const{activeEditorPane:i}=e.get(O);if(i instanceof ii){const s=i.viewModel.get();return s?this.runWithMergeEditor({viewModel:s,inputModel:i.inputModel.get(),input:i.input,editorIdentifier:{editor:i.input,groupId:i.group.id}},e,...t):void 0}}}class t0 extends R{constructor(){super({id:"_open.mergeEditor",title:y(9068,"Open Merge Editor")})}run(e,...t){const i=Zw.validate(t[0]),s={base:{resource:i.base},input1:{resource:i.input1.uri,label:i.input1.title,description:i.input1.description,detail:i.input1.detail},input2:{resource:i.input2.uri,label:i.input2.title,description:i.input2.description,detail:i.input2.detail},result:{resource:i.output},options:{preserveFocus:!0}};e.get(O).openEditor(s)}}var Zw;(function(a){function e(o){if(!o||typeof o!="object")throw new TypeError("invalid argument");const r=o,n=i(r.base),d=i(r.output),l=t(r.input1),h=t(r.input2);return{base:n,input1:l,input2:h,output:d}}a.validate=e;function t(o){if(typeof o=="string")return new zd(F.parse(o,!0),void 0,void 0,void 0);if(!o||typeof o!="object")throw new TypeError("invalid argument");if(s(o))return new zd(F.revive(o),void 0,void 0,void 0);const r=o,n=r.title,d=i(r.uri),l=r.detail,h=r.description;return new zd(d,n,l,h)}function i(o){if(typeof o=="string")return F.parse(o,!0);if(o&&typeof o=="object")return F.revive(o);throw new TypeError("invalid argument")}function s(o){if(!o||typeof o!="object")return!1;const r=o;return typeof r.scheme=="string"&&typeof r.authority=="string"&&typeof r.path=="string"&&typeof r.query=="string"&&typeof r.fragment=="string"}})(Zw||(Zw={}));class i0 extends R{constructor(){super({id:"merge.mixedLayout",title:y(9069,"Mixed Layout"),toggled:wd.isEqualTo("mixed"),menu:[{id:b.EditorTitle,when:Ke,group:"1_merge",order:9}],precondition:Ke})}run(e){const{activeEditorPane:t}=e.get(O);t instanceof ii&&t.setLayoutKind("mixed")}}class s0 extends R{constructor(){super({id:"merge.columnLayout",title:y(9070,"Column Layout"),toggled:wd.isEqualTo("columns"),menu:[{id:b.EditorTitle,when:Ke,group:"1_merge",order:10}],precondition:Ke})}run(e){const{activeEditorPane:t}=e.get(O);t instanceof ii&&t.setLayoutKind("columns")}}class o0 extends R{constructor(){super({id:"merge.showNonConflictingChanges",title:y(9071,"Show Non-Conflicting Changes"),toggled:m_.isEqualTo(!0),menu:[{id:b.EditorTitle,when:Ke,group:"3_merge",order:9}],precondition:Ke})}run(e){const{activeEditorPane:t}=e.get(O);t instanceof ii&&t.toggleShowNonConflictingChanges()}}class r0 extends R{constructor(){super({id:"merge.showBase",title:y(9072,"Show Base"),toggled:Gp.isEqualTo(!0),menu:[{id:b.EditorTitle,when:I.and(Ke,wd.isEqualTo("columns")),group:"2_merge",order:9}]})}run(e){const{activeEditorPane:t}=e.get(O);t instanceof ii&&t.toggleBase()}}class n0 extends R{constructor(){super({id:"merge.showBaseTop",title:y(9073,"Show Base Top"),toggled:I.and(Gp,iv),menu:[{id:b.EditorTitle,when:I.and(Ke,wd.isEqualTo("mixed")),group:"2_merge",order:10}]})}run(e){const{activeEditorPane:t}=e.get(O);t instanceof ii&&t.toggleShowBaseTop()}}class a0 extends R{constructor(){super({id:"merge.showBaseCenter",title:y(9074,"Show Base Center"),toggled:I.and(Gp,iv.negate()),menu:[{id:b.EditorTitle,when:I.and(Ke,wd.isEqualTo("mixed")),group:"2_merge",order:11}]})}run(e){const{activeEditorPane:t}=e.get(O);t instanceof ii&&t.toggleShowBaseCenter()}}const ni=y(9075,"Merge Editor");class d0 extends Ts{constructor(){super({id:"merge.openResult",icon:P.goToFile,title:y(9076,"Open File"),category:ni,menu:[{id:b.EditorTitle,when:Ke,group:"navigation",order:1}],precondition:Ke})}runWithViewModel(e,t){t.get(O).openEditor({resource:e.model.resultTextModel.uri})}}class c0 extends Ts{constructor(){super({id:"merge.goToNextUnhandledConflict",category:ni,title:y(9077,"Go to Next Unhandled Conflict"),icon:P.arrowDown,menu:[{id:b.EditorTitle,when:Ke,group:"navigation",order:3}],f1:!0,precondition:Ke})}runWithViewModel(e){e.model.telemetry.reportNavigationToNextConflict(),e.goToNextModifiedBaseRange(t=>!e.model.isHandled(t).get())}}class l0 extends Ts{constructor(){super({id:"merge.goToPreviousUnhandledConflict",category:ni,title:y(9078,"Go to Previous Unhandled Conflict"),icon:P.arrowUp,menu:[{id:b.EditorTitle,when:Ke,group:"navigation",order:2}],f1:!0,precondition:Ke})}runWithViewModel(e){e.model.telemetry.reportNavigationToPreviousConflict(),e.goToPreviousModifiedBaseRange(t=>!e.model.isHandled(t).get())}}class h0 extends Ts{constructor(){super({id:"merge.toggleActiveConflictInput1",category:ni,title:y(9079,"Toggle Current Conflict from Left"),f1:!0,precondition:Ke})}runWithViewModel(e){e.toggleActiveConflict(1)}}class u0 extends Ts{constructor(){super({id:"merge.toggleActiveConflictInput2",category:ni,title:y(9080,"Toggle Current Conflict from Right"),f1:!0,precondition:Ke})}runWithViewModel(e){e.toggleActiveConflict(2)}}class p0 extends Ts{constructor(){super({id:"mergeEditor.compareInput1WithBase",category:ni,title:y(9081,"Compare Input 1 With Base"),shortTitle:c(9082,"Compare With Base"),f1:!0,precondition:Ke,menu:{id:b.MergeInput1Toolbar,group:"primary"},icon:P.compareChanges})}runWithViewModel(e,t){const i=t.get(O);ZI(e,i,1)}}class g0 extends Ts{constructor(){super({id:"mergeEditor.compareInput2WithBase",category:ni,title:y(9083,"Compare Input 2 With Base"),shortTitle:c(9082,"Compare With Base"),f1:!0,precondition:Ke,menu:{id:b.MergeInput2Toolbar,group:"primary"},icon:P.compareChanges})}runWithViewModel(e,t){const i=t.get(O);ZI(e,i,2)}}async function ZI(a,e,t){e.openEditor(e.activeEditor,{pinned:!0});const s=a.model.base,o=t===1?a.inputCodeEditorView1.editor:a.inputCodeEditorView2.editor,r=o.getPosition().lineNumber;await e.openEditor({original:{resource:s.uri},modified:{resource:o.getModel().uri},options:{selection:{startLineNumber:r,startColumn:1},revealIfOpened:!0,revealIfVisible:!0}})}class f0 extends Ts{constructor(){super({id:"merge.openBaseEditor",category:ni,title:y(9084,"Open Base File"),f1:!0,precondition:Ke})}runWithViewModel(e,t){t.get(tt).open(e.model.base.uri)}}class m0 extends Ts{constructor(){super({id:"merge.acceptAllInput1",category:ni,title:y(9085,"Accept All Incoming Changes from Left"),f1:!0,precondition:Ke,menu:{id:b.MergeInput1Toolbar,group:"primary"},icon:P.checkAll})}runWithViewModel(e){e.acceptAll(1)}}class w0 extends Ts{constructor(){super({id:"merge.acceptAllInput2",category:ni,title:y(9086,"Accept All Current Changes from Right"),f1:!0,precondition:Ke,menu:{id:b.MergeInput2Toolbar,group:"primary"},icon:P.checkAll})}runWithViewModel(e){e.acceptAll(2)}}class b0 extends Ts{constructor(){super({id:"mergeEditor.resetResultToBaseAndAutoMerge",category:ni,title:y(9087,"Reset Result"),shortTitle:c(9088,"Reset"),f1:!0,precondition:Ke,menu:{id:b.MergeInputResultToolbar,group:"primary"},icon:P.discard})}runWithViewModel(e,t){e.model.reset()}}class v0 extends R{constructor(){super({id:"mergeEditor.resetCloseWithConflictsChoice",category:ni,title:y(9089,"Reset Choice for 'Close with Conflicts'"),f1:!0})}run(e){e.get(ge).remove(iR,ee.PROFILE)}}class y0 extends Pv{constructor(){super({id:"mergeEditor.acceptAllCombination",category:ni,title:y(9090,"Accept All Combination"),f1:!0})}runWithMergeEditor(e,t,...i){const{viewModel:s}=e,o=s.model.modifiedBaseRanges.get(),r=s.model;return it(n=>{for(const d of o){const l=r.getState(d).get();l.kind!==xr.unrecognized&&!l.isInputIncluded(1)&&(!l.isInputIncluded(2)||!s.shouldUseAppendInsteadOfAccept.get())&&d.canBeCombined&&(r.setState(d,l.withInputValue(1,!0).withInputValue(2,!0,!0),!0,n),r.telemetry.reportSmartCombinationInvoked(l.includesInput(2)))}}),{success:!0}}}class C0 extends Pv{constructor(){super({id:"mergeEditor.acceptMerge",category:ni,title:y(9091,"Complete Merge"),f1:!0,precondition:Ke,keybinding:[{primary:C.CtrlCmd|w.Enter,weight:L.EditorContrib,when:Ke}]})}async runWithMergeEditor({inputModel:e,editorIdentifier:t,viewModel:i},s){const o=s.get(Bi),r=s.get(O);if(i.model.unhandledConflictsCount.get()>0){const{confirmed:n}=await o.confirm({message:c(9092,"Do you want to complete the merge of {0}?",Dt(e.resultUri)),detail:c(9093,"The file contains unhandled conflicts."),primaryButton:c(9094,"&&Complete with Conflicts")});if(!n)return{successful:!1}}return await e.accept(),await r.closeEditor(t),{successful:!0}}}class S0 extends Pv{constructor(){super({id:"mergeEditor.toggleBetweenInputs",category:ni,title:y(9095,"Toggle Between Merge Editor Inputs"),f1:!0,precondition:Ke,keybinding:[{primary:C.CtrlCmd|C.Shift|w.KeyT,weight:L.WorkbenchContrib+10,when:Ke}]})}runWithMergeEditor({viewModel:e},t){e.inputCodeEditorView1.editor.hasWidgetFocus()?e.inputCodeEditorView2.editor.focus():e.inputCodeEditorView1.editor.focus()}}const Ov=y(9096,"Merge Editor (Dev)");class E0 extends R{constructor(){super({id:"merge.dev.copyContentsJson",category:Ov,title:y(9097,"Copy Merge Editor State as JSON"),icon:P.layoutCentered,f1:!0,precondition:Ke})}run(e){const{activeEditorPane:t}=e.get(O),i=e.get(yc),s=e.get(Qe);if(!(t instanceof ii)){s.info({name:c(9098,"Merge Editor"),message:c(9099,"No active merge editor")});return}const o=t.model;if(!o)return;const r={languageId:o.resultTextModel.getLanguageId(),base:o.base.getValue(),input1:o.input1.textModel.getValue(),input2:o.input2.textModel.getValue(),result:o.resultTextModel.getValue(),initialResult:o.getInitialResultValue()},n=JSON.stringify(r,void 0,4);i.writeText(n),s.info({name:c(9098,"Merge Editor"),message:c(9100,"Successfully copied merge editor state")})}}class _0 extends R{constructor(){super({id:"merge.dev.saveContentsToFolder",category:Ov,title:y(9101,"Save Merge Editor State to Folder"),icon:P.layoutCentered,f1:!0,precondition:Ke})}async run(e){const{activeEditorPane:t}=e.get(O),i=e.get(Qe),s=e.get(yi),o=e.get(Ve),r=e.get(Es);if(!(t instanceof ii)){i.info({name:c(9098,"Merge Editor"),message:c(9099,"No active merge editor")});return}const n=t.model;if(!n)return;const d=await s.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,title:c(9102,"Select folder to save to")});if(!d)return;const l=d[0],h=r.getExtensions(n.resultTextModel.getLanguageId())[0]||"";async function p(g,f){await o.writeFile(F.joinPath(l,g+h),w_.fromString(f),{})}await Promise.all([p("base",n.base.getValue()),p("input1",n.input1.textModel.getValue()),p("input2",n.input2.textModel.getValue()),p("result",n.resultTextModel.getValue()),p("initialResult",n.getInitialResultValue())]),i.info({name:c(9098,"Merge Editor"),message:c(9103,"Successfully saved merge editor state to folder")})}}class I0 extends R{constructor(){super({id:"merge.dev.loadContentsFromFolder",category:Ov,title:y(9104,"Load Merge Editor State from Folder"),icon:P.layoutCentered,f1:!0})}async run(e,t){const i=e.get(yi),s=e.get(O),o=e.get(Ve),r=e.get(lt);t||(t={});let n;if(t.folderUri)n=t.folderUri;else{const E=await i.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,title:c(9102,"Select folder to save to")});if(!E)return;n=E[0]}const d=await o.resolve(n);function l(E){return d.children.find(x=>x.name.startsWith(E))?.resource}const h=await D0(r,t.resultState),p=l("base"),g=l("input1"),f=l("input2"),m=l(h?"initialResult":"result"),v={base:{resource:p},input1:{resource:g,label:"Input 1",description:"Input 1",detail:"(from file)"},input2:{resource:f,label:"Input 2",description:"Input 2",detail:"(from file)"},result:{resource:m}};s.openEditor(v)}}async function D0(a,e){return e?e==="initial":(await a.pick([{label:"result",result:!1},{label:"initial result",result:!0}],{canPickMany:!1}))?.result}class A0{canSerialize(){return!0}serialize(e){return JSON.stringify(this.toJSON(e))}toJSON(e){return{base:e.base,input1:e.input1,input2:e.input2,result:e.result}}deserialize(e,t){try{const i=sR(t);return e.createInstance(Zo,i.base,new zd(i.input1.uri,i.input1.title,i.input1.detail,i.input1.description),new zd(i.input2.uri,i.input2.title,i.input2.detail,i.input2.description),i.result)}catch(i){gr(i);return}}}class T0{constructor(){this.name="mergeEditor",this.type=iC.Help,this.priority=125,this.when=oR.create("isMergeEditor",!0)}getProvider(e){const t=e.get(qn),i=t.getActiveCodeEditor()||t.getFocusedCodeEditor();if(!i)return;const s=[c(9108,"You are in a merge editor."),c(9109,"Navigate between merge conflicts using the commands Go to Next Unhandled Conflict{0} and Go to Previous Unhandled Conflict{1}.","<keybinding:merge.goToNextUnhandledConflict>","<keybinding:merge.goToPreviousUnhandledConflict>"),c(9110,"Run the command Merge Editor: Accept All Incoming Changes from the Left{0} and Merge Editor: Accept All Current Changes from the Right{1}","<keybinding:merge.acceptAllInput1>","<keybinding:merge.acceptAllInput2>"),c(9111,"Complete the Merge{0}.","<keybinding:mergeEditor.acceptMerge>"),c(9112,"Toggle between merge editor inputs, incoming and current changes {0}.","<keybinding:mergeEditor.toggleBetweenInputs>")];return new rR(nR.MergeEditor,{type:iC.Help},()=>s.join(`
`),()=>i.focus(),aR.MergeEditor)}}se.as(Lt.EditorPane).registerEditorPane(Oi.create(ii,ii.ID,c(9105,"Merge Editor")),[new he(Zo)]);se.as(Lt.EditorFactory).registerEditorSerializer(Zo.ID,A0);se.as(Lo.Configuration).registerConfiguration({properties:{"mergeEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:"advanced",markdownEnumDescriptions:[c(9106,"Uses the legacy diffing algorithm."),c(9107,"Uses the advanced diffing algorithm.")]},"mergeEditor.showDeletionMarkers":{type:"boolean",default:!0,description:"Controls if deletions in base or one of the inputs should be indicated by a vertical bar."}}});S(d0);S(i0);S(s0);S(t0);S(f0);S(o0);S(r0);S(n0);S(a0);S(c0);S(l0);S(h0);S(u0);S(p0);S(g0);S(m0);S(w0);S(b0);S(C0);S(v0);S(y0);S(S0);S(E0);S(_0);S(I0);se.as(jb.Workbench).registerWorkbenchContribution(Jw,kp.Restored);Vt(nu.ID,nu,Pt.BlockStartup);dR.register(new T0);const k0=100;function _d(a,e){a?.addImplementation(k0,"webview",t=>{const s=t.get(Hn).activeWebview;if(s?.isFocused)return e(s),!0;if(Hs()?.classList.contains("action-menu-item")){const o=t.get(O);if(o.activeEditor instanceof ed)return e(o.activeEditor.webview),!0}return!1})}_d(dE,a=>a.undo());_d(cE,a=>a.redo());_d(cR,a=>a.selectAll());_d(af,a=>a.copy());_d(df,a=>a.paste());_d(nf,a=>a.cut());const Mv="preventDefaultContextMenuItems";nf&&_.appendMenuItem(b.WebviewContext,{command:{id:nf.id,title:c(13155,"Cut")},group:"5_cutcopypaste",order:1,when:I.not(Mv)});af&&_.appendMenuItem(b.WebviewContext,{command:{id:af.id,title:c(13156,"Copy")},group:"5_cutcopypaste",order:2,when:I.not(Mv)});df&&_.appendMenuItem(b.WebviewContext,{command:{id:df.id,title:c(13157,"Paste")},group:"5_cutcopypaste",order:3,when:I.not(Mv)});const x0="workbench.action.openSettings",L0=c(8516,"Configure");let Qw=class extends M{constructor(e,t){super();const s=[new R0,new V0].map(n=>new P0(t,n));s.forEach(n=>this._register(n));let o;const r=()=>{const n=e.activeTextEditorControl;if(n===o)return;o=n;const d=gs(n);s.forEach(l=>l.onActiveEditorChanged(d))};this._register(e.onDidActiveEditorChange(r)),r()}};Qw=D([u(0,O),u(1,d_)],Qw);class R0{constructor(){this.id="decoratorsLimitInfo",this.name=c(8517,"Color Decorator Status"),this.label=c(8518,"Color decorators"),this.source=c(8519,"Color Decorators"),this.settingsId="editor.colorDecoratorsLimit"}getLimitReporter(e){return lR.get(e)?.limitReporter}}class V0{constructor(){this.id="foldingLimitInfo",this.name=c(8520,"Folding Status"),this.label=c(8521,"Folding ranges"),this.source=c(8522,"Folding"),this.settingsId="editor.foldingMaximumRegions"}getLimitReporter(e){return c_.get(e)?.limitReporter}}class P0{constructor(e,t){this.languageStatusService=e,this.accessor=t}onActiveEditorChanged(e){this._indicatorChangeListener&&(this._indicatorChangeListener.dispose(),this._indicatorChangeListener=void 0);let t;return e&&(t=this.accessor.getLimitReporter(e)),this.updateStatusItem(t),t?(this._indicatorChangeListener=t.onDidChange(i=>{this.updateStatusItem(t)}),!0):!1}updateStatusItem(e){if(this._limitStatusItem&&(this._limitStatusItem.dispose(),this._limitStatusItem=void 0),e&&e.limited!==!1){const t={id:this.accessor.id,selector:"*",name:this.accessor.name,severity:Te.Warning,label:this.accessor.label,detail:c(8523,"only {0} shown for performance reasons",e.limited),command:{id:x0,arguments:[this.accessor.settingsId],title:L0},accessibilityInfo:void 0,source:this.accessor.source,busy:!1};this._limitStatusItem=this.languageStatusService.addStatus(t)}}dispose(){this._limitStatusItem?.dispose(),this._limitStatusItem=void 0,this._indicatorChangeListener?.dispose(),this._indicatorChangeListener=void 0}}se.as(jb.Workbench).registerWorkbenchContribution(Qw,kp.Restored);var Fa;let au=(Fa=class extends M{constructor(e){super(),this.configurationService=e,this.styleSheet=wp(),K.filter(e.onDidChangeConfiguration,s=>s.affectsConfiguration("workbench.sash.size"))(this.onDidChangeSize,this,this._store),this.onDidChangeSize(),K.filter(e.onDidChangeConfiguration,s=>s.affectsConfiguration("workbench.sash.hoverDelay"))(this.onDidChangeHoverDelay,this,this._store),this.onDidChangeHoverDelay()}onDidChangeSize(){const e=this.configurationService.getValue("workbench.sash.size"),t=dh(e,4,20),i=dh(e,1,8);this.styleSheet.textContent=`
			.monaco-workbench {
				--vscode-sash-size: ${t}px;
				--vscode-sash-hover-size: ${i}px;
			}
		`,hR(t)}onDidChangeHoverDelay(){uR(this.configurationService.getValue("workbench.sash.hoverDelay"))}},Fa.ID="workbench.contrib.sash",Fa);au=D([u(0,te)],au);Vt(au.ID,au,Pt.AfterRestored);se.as(Lo.Configuration).registerConfiguration({...Ld,properties:{"workbench.sash.size":{type:"number",default:ih?20:4,minimum:1,maximum:20,description:c(10434,"Controls the feedback area size in pixels of the dragging area in between views/editors. Set it to a larger value if you feel it's hard to resize views using the mouse.")},"workbench.sash.hoverDelay":{type:"number",default:300,minimum:0,maximum:2e3,description:c(10435,"Controls the hover feedback delay in milliseconds of the dragging area in between views/editors.")}}});new oe("inPreferencesSearch",!1);new oe("inSettingsEditor",!1);new oe("inSettingsJSONEditor",!1);new oe("inSettingsSearch",!1);new oe("settingsTocRowFocus",!1);new oe("settingRowFocus",!1);new oe("inKeybindings",!1);new oe("inKeybindingsSearch",!1);new oe("keybindingsSearchHasValue",!1);new oe("keybindingFocus",!1);new oe("whenFocus",!1);new oe("aiSettingResultsAvailable",!1);const Ml="workbench.action.openKeyboardLayoutPicker";var zC;(function(a){a.ShowAISearchToggle="workbench.settings.showAISearchToggle",a.EnableNaturalLanguageSearch="workbench.settings.enableNaturalLanguageSearch"})(zC||(zC={}));c(10145,"Preview setting: this setting controls a new feature that is still under refinement yet ready to use. Feedback is welcome.");c(10146,"Experimental setting: this setting controls a new feature that is actively being developed and may be unstable. It is subject to change or removal.");c(10147,"Advanced setting: this setting is intended for advanced scenarios and configurations. Only modify this if you know what it does.");const O0=new Set;["css","html","scss","less","json","js","ts","ie","id","php","scm"].forEach(a=>O0.add(a));const Fo=new Map;Fo.set("power shell","PowerShell");Fo.set("powershell","PowerShell");Fo.set("javascript","JavaScript");Fo.set("typescript","TypeScript");Fo.set("github","GitHub");Fo.set("jet brains","JetBrains");Fo.set("jetbrains","JetBrains");Fo.set("re sharper","ReSharper");Fo.set("resharper","ReSharper");var Ba;let du=(Ba=class extends M{constructor(e,t){super(),this.keyboardLayoutService=e,this.statusbarService=t,this.pickerElement=this._register(new Ae);const i=c(9874,"Keyboard Layout"),s=this.keyboardLayoutService.getCurrentKeyboardLayout();if(s){const o=Rh(s),r=c(9875,"Layout: {0}",o.label);this.pickerElement.value=this.statusbarService.addEntry({name:i,text:r,ariaLabel:r,command:Ml},"status.workbench.keyboardLayout",_t.RIGHT)}this._register(this.keyboardLayoutService.onDidChangeKeyboardLayout(()=>{const o=this.keyboardLayoutService.getCurrentKeyboardLayout(),r=Rh(o);if(this.pickerElement.value){const n=c(9875,"Layout: {0}",r.label);this.pickerElement.value.update({name:i,text:n,ariaLabel:n,command:Ml})}else{const n=c(9875,"Layout: {0}",r.label);this.pickerElement.value=this.statusbarService.addEntry({name:i,text:n,ariaLabel:n,command:Ml},"status.workbench.keyboardLayout",_t.RIGHT)}}))}},Ba.ID="workbench.contrib.keyboardLayoutPicker",Ba);du=D([u(0,el),u(1,Ss)],du);Vt(du.ID,du,Pt.BlockStartup);const M0=[`// ${c(9876,"Defines the keyboard layout used in VS Code in the browser environment.")}`,`// ${c(9877,'Open VS Code and run "Developer: Inspect Key Mappings (JSON)" from Command Palette.')}`,"","// Once you have the keyboard layout info, please paste it below.",`
`].join(`
`);S(class extends R{constructor(){super({id:Ml,title:y(9878,"Change Keyboard Layout"),f1:!0})}async run(a){const e=a.get(el),t=a.get(lt),i=a.get(te),s=a.get(Fb),o=a.get(O),r=a.get(Ve),n=e.getAllKeyboardLayouts(),d=e.getCurrentKeyboardLayout(),h=i.getValue("keyboard.layout")==="autodetect",p=n.map(v=>{const E=!h&&yC(d,v),x=Rh(v);return{layout:v,label:[x.label,v&&v.isUserKeyboardLayout?"(User configured layout)":""].join(" "),id:v.text||v.lang||v.layout,description:x.description+(E?" (Current layout)":""),picked:!h&&yC(d,v)}}).sort((v,E)=>v.label<E.label?-1:v.label>E.label?1:0);if(p.length>0){const v=Ge?"Mac":mi?"Win":"Linux";p.unshift({type:"separator",label:c(9879,"Keyboard Layouts ({0})",v)})}const g={label:c(9880,"Configure Keyboard Layout")};p.unshift(g);const f={label:c(9881,"Auto Detect"),description:h?`Current: ${Rh(d).label}`:void 0,picked:h?!0:void 0};p.unshift(f);const m=await t.pick(p,{placeHolder:c(9882,"Select Keyboard Layout"),matchOnDescription:!0});if(m){if(m===f){i.updateValue("keyboard.layout","autodetect");return}if(m===g){const v=s.keyboardLayoutResource;return await r.stat(v).then(void 0,()=>r.createFile(v,w_.fromString(M0))).then(E=>{if(E)return o.openEditor({resource:E.resource,languageId:"jsonc",options:{pinned:!0}})},E=>{throw new Error(c(9883,"Unable to create '{0}' ({1}).",v.toString(),E))}),Promise.resolve()}i.updateValue("keyboard.layout",Vc(m.layout))}}});var Ga;let cu=(Ga=class extends M{constructor(e,t,i){super(),this.activityService=e,this.workingCopyService=t,this.filesConfigurationService=i,this.badgeHandle=this._register(new Ae),this.lastKnownDirtyCount=0,this.updateActivityBadge(),this.registerListeners()}registerListeners(){this._register(this.workingCopyService.onDidChangeDirty(e=>this.onWorkingCopyDidChangeDirty(e)))}onWorkingCopyDidChangeDirty(e){const t=e.isDirty();t&&!(e.capabilities&pR.Untitled)&&this.filesConfigurationService.hasShortAutoSaveDelay(e.resource)||(t||this.lastKnownDirtyCount>0)&&this.updateActivityBadge()}updateActivityBadge(){const e=this.lastKnownDirtyCount=this.workingCopyService.dirtyCount;e>0?this.badgeHandle.value=this.activityService.showViewContainerActivity(Ud,{badge:new Mp(e,t=>t===1?c(8257,"1 unsaved file"):c(8258,"{0} unsaved files",e))}):this.badgeHandle.clear()}},Ga.ID="workbench.contrib.dirtyFilesIndicator",Ga);cu=D([u(0,Ir),u(1,IE),u(2,ud)],cu);var eb,Sn;let lu=(Sn=class extends wo{constructor(e,t,i,s,o){super(eb.ID,e,{openInternal:(r,n)=>this.openInternal(r,n)},t,i,o),this.editorResolverService=s}async openInternal(e,t){if(e instanceof td&&this.group.activeEditor){const i=this.group.activeEditor,s=i?.toUntyped();if(!s)return;let o=await this.editorResolverService.resolveEditor({...s,options:{...t,override:Ca.PICK}},this.group);if(o===ai.NONE)o=void 0;else if(o===ai.ABORT)return;if(nE(o))for(const r of o.editor instanceof Jt?[o.editor.original,o.editor.modified]:[o.editor])r instanceof td&&(r.setForceOpenAsText(),r.setPreferredLanguageId(sv));await this.group.replaceEditors([{editor:i,replacement:o?.editor??e,options:{...o?.options??t}}])}}getTitle(){return this.input?this.input.getName():c(7891,"Binary File Viewer")}},eb=Sn,Sn.ID=gR,Sn);lu=eb=D([u(1,nt),u(2,we),u(3,Qs),u(4,ge)],lu);class N0{canSerialize(e){return!0}serialize(e){const t=e,i=t.resource,s=t.preferredResource,o={resourceJSON:i.toJSON(),preferredResourceJSON:qe(i,s)?void 0:s,name:t.getPreferredName(),description:t.getPreferredDescription(),encoding:t.getEncoding(),modeId:t.getPreferredLanguageId()};return JSON.stringify(o)}deserialize(e,t){return e.invokeFunction(i=>{const s=JSON.parse(t),o=F.revive(s.resourceJSON),r=F.revive(s.preferredResourceJSON),n=s.name,d=s.description,l=s.encoding,h=s.modeId,p=i.get(il).createTextEditor({resource:o,label:n,description:d,encoding:l,languageId:h,forceFile:!0});return r&&p.setPreferredResource(r),p})}}var Wa;let hu=(Wa=class extends M{constructor(e,t,i){super(),this.textEditorService=t,this.fileService=i,this._register(e.registerHandler(this))}handles(e){return e.typeId===of&&this.fileService.canHandleResource(e.resource)}handlesSync(e){return e.typeId===of&&this.fileService.hasProvider(e.resource)}isOpen(e,t){return this.handlesSync(e)?qe(e.resource,t.resource):!1}createEditor(e){return this.textEditorService.createTextEditor({resource:e.resource,forceFile:!0})}},Wa.ID="workbench.contrib.fileEditorWorkingCopyEditorHandler",Wa);hu=D([u(0,Np),u(1,il),u(2,Ve)],hu);var tb,En;let uu=(En=class extends UI{constructor(e,t,i,s,o,r,n,d,l,h,p,g,f,m,v,E,x,G,W){super(tb.ID,e,t,o,n,d,h,l,p,i),this.paneCompositeService=s,this.contextService=r,this.textFileService=g,this.explorerService=f,this.uriIdentityService=m,this.pathService=v,this.configurationService=E,this.preferencesService=x,this.hostService=G,this.filesConfigurationService=W,this._register(this.fileService.onDidFilesChange(Y=>this.onDidFilesChange(Y))),this._register(this.fileService.onDidRunOperation(Y=>this.onDidRunOperation(Y)))}onDidFilesChange(e){for(const t of e.rawDeleted)this.clearEditorViewState(t)}onDidRunOperation(e){e.operation===Gr.MOVE&&e.target&&this.moveEditorViewState(e.resource,e.target.resource,this.uriIdentityService.extUri)}getTitle(){return this.input?this.input.getName():c(7892,"Text File Editor")}get input(){return this._input}async setInput(e,t,i,s){cs("code/willSetInputToTextFileEditor"),await super.setInput(e,t,i,s);try{const o=await e.resolve(t);if(s.isCancellationRequested)return;if(o instanceof A_)return this.openAsBinary(e,t);const r=o,n=fe(this.editorControl);if(n.setModel(r.textEditorModel),!Sb(t?.viewState)){const d=this.loadEditorViewState(e,i);d&&(t?.selection&&(d.cursorState=[]),n.restoreViewState(d))}t&&Tn(t,n,Nt.Immediate),n.updateOptions(this.getReadonlyConfiguration(r.isReadonly())),n.handleInitialized&&n.handleInitialized()}catch(o){await this.handleSetInputError(o,e,t)}cs("code/didSetInputToTextFileEditor")}async handleSetInputError(e,t,i){if(e.textFileOperationResult===AS.FILE_IS_BINARY)return this.openAsBinary(t,i);if(e.fileOperationResult===Ms.FILE_IS_DIRECTORY){const s=[];throw s.push(Gt({id:"workbench.files.action.openFolder",label:c(7893,"Open Folder"),run:async()=>this.hostService.openWindow([{folderUri:t.resource}],{forceNewWindow:!0})})),this.contextService.isInsideWorkspace(t.preferredResource)&&s.push(Gt({id:"workbench.files.action.reveal",label:c(7894,"Reveal Folder"),run:async()=>(await this.paneCompositeService.openPaneComposite(Ud,ce.Sidebar,!0),this.explorerService.select(t.preferredResource,!0))})),sC(c(7895,"The file is not displayed in the text editor because it is a directory."),s,{forceMessage:!0})}if(e.fileOperationResult===Ms.FILE_TOO_LARGE){let s;throw e instanceof IS?s=c(7896,"The file is not displayed in the text editor because it is very large ({0}).",vp.formatSize(e.size)):s=c(7897,"The file is not displayed in the text editor because it is very large."),DS(this.group,t,i,s,this.preferencesService)}throw e.fileOperationResult===Ms.FILE_NOT_FOUND&&!this.filesConfigurationService.isReadonly(t.preferredResource)&&await this.pathService.hasValidBasename(t.preferredResource)?sC(new lE(c(7898,"The editor could not be opened because the file was not found."),Ms.FILE_NOT_FOUND),[Gt({id:"workbench.files.action.createMissingFile",label:c(7899,"Create File"),run:async()=>(await this.textFileService.create([{resource:t.preferredResource}]),this.editorService.openEditor({resource:t.preferredResource,options:{pinned:!0}}))})],{allowDialog:!0}):e}openAsBinary(e,t){const i=this.configurationService.getValue("workbench.editor.defaultBinaryEditor"),s={...t,activation:ho.PRESERVE};i&&i!==""&&i!==Mt.id?this.doOpenAsBinaryInDifferentEditor(this.group,i,e,s):this.doOpenAsBinaryInSameEditor(this.group,i,e,s)}doOpenAsBinaryInDifferentEditor(e,t,i,s){this.editorService.replaceEditors([{editor:i,replacement:{resource:i.resource,options:{...s,override:t}}}],e)}doOpenAsBinaryInSameEditor(e,t,i,s){t===Mt.id?(i.setForceOpenAsText(),i.setPreferredLanguageId(sv),s={...s,forceReload:!0}):i.setForceOpenAsBinary(),e.openEditor(i,s)}clearInput(){super.clearInput(),this.editorControl?.setModel(null)}createEditorControl(e,t){cs("code/willCreateTextFileEditorControl"),super.createEditorControl(e,t),cs("code/didCreateTextFileEditorControl")}tracksEditorViewState(e){return e instanceof td}tracksDisposedEditorViewState(){return!0}},tb=En,En.ID=fR,En);uu=tb=D([u(1,nt),u(2,Ve),u(3,_r),u(4,z),u(5,xt),u(6,ge),u(7,Cs),u(8,O),u(9,we),u(10,U),u(11,zn),u(12,mR),u(13,Kn),u(14,Gn),u(15,te),u(16,ld),u(17,Rt),u(18,ud)],uu);var Ka;let pu=(Ka=class extends M{constructor(e,t,i,s,o,r,n){super(),this.editorService=e,this.textFileService=t,this.lifecycleService=i,this.hostService=s,this.codeEditorService=o,this.filesConfigurationService=r,this.workingCopyEditorService=n,this.ensureDirtyFilesAreOpenedWorker=this._register(new $S(d=>this.ensureDirtyTextFilesAreOpened(d),this.getDirtyTextFileTrackerDelay())),this.registerListeners()}registerListeners(){this._register(this.textFileService.files.onDidChangeDirty(e=>this.ensureDirtyFilesAreOpenedWorker.work(e.resource))),this._register(this.textFileService.files.onDidSaveError(e=>this.ensureDirtyFilesAreOpenedWorker.work(e.resource))),this._register(this.textFileService.untitled.onDidChangeDirty(e=>this.ensureDirtyFilesAreOpenedWorker.work(e.resource))),this._register(this.hostService.onDidChangeFocus(e=>e?this.reloadVisibleTextFileEditors():void 0)),this._register(this.lifecycleService.onDidShutdown(()=>this.dispose()))}getDirtyTextFileTrackerDelay(){return 800}ensureDirtyTextFilesAreOpened(e){this.doEnsureDirtyTextFilesAreOpened(Xo(e.filter(t=>{if(!this.textFileService.isDirty(t))return!1;const i=this.textFileService.files.get(t);if(i?.hasState(oC.PENDING_SAVE)||t.scheme!==ue.untitled&&!i?.hasState(oC.ERROR)&&this.filesConfigurationService.hasShortAutoSaveDelay(t)||this.editorService.isOpened({resource:t,typeId:t.scheme===ue.untitled?Ys.ID:b_,editorId:Mt.id}))return!1;const s=i??this.textFileService.untitled.get(t);return!(s&&this.workingCopyEditorService.findEditor(s))}),t=>t.toString()))}doEnsureDirtyTextFilesAreOpened(e){e.length&&this.editorService.openEditors(e.map(t=>({resource:t,options:{inactive:!0,pinned:!0,preserveFocus:!0}})))}reloadVisibleTextFileEditors(){Xo(Mi(this.codeEditorService.listCodeEditors().map(e=>{const t=e.getModel()?.uri;if(!t)return;const i=this.textFileService.files.get(t);if(!(!i||i.isDirty()||!i.isResolved()))return i})),e=>e.resource.toString()).forEach(e=>this.textFileService.files.resolve(e.resource,{reload:{async:!0}}))}},Ka.ID="workbench.contrib.textFileEditorTracker",Ka);pu=D([u(0,O),u(1,zn),u(2,gd),u(3,Rt),u(4,qn),u(5,ud),u(6,Np)],pu);const F0="saveConflictResolutionContext",ib="conflictResolution",Nv="learnMoreDirtyWriteError",QI=c(7900,"Use the actions in the editor tool bar to either undo your changes or overwrite the content of the file with your changes.");var Ua;let gu=(Ua=class extends M{constructor(e,t,i,s,o,r,n){super(),this.notificationService=e,this.textFileService=t,this.editorService=s,this.instantiationService=r,this.storageService=n,this.messages=new js,this.activeConflictResolutionResource=void 0,this.conflictResolutionContext=new oe(F0,!1,!0).bindTo(i);const d=this._register(r.createInstance(v_));this._register(o.registerTextModelContentProvider(ib,d)),this.textFileService.files.saveErrorHandler=this,this.registerListeners()}registerListeners(){this._register(this.textFileService.files.onDidSave(e=>this.onFileSavedOrReverted(e.model.resource))),this._register(this.textFileService.files.onDidRevert(e=>this.onFileSavedOrReverted(e.resource))),this._register(this.editorService.onDidActiveEditorChange(()=>this.onActiveEditorChanged()))}onActiveEditorChanged(){let e=!1,t;const i=this.editorService.activeEditor;i instanceof Jt&&i.original.resource?.scheme===ib&&(e=!0,t=i.modified.resource),this.conflictResolutionContext.set(e),this.activeConflictResolutionResource=t}onFileSavedOrReverted(e){const t=this.messages.get(e);t&&(t.close(),this.messages.delete(e))}onSaveError(e,t,i){const s=e,o=t.resource;let r;const n=[],d=[];if(s.fileOperationResult===Ms.FILE_MODIFIED_SINCE)if(this.activeConflictResolutionResource&&qe(this.activeConflictResolutionResource,t.resource)){if(this.storageService.getBoolean(Nv,ee.APPLICATION))return;r=QI,n.push(this.instantiationService.createInstance(fu)),d.push(this.instantiationService.createInstance(sb))}else r=c(7901,"Failed to save '{0}': The content of the file is newer. Please compare your version with the file contents or overwrite the content of the file with your changes.",Dt(o)),n.push(this.instantiationService.createInstance(ob,t)),n.push(this.instantiationService.createInstance(U0,t,i)),d.push(this.instantiationService.createInstance(nb));else{const p=s.fileOperationResult===Ms.FILE_WRITE_LOCKED,g=p&&s.options?.unlock,f=s.fileOperationResult===Ms.FILE_PERMISSION_DENIED,m=o.scheme===ue.file;m&&(f||g)?n.push(this.instantiationService.createInstance(B0,t,i,!!g)):p?n.push(this.instantiationService.createInstance(K0,t,i)):n.push(this.instantiationService.createInstance(G0,t,i)),n.push(this.instantiationService.createInstance(rb,t)),n.push(this.instantiationService.createInstance(W0,t)),p?g&&m?r=mi?c(7902,"Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.",Dt(o)):c(7903,"Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.",Dt(o)):r=c(7904,"Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.",Dt(o)):m&&f?r=mi?c(7905,"Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.",Dt(o)):c(7906,"Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.",Dt(o)):r=c(7907,"Failed to save '{0}': {1}",Dt(o),Hl(e,!1))}const l={primary:n,secondary:d},h=this.notificationService.notify({id:`${Ep(t.resource.toString())}`,severity:Te.Error,message:r,actions:l});K.once(h.onDidClose)(()=>{dt(n),dt(d)}),this.messages.set(t.resource,h)}dispose(){super.dispose(),this.messages.clear()}},Ua.ID="workbench.contrib.textFileSaveErrorHandler",Ua);gu=D([u(0,Qe),u(1,zn),u(2,de),u(3,O),u(4,$n),u(5,z),u(6,ge)],gu);let fu=class extends Je{constructor(e){super("workbench.files.action.resolveConflictLearnMore",c(7908,"Learn More")),this.openerService=e}async run(){await this.openerService.open(F.parse("https://go.microsoft.com/fwlink/?linkid=868264"))}};fu=D([u(0,tt)],fu);let sb=class extends Je{constructor(e){super("workbench.files.action.resolveConflictLearnMoreDoNotShowAgain",c(7909,"Don't Show Again")),this.storageService=e}async run(e){this.storageService.store(Nv,!0,ee.APPLICATION,Ze.USER),e.dispose()}};sb=D([u(0,ge)],sb);let ob=class extends Je{constructor(e,t,i,s,o){super("workbench.files.action.resolveConflict",c(7910,"Compare")),this.model=e,this.editorService=t,this.notificationService=i,this.instantiationService=s,this.productService=o}async run(){if(!this.model.isDisposed()){const e=this.model.resource,t=Dt(e),i=c(7911,"{0} (in file)  {1} (in {2}) - Resolve save conflict",t,t,this.productService.nameLong);await v_.open(e,ib,i,this.editorService,{pinned:!0});const s={primary:[this.instantiationService.createInstance(fu)]},o=this.notificationService.notify({id:`${Ep(e.toString())}`,severity:Te.Info,message:QI,actions:s,neverShowAgain:{id:Nv,isSecondary:!0}});K.once(o.onDidClose)(()=>dt(s.primary))}}};ob=D([u(1,O),u(2,Qe),u(3,z),u(4,_s)],ob);class B0 extends Je{constructor(e,t,i){super("workbench.files.action.saveModelElevated",i?mi?c(7912,"Overwrite as Admin..."):c(7913,"Overwrite as Sudo..."):mi?c(7914,"Retry as Admin..."):c(7915,"Retry as Sudo...")),this.model=e,this.options=t,this.triedToUnlock=i}async run(){this.model.isDisposed()||await this.model.save({...this.options,writeElevated:!0,writeUnlock:this.triedToUnlock,reason:Ji.EXPLICIT})}}class G0 extends Je{constructor(e,t){super("workbench.files.action.saveModel",c(7916,"Retry")),this.model=e,this.options=t}async run(){this.model.isDisposed()||await this.model.save({...this.options,reason:Ji.EXPLICIT})}}class W0 extends Je{constructor(e){super("workbench.files.action.revertModel",c(7917,"Revert")),this.model=e}async run(){this.model.isDisposed()||await this.model.revert()}}let rb=class extends Je{constructor(e,t){super("workbench.files.action.saveModelAs",wR.value),this.model=e,this.editorService=t}async run(){if(!this.model.isDisposed()){const e=this.findEditor();e&&await this.editorService.save(e,{saveAs:!0,reason:Ji.EXPLICIT})}}findEditor(){let e;const t=this.editorService.findEditors(this.model.resource,{supportSideBySide:Le.PRIMARY});for(const i of t)if(i.editor instanceof td){e=i;break}else e||(e=i);return e}};rb=D([u(1,O)],rb);class K0 extends Je{constructor(e,t){super("workbench.files.action.unlock",c(7918,"Overwrite")),this.model=e,this.options=t}async run(){this.model.isDisposed()||await this.model.save({...this.options,writeUnlock:!0,reason:Ji.EXPLICIT})}}class U0 extends Je{constructor(e,t){super("workbench.files.action.saveIgnoreModifiedSince",c(7918,"Overwrite")),this.model=e,this.options=t}async run(){this.model.isDisposed()||await this.model.save({...this.options,ignoreModifiedSince:!0,reason:Ji.EXPLICIT})}}let nb=class extends Je{constructor(e){super("workbench.files.action.configureSaveConflict",c(7919,"Configure")),this.preferencesService=e}async run(){this.preferencesService.openSettings({query:"files.saveConflictResolution"})}};nb=D([u(0,ld)],nb);var Ha;let mu=(Ha=class extends M{constructor(e,t,i,s,o,r,n,d){super(),this.fileService=e,this.configurationService=t,this.contextService=i,this.notificationService=s,this.openerService=o,this.uriIdentityService=r,this.hostService=n,this.telemetryService=d,this.watchedWorkspaces=new js(l=>this.uriIdentityService.extUri.getComparisonKey(l)),this.registerListeners(),this.refresh()}registerListeners(){this._register(this.contextService.onDidChangeWorkspaceFolders(e=>this.onDidChangeWorkspaceFolders(e))),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.onDidChangeWorkbenchState())),this._register(this.configurationService.onDidChangeConfiguration(e=>this.onDidChangeConfiguration(e))),this._register(this.fileService.onDidWatchError(e=>this.onDidWatchError(e)))}onDidChangeWorkspaceFolders(e){for(const t of e.removed)this.unwatchWorkspace(t);for(const t of e.added)this.watchWorkspace(t)}onDidChangeWorkbenchState(){this.refresh()}onDidChangeConfiguration(e){(e.affectsConfiguration("files.watcherExclude")||e.affectsConfiguration("files.watcherInclude"))&&this.refresh()}onDidWatchError(e){const t=e.toString();let i;t.indexOf("ENOSPC")>=0?(i="ENOSPC",this.notificationService.prompt(Te.Warning,c(8253,"Unable to watch for file changes. Please follow the instructions link to resolve this issue."),[{label:c(8254,"Instructions"),run:()=>this.openerService.open(F.parse("https://go.microsoft.com/fwlink/?linkid=867693"))}],{sticky:!0,neverShowAgain:{id:"ignoreEnospcError",isSecondary:!0,scope:bR.WORKSPACE}})):t.indexOf("EUNKNOWN")>=0?(i="EUNKNOWN",this.notificationService.prompt(Te.Warning,c(8255,"File changes watcher stopped unexpectedly. A reload of the window may enable the watcher again unless the workspace cannot be watched for file changes."),[{label:c(8256,"Reload"),run:()=>this.hostService.reload()}],{sticky:!0,priority:Qn.SILENT})):t.indexOf("ETERM")>=0&&(i="ETERM"),i&&this.telemetryService.publicLog2("fileWatcherError",{reason:i})}watchWorkspace(e){const t=[],i=this.configurationService.getValue({resource:e.uri});if(i.files?.watcherExclude)for(const r in i.files.watcherExclude)r&&i.files.watcherExclude[r]===!0&&t.push(r);const s=new js(r=>this.uriIdentityService.extUri.getComparisonKey(r));if(s.set(e.uri,e.uri),i.files?.watcherInclude){for(const r of i.files.watcherInclude)if(r)if(vR(r)){const n=F.file(r).with({scheme:e.uri.scheme});this.uriIdentityService.extUri.isEqualOrParent(n,e.uri)&&s.set(n,n)}else{const n=e.toResource(r);s.set(n,n)}}const o=new B;for(const[,r]of s)o.add(this.fileService.watch(r,{recursive:!0,excludes:t}));this.watchedWorkspaces.set(e.uri,o)}unwatchWorkspace(e){this.watchedWorkspaces.has(e.uri)&&(dt(this.watchedWorkspaces.get(e.uri)),this.watchedWorkspaces.delete(e.uri))}refresh(){this.unwatchWorkspaces();for(const e of this.contextService.getWorkspace().folders)this.watchWorkspace(e)}unwatchWorkspaces(){for(const[,e]of this.watchedWorkspaces)e.dispose();this.watchedWorkspaces.clear()}dispose(){super.dispose(),this.unwatchWorkspaces()}},Ha.ID="workbench.contrib.workspaceWatcher",Ha);mu=D([u(0,Ve),u(1,te),u(2,xt),u(3,Qe),u(4,tt),u(5,Kn),u(6,Rt),u(7,nt)],mu);var za;let wu=(za=class{constructor(e){e.registerFormatter({scheme:ue.file,formatting:{label:"${authority}${path}",separator:Bd,tildify:!mi,normalizeDriveLetter:mi,authorityPrefix:Bd+Bd,workspaceSuffix:""}})}},za.ID="workbench.contrib.fileUriLabel",za);wu=D([u(0,rs)],wu);se.as(Lt.EditorPane).registerEditorPane(Oi.create(uu,uu.ID,c(8159,"Text File Editor")),[new he(td)]);se.as(Lt.EditorPane).registerEditorPane(Oi.create(lu,lu.ID,c(8160,"Binary File Editor")),[new he(td)]);se.as(Lt.EditorFactory).registerEditorSerializer(b_,N0);Vt(hu.ID,hu,Pt.BlockRestore);Vt(pu.ID,pu,Pt.BlockStartup);Vt(gu.ID,gu,Pt.BlockStartup);Vt(wu.ID,wu,Pt.BlockStartup);Vt(mu.ID,mu,Pt.AfterRestored);Vt(cu.ID,cu,Pt.BlockStartup);yR.registerLanguage({id:sv,aliases:["Binary"],mimetypes:["text/x-code-binary"]});const H0=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));xe(H0);Vb((a,e)=>{const t=HS(a);e.addRule(`.monaco-workbench-part { background-color: ${t}; }`);const i=a.getColor(CR);if(i&&e.addRule(`.monaco-workbench-part ::selection { background-color: ${i}; }`),ei){const s=a.getColor(SR);if(s){const o="monaco-workbench-meta-theme-color";let r=me.document.getElementById(o);r||(r=SE(),r.name="theme-color",r.id=o),r.content=s.toString()}}Pb&&e.addRule(`
			.monaco-workbench-part.web {
				touch-action: none;
			}
			.monaco-workbench-part .monaco-editor .view-lines {
				user-select: text;
				-webkit-user-select: text;
			}
		`),ih&&ER()&&e.addRule(`.monaco-workbench-part { background-color: ${t}; }`)});var $a;let bu=($a=class extends M{constructor(e,t){super(),this.editorService=e,this.statusbarService=t,this.paneInitialScrollTop=new Map,this.syncScrollDispoasbles=this._register(new B),this.paneDisposables=new B,this.statusBarEntry=this._register(new Ae),this.isActive=!1,this._reentrancyBarrier=new l_,this.registerActions()}registerActiveListeners(){this.syncScrollDispoasbles.add(this.editorService.onDidVisibleEditorsChange(()=>this.trackVisiblePanes()))}activate(){this.registerActiveListeners(),this.trackVisiblePanes()}toggle(){this.isActive?this.deactivate():this.activate(),this.isActive=!this.isActive,this.toggleStatusbarItem(this.isActive)}trackVisiblePanes(){this.paneDisposables.clear(),this.paneInitialScrollTop.clear();for(const e of this.getAllVisiblePanes())yg(e)&&(this.paneInitialScrollTop.set(e,e.getScrollPosition()),this.paneDisposables.add(e.onDidChangeScroll(()=>this._reentrancyBarrier.runExclusivelyOrSkip(()=>{this.onDidEditorPaneScroll(e)}))))}onDidEditorPaneScroll(e){const t=this.paneInitialScrollTop.get(e);if(t===void 0)throw new Error("Scrolled pane not tracked");if(!yg(e))throw new Error("Scrolled pane does not support scrolling");const i=e.getScrollPosition(),s={scrollTop:i.scrollTop-t.scrollTop,scrollLeft:i.scrollLeft!==void 0&&t.scrollLeft!==void 0?i.scrollLeft-t.scrollLeft:void 0};for(const o of this.getAllVisiblePanes()){if(o===e||!yg(o))continue;const r=this.paneInitialScrollTop.get(o);if(r===void 0)throw new Error("Could not find initial offset for pane");const n=o.getScrollPosition(),d={scrollTop:r.scrollTop+s.scrollTop,scrollLeft:r.scrollLeft!==void 0&&s.scrollLeft!==void 0?r.scrollLeft+s.scrollLeft:void 0};n.scrollTop===d.scrollTop&&n.scrollLeft===d.scrollLeft||o.setScrollPosition(d)}}getAllVisiblePanes(){const e=[];for(const t of this.editorService.visibleEditorPanes){if(t instanceof Ks){const i=t.getPrimaryEditorPane(),s=t.getSecondaryEditorPane();i&&e.push(i),s&&e.push(s);continue}e.push(t)}return e}deactivate(){this.paneDisposables.clear(),this.syncScrollDispoasbles.clear(),this.paneInitialScrollTop.clear()}toggleStatusbarItem(e){if(e){if(!this.statusBarEntry.value){const t=c(10651,"Scrolling Locked"),i=c(10652,"Lock Scrolling Enabled");this.statusBarEntry.value=this.statusbarService.addEntry({name:t,text:t,tooltip:i,ariaLabel:t,command:{id:"workbench.action.toggleLockedScrolling",title:""},kind:"prominent",showInAllWindows:!0},"status.scrollLockingEnabled",_t.RIGHT,102)}}else this.statusBarEntry.clear()}registerActions(){const e=this;this._register(S(class extends R{constructor(){super({id:"workbench.action.toggleLockedScrolling",title:{...y(10653,"Toggle Locked Scrolling Across Editors"),mnemonicTitle:c(10654,"Locked Scrolling")},category:T.View,f1:!0,metadata:{description:c(10655,"Synchronize Scrolling Editors")}})}run(){e.toggle()}})),this._register(S(class extends R{constructor(){super({id:"workbench.action.holdLockedScrolling",title:{...y(10656,"Hold Locked Scrolling Across Editors"),mnemonicTitle:c(10657,"Locked Scrolling")},category:T.View})}run(t){const i=t.get(ot);e.toggle();const s=i.enableKeybindingHoldMode("workbench.action.holdLockedScrolling");s&&s.finally(()=>{e.toggle()})}}))}dispose(){this.deactivate(),super.dispose()}},$a.ID="workbench.contrib.syncScrolling",$a);bu=D([u(0,O),u(1,Ss)],bu);Vt(bu.ID,bu,Pt.Eventually);function z0(a,e){return[Gt({id:"undo",label:c(2918,"Undo"),run:()=>Zn().execCommand("undo")}),Gt({id:"redo",label:c(2919,"Redo"),run:()=>Zn().execCommand("redo")}),new ys,Gt({id:"editor.action.clipboardCutAction",label:c(2920,"Cut"),run:()=>{e.trace("TextInputActionsProvider#cut"),Zn().execCommand("cut")}}),Gt({id:"editor.action.clipboardCopyAction",label:c(2921,"Copy"),run:()=>{e.trace("TextInputActionsProvider#copy"),Zn().execCommand("copy")}}),Gt({id:"editor.action.clipboardPasteAction",label:c(2922,"Paste"),run:async t=>{e.trace("TextInputActionsProvider#paste");const i=await a.readText();if(th(t)||y_(t)){const s=t.selectionStart||0,o=t.selectionEnd||0;t.value=`${t.value.substring(0,s)}${i}${t.value.substring(o,t.value.length)}`,t.selectionStart=s+i.length,t.selectionEnd=t.selectionStart,t.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))}}}),new ys,Gt({id:"editor.action.selectAll",label:c(2923,"Select All"),run:()=>Zn().execCommand("selectAll")})]}var qa;let vu=(qa=class extends M{constructor(e,t,i,s){super(),this.layoutService=e,this.contextMenuService=t,this.clipboardService=i,this.logService=s,this.textInputActions=new Tp(()=>z0(this.clipboardService,this.logService)),this.registerListeners()}registerListeners(){this._register(K.runAndSubscribe(this.layoutService.onDidAddContainer,({container:e,disposables:t})=>{t.add(X(e,"contextmenu",i=>this.onContextMenu(He(e),i)))},{container:this.layoutService.mainContainer,disposables:this._store}))}onContextMenu(e,t){if(t.defaultPrevented)return;const i=t.target;if(!th(i)&&!y_(i))return;be.stop(t,!0);const s=new uo(e,t);this.contextMenuService.showContextMenu({getAnchor:()=>s,getActions:()=>this.textInputActions.value,getActionsContext:()=>i})}},qa.ID="workbench.contrib.textInputActionsProvider",qa);vu=D([u(0,je),u(1,st),u(2,yc),u(3,et)],vu);Vt(vu.ID,vu,Pt.BlockRestore);const dc=class dc extends R{constructor(){super({id:dc.ID,title:{...y(2755,"Keyboard Shortcuts Reference"),mnemonicTitle:c(2756,"&&Keyboard Shortcuts Reference")},category:T.Help,f1:!0,keybinding:{weight:L.WorkbenchContrib,when:null,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.KeyR)},menu:{id:b.MenubarHelpMenu,group:"2_reference",order:1}})}run(e){const t=e.get(_s),i=e.get(tt),s=xn?t.keyboardShortcutsUrlLinux:Ge?t.keyboardShortcutsUrlMac:t.keyboardShortcutsUrlWin;s&&i.open(F.parse(s))}};dc.ID="workbench.action.keybindingsReference",dc.AVAILABLE=!!(xn?Vi.keyboardShortcutsUrlLinux:Ge?Vi.keyboardShortcutsUrlMac:Vi.keyboardShortcutsUrlWin);let yu=dc;const cc=class cc extends R{constructor(){super({id:cc.ID,title:{...y(2757,"Video Tutorials"),mnemonicTitle:c(2758,"&&Video Tutorials")},category:T.Help,f1:!0,menu:{id:b.MenubarHelpMenu,group:"2_reference",order:2}})}run(e){const t=e.get(_s),i=e.get(tt);t.introductoryVideosUrl&&i.open(F.parse(t.introductoryVideosUrl))}};cc.ID="workbench.action.openVideoTutorialsUrl",cc.AVAILABLE=!!Vi.introductoryVideosUrl;let Cu=cc;const lc=class lc extends R{constructor(){super({id:lc.ID,title:{...y(2759,"Tips and Tricks"),mnemonicTitle:c(2760,"Tips and Tri&&cks")},category:T.Help,f1:!0,menu:{id:b.MenubarHelpMenu,group:"2_reference",order:3}})}run(e){const t=e.get(_s),i=e.get(tt);t.tipsAndTricksUrl&&i.open(F.parse(t.tipsAndTricksUrl))}};lc.ID="workbench.action.openTipsAndTricksUrl",lc.AVAILABLE=!!Vi.tipsAndTricksUrl;let Su=lc;const hc=class hc extends R{constructor(){super({id:hc.ID,title:{...y(2761,"Documentation"),mnemonicTitle:c(2762,"&&Documentation")},category:T.Help,f1:!0,menu:{id:b.MenubarHelpMenu,group:"1_welcome",order:3}})}run(e){const t=e.get(_s),i=e.get(tt),s=ei?t.serverDocumentationUrl:t.documentationUrl;s&&i.open(F.parse(s))}};hc.ID="workbench.action.openDocumentationUrl",hc.AVAILABLE=!!(ei?Vi.serverDocumentationUrl:Vi.documentationUrl);let Eu=hc;const uc=class uc extends R{constructor(){super({id:uc.ID,title:y(2763,"Signup for the VS Code Newsletter"),category:T.Help,f1:!0})}run(e){const t=e.get(_s),i=e.get(tt),s=e.get(nt);i.open(F.parse(`${t.newsletterSignupUrl}?machineId=${encodeURIComponent(s.machineId)}`))}};uc.ID="workbench.action.openNewsletterSignupUrl",uc.AVAILABLE=!!Vi.newsletterSignupUrl;let _u=uc;const pc=class pc extends R{constructor(){super({id:pc.ID,title:{...y(2764,"Join Us on YouTube"),mnemonicTitle:c(2765,"&&Join Us on YouTube")},category:T.Help,f1:!0,menu:{id:b.MenubarHelpMenu,group:"3_feedback",order:1}})}run(e){const t=e.get(_s),i=e.get(tt);t.youTubeUrl&&i.open(F.parse(t.youTubeUrl))}};pc.ID="workbench.action.openYouTubeUrl",pc.AVAILABLE=!!Vi.youTubeUrl;let Iu=pc;const gc=class gc extends R{constructor(){super({id:gc.ID,title:{...y(2766,"Search Feature Requests"),mnemonicTitle:c(2767,"&&Search Feature Requests")},category:T.Help,f1:!0,menu:{id:b.MenubarHelpMenu,group:"3_feedback",order:2}})}run(e){const t=e.get(_s),i=e.get(tt);t.requestFeatureUrl&&i.open(F.parse(t.requestFeatureUrl))}};gc.ID="workbench.action.openRequestFeatureUrl",gc.AVAILABLE=!!Vi.requestFeatureUrl;let Du=gc;const fc=class fc extends R{constructor(){super({id:fc.ID,title:{...y(2768,"View License"),mnemonicTitle:c(2769,"View &&License")},category:T.Help,f1:!0,menu:{id:b.MenubarHelpMenu,group:"4_legal",order:1}})}run(e){const t=e.get(_s),i=e.get(tt),s=ei?t.serverLicenseUrl:t.licenseUrl;if(s)if(Qg){const o=s.indexOf("?")>0?"&":"?";i.open(F.parse(`${s}${o}lang=${Qg}`))}else i.open(F.parse(s))}};fc.ID="workbench.action.openLicenseUrl",fc.AVAILABLE=!!(ei?Vi.serverLicense:Vi.licenseUrl);let Au=fc;const mc=class mc extends R{constructor(){super({id:mc.ID,title:{...y(2770,"Privacy Statement"),mnemonicTitle:c(2771,"Privac&&y Statement")},category:T.Help,f1:!0,menu:{id:b.MenubarHelpMenu,group:"4_legal",order:2}})}run(e){const t=e.get(_s),i=e.get(tt);t.privacyStatementUrl&&i.open(F.parse(t.privacyStatementUrl))}};mc.ID="workbench.action.openPrivacyStatementUrl",mc.AVAILABLE=!!Vi.privacyStatementUrl;let Tu=mc;const op=class op extends R{constructor(){super({id:op.ID,title:y(2772,"Get Started with Accessibility Features"),category:T.Help,f1:!0,menu:{id:b.MenubarHelpMenu,group:"1_welcome",order:6}})}run(e){e.get(ke).executeCommand("workbench.action.openWalkthrough","SetupAccessibility")}};op.ID="workbench.action.getStartedWithAccessibilityFeatures";let ab=op;const rp=class rp extends R{constructor(){super({id:rp.ID,title:y(2773,"Ask @vscode"),category:T.Help,f1:!0,precondition:I.equals("chatSetupHidden",!1)})}async run(e){e.get(ke).executeCommand("workbench.action.chat.open",{mode:"ask",query:"@vscode ",isPartialQuery:!0})}};rp.ID="workbench.action.askVScode";let ku=rp;_.appendMenuItem(b.MenubarHelpMenu,{command:{id:ku.ID,title:y(2773,"Ask @vscode")},order:7,group:"1_welcome",when:I.equals("chatSetupHidden",!1)});yu.AVAILABLE&&S(yu);Cu.AVAILABLE&&S(Cu);Su.AVAILABLE&&S(Su);Eu.AVAILABLE&&S(Eu);_u.AVAILABLE&&S(_u);Iu.AVAILABLE&&S(Iu);Du.AVAILABLE&&S(Du);Au.AVAILABLE&&S(Au);Tu.AVAILABLE&&S(Tu);S(ab);S(ku);function Fv(a){const e=a?.getHTMLElement();e&&!Jl(e)&&a?.domFocus()}async function $0(a,e){if(!S_.getValue(a.contextKeyService))return e(a);const t=a.getFocus(),i=a.getSelection();await e(a);const s=a.getFocus();if(i.length>1||!In(t,i)||In(t,s))return;const o=new KeyboardEvent("keydown");a.setSelection(s,o)}async function bi(a,e){if(!a)return;await $0(a,e);const t=a.getFocus();t.length&&a.reveal(t[0]),a.setAnchor(t[0]),Fv(a)}Z.registerCommandAndKeybindingRule({id:"list.focusDown",weight:L.WorkbenchContrib,when:Pe,primary:w.DownArrow,mac:{primary:w.DownArrow,secondary:[C.WinCtrl|w.KeyN]},handler:(a,e)=>{bi(a.get(ne).lastFocusedList,async t=>{const i=new KeyboardEvent("keydown");await t.focusNext(typeof e=="number"?e:1,!1,i)})}});Z.registerCommandAndKeybindingRule({id:"list.focusUp",weight:L.WorkbenchContrib,when:Pe,primary:w.UpArrow,mac:{primary:w.UpArrow,secondary:[C.WinCtrl|w.KeyP]},handler:(a,e)=>{bi(a.get(ne).lastFocusedList,async t=>{const i=new KeyboardEvent("keydown");await t.focusPrevious(typeof e=="number"?e:1,!1,i)})}});Z.registerCommandAndKeybindingRule({id:"list.focusAnyDown",weight:L.WorkbenchContrib,when:Pe,primary:C.Alt|w.DownArrow,mac:{primary:C.Alt|w.DownArrow,secondary:[C.WinCtrl|C.Alt|w.KeyN]},handler:(a,e)=>{bi(a.get(ne).lastFocusedList,async t=>{const i=new KeyboardEvent("keydown",{altKey:!0});await t.focusNext(typeof e=="number"?e:1,!1,i)})}});Z.registerCommandAndKeybindingRule({id:"list.focusAnyUp",weight:L.WorkbenchContrib,when:Pe,primary:C.Alt|w.UpArrow,mac:{primary:C.Alt|w.UpArrow,secondary:[C.WinCtrl|C.Alt|w.KeyP]},handler:(a,e)=>{bi(a.get(ne).lastFocusedList,async t=>{const i=new KeyboardEvent("keydown",{altKey:!0});await t.focusPrevious(typeof e=="number"?e:1,!1,i)})}});Z.registerCommandAndKeybindingRule({id:"list.focusPageDown",weight:L.WorkbenchContrib,when:Pe,primary:w.PageDown,handler:a=>{bi(a.get(ne).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown");await e.focusNextPage(t)})}});Z.registerCommandAndKeybindingRule({id:"list.focusPageUp",weight:L.WorkbenchContrib,when:Pe,primary:w.PageUp,handler:a=>{bi(a.get(ne).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown");await e.focusPreviousPage(t)})}});Z.registerCommandAndKeybindingRule({id:"list.focusFirst",weight:L.WorkbenchContrib,when:Pe,primary:w.Home,handler:a=>{bi(a.get(ne).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown");await e.focusFirst(t)})}});Z.registerCommandAndKeybindingRule({id:"list.focusLast",weight:L.WorkbenchContrib,when:Pe,primary:w.End,handler:a=>{bi(a.get(ne).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown");await e.focusLast(t)})}});Z.registerCommandAndKeybindingRule({id:"list.focusAnyFirst",weight:L.WorkbenchContrib,when:Pe,primary:C.Alt|w.Home,handler:a=>{bi(a.get(ne).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown",{altKey:!0});await e.focusFirst(t)})}});Z.registerCommandAndKeybindingRule({id:"list.focusAnyLast",weight:L.WorkbenchContrib,when:Pe,primary:C.Alt|w.End,handler:a=>{bi(a.get(ne).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown",{altKey:!0});await e.focusLast(t)})}});function eD(a,e){if(a instanceof ol||a instanceof rl||a instanceof nl){const t=a,i=t.getFocus()?t.getFocus()[0]:void 0,s=t.getSelection();s&&typeof i=="number"&&s.indexOf(i)>=0?t.setSelection(s.filter(o=>o!==e)):typeof i=="number"&&t.setSelection(s.concat(i))}else if(a instanceof Is||a instanceof Ds||a instanceof ri){const t=a,i=t.getFocus()?t.getFocus()[0]:void 0;if(e===i)return;const s=t.getSelection(),o=new KeyboardEvent("keydown",{shiftKey:!0});s&&s.indexOf(i)>=0?t.setSelection(s.filter(r=>r!==e),o):t.setSelection(s.concat(i),o)}}function Bv(a,e){const t=a.getStickyScrollFocus();if(t.length===0)throw new Error("StickyScroll has no focus");if(t.length>1)throw new Error("StickyScroll can only have a single focused item");a.reveal(t[0]),a.getHTMLElement().focus(),a.setFocus(t),e?.(t[0])}Z.registerCommandAndKeybindingRule({id:"list.expandSelectionDown",weight:L.WorkbenchContrib,when:I.and(Pe,ov),primary:C.Shift|w.DownArrow,handler:(a,e)=>{const t=a.get(ne).lastFocusedList;if(!t)return;const i=t.getFocus()?t.getFocus()[0]:void 0,s=new KeyboardEvent("keydown");t.focusNext(typeof e=="number"?e:1,!1,s),eD(t,i);const o=t.getFocus();o.length&&t.reveal(o[0]),Fv(t)}});Z.registerCommandAndKeybindingRule({id:"list.expandSelectionUp",weight:L.WorkbenchContrib,when:I.and(Pe,ov),primary:C.Shift|w.UpArrow,handler:(a,e)=>{const t=a.get(ne).lastFocusedList;if(!t)return;const i=t.getFocus()?t.getFocus()[0]:void 0,s=new KeyboardEvent("keydown");t.focusPrevious(typeof e=="number"?e:1,!1,s),eD(t,i);const o=t.getFocus();o.length&&t.reveal(o[0]),Fv(t)}});Z.registerCommandAndKeybindingRule({id:"list.collapse",weight:L.WorkbenchContrib,when:I.and(Pe,I.or(_R,IR)),primary:w.LeftArrow,mac:{primary:w.LeftArrow,secondary:[C.CtrlCmd|w.UpArrow]},handler:a=>{const e=a.get(ne).lastFocusedList;if(!e||!(e instanceof Is||e instanceof Ds||e instanceof ri))return;const t=e,i=t.getFocus();if(i.length===0)return;const s=i[0];if(!t.collapse(s)){const o=t.getParentElement(s);o&&bi(e,r=>{const n=new KeyboardEvent("keydown");r.setFocus([o],n)})}}});Z.registerCommandAndKeybindingRule({id:"list.stickyScroll.collapse",weight:L.WorkbenchContrib+50,when:rv,primary:w.LeftArrow,mac:{primary:w.LeftArrow,secondary:[C.CtrlCmd|w.UpArrow]},handler:a=>{const e=a.get(ne).lastFocusedList;!e||!(e instanceof Is||e instanceof Ds||e instanceof ri)||Bv(e,t=>e.collapse(t))}});Z.registerCommandAndKeybindingRule({id:"list.collapseAll",weight:L.WorkbenchContrib,when:Pe,primary:C.CtrlCmd|w.LeftArrow,mac:{primary:C.CtrlCmd|w.LeftArrow,secondary:[C.CtrlCmd|C.Shift|w.UpArrow]},handler:a=>{const e=a.get(ne).lastFocusedList;e&&!(e instanceof ol||e instanceof rl||e instanceof nl)&&e.collapseAll()}});Z.registerCommandAndKeybindingRule({id:"list.collapseAllToFocus",weight:L.WorkbenchContrib,when:Pe,handler:a=>{const e=a.get(ne).lastFocusedList,t=C_("keydown",!0);if(e instanceof Is||e instanceof Ds||e instanceof ri){const i=e,s=i.getFocus();s.length>0&&i.collapse(s[0],!0),i.setSelection(s,t),i.setAnchor(s[0])}}});Z.registerCommandAndKeybindingRule({id:"list.focusParent",weight:L.WorkbenchContrib,when:Pe,handler:a=>{const e=a.get(ne).lastFocusedList;if(!e||!(e instanceof Is||e instanceof Ds||e instanceof ri))return;const t=e,i=t.getFocus();if(i.length===0)return;const s=i[0],o=t.getParentElement(s);o&&bi(e,r=>{const n=new KeyboardEvent("keydown");r.setFocus([o],n)})}});Z.registerCommandAndKeybindingRule({id:"list.expand",weight:L.WorkbenchContrib,when:I.and(Pe,I.or(DR,AR)),primary:w.RightArrow,handler:a=>{const e=a.get(ne).lastFocusedList;if(e){if(e instanceof Is||e instanceof Ds){const t=e.getFocus();if(t.length===0)return;const i=t[0];if(!e.expand(i)){const s=e.getFirstElementChild(i);s&&e.getNode(s).visible&&bi(e,r=>{const n=new KeyboardEvent("keydown");r.setFocus([s],n)})}}else if(e instanceof ri){const t=e.getFocus();if(t.length===0)return;const i=t[0];e.expand(i).then(s=>{if(i&&!s){const o=e.getFirstElementChild(i);o&&e.getNode(o).visible&&bi(e,n=>{const d=new KeyboardEvent("keydown");n.setFocus([o],d)})}})}}}});function Gv(a,e){const t=a.get(ne).lastFocusedList,i=C_("keydown",e);if(t instanceof ol||t instanceof rl||t instanceof nl){const s=t;s.setAnchor(s.getFocus()[0]),s.setSelection(s.getFocus(),i)}else if(t instanceof Is||t instanceof Ds||t instanceof ri){const s=t,o=s.getFocus();if(o.length>0){let r=!0;(s.expandOnlyOnTwistieClick===!0||typeof s.expandOnlyOnTwistieClick!="boolean"&&s.expandOnlyOnTwistieClick(o[0]))&&(r=!1),r&&s.toggleCollapsed(o[0])}s.setAnchor(o[0]),s.setSelection(o,i)}}Z.registerCommandAndKeybindingRule({id:"list.select",weight:L.WorkbenchContrib,when:Pe,primary:w.Enter,mac:{primary:w.Enter,secondary:[C.CtrlCmd|w.DownArrow]},handler:a=>{Gv(a,!1)}});Z.registerCommandAndKeybindingRule({id:"list.stickyScrollselect",weight:L.WorkbenchContrib+50,when:rv,primary:w.Enter,mac:{primary:w.Enter,secondary:[C.CtrlCmd|w.DownArrow]},handler:a=>{const e=a.get(ne).lastFocusedList;!e||!(e instanceof Is||e instanceof Ds||e instanceof ri)||Bv(e,t=>e.setSelection([t]))}});Z.registerCommandAndKeybindingRule({id:"list.selectAndPreserveFocus",weight:L.WorkbenchContrib,when:Pe,handler:a=>{Gv(a,!0)}});Z.registerCommandAndKeybindingRule({id:"list.selectAll",weight:L.WorkbenchContrib,when:I.and(Pe,ov),primary:C.CtrlCmd|w.KeyA,handler:a=>{const e=a.get(ne).lastFocusedList;if(e instanceof ol||e instanceof rl||e instanceof nl){const t=e,i=new KeyboardEvent("keydown");t.setSelection(TR(t.length),i)}else if(e instanceof Is||e instanceof Ds||e instanceof ri){const t=e,i=t.getFocus(),s=t.getSelection();let o;i.length>0&&(s.length===0||!s.includes(i[0]))&&(o=i[0]),!o&&s.length>0&&(o=s[0]);let r;o?r=t.getParentElement(o):r=void 0;const n=[],d=h=>{for(const p of h.children)p.visible&&(n.push(p.element),p.collapsed||d(p))};d(t.getNode(r)),r&&s.length===n.length&&n.unshift(r);const l=new KeyboardEvent("keydown");t.setSelection(n,l)}}});Z.registerCommandAndKeybindingRule({id:"list.toggleSelection",weight:L.WorkbenchContrib,when:Pe,primary:C.CtrlCmd|C.Shift|w.Enter,handler:a=>{const e=a.get(ne).lastFocusedList;if(!e)return;const t=e.getFocus();if(t.length===0)return;const i=e.getSelection(),s=i.indexOf(t[0]);s>-1?e.setSelection([...i.slice(0,s),...i.slice(s+1)]):e.setSelection([...i,t[0]])}});Z.registerCommandAndKeybindingRule({id:"list.showHover",weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.KeyI),when:Pe,handler:async a=>{const t=a.get(ne).lastFocusedList;if(!t)return;const i=t.getFocus();if(!i||i.length===0)return;const n=t.getHTMLElement().querySelector(".monaco-scrollable-element")?.querySelector(".monaco-list-rows")?.querySelector(".focused");if(!n)return;const d=q0(n);d&&a.get(oi).showManagedHover(d)}});function q0(a){if(a.matches('[custom-hover="true"]'))return a;const e=a.querySelector('[custom-hover="true"]:not([tabindex]):not(.action-item)');if(e)return e}Z.registerCommandAndKeybindingRule({id:"list.toggleExpand",weight:L.WorkbenchContrib,when:Pe,primary:w.Space,handler:a=>{const e=a.get(ne).lastFocusedList;if(e instanceof Is||e instanceof Ds||e instanceof ri){const t=e,i=t.getFocus();if(!t.options.disableExpandOnSpacebar&&i.length>0&&t.isCollapsible(i[0])){t.toggleCollapsed(i[0]);return}}Gv(a,!0)}});Z.registerCommandAndKeybindingRule({id:"list.stickyScrolltoggleExpand",weight:L.WorkbenchContrib+50,when:rv,primary:w.Space,handler:a=>{const e=a.get(ne).lastFocusedList;!e||!(e instanceof Is||e instanceof Ds||e instanceof ri)||Bv(e)}});Z.registerCommandAndKeybindingRule({id:"list.clear",weight:L.WorkbenchContrib,when:I.and(Pe,kR),primary:w.Escape,handler:a=>{const e=a.get(ne).lastFocusedList;if(!e)return;const t=e.getSelection(),i=new KeyboardEvent("keydown");if(t.length>1)if(S_.getValue(e.contextKeyService)){const o=e.getFocus();e.setSelection([o[0]],i)}else e.setSelection([],i);else e.setSelection([],i),e.setFocus([],i);e.setAnchor(void 0)}});re.registerCommand({id:"list.triggerTypeNavigation",handler:a=>{a.get(ne).lastFocusedList?.triggerTypeNavigation()}});re.registerCommand({id:"list.toggleFindMode",handler:a=>{const e=a.get(ne).lastFocusedList;if(e instanceof Wp||e instanceof ri){const t=e;t.findMode=t.findMode===Cg.Filter?Cg.Highlight:Cg.Filter}}});re.registerCommand({id:"list.toggleFindMatchType",handler:a=>{const e=a.get(ne).lastFocusedList;if(e instanceof Wp||e instanceof ri){const t=e;t.findMatchType=t.findMatchType===Sg.Contiguous?Sg.Fuzzy:Sg.Contiguous}}});re.registerCommandAlias("list.toggleKeyboardNavigation","list.triggerTypeNavigation");re.registerCommandAlias("list.toggleFilterOnType","list.toggleFindMode");Z.registerCommandAndKeybindingRule({id:"list.find",weight:L.WorkbenchContrib,when:I.and(E_,xR),primary:C.CtrlCmd|C.Alt|w.KeyF,secondary:[w.F3],handler:a=>{const e=a.get(ne).lastFocusedList;e instanceof ol||e instanceof rl||e instanceof nl||(e instanceof Wp||e instanceof ri)&&e.openFind()}});Z.registerCommandAndKeybindingRule({id:"list.closeFind",weight:L.WorkbenchContrib,when:I.and(E_,LR),primary:w.Escape,handler:a=>{const e=a.get(ne).lastFocusedList;(e instanceof Wp||e instanceof ri)&&e.closeFind()}});Z.registerCommandAndKeybindingRule({id:"list.scrollUp",weight:L.WorkbenchContrib,when:I.and(Pe,RR?.negate()),primary:C.CtrlCmd|w.UpArrow,handler:a=>{const e=a.get(ne).lastFocusedList;e&&(e.scrollTop-=10)}});Z.registerCommandAndKeybindingRule({id:"list.scrollDown",weight:L.WorkbenchContrib,when:I.and(Pe,VR?.negate()),primary:C.CtrlCmd|w.DownArrow,handler:a=>{const e=a.get(ne).lastFocusedList;e&&(e.scrollTop+=10)}});Z.registerCommandAndKeybindingRule({id:"list.scrollLeft",weight:L.WorkbenchContrib,when:Pe,handler:a=>{const e=a.get(ne).lastFocusedList;e&&(e.scrollLeft-=10)}});Z.registerCommandAndKeybindingRule({id:"list.scrollRight",weight:L.WorkbenchContrib,when:Pe,handler:a=>{const e=a.get(ne).lastFocusedList;e&&(e.scrollLeft+=10)}});S(class extends R{constructor(){super({id:"tree.toggleStickyScroll",title:{...y(2903,"Toggle Tree Sticky Scroll"),mnemonicTitle:c(2904,"&&Toggle Tree Sticky Scroll")},category:"View",metadata:{description:c(2905,"Toggles Sticky Scroll widget at the top of tree structures such as the File Explorer and Debug variables View.")},f1:!0})}run(e){const t=e.get(te),i=!t.getValue("workbench.tree.enableStickyScroll");t.updateValue("workbench.tree.enableStickyScroll",i)}});class ig extends R{constructor(e,t){super(e),this.direction=t}run(e){const t=e.get(je),i=e.get(U),s=e.get(_r),o=t.hasFocus(j.EDITOR_PART),r=t.hasFocus(j.PANEL_PART),n=t.hasFocus(j.SIDEBAR_PART),d=t.hasFocus(j.AUXILIARYBAR_PART);let l;if(o){if(this.navigateAcrossEditorGroup(this.toGroupDirection(this.direction),i))return;l=t.getVisibleNeighborPart(j.EDITOR_PART,this.direction)}r&&(l=t.getVisibleNeighborPart(j.PANEL_PART,this.direction)),n&&(l=t.getVisibleNeighborPart(j.SIDEBAR_PART,this.direction)),d&&(l=l=t.getVisibleNeighborPart(j.AUXILIARYBAR_PART,this.direction)),l===j.EDITOR_PART?this.navigateBackToEditorGroup(this.toGroupDirection(this.direction),i)||this.navigateToEditorGroup(this.direction===_e.Right?Xe.FIRST:Xe.LAST,i):l===j.SIDEBAR_PART?this.navigateToSidebar(t,s):l===j.PANEL_PART?this.navigateToPanel(t,s):l===j.AUXILIARYBAR_PART&&this.navigateToAuxiliaryBar(t,s)}async navigateToPanel(e,t){if(!e.isVisible(j.PANEL_PART))return!1;const i=t.getActivePaneComposite(ce.Panel);if(!i)return!1;const s=i.getId(),o=await t.openPaneComposite(s,ce.Panel,!0);return o||!1}async navigateToSidebar(e,t){if(!e.isVisible(j.SIDEBAR_PART))return!1;const i=t.getActivePaneComposite(ce.Sidebar);if(!i)return!1;const s=i.getId();return!!await t.openPaneComposite(s,ce.Sidebar,!0)}async navigateToAuxiliaryBar(e,t){if(!e.isVisible(j.AUXILIARYBAR_PART))return!1;const i=t.getActivePaneComposite(ce.AuxiliaryBar);if(!i)return!1;const s=i.getId(),o=await t.openPaneComposite(s,ce.AuxiliaryBar,!0);return o||!1}navigateAcrossEditorGroup(e,t){return this.doNavigateToEditorGroup({direction:e},t)}navigateToEditorGroup(e,t){return this.doNavigateToEditorGroup({location:e},t)}navigateBackToEditorGroup(e,t){if(!t.activeGroup)return!1;const i=this.toOppositeDirection(e);return t.findGroup({direction:i},t.activeGroup)?!1:(t.activeGroup.focus(),!0)}toGroupDirection(e){switch(e){case _e.Down:return J.DOWN;case _e.Left:return J.LEFT;case _e.Right:return J.RIGHT;case _e.Up:return J.UP}}toOppositeDirection(e){switch(e){case J.UP:return J.DOWN;case J.RIGHT:return J.LEFT;case J.LEFT:return J.RIGHT;case J.DOWN:return J.UP}}doNavigateToEditorGroup(e,t){const i=t.findGroup(e,t.activeGroup);return i?(i.focus(),!0):!1}}S(class extends ig{constructor(){super({id:"workbench.action.navigateLeft",title:y(2906,"Navigate to the View on the Left"),category:T.View,f1:!0},_e.Left)}});S(class extends ig{constructor(){super({id:"workbench.action.navigateRight",title:y(2907,"Navigate to the View on the Right"),category:T.View,f1:!0},_e.Right)}});S(class extends ig{constructor(){super({id:"workbench.action.navigateUp",title:y(2908,"Navigate to the View Above"),category:T.View,f1:!0},_e.Up)}});S(class extends ig{constructor(){super({id:"workbench.action.navigateDown",title:y(2909,"Navigate to the View Below"),category:T.View,f1:!0},_e.Down)}});class tD extends R{constructor(e,t){super(e),this.focusNext=t}run(e){const t=e.get(je),i=e.get(O);this.focusNextOrPreviousPart(t,i,this.focusNext)}findVisibleNeighbour(e,t,i){const s=wr(),o=CE(s);let r;if(o)t===j.EDITOR_PART?r=j.STATUSBAR_PART:r=j.EDITOR_PART;else switch(t){case j.EDITOR_PART:r=i?j.PANEL_PART:j.SIDEBAR_PART;break;case j.PANEL_PART:r=i?j.AUXILIARYBAR_PART:j.EDITOR_PART;break;case j.AUXILIARYBAR_PART:r=i?j.STATUSBAR_PART:j.PANEL_PART;break;case j.STATUSBAR_PART:r=i?j.ACTIVITYBAR_PART:j.AUXILIARYBAR_PART;break;case j.ACTIVITYBAR_PART:r=i?j.SIDEBAR_PART:j.STATUSBAR_PART;break;case j.SIDEBAR_PART:r=i?j.EDITOR_PART:j.ACTIVITYBAR_PART;break;default:r=j.EDITOR_PART}return e.isVisible(r,s)||r===j.EDITOR_PART?r:this.findVisibleNeighbour(e,r,i)}focusNextOrPreviousPart(e,t,i){let s;t.activeEditorPane?.hasFocus()||e.hasFocus(j.EDITOR_PART)?s=j.EDITOR_PART:e.hasFocus(j.ACTIVITYBAR_PART)?s=j.ACTIVITYBAR_PART:e.hasFocus(j.STATUSBAR_PART)?s=j.STATUSBAR_PART:e.hasFocus(j.SIDEBAR_PART)?s=j.SIDEBAR_PART:e.hasFocus(j.AUXILIARYBAR_PART)?s=j.AUXILIARYBAR_PART:e.hasFocus(j.PANEL_PART)&&(s=j.PANEL_PART),e.focusPart(s?this.findVisibleNeighbour(e,s,i):j.EDITOR_PART,wr())}}S(class extends tD{constructor(){super({id:"workbench.action.focusNextPart",title:y(2910,"Focus Next Part"),category:T.View,f1:!0,keybinding:{primary:w.F6,weight:L.WorkbenchContrib}},!0)}});S(class extends tD{constructor(){super({id:"workbench.action.focusPreviousPart",title:y(2911,"Focus Previous Part"),category:T.View,f1:!0,keybinding:{primary:C.Shift|w.F6,weight:L.WorkbenchContrib}},!1)}});const Wv="addRootFolder",j0=y(2976,"Add Folder to Workspace..."),iD="setRootFolder",sD="_workbench.pickWorkspaceFolder";re.registerCommand({id:"workbench.action.files.openFileFolderInNewWindow",handler:a=>a.get(yi).pickFileFolderAndOpen({forceNewWindow:!0})});re.registerCommand({id:"_files.pickFolderAndOpen",handler:(a,e)=>a.get(yi).pickFolderAndOpen(e)});re.registerCommand({id:"workbench.action.files.openFolderInNewWindow",handler:a=>a.get(yi).pickFolderAndOpen({forceNewWindow:!0})});re.registerCommand({id:"workbench.action.files.openFileInNewWindow",handler:a=>a.get(yi).pickFileAndOpen({forceNewWindow:!0})});re.registerCommand({id:"workbench.action.openWorkspaceInNewWindow",handler:a=>a.get(yi).pickWorkspaceAndOpen({forceNewWindow:!0})});re.registerCommand({id:Wv,handler:async a=>{const e=a.get(al),t=await oD(a);t?.length&&await e.addFolders(t.map(i=>({uri:i})))}});re.registerCommand({id:iD,handler:async a=>{const e=a.get(al),t=a.get(xt),i=await oD(a);i?.length&&await e.updateFolders(0,t.getWorkspace().folders.length,i.map(s=>({uri:s})))}});async function oD(a){const e=a.get(yi),t=a.get(Gn);return await e.showOpenDialog({openLabel:wE(c(2977,"&&Add")),title:c(2978,"Add Folder to Workspace"),canSelectFolders:!0,canSelectMany:!0,defaultUri:await e.defaultFolderPath(),availableFileSystems:[t.defaultUriScheme]})}re.registerCommand(sD,async function(a,e){const t=a.get(lt),i=a.get(rs),s=a.get(xt),o=a.get(Ro),r=a.get(Es),n=s.getWorkspace().folders;if(!n.length)return;const d=n.map(g=>{const f=g.name,m=i.getUriLabel(qc(g.uri),{relative:!0});return{label:f,description:m!==f?m:void 0,folder:g,iconClasses:ES(o,r,g.uri,$t.ROOT_FOLDER)}}),l=(e?e[0]:void 0)||Object.create(null);l.activeItem||(l.activeItem=d[0]),l.placeHolder||(l.placeHolder=c(2979,"Select workspace folder")),typeof l.matchOnDescription!="boolean"&&(l.matchOnDescription=!0);const h=(e?e[1]:void 0)||Ni.None,p=await t.pick(d,l,h);if(p)return n[d.indexOf(p)]});re.registerCommand({id:"vscode.openFolder",handler:(a,e,t)=>{const i=a.get(ke);if(typeof t=="boolean"&&(t={forceNewWindow:t}),!e){const d={forceNewWindow:t?.forceNewWindow};return t?.forceLocalWindow&&(d.remoteAuthority=null,d.availableFileSystems=["file"]),i.executeCommand("_files.pickFolderAndOpen",d)}const s=F.from(e,!0),o={forceNewWindow:t?.forceNewWindow,forceReuseWindow:t?.forceReuseWindow,noRecentEntry:t?.noRecentEntry,remoteAuthority:t?.forceLocalWindow?null:void 0,forceProfile:t?.forceProfile,forceTempProfile:t?.forceTempProfile},r=__(s)||s.scheme===ue.untitled?{workspaceUri:s}:{folderUri:s},n=t?.filesToOpen?.map(d=>({fileUri:F.from(d,!0)}))??[];return i.executeCommand("_files.windowOpen",[r,...n],o)},metadata:{description:"Open a folder or workspace in the current window or new window depending on the newWindow argument. Note that opening in the same window will shutdown the current extension host process and start a new one on the given folder/workspace unless the newWindow parameter is set to true.",args:[{name:"uri",description:"(optional) Uri of the folder or workspace file to open. If not provided, a native dialog will ask the user for the folder",constraint:a=>a==null||a instanceof F},{name:"options",description:"(optional) Options. Object with the following properties: `forceNewWindow`: Whether to open the folder/workspace in a new window or the same. Defaults to opening in the same window. `forceReuseWindow`: Whether to force opening the folder/workspace in the same window.  Defaults to false. `noRecentEntry`: Whether the opened URI will appear in the 'Open Recent' list. Defaults to false. `forceLocalWindow`: Whether to force opening the folder/workspace in a local window. Defaults to false. `forceProfile`: The profile to use when opening the folder/workspace. Defaults to the current profile. `forceTempProfile`: Whether to use a temporary profile when opening the folder/workspace. Defaults to false. `filesToOpen`: An array of files to open in the new window. Defaults to an empty array. Note, for backward compatibility, options can also be of type boolean, representing the `forceNewWindow` setting.",constraint:a=>a===void 0||typeof a=="object"||typeof a=="boolean"}]}});re.registerCommand({id:"vscode.newWindow",handler:(a,e)=>{const t=a.get(ke),i={forceReuseWindow:e?.reuseWindow,remoteAuthority:e?.remoteAuthority};return t.executeCommand("_files.newWindow",i)},metadata:{description:"Opens an new window depending on the newWindow argument.",args:[{name:"options",description:"(optional) Options. Object with the following properties: `reuseWindow`: Whether to open a new window or the same. Defaults to opening in a new window. ",constraint:a=>a===void 0||typeof a=="object"}]}});re.registerCommand("_workbench.removeFromRecentlyOpened",function(a,e){return a.get(Wn).removeRecentlyOpened([e])});re.registerCommand({id:"vscode.removeFromRecentlyOpened",handler:(a,e)=>{const t=a.get(Wn);return typeof e=="string"?e=e.match(/^[^:/?#]+:\/\//)?F.parse(e):F.file(e):e=F.revive(e),t.removeRecentlyOpened([e])},metadata:{description:"Removes an entry with the given path from the recently opened list.",args:[{name:"path",description:"URI or URI string to remove from recently opened.",constraint:a=>typeof a=="string"||a instanceof F}]}});re.registerCommand("_workbench.addToRecentlyOpened",async function(a,e){const t=a.get(Wn),i=e.uri,s=e.label,o=e.remoteAuthority;let r;return e.type==="workspace"?r={workspace:await t.getWorkspaceIdentifier(i),label:s,remoteAuthority:o}:e.type==="folder"?r={folderUri:i,label:s,remoteAuthority:o}:r={fileUri:i,label:s,remoteAuthority:o},t.addRecentlyOpened([r])});re.registerCommand("_workbench.getRecentlyOpened",async function(a){return a.get(Wn).getRecentlyOpened()});const Id=y(2957,"Workspaces"),np=class np extends R{constructor(){super({id:np.ID,title:y(2958,"Open File..."),category:T.File,f1:!0,keybinding:{when:Kp.toNegated(),weight:L.WorkbenchContrib,primary:C.CtrlCmd|w.KeyO}})}async run(e,t){return e.get(yi).pickFileAndOpen({forceNewWindow:!1,telemetryExtraData:t})}};np.ID="workbench.action.files.openFile";let xu=np;const ap=class ap extends R{constructor(){super({id:ap.ID,title:y(2959,"Open Folder..."),category:T.File,f1:!0,precondition:bd,keybinding:{weight:L.WorkbenchContrib,primary:void 0,linux:{primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.KeyO)},win:{primary:Ce(C.CtrlCmd|w.KeyK,C.CtrlCmd|w.KeyO)}}})}async run(e,t){return e.get(yi).pickFolderAndOpen({forceNewWindow:!1,telemetryExtraData:t})}};ap.ID="workbench.action.files.openFolder";let Lu=ap;const dp=class dp extends R{constructor(){super({id:dp.ID,title:y(2959,"Open Folder..."),category:T.File,f1:!0,precondition:I.and(bd.toNegated(),Vo.isEqualTo("workspace")),keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|w.KeyO}})}run(e){return e.get(ke).executeCommand(iD)}};dp.ID="workbench.action.files.openFolderViaWorkspace";let Ru=dp;const va=class va extends R{constructor(){super({id:va.ID,title:va.LABEL,category:T.File,f1:!0,precondition:I.and(Kp,bd),keybinding:{weight:L.WorkbenchContrib,primary:C.CtrlCmd|w.KeyO}})}async run(e,t){return e.get(yi).pickFileFolderAndOpen({forceNewWindow:!1,telemetryExtraData:t})}};va.ID="workbench.action.files.openFileFolder",va.LABEL=y(2960,"Open...");let Vu=va;const cp=class cp extends R{constructor(){super({id:cp.ID,title:y(2961,"Open Workspace from File..."),category:T.File,f1:!0,precondition:Po})}async run(e,t){return e.get(yi).pickWorkspaceAndOpen({telemetryExtraData:t})}};cp.ID="workbench.action.openWorkspace";let Pu=cp;const lp=class lp extends R{constructor(){super({id:lp.ID,title:y(2962,"Close Workspace"),category:Id,f1:!0,precondition:I.and(Vo.notEqualsTo("empty"),nv),keybinding:{weight:L.WorkbenchContrib,primary:Ce(C.CtrlCmd|w.KeyK,w.KeyF)}})}async run(e){const t=e.get(Rt),i=e.get(wi);return t.openWindow({forceReuseWindow:!0,remoteAuthority:i.remoteAuthority})}};lp.ID="workbench.action.closeFolder";let Hc=lp;const hp=class hp extends R{constructor(){super({id:hp.ID,title:y(2963,"Open Workspace Configuration File"),category:Id,f1:!0,precondition:Vo.isEqualTo("workspace")})}async run(e){const t=e.get(xt),i=e.get(O),s=t.getWorkspace().configuration;s&&await i.openEditor({resource:s,options:{pinned:!0}})}};hp.ID="workbench.action.openWorkspaceConfigFile";let db=hp;const up=class up extends R{constructor(){super({id:up.ID,title:j0,category:Id,f1:!0,precondition:I.or(Po,Vo.isEqualTo("workspace"))})}run(e){return e.get(ke).executeCommand(Wv)}};up.ID="workbench.action.addRootFolder";let cb=up;const pp=class pp extends R{constructor(){super({id:pp.ID,title:y(2964,"Remove Folder from Workspace..."),category:Id,f1:!0,precondition:I.and(PR.notEqualsTo("0"),I.or(Po,Vo.isEqualTo("workspace")))})}async run(e){const t=e.get(ke),i=e.get(al),s=await t.executeCommand(sD);s&&await i.removeFolders([s.uri])}};pp.ID="workbench.action.removeRootFolder";let lb=pp;const gp=class gp extends R{constructor(){super({id:gp.ID,title:y(2965,"Save Workspace As..."),category:Id,f1:!0,precondition:Po})}async run(e){const t=e.get(al),i=e.get(xt),s=await t.pickNewWorkspacePath();if(s&&__(s))switch(i.getWorkbenchState()){case Ns.EMPTY:case Ns.FOLDER:{const o=i.getWorkspace().folders.map(r=>({uri:r.uri}));return t.createAndEnterWorkspace(o,s)}case Ns.WORKSPACE:return t.saveAndEnterWorkspace(s)}}};gp.ID="workbench.action.saveWorkspaceAs";let Ou=gp;const fp=class fp extends R{constructor(){super({id:fp.ID,title:y(2966,"Duplicate As Workspace in New Window"),category:Id,f1:!0,precondition:Po})}async run(e){const t=e.get(xt),i=e.get(al),s=e.get(Rt),o=e.get(Wn),r=e.get(wi),n=t.getWorkspace().folders,d=r.remoteAuthority,l=await o.createUntitledWorkspace(n,d);return await i.copyWorkspaceSettings(l),s.openWindow([{workspaceUri:l.configPath}],{forceNewWindow:!0,remoteAuthority:d})}};fp.ID="workbench.action.duplicateWorkspaceInNewWindow";let Mu=fp;S(cb);S(lb);S(xu);S(Lu);S(Ru);S(Vu);S(Pu);S(db);S(Hc);S(Ou);S(Mu);_.appendMenuItem(b.MenubarFileMenu,{group:"2_open",command:{id:xu.ID,title:c(2967,"&&Open File...")},order:1,when:Kp.toNegated()});_.appendMenuItem(b.MenubarFileMenu,{group:"2_open",command:{id:Lu.ID,title:c(2968,"Open &&Folder...")},order:2,when:bd});_.appendMenuItem(b.MenubarFileMenu,{group:"2_open",command:{id:Ru.ID,title:c(2968,"Open &&Folder...")},order:2,when:I.and(bd.toNegated(),Vo.isEqualTo("workspace"))});_.appendMenuItem(b.MenubarFileMenu,{group:"2_open",command:{id:Vu.ID,title:c(2969,"&&Open...")},order:1,when:I.and(Kp,bd)});_.appendMenuItem(b.MenubarFileMenu,{group:"2_open",command:{id:Pu.ID,title:c(2970,"Open Wor&&kspace from File...")},order:3,when:Po});_.appendMenuItem(b.MenubarFileMenu,{group:"3_workspace",command:{id:Wv,title:c(2971,"A&&dd Folder to Workspace...")},when:I.or(Po,Vo.isEqualTo("workspace")),order:1});_.appendMenuItem(b.MenubarFileMenu,{group:"3_workspace",command:{id:Ou.ID,title:c(2972,"Save Workspace As...")},order:2,when:Po});_.appendMenuItem(b.MenubarFileMenu,{group:"3_workspace",command:{id:Mu.ID,title:c(2973,"Duplicate Workspace")},order:3,when:Po});_.appendMenuItem(b.MenubarFileMenu,{group:"6_close",command:{id:Hc.ID,title:c(2974,"Close &&Folder")},order:3,when:I.and(Vo.isEqualTo("folder"),nv)});_.appendMenuItem(b.MenubarFileMenu,{group:"6_close",command:{id:Hc.ID,title:c(2975,"Close &&Workspace")},order:3,when:I.and(Vo.isEqualTo("workspace"),nv)});var Y0={"vs/workbench/contrib/debug/browser/media/continue-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIxSURBVHgB7dlNbtNAGMbxZyaUBSuOYHOBYlYskEhPwscFoKsqIBRHCCKyKNADQLkAR0jCiqBIhH6wAim+AWyAVKlnmDdKJUNTimT7nVm8v13SStGjfyauG0AIIYQQQgghBKPu5HGzO0kjBEahYjRUN3QbFk33MHMvkW6tP3iDQFQ6eDFW68GpF1HYzfN5p5WkGTzTYGAtbmu9Nni29/QWPGMZvBS56bu9/SevfZ5tzsELvmvXO1jZoTGms+Inka/atRduJY9SY3SMxSf2n5a1+5y1Wd7SraSVba0/jM+oHXPWZj3DIdRm/9DyXZt98Alftb0NJlT7ornEWtvrYLKZbOL61RtU+woYansfTDbUBtWectQOYvCJ/6nd0GtvUUJQg8l5tS1wGSUEN5gM7ABHmMXuvvomKnYBAaGhB18PMN4f3dfatN1b+FRNdwP/DSUEM3j7cFt9+DSKVMO8cg+bK37F7Tcvf5m8gxK8D6aqH/feq+P86N4ZVd2xRebO8x33x8o7lOT1DO982YGrGh9r23f1nq/4QFpWnV+rYizxUpiqjj+P1eznD5aqReyDqerIVdXnnNWZO6tpkn5HxdgGF6s2mKsWsQz2XbWo9sG9w96/qpJp3VWL6h1sVWTNvA/PVYvqLhy5kxmteJ6q3nVVh2DGfR2mqi+W19UhPOC8LHmrWlRpYQNNZ3H619PeqxbV8HVpN9LI29CK/iWThVCVBQ1PJ2mpm3UhhBBCCCFEOH4DIKF0k8sm4ZEAAAAASUVORK5CYII=",import.meta.url).href,"vs/workbench/contrib/debug/browser/media/pause-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADASURBVHgB7dmxDcIwEEbh3xGLMAIbgFiADWADKmqoEUPAJFY2YAOyBRUxR2GLjkgxzeV9VWLlFD+3lgAAAAAAmJ6gyg4x7ZW0KT8Iup5X4fZr7hiTntI2Je3ymj23l3U4qaKZKrNNLuwUl/n91asdMvc5+b7X3A6ozIZGD1XWaGII9o5g7wj2jmDvCPaOYO8I9o5g7wj2jmDvCPaO4NpGXG0k/UH1mwfbZmeVMb9acDdsrHwbv5bvAgAAAAAAo70BgzIgmYCKG/cAAAAASUVORK5CYII=",import.meta.url).href,"vs/workbench/contrib/debug/browser/media/restart-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAASRSURBVHgB7ZlPTxtHGMafGUNsStWEQ6QcTauemha76r1GvZf0CzQ410iBcgiCNGVpipE5ADnkWuMec4hoP4BNbtzstBwqVWq2UlUhBTUoqgv2emf6jg1lcW1iZsdWkeYnGbyz9s48nnnn/TOAxWKxWCwWi8VisXQBQx9ZKS0lfCAR4bjsCzHSbOUuINwq/LKTdPbRY7QEOyXnShS4cnxdBfY7DXa59CDFI5EpJmVKBr7TYTRbkGxDiNrTuaTjogcMQIMoItOc84Xj65jEBv1LBz/TEMp5jt7GISVkNw+WSNEf+t6gXPkps+jXa3nTwjkMs1xajmd/XCqS2CKUWD2YFNIh4YVM6cENGMSoYCWWc1FszlQHpCzThG+cvOQW2VUn2x2NcP6EZnsBhtBa0u1QGxJIbDs7VaKkZPkqvM12tp57nsPu/u8pDjYJzm623FazvUCicff9+UWERGvTIvt0gjbc3Gwayzfe8lFXCJGeS97fQhcUZRHb5e04h++0ES4h2Mxscn4dITCzpJtLOH66jW0eCC/ZrVjFOBvHXHLOHXrzrUlfyJmW2wxcrjZWUgiMb1pNZH42Mf+Zrl+98+4dXB4cWRMCt1puMcnxLULQC8HugahPIyS3r99GDG/kyCRa7TaRfZa5CU3M2HAAmpW0ipyCbWGiqJWdFSbqXoGxk52fBl26O3bvQ2hgfIY5R0754OAr+roI6wyuDl+lTV58HWwjT5BQgQ006JENmyM9mkZkMEpujTzBCYxxTEADLcEx+Mo1lNEnYtGYpFj8h2AbB/8YGmgJ/oLs8ZLwxo9+dbeLVyiuVa+hDrYVbFPLGhr0NT3URUoH62WM1Pjgn8FmIby3z5tc/O9tWMGYo9a1kVz5Qgg2yYURLKpdZdSv5UIIfrzzGIdS/meT0ikOXAjBu9FdymNlKtjGNN2ikXxY5bMvKy8bO/7M9Rkzay9A5a8KIz4NuhQB8RQahJphtdRUrEvJ+3jNr6x54nBVtZlE/ZhAPRWMpaE8lcAmNAgl2PV+SUjhFSheLlCyOkXDmKa2pEN+0xR7r/5g9PzWlNClPLv/MzwIz2USY8G2Rr5KQQIMkH2WZQJMZWXxYBdkwQ40CR1pZUrfTEc4Wzv1UIYNJi/d+uiDihzXHFv25yxD1ae8V+Zabv06O3bvHWgSepeeT365TjF1MdhG15OCeU+2yxh9tPMI50HVtVZ3MoxVxVQbsSqc/AQhMBJLH5VnC/R2tOWWS10ssshAfhjD8sV7L+B0mHG1Oe292mO+qMd5RK5REtya/tFSFouzY/dDVS6NJQ/NMi0KNKqRNr2oI5T8gah9PzQ0tM+rVJCNNbv2pY+BQx816acox71Bad/nbUq9RsQ2h2KQM2Y6SJmM3KVacyMZIHtP0CDiZ5w7GRPb6A+GaYiGv3BUVw7zfBXAHNe1tVxQO3qWDy+XliapvvUVmi7lPP1IdfRCx6kPqfj30PQRas8LANnGYRibYJxNBJZtsN9/Q1F1JMMZ2/xbeN/16qy47wfidF4SF6fKM/w52ehv/ToQt1gsFovFYrFYLJau+AfCNPXR3BjmUgAAAABJRU5ErkJggg==",import.meta.url).href,"vs/workbench/contrib/debug/browser/media/run-with-debugging-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAUfSURBVHgB7ZpNTxtHGMefmbWTktICh1x66bqXXqpit5ccKmHovSVfoGCukUqJUlEaqixKE0Qb4RQpxwL9Amn6BWJzKlKl2Ea5VJXqvfVYU1xsx96ZPI+9gxdjwtpmd1G0Pwn2bWZ3/vOft2cAICQkJCQkJCQkJCTkQrKau5tczRk6XBAYeAQJ5Rq/AxKSeGnip4zF8W9/gYDxRPBa7u40cP7riY8x2Las+spSwjAhIDh4gAA+2u2+lDDLeTSzVrg/AwHhieAz0FH69g9797aC6NtBCG4SlNv+CGYyK4RY6fJE99tt3xxeSnxnCMFj0Byxj2O7/dQPt31t0kuJJXNx/HbsFLdjfrgdSB8O0u3ABq2g3A5MsOJa/BNy+z3wye3ABU+ySXK7eElc8cXtwAUrFhILvrh9YQQTfrjtkWCeBSGug5AUHZnQI27c1nj0MfRBBDyARmBoFfQJXVOoCD1CbiPFdC4dq0LZ4BxDTQcSYBT6wJcmjfNuFvogIzNQhWoM4+oJOCcGdlgF+kxCnGodA+ySZCyLFjwZJODf+GsD/tjbnde4MLAJn3ATv/Mv9MFADtPggU0tQ7saqok1j1JO0+Dy4979NPQIubqaW41VKgcZCeJht6ZL9w9F/VPoA1c7HlSIncLO2PDQcOnW+7fko+ePoCz20yjsK1UGJIuvM/FUZ4wl1btpl+PqW++kUrEUPPjzAasflt+9FgdzkhknvvGs8DuzGPsStxCMLkLxFpg4eqewi+xAn7gSTDXOuXiKhc/yy5fn6oe1Gc5hy35cxELMOfspptcpPTSnESy+EJPRK0M7olbbxOaZFKI+hds8RZV+/fk6e1Gv6UwTm/YeWCeYTfxUFdaKkTBKMACu+jBj4mc86DQdYKHJNV09swtvOtPTKI2ip1B0UxT1ccxnUv7WdZTeN0Xn5HqjWpvHtHe69NVzcdWJK8FS8jkU3XSMCs1Uu8DA/u3oVZOaeBfMg0Ypi2mTdh9XFIVVn1MXtcNaPMIh3fWz5+SqE1eCHY4dNdMWDP6rl1Kn5eMatDxqU+xsEVpUyzPLKjn67Lm76qSnbdrmFESjcp9QX+6ck1v99/8043wePHLVSY/zMNcdFxLcY1es1DsfvFndl3UtksXTz7xy1Ykrwbi8ax6rcHh0DxUsWEIUzsorgcU1ztKd76L1MvHPxwxG8lZ2X1gfeeWqE1eCaS1LR860cWUsiXWzZMRuAMpgrkU+r1pl3X5kNH+15mPPhSpcCW4v3HtpxV3AFRi+a9q+MiAA3PZhp9JB/h41YI0NjivBOJVQXIoL7wj+kazVHyMaG4Ee4Uxe//rD5d8gQFwFDzRv0s8laGyre5aUk4Y0XpmP1secs1l13bAaZw5yXtNjtDRCg0uezhjwGTwbOy0lVcZufhcXKWyilR7yb4yOmBAwrgXTdFLjFQNP4/at0SEt+nitsMYyHU5vFbeoWsY4BQPQWndj543XyxWD4twgcTUA0Vr5wNo3GEi1zSIdeU1aLvKhIVNjGjZ1C0TlBa3I1qFdOe30gt0cjo6kb3xwA4LAlcNla3/mmFghb+JRhXcYCkb/hlrjWaNS26QjiqU1txJblCBXQI3QXK7T+yAgXDZpkbRPpBAwt5hYfog7ilM4r9K/NaipJo6R0Sw4XEUy5P4348srlK+d9uh9vuN6Tl0rfL8lBNtZStzePnaf/p+DsS9ol8OOeEyUmhdSbnSuxFZz93AzXU4sji+nICQkJCQkJCTkdecljQujDnl0mKoAAAAASUVORK5CYII=",import.meta.url).href,"vs/workbench/contrib/debug/browser/media/stepinto-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJRSURBVHgB7ZpNbtNAFMf/zzYCdnACcoQKLlCzYAviAvQIoFLEroUVUoXoCZpwBLYg6nKDcoLkBsmCL6luH/Ocpoqjtnbdea9S+n5SFI89mpmfx56PlwCO4ziO4ziODgRj1gtenU9/zGkfhmQwJmEUC6dMb3qCG4YLLzsuvOy48LLjwldl/Vt9JdWVzYLxuohT1jxRhd8U/CJJUWx85z6uwFbB9A/oE2NPykREoglLw5gxqBKEta7SIvsX2D1mrElJocx+TOkowi8LvhcauFM72UF6Qfa0pJD+JHUgAlGEd3KaUImcgUntwiWkz5FFKHNMhMdSByIQ7ZHefkIHXaWbZLdzOkAkog5aXaQtZadNUWDjK69whiIUXn/vZFCjulhCGFjJCmqb73OlG9CUFVSjDZeV1pYV1MMrbaUtZAWTeFKTtJWsYLJ5mBu9x4vXLGUF04jhSU/vzXpapi9LWcE8Lv224F5ZoifHWYbRh5xGcJxomD7Ssqmn26FOnqY5RbWu3MrtmmFWU1gz4xeQ0xGehoHqgZzjBD/CNPHlDjB8ZyRtUovI/glfYTO/ecZlmZZe3QU+W0irz8MNssJ9iWr8LrEKA9SFQ2yqd4HsDKIUu/KOa6MuXB7jWcusPYte1l9aElZaZ02mCxJN1IXD49w6FhWCAWMoo9/DjP22WcNo/RPKqAsfpZXwsCFbWJFgYLGuVheuwqslnp+1NTxBhuZhCryHAWb74YzwMBzKH1p49qluQujZQ8Ijq13TtW0Pw+9Gk8NbGMUKsDuO4ziO4zjXzX/ncxVIRDwWzgAAAABJRU5ErkJggg==",import.meta.url).href,"vs/workbench/contrib/debug/browser/media/stepout-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJSSURBVHgB7ZpRbtNAEIb/cYIAqQ/tCQg3qOACOEi8Aj1BOQIPEbw14amoIHECKBcA8cpDDTeAEyQ3oA9AK9XpdsbxSlGUNk60M62i+aRIlr3S5vPYuzvjBRzHcRzHcRwdCMa8KkKnBDpy3AZGb3MawRBT4V4RtkNAwZ1u1qeOUSI/eEK/YEQGI+bICpsc5qPe97ANI0wifInsNH840l2LSKsLN5CNmEirCi8hG1GXVhNeQTaiKq0yaF0mG4DPs23nnNvSHMiSC18l+65Lu7PtNwgvLKWTCi8rK/RzCpbSyYRXkY1YSqeLcMDXWdnzgMEi2Ugtvcs3bTBzSaS/IBHphEs8D7JUrBHZ94+pjyVgaWxk6E9LBxm1CTtIRDJhmUaI18UivYpsZFpaZIl4isrTTVFJBy2RLgn3V5WNROk24UFKWcE8PewdceymOOiS6X8wy5ZuCi687rjwuuPC604b9gRcI+bCYYwuHEcN03XsXhFAt7nP+i0OLQQ6mSQLVpj11GfZv0BOYzzldOGenAsZfvI08e0OMBwYSZv0IrL/UeW4e3MuS8778i6Xdyyk1efhBbLCFl/79K/EIxigLnzKn0avkI0QtfBR3nFt1IXLczxr2LRjEWX9pSWhcYmVssmHck3UhflxPm7aNiOuUCqjH+GAH02b8mj9G8qoC49blfBwQTNekeBw32C/h7rwh5xkH8dOVVCfjwzNwxbwBgaY5MNSr5YaMx8WmAhWv/qrwuEZ4eG+0W4e87r0a9m2VKJDPJid3cKoegIcx3Ecx3GcNeAC4UEBaURTA6MAAAAASUVORK5CYII=",import.meta.url).href,"vs/workbench/contrib/debug/browser/media/stepover-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMnSURBVHgB7ZldTttAFIXPOA5Sfx5YgmEDzQ6agPpcdgB0BVQ09JHQp7a0aruBClZA+9qWOKygdAONl5BKhf4AuT0DQXKCG8cTzwik+SQLezzGc3zv3Dt3Ang8Ho/H4/F4PB4TFG4IrVjQA6J029uGSlAQp4LXYokqqUEHQO8ESDjwXt6zT2NRfUE/1SQnCvNFRYewiBY4AyyLoC5ATQlmR/tUeTTbkkDQUQE+vmyoD7CIFcHrsdQDwSYuhJ6T40oRO6zww6xo8Uphh9bffW7gsnkEKBG6XcQBxxQb87IOMyIKb50J2huxLKNkSrOwtioHuUdLzuZ0TVLn0Zh+cxS+s7Ev9/4GeMbrHyiBUgRrS+jBZd2jS/d47x3DTecsxOFogGp+khoqqPH0Id166crzCo+rnBp/FBarmJ6po/TGF1mSAHsZt/RcbDEI7WICdNr5TYuf0p05qCxXPuRRS10bRempBOs5Szf+esWNadGTAK1J0s0omxR+dIqGquA9xru8keCpghbzYjwqlm1b24tqzUSsZquhcDdEHCgsYHi+l4Kx4Oa+rGDEAlrs60XVwpS0KPoW0NWidQxAiZgHLcU8O0xiIjZryagZqJSqwhanyBuUhJHgdQYqjAyS1mjAgGN+uhlODRk/XzMJT8+fSQo8YubSnLdD6YOD7bywsCrKIQnD4nPcTHCA+0P/RGXnYIt0K5zfJkvPwoJZEOioHKXbaOFvcIexWE3hPNyMuTJi7k23bS+oG1NXFw5aun7lUm/18lpJuWnD4/F4xuE8uupq6PKlevtHFwsucfY2LfQX39fXWz/9wcIlwAEXAh0WCuJKuJO3nNe4YI0rmTVuImdYvROi40J0qZt4/2Mgto3sAiFisd9m0V+HA6x/Um3dY0EX+dVQ9zZ3MGxb2bqFjy62a6MJukY/HVjZumDpTyxCsQqbtK8x1gUXcFAZHFaxH7S4H22lryFO0hJ/fvnOP3M53bosM+dhGSdpiXn2Eca7q+hcDAc4EfzqgepQkN5n1ukpLVyfd3mvwT4HcIDztfSTz1LHZTTmnNUfAx6Px+PxeDwej8dz3fgHnygaDf8DyT4AAAAASUVORK5CYII=",import.meta.url).href,"vs/workbench/contrib/debug/browser/media/stop-tb.png":new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADLSURBVHgB7dkxDoJAEEbhf4ml3gFvwpGsNFSWxEqPxEmMdzDRRHRXSGjsZIEQhvclhJaXHZodCQAAAAD+4BThXuwyeWWaUqJyk19KdbRSjDrWJe6oCQUfmlepjhItzOKC40b6122dn7ca2bM4uI9eXj0x0tYRbB3B1hFsHcHWEWwdwdYRbB3B1hFsHcHWEWzdEBfxepz2UUu5LqrwdklQb0MEp95XV41sqFEc5IRrqWZirv9waJ/O4k64Xka3+9mphOYbBAAAAABj+QJmPCRPyVBXxgAAAABJRU5ErkJggg==",import.meta.url).href};I_(Y0);let Nl;I_({"vs/workbench/contrib/webview/browser/pre/service-worker.js":()=>Eg(new URL("/assets/service-worker.VQd3YMwb.js",import.meta.url).href,Nl),"vs/workbench/contrib/webview/browser/pre/index.html":()=>Eg(new URL("/assets/index.DcLbqHcr.html",import.meta.url).href,Nl),"vs/workbench/contrib/webview/browser/pre/fake.html":()=>Eg(new URL("/assets/fake.DXkbmQ09.html",import.meta.url).href,Nl)});KR(async a=>{a.get(mt)});function pG(a){return a!=null&&(Nl=a),{...C1(),[jt.toString()]:new he(Hm,[],!1),[At.toString()]:new he(Im,[],!0),[Ir.toString()]:new he(nm,[],!0),[_r.toString()]:new he(Fm,[],!0),[qn.toString()]:new he(WR,[],!0),[il.toString()]:new he(HR,[],!1),[Qs.toString()]:new he(Dm,[],!1),[Zs.toString()]:new he(_V,[],!0),[Bn.toString()]:new he(GR,[],!0),[_b.toString()]:new he(Tm,[],!0),[mt.toString()]:new he(Vh,[],!1),[a_.toString()]:new he(Lm,[],!0),[Hn.toString()]:new he(Mm,[],!0),[JE.toString()]:new he(zM,[],!0),[Zb.toString()]:new he(BR,[],!0),[Xc.toString()]:new he(Nm,[],!0),[Mb.toString()]:new he(Km,[],!0),[FR.toString()]:new he(r1,[],!0),[MR.toString()]:new he(NR,[],!0),[OR.toString()]:new he(n1,[],!0)}}se.as(qt.ViewContainersRegistry);se.as(qt.ViewsRegistry);export{hf as A,TC as B,_e as D,fC as E,im as P,om as S,pG as a,nm as b,Yo as c,Da as d,HV as e,iI as f,MF as g,dV as h};

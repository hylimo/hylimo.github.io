import{_ as s,o as a,c as n,au as t}from"./chunks/framework.YNMxXZI1.js";const g=JSON.parse('{"title":"Diagram DSL","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"docs/diagram.md","filePath":"docs/diagram.md"}'),i={name:"docs/diagram.md"};function l(o,e,p,c,r,d){return a(),n("div",null,[...e[0]||(e[0]=[t(`<h1 id="diagram-dsl" tabindex="-1">Diagram DSL <a class="header-anchor" href="#diagram-dsl" aria-label="Permalink to “Diagram DSL”">​</a></h1><p>HyLiMo provides several diagram type-independent features</p><h2 id="diagram" tabindex="-1">Diagram <a class="header-anchor" href="#diagram" aria-label="Permalink to “Diagram”">​</a></h2><p>Diagrams are a triple of a root element, styles and font families. Diagrams can be created using the <code>createDiagram</code> function. However, usually the <code>diagram</code> function is not used directly, but rather the <code>diagram</code> DSL function (or the diagram type-specific equivalent) is used:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>diagram {</span></span>
<span class="line"><span>    // diagram content</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>The diagram must always be the returned value in the global scope and thus should usually be the last and/or only statement in the file.</p><h2 id="elements" tabindex="-1">Elements <a class="header-anchor" href="#elements" aria-label="Permalink to “Elements”">​</a></h2><p>Elements are the building blocks of diagrams. Different types of elements exist:</p><ul><li>rect: a rectangle with an optional content</li><li>ellipse: an ellipse with an optional content</li><li>path: an SVG path</li><li>text: a text element containing at least one span <ul><li>span: a span of text with associated styling</li></ul></li><li>vbox: stacks elements vertically</li><li>hbox: stacks elements horizontally</li><li>stack: stacks elements on the z-axis</li><li>canvas: a canvas where elements and connections can be used <ul><li>canvasElement: a container with a position on the canvas</li><li>points: three different types of points are supported <ul><li>absolutePoint: a point with absolute coordinates</li><li>relativePoint: a point with coordinates relative to another point or canvasElement</li><li>linePoint: point on a canvasConnection or the outline of a canvasElement, defined by its relative position on the line, and an optional distance to the line</li></ul></li><li>canvasConnection: connection between two canvas elements / points, consists of a list of segments, at least one <ul><li>marker: element positioned at the start / end of the canvasConnection</li><li>canvasConnectionSegment: segments which make up the connection, three types of segments exist: <ul><li>canvasLineSegemtn: straight line between two points</li><li>canvasBezierSegment: cubic bezier curve between two points using two control points</li><li>canvasAxisAlignedSegment: axis-aligned poly line, consisting of one to three line segments</li></ul></li></ul></li></ul></li></ul><p>Elements are usually used by developers to create new diagram types. However, diagrammers can also use elements directly to extend the graphical appearance of their diagrams. Each of these elements can be created as a function, which takes element type-specific parameters. All these functions have in common, that they take a function as only positional argument, which is executed to create inner elements:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>rect(fill = &quot;green&quot;) {</span></span>
<span class="line"><span>    text {</span></span>
<span class="line"><span>        span(text = &quot;Hello World&quot;)</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="styles" tabindex="-1">Styles <a class="header-anchor" href="#styles" aria-label="Permalink to “Styles”">​</a></h2><p>Styling allows to manipulate the appearance of elements. Available style attributes depend on the element type. For example, shape-like elements provide <code>fill</code>, <code>fillOpacity</code>, <code>stroke</code>, <code>strokeWidth</code>, <code>strokeOpacity</code>, <code>strokeDash</code>, and <code>strokeDashSpace</code> attributes. Layouted elements, including <code>vbox</code>, <code>hbox</code>, <code>stack</code>, <code>rect</code>, <code>ellipse</code> and <code>path</code> also provide attributes to affect their layouting:</p><ul><li><code>width</code>, <code>minWidth</code>, and <code>maxWidth</code> for defining its width, here <code>width</code> takes precedence over <code>minWidth</code> and <code>maxWidth</code></li><li><code>height</code>, <code>minHeight</code>, and <code>maxHeight</code> for defining its height, here <code>height</code> takes precedence over <code>minHeight</code> and <code>maxHeight</code></li><li><code>margin</code>, and its variants <code>marginTop</code>, <code>marginRight</code>, <code>marginBottom</code>, and <code>marginLeft</code> for defining the margin around the element</li><li><code>vAlign</code> and <code>hAlign</code> for defining the vertical and horizontal alignment of the element within its parent</li></ul><p>Style attributes can be set in two ways: First, they can be defined directly on the element. However, this makes styling more verbose and less reusable. Therefore, styles can also be defined using the SCSS-inspired <code>styles</code> function:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>styles {</span></span>
<span class="line"><span>    any {</span></span>
<span class="line"><span>        fill = &quot;green&quot;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>This function takes a function as only positional argument, which is executed to define the styles. Selectors can be nested to limit to which elements the styles apply, similar to SCSS, selectors can be nested:.</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>styles {</span></span>
<span class="line"><span>    cls(&quot;class&quot;) {</span></span>
<span class="line"><span>        cls(&quot;title&quot;) {</span></span>
<span class="line"><span>            fontWeight = &quot;bold&quot;</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>Supported selectors include cls, which matches elements with a specific class, type, which matches elements of a specific type, and any, which matches all elements.</p><p>To support theming, CSS-inspired variables can be used in styles:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>type(&quot;rect&quot;) {</span></span>
<span class="line"><span>    border = var(&quot;primary&quot;)</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>The value of variable can be defined in selectors:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>any {</span></span>
<span class="line"><span>    variables.primary = &quot;green&quot;</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>Also, to define variables for nested elements, we provide the <code>vars</code> construct which wrapps set variables into an <code>any</code> selector:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>vars {</span></span>
<span class="line"><span>    primary = &quot;green&quot;</span></span>
<span class="line"><span>    secondary = &quot;blue&quot;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>// is equivalent to</span></span>
<span class="line"><span>any {</span></span>
<span class="line"><span>    variables.primary = &quot;green&quot;</span></span>
<span class="line"><span>    variables.secondary = &quot;blue&quot;</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="canvas-constructs" tabindex="-1">Canvas Constructs <a class="header-anchor" href="#canvas-constructs" aria-label="Permalink to “Canvas Constructs”">​</a></h2><p>Canvas is the most important diagram element for graph-based diagrams. To allow separating layouting and styling from the contents of elements, and create a consistant user experience, inside <code>diagram</code> blocks, several constructs are available:</p><h3 id="element-function" tabindex="-1"><code>element</code> function <a class="header-anchor" href="#element-function" aria-label="Permalink to “element function”">​</a></h3><p>can be used to create a canvas element with some content:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>element {</span></span>
<span class="line"><span>    text {</span></span>
<span class="line"><span>        span(text = &quot;Hello World&quot;)</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="point-functions" tabindex="-1">Point functions <a class="header-anchor" href="#point-functions" aria-label="Permalink to “Point functions”">​</a></h3><ul><li><code>apos</code>: creates an absolute point, takes x and y as arguments</li><li><code>rpos</code>: creates a relative point, takes target, x and y as arguments</li><li><code>lpos</code>: creates a line point, takes target, pos, and distance as arguments</li></ul><h3 id="styles-operator" tabindex="-1"><code>styles</code> operator <a class="header-anchor" href="#styles-operator" aria-label="Permalink to “styles operator”">​</a></h3><p>Can be applied to any element to define element-specific styles:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>rect() styles {</span></span>
<span class="line"><span>    fill = green</span></span>
<span class="line"><span>    any {</span></span>
<span class="line"><span>        fontSize = 10</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>Also allows to set style classes:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>rect() styles {</span></span>
<span class="line"><span>    class += &quot;test-rect&quot;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>// is equivalent to</span></span>
<span class="line"><span>rect(class = list(&quot;test-rect&quot;))</span></span></code></pre></div><h3 id="layout-operator" tabindex="-1"><code>layout</code> operator <a class="header-anchor" href="#layout-operator" aria-label="Permalink to “layout operator”">​</a></h3><p>Can be used to set width, height and position of a canvasElement (<strong>not</strong> other diagram elements):</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>element {</span></span>
<span class="line"><span>    // some content</span></span>
<span class="line"><span>} layout {</span></span>
<span class="line"><span>    width = 100</span></span>
<span class="line"><span>    height = 100</span></span>
<span class="line"><span>    pos = apos(10, 20)</span></span>
<span class="line"><span>}</span></span></code></pre></div><h3 id="with-operator" tabindex="-1"><code>with</code> operator <a class="header-anchor" href="#with-operator" aria-label="Permalink to “with operator”">​</a></h3><p>Can be used to customize canvasConnections, by adding labels to the canvas connection and defining the segments using a custom fluent builder syntax:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>aCanvasConnection with {</span></span>
<span class="line"><span>    over = start().line(apos(10, 20)).line(end())</span></span>
<span class="line"><span>    // a label in the middle of the connection with distance 100</span></span>
<span class="line"><span>    label(&quot;the text of the label&quot;, 0.5, 100)</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>The builder for creating the segments supports the following methods:</p><ul><li>start: starts the line, if the start element is a canvasElement takes the relative position on the outline as argument<div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// canvas element start:</span></span>
<span class="line"><span>start(0)</span></span>
<span class="line"><span>// point start</span></span>
<span class="line"><span>start()</span></span></code></pre></div></li><li>end: ends the line, if the end element is a canvasElement takes the relative position on the outline as argument<div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// canvas element end</span></span>
<span class="line"><span>end(0)</span></span>
<span class="line"><span>// point end</span></span>
<span class="line"><span>end()</span></span></code></pre></div></li><li>line: adds a line segment for each positional argument<div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// 1 segment</span></span>
<span class="line"><span>start(0).line(end(0))</span></span>
<span class="line"><span>// 2 segments</span></span>
<span class="line"><span>start(0).line(apos(100, 100), end(0))</span></span></code></pre></div></li><li>bezier: adds a bezier segment, first takes relative coordinates for the start control point, next the end point, and last the relative coordinates for the end control point. Also supports adding multiple segments at once by repeating the first two parameters for each segment, control points are mirrored at each inner point.<div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// 1 segment</span></span>
<span class="line"><span>over = start(0).bezier(100, 100, end(0), 100, 100)</span></span>
<span class="line"><span>// 2 segments</span></span>
<span class="line"><span>over = start(0).bezier(100, 100, apos(100, 100), 100, 100, end(0), 100, 100)</span></span></code></pre></div></li><li>axisAligned: adds an axis-aligned segment, takes the end point and a relative position between -1 and 1 for the center part of the segment. If the provided position is positive, the position defines the relative position of the vertical segment, if negative the relative position of the horizontal segment. Similar to other segment types, inputs can be repeated for multiple segments.<div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>// 1 segment, horizontal first</span></span>
<span class="line"><span>over = start(0).axisAligned(0.5, end(0))</span></span>
<span class="line"><span>// 1 segment, vertical first</span></span>
<span class="line"><span>over = start(0).axisAligned(-0.5, end(0))</span></span>
<span class="line"><span>// 2 segments</span></span>
<span class="line"><span>over = start(0).axisAligned(0.5, apos(100, 100), -0.5, end(0))</span></span></code></pre></div></li></ul><p>Label allows to create a label on the connection. The function takes the text to display, the relative position on the connection, and the distance to the connection as arguments.</p>`,46)])])}const u=s(i,[["render",l]]);export{g as __pageData,u as default};
